<!DOCTYPE html><html>
<head>
<title></title>
<style type="text/css">
<!--
.xflip {
    -moz-transform: scaleX(-1);
    -webkit-transform: scaleX(-1);
    -o-transform: scaleX(-1);
    transform: scaleX(-1);
    filter: fliph;
}
.yflip {
    -moz-transform: scaleY(-1);
    -webkit-transform: scaleY(-1);
    -o-transform: scaleY(-1);
    transform: scaleY(-1);
    filter: flipv;
}
.xyflip {
    -moz-transform: scaleX(-1) scaleY(-1);
    -webkit-transform: scaleX(-1) scaleY(-1);
    -o-transform: scaleX(-1) scaleY(-1);
    transform: scaleX(-1) scaleY(-1);
    filter: fliph + flipv;
}
-->
</style>
</head>
<body>
<a name=1></a><b>The&#160;Linux&#160;Command&#160;Line</b><br/>
Fifth&#160;Internet&#160;Edition<br/>
William Shotts<br/>
A&#160;LinuxCommand.org&#160;Book<br/>
<hr/>
Copyright&#160;©2008-2019,&#160;William&#160;E.&#160;Shotts, Jr.<br/>
This&#160;work&#160;is&#160;licensed&#160;under&#160;the&#160;Creative&#160;Commons&#160;Attribution-Noncommercial-No&#160;De-<br/>rivative&#160;Works&#160;3.0&#160;United&#160;States&#160;License.&#160;To&#160;view&#160;a&#160;copy&#160;of&#160;this&#160;license,&#160;visit&#160;the&#160;link<br/>above&#160;or send a&#160;letter&#160;to Creative&#160;Commons, PO&#160;Box 1866, Mountain&#160;View,&#160;CA&#160;94042.<br/>A&#160;version&#160;of&#160;this&#160;book&#160;is&#160;also&#160;available&#160;in&#160;printed&#160;form,&#160;published&#160;by&#160;No&#160;Starch&#160;Press.<br/>Copies&#160;may&#160;be&#160;purchased&#160;wherever&#160;fine&#160;books&#160;are&#160;sold.&#160;No&#160;Starch&#160;Press&#160;also&#160;offers&#160;elec-<br/>tronic&#160;formats&#160;for popular&#160;e-readers.&#160;They&#160;can be&#160;reached&#160;at:<a href="https://www.nostarch.com/">&#160;https://www.nostarch.com</a>.<br/>Linux®&#160;&#160;is&#160;the&#160;registered&#160;trademark&#160;of&#160;Linus&#160;Torvalds.&#160;&#160;&#160;All&#160;other&#160;trademarks&#160;belong&#160;to<br/>their&#160;respective&#160;owners.<br/>This&#160;book&#160;is&#160;part&#160;of&#160;the&#160;LinuxCommand.org&#160;project,&#160;a&#160;site&#160;for&#160;Linux&#160;education&#160;and&#160;advo-<br/>cacy&#160;devoted&#160;to&#160;helping&#160;users&#160;of&#160;legacy&#160;operating&#160;systems&#160;migrate&#160;into&#160;the&#160;future.&#160;&#160;You<br/>may contact&#160;the&#160;LinuxCommand.org&#160;project&#160;at<a href="http://linuxcommand.org/">&#160;http://linuxcommand.org</a>.<br/><b>Release&#160;History</b><br/>
<b>Version</b><br/>
<b>Date</b><br/>
<b>Description</b><br/>
19.01A<br/>
January 28, 2019<br/>
Fifth Internet&#160;Edition&#160;(Corrected&#160;TOC)<br/>
19.01<br/>
January 17, 2019<br/>
Fifth Internet&#160;Edition.<br/>
17.10<br/>
October&#160;19, 2017<br/>
Fourth Internet&#160;Edition.<br/>
16.07<br/>
July 28, 2016<br/>
Third Internet&#160;Edition.<br/>
13.07<br/>
July 6, 2013<br/>
Second Internet&#160;Edition.<br/>
09.12<br/>
December 14, 2009<br/>
First&#160;Internet&#160;Edition.<br/>
<hr/>
<a name=3></a><i><b>Table&#160;of&#160;Contents</b></i><br/>
<a href="linux-command-lines.html#18"><i><b>Introduction</b></i></a><i><b>....................................................................................................xvi</b></i><br/>
Why&#160;Use&#160;the&#160;Command&#160;Line?......................................................................................xvi<br/>What&#160;This&#160;Book&#160;Is&#160;About..............................................................................................xvi<br/>Who&#160;Should&#160;Read&#160;This&#160;Book.......................................................................................xvi<br/>What's&#160;in&#160;This&#160;Book.....................................................................................................xvi&#160;i<br/>How&#160;To&#160;Read&#160;This&#160;Book................................................................................................xix<br/>
Prerequisites............................................................................................................xix<br/>
Why&#160;I&#160;Don't&#160;Call&#160;It&#160;“GNU/Linux”...........................................................................xix<br/>
What's&#160;New&#160;in&#160;the&#160;Fifth&#160;Internet&#160;Edition.........................................................................xx<br/>Acknowledgments..........................................................................................................xx<br/>
First&#160;Internet&#160;Edition..................................................................................................xx<br/>Second&#160;Internet&#160;Edition............................................................................................xxi<br/>Third&#160;Internet&#160;Edition................................................................................................xxi<br/>Fourth&#160;Internet&#160;Edition..............................................................................................xxi<br/>Fifth&#160;Internet&#160;Edition.................................................................................................xxi<br/>
Your&#160;Feedback&#160;Is&#160;Needed!............................................................................................xxi<br/>Further&#160;Reading............................................................................................................xxi<br/>Colophon......................................................................................................................xxi<br/>
<a href="linux-command-lines.html#25"><b>Part&#160;1&#160;–&#160;Learning&#160;the&#160;Shell.</b></a><b>..............................................................1</b><br/>
<a href="linux-command-lines.html#26"><i><b>1&#160;–&#160;What&#160;Is&#160;the&#160;Shell?</b></i></a><i><b>......................................................................................2</b></i><br/>
Terminal&#160;Emulators..........................................................................................................2<br/>Making&#160;Your&#160;First&#160;Keystrokes..........................................................................................2<br/>
Command&#160;History.......................................................................................................3<br/>Cursor&#160;Movement.......................................................................................................3<br/>
A&#160;Few&#160;Words&#160;About&#160;Mice&#160;and&#160;Focus.....................................................................3<br/>
Try&#160;Some&#160;Simple&#160;Commands..........................................................................................4<br/>Ending&#160;a&#160;Terminal&#160;Session..............................................................................................5<br/>
The&#160;Console&#160;Behind&#160;the&#160;Curtain...........................................................................5<br/>
Summing&#160;Up....................................................................................................................5<br/>Further&#160;Reading...............................................................................................................6<br/>
<a href="linux-command-lines.html#31"><i><b>2&#160;–&#160;Navigation</b></i></a><i><b>...................................................................................................7</b></i><br/>
Understanding&#160;the&#160;File&#160;System&#160;Tree...............................................................................7<br/>The&#160;Current&#160;Working&#160;Directory........................................................................................7<br/>Listing&#160;the&#160;Contents&#160;of&#160;a&#160;Directory..................................................................................8<br/>
i<br/>
<hr/>
<a name=4></a>Changing&#160;the&#160;Current&#160;Working&#160;Directory........................................................................9<br/>
Absolute&#160;Pathnames..................................................................................................9<br/>Relative&#160;Pathnames...................................................................................................9<br/>Some&#160;Helpful&#160;Shortcuts............................................................................................11<br/>
Important&#160;Facts&#160;About&#160;Filenames........................................................................11<br/>
Summing&#160;Up..................................................................................................................12<br/>
<a href="linux-command-lines.html#37"><i><b>3&#160;–&#160;Exploring&#160;the&#160;System</b></i></a><i><b>..............................................................................13</b></i><br/>
Having&#160;More&#160;Fun&#160;with&#160;ls................................................................................................13<br/>
Options&#160;and&#160;Arguments............................................................................................14<br/>A&#160;Longer&#160;Look&#160;at&#160;Long&#160;Format.................................................................................16<br/>
Determining&#160;a&#160;File's&#160;Type&#160;with&#160;file.................................................................................17<br/>Viewing&#160;File&#160;Contents&#160;with&#160;less.....................................................................................17<br/>
What&#160;Is&#160;“Text”?.....................................................................................................17<br/>Less&#160;Is&#160;More........................................................................................................19<br/>
Taking&#160;a&#160;Guided&#160;Tour.....................................................................................................19<br/>Symbolic&#160;Links...............................................................................................................23<br/>Hard&#160;Links.....................................................................................................................24<br/>Summing&#160;Up..................................................................................................................24<br/>Further&#160;Reading.............................................................................................................24<br/>
<a href="linux-command-lines.html#49"><i><b>4&#160;–&#160;Manipulating&#160;Files&#160;and&#160;Directories</b></i></a><i><b>........................................................25</b></i><br/>
Wildcards.......................................................................................................................25<br/>
Character&#160;Ranges................................................................................................27<br/>Wildcards&#160;Work&#160;in&#160;the&#160;GUI&#160;Too............................................................................27<br/>
mkdir&#160;–&#160;Create&#160;Directories.............................................................................................28<br/>cp&#160;–&#160;Copy&#160;Files&#160;and&#160;Directories....................................................................................28<br/>
Useful&#160;Options&#160;and&#160;Examples..................................................................................29<br/>
mv&#160;–&#160;Move&#160;and&#160;Rename&#160;Files.......................................................................................30<br/>
Useful&#160;Options&#160;and&#160;Examples..................................................................................30<br/>
rm&#160;–&#160;Remove&#160;Files&#160;and&#160;Directories...............................................................................31<br/>
Useful&#160;Options&#160;and&#160;Examples..................................................................................32<br/>
Be&#160;Careful&#160;with&#160;rm!..............................................................................................33<br/>
ln&#160;–&#160;Create&#160;Links............................................................................................................33<br/>
Hard&#160;Links................................................................................................................33<br/>Symbolic&#160;Links..........................................................................................................34<br/>
Let's&#160;Build&#160;a&#160;Playground................................................................................................34<br/>
Creating&#160;Directories..................................................................................................34<br/>Copying&#160;Files............................................................................................................35<br/>Moving&#160;and&#160;Renaming&#160;Files.....................................................................................36<br/>Creating&#160;Hard&#160;Links..................................................................................................37<br/>Creating&#160;Symbolic&#160;Links...........................................................................................38<br/>Removing&#160;Files&#160;and&#160;Directories...............................................................................39<br/>
Creating&#160;Symlinks&#160;With&#160;The&#160;GUI.........................................................................41<br/>
Summing&#160;Up..................................................................................................................41<br/>Further&#160;Reading.............................................................................................................41<br/>
<a href="linux-command-lines.html#66"><i><b>5&#160;–&#160;Working&#160;with&#160;Commands</b></i></a><i><b>........................................................................42</b></i><br/>
What&#160;Exactly&#160;Are&#160;Commands?......................................................................................42<br/>Identifying&#160;Commands...................................................................................................43<br/>
ii<br/>
<hr/>
<a name=5></a>type&#160;–&#160;Display&#160;a&#160;Command's&#160;Type...........................................................................43<br/>which&#160;–&#160;Display&#160;an&#160;Executable's&#160;Location...............................................................43<br/>
Getting&#160;a&#160;Command's&#160;Documentation..........................................................................44<br/>
help&#160;–&#160;Get&#160;Help&#160;for&#160;Shel&#160;&#160;Builtins..............................................................................44<br/>--help&#160;–&#160;Display&#160;Usage&#160;Information..........................................................................45<br/>man&#160;–&#160;Display&#160;a&#160;Program's&#160;Manual&#160;Page................................................................46<br/>apropos&#160;–&#160;Display&#160;Appropriate&#160;Commands..............................................................47<br/>whatis&#160;–&#160;Display&#160;One-line&#160;Manual&#160;Page&#160;Descriptions..............................................48<br/>
The&#160;Most&#160;Brutal&#160;Man&#160;Page&#160;Of&#160;Them&#160;All..............................................................48<br/>
info&#160;–&#160;Display&#160;a&#160;Program's&#160;Info&#160;Entry.......................................................................48<br/>README&#160;and&#160;Other&#160;Program&#160;Documentation&#160;Files................................................50<br/>
Creating&#160;Our&#160;Own&#160;Commands&#160;with&#160;alias......................................................................50<br/>Summing&#160;Up..................................................................................................................52<br/>Further&#160;Reading.............................................................................................................52<br/>
<a href="linux-command-lines.html#78"><i><b>6&#160;–&#160;Redirection</b></i></a><i><b>................................................................................................54</b></i><br/>
Standard&#160;Input,&#160;Output,&#160;and&#160;Error.................................................................................54<br/>Redirecting&#160;Standard&#160;Output.........................................................................................55<br/>Redirecting&#160;Standard&#160;Error............................................................................................57<br/>
Redirecting&#160;Standard&#160;Output&#160;and&#160;Standard&#160;Error&#160;to&#160;One&#160;File.................................57<br/>Disposing&#160;of&#160;Unwanted&#160;Output.................................................................................58<br/>
/dev/nul&#160;&#160;In&#160;Unix&#160;Culture......................................................................................58<br/>
Redirecting&#160;Standard&#160;Input............................................................................................58<br/>
cat&#160;–&#160;Concatenate&#160;Files............................................................................................59<br/>
Pipelines........................................................................................................................61<br/>
The&#160;Difference&#160;Between&#160;&gt;&#160;and&#160;|..........................................................................61<br/>
Filters........................................................................................................................62<br/>uniq&#160;-&#160;Report&#160;or&#160;Omit&#160;Repeated&#160;Lines......................................................................62<br/>wc&#160;–&#160;Print&#160;Line,&#160;Word,&#160;and&#160;Byte&#160;Counts...................................................................63<br/>grep&#160;–&#160;Print&#160;Lines&#160;Matching&#160;a&#160;Pattern......................................................................63<br/>head&#160;/&#160;tail&#160;–&#160;Print&#160;First&#160;/&#160;Last&#160;Part&#160;of&#160;Files................................................................64<br/>tee&#160;–&#160;Read&#160;from&#160;Stdin&#160;and&#160;Output&#160;to&#160;Stdout&#160;and&#160;Files............................................65<br/>
Summing&#160;Up..................................................................................................................66<br/>
Linux&#160;Is&#160;About&#160;Imagination..................................................................................66<br/>
<a href="linux-command-lines.html#92"><i><b>7&#160;–&#160;Seeing&#160;the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It</b></i></a><i><b>....................................................68</b></i><br/>
Expansion......................................................................................................................68<br/>
Pathname&#160;Expansion...............................................................................................69<br/>
Pathname&#160;Expansion&#160;of&#160;Hidden&#160;Files.................................................................70<br/>
Tilde&#160;Expansion........................................................................................................70<br/>Arithmetic&#160;Expansion................................................................................................71<br/>Brace&#160;Expansion......................................................................................................72<br/>Parameter&#160;Expansion...............................................................................................73<br/>Command&#160;Substitution.............................................................................................74<br/>
Quoting..........................................................................................................................75<br/>
Double&#160;Quotes..........................................................................................................76<br/>Single&#160;Quotes...........................................................................................................78<br/>Escaping&#160;Characters................................................................................................78<br/>
Backslash&#160;Escape&#160;Sequences............................................................................79<br/>
Summing&#160;Up..................................................................................................................79<br/>
iii<br/>
<hr/>
<a name=6></a>Further&#160;Reading.............................................................................................................80<br/>
<a href="linux-command-lines.html#105"><i><b>8&#160;–&#160;Advanced&#160;Keyboard&#160;Tricks</b></i></a><i><b>.....................................................................81</b></i><br/>
Command&#160;Line&#160;Editing..................................................................................................81<br/>
Cursor&#160;Movement.....................................................................................................81<br/>Modifying&#160;Text...........................................................................................................82<br/>Cutting&#160;and&#160;Pasting&#160;(Killing&#160;and&#160;Yanking)&#160;Text.........................................................82<br/>
The&#160;Meta&#160;Key......................................................................................................83<br/>
Completion....................................................................................................................83<br/>
Programmable&#160;Completion..................................................................................85<br/>
Using&#160;History.................................................................................................................85<br/>
Searching&#160;History.....................................................................................................86<br/>History&#160;Expansion.....................................................................................................88<br/>
script....................................................................................................................88<br/>
Summing&#160;Up..................................................................................................................89<br/>Further&#160;Reading.............................................................................................................89<br/>
<a href="linux-command-lines.html#114"><i><b>9&#160;–&#160;Permissions</b></i></a><i><b>..............................................................................................90</b></i><br/>
Owners,&#160;Group&#160;Members,&#160;and&#160;Everybody&#160;Else............................................................91<br/>Reading,&#160;Writing,&#160;and&#160;Executing...................................................................................92<br/>
chmod&#160;–&#160;Change&#160;File&#160;Mode.....................................................................................94<br/>
What&#160;the&#160;Heck&#160;is&#160;Octal?......................................................................................95<br/>
Setting&#160;File&#160;Mode&#160;with&#160;the&#160;GUI.................................................................................98<br/>umask&#160;–&#160;Set&#160;Default&#160;Permissions............................................................................98<br/>
Some&#160;Special&#160;Permissions................................................................................100<br/>
Changing&#160;Identities......................................................................................................101<br/>
su&#160;–&#160;Run&#160;a&#160;Shel&#160;&#160;with&#160;Substitute&#160;User&#160;and&#160;Group&#160;IDs...........................................102<br/>sudo&#160;–&#160;Execute&#160;a&#160;Command&#160;as&#160;Another&#160;User.......................................................103<br/>
Ubuntu&#160;and&#160;sudo...............................................................................................104<br/>
chown&#160;–&#160;Change&#160;File&#160;Owner&#160;and&#160;Group................................................................104<br/>chgrp&#160;–&#160;Change&#160;Group&#160;Ownership.........................................................................106<br/>
Exercising&#160;Our&#160;Privileges............................................................................................106<br/>Changing&#160;Your&#160;Password............................................................................................108<br/>Summing&#160;Up................................................................................................................109<br/>Further&#160;Reading..........................................................................................................109<br/>
<a href="linux-command-lines.html#134"><i><b>10&#160;–&#160;Processes</b></i></a><i><b>..............................................................................................110</b></i><br/>
How&#160;a&#160;Process&#160;Works.................................................................................................110<br/>Viewing&#160;Processes.......................................................................................................111<br/>
Viewing&#160;Processes&#160;Dynamical&#160;y&#160;with&#160;top................................................................113<br/>
Control&#160;ing&#160;Processes..................................................................................................116<br/>
Interrupting&#160;a&#160;Process.............................................................................................116<br/>Putting&#160;a&#160;Process&#160;in&#160;the&#160;Background.....................................................................117<br/>Returning&#160;a&#160;Process&#160;to&#160;the&#160;Foreground.................................................................118<br/>Stopping&#160;(Pausing)&#160;a&#160;Process................................................................................118<br/>
Signals.........................................................................................................................119<br/>
Sending&#160;Signals&#160;to&#160;Processes&#160;with&#160;kill...................................................................120<br/>Sending&#160;Signals&#160;to&#160;Multiple&#160;Processes&#160;with&#160;killall..................................................122<br/>
Shutting&#160;Down&#160;the&#160;System..........................................................................................123<br/>More&#160;Process-Related&#160;Commands.............................................................................124<br/>
iv<br/>
<hr/>
<a name=7></a>Summing&#160;Up................................................................................................................124<br/>
<a href="linux-command-lines.html#151"><b>Part&#160;2&#160;–&#160;Configuration&#160;and&#160;the&#160;Environment</b></a><b>..............................127</b><br/>
<a href="linux-command-lines.html#152"><i><b>11&#160;–&#160;The&#160;Environment</b></i></a><i><b>..................................................................................128</b></i><br/>
What&#160;is&#160;Stored&#160;in&#160;the&#160;Environment?............................................................................128<br/>
Examining&#160;The&#160;Environment..................................................................................128<br/>Some&#160;Interesting&#160;Variables.....................................................................................130<br/>
How&#160;Is&#160;The&#160;Environment&#160;Established?.......................................................................131<br/>
What's&#160;in&#160;a&#160;Startup&#160;File?........................................................................................132<br/>
Modifying&#160;the&#160;Environment..........................................................................................134<br/>
Which&#160;Files&#160;Should&#160;We&#160;Modify?.............................................................................135<br/>Text&#160;Editors.............................................................................................................135<br/>Using&#160;a&#160;Text&#160;Editor.................................................................................................136<br/>
Why&#160;Comments&#160;Are&#160;Important..........................................................................139<br/>
Activating&#160;Our&#160;Changes..........................................................................................140<br/>
Summing&#160;Up................................................................................................................140<br/>Further&#160;Reading..........................................................................................................140<br/>
<a href="linux-command-lines.html#165"><i><b>12&#160;–&#160;A&#160;Gentle&#160;Introduction&#160;to&#160;vi</b></i></a><i><b>..................................................................141</b></i><br/>
Why&#160;We&#160;Should&#160;Learn&#160;vi.............................................................................................141<br/>A&#160;Little&#160;Background.....................................................................................................142<br/>Starting&#160;and&#160;Stopping&#160;vi..............................................................................................142<br/>
Compatibility&#160;Mode............................................................................................143<br/>
Editing&#160;Modes..............................................................................................................144<br/>
Entering&#160;Insert&#160;Mode..............................................................................................145<br/>Saving&#160;Our&#160;Work....................................................................................................145<br/>
Moving&#160;the&#160;Cursor&#160;Around...........................................................................................146<br/>Basic&#160;Editing................................................................................................................147<br/>
Appending&#160;Text.......................................................................................................147<br/>Opening&#160;a&#160;Line.......................................................................................................148<br/>Deleting&#160;Text...........................................................................................................149<br/>Cutting,&#160;Copying,&#160;and&#160;Pasting&#160;Text........................................................................150<br/>Joining&#160;Lines...........................................................................................................152<br/>
Search-and-Replace...................................................................................................152<br/>
Searching&#160;Within&#160;a&#160;Line..........................................................................................152<br/>Searching&#160;the&#160;Entire&#160;File........................................................................................152<br/>Global&#160;Search-and-Replace...................................................................................153<br/>
Editing&#160;Multiple&#160;Files...................................................................................................155<br/>
Switching&#160;Between&#160;Files.........................................................................................156<br/>Opening&#160;Additional&#160;Files&#160;for&#160;Editing.......................................................................157<br/>Copying&#160;Content&#160;from&#160;One&#160;File&#160;into&#160;Another..........................................................157<br/>Inserting&#160;an&#160;Entire&#160;File&#160;into&#160;Another.......................................................................158<br/>
Saving&#160;Our&#160;Work.........................................................................................................159<br/>Summing&#160;Up................................................................................................................160<br/>Further&#160;Reading..........................................................................................................160<br/>
<a href="linux-command-lines.html#186"><i><b>13&#160;–&#160;Customizing&#160;the&#160;Prompt</b></i></a><i><b>......................................................................162</b></i><br/>
Anatomy&#160;of&#160;a&#160;Prompt...................................................................................................162<br/>
v<br/>
<hr/>
<a name=8></a>Trying&#160;Some&#160;Alternative&#160;Prompt&#160;Designs....................................................................164<br/>Adding&#160;Color................................................................................................................165<br/>
Terminal&#160;Confusion............................................................................................165<br/>
Moving&#160;the&#160;Cursor.......................................................................................................168<br/>Saving&#160;the&#160;Prompt.......................................................................................................169<br/>Summing&#160;Up................................................................................................................169<br/>Further&#160;Reading..........................................................................................................170<br/>
<a href="linux-command-lines.html#195"><b>Part&#160;3&#160;–&#160;Common&#160;Tasks&#160;and&#160;Essential&#160;Tools</b></a><b>.............................171</b><br/>
<a href="linux-command-lines.html#196"><i><b>14&#160;–&#160;Package&#160;Management</b></i></a><i><b>..........................................................................172</b></i><br/>
Packaging&#160;Systems.....................................................................................................172<br/>How&#160;a&#160;Package&#160;System&#160;Works...................................................................................173<br/>
Package&#160;Files.........................................................................................................173<br/>Repositories............................................................................................................173<br/>Dependencies.........................................................................................................174<br/>High&#160;and&#160;Low-level&#160;Package&#160;Tools........................................................................174<br/>
Common&#160;Package&#160;Management&#160;Tasks.......................................................................175<br/>
Finding&#160;a&#160;Package&#160;in&#160;a&#160;Repository.........................................................................175<br/>Instal&#160;ing&#160;a&#160;Package&#160;from&#160;a&#160;Repository..................................................................175<br/>Instal&#160;ing&#160;a&#160;Package&#160;from&#160;a&#160;Package&#160;File..............................................................176<br/>Removing&#160;a&#160;Package.............................................................................................176<br/>Updating&#160;Packages&#160;from&#160;a&#160;Repository...................................................................177<br/>Upgrading&#160;a&#160;Package&#160;from&#160;a&#160;Package&#160;File............................................................177<br/>Listing&#160;Instal&#160;ed&#160;Packages......................................................................................178<br/>Determining&#160;Whether&#160;a&#160;Package&#160;is&#160;Instal&#160;ed.........................................................178<br/>Displaying&#160;Information&#160;About&#160;an&#160;Instal&#160;ed&#160;Package...............................................179<br/>Finding&#160;Which&#160;Package&#160;Installed&#160;a&#160;File.................................................................179<br/>
Summing&#160;Up................................................................................................................180<br/>
The&#160;Linux&#160;Software&#160;Installation&#160;Myth.................................................................180<br/>
Further&#160;Reading..........................................................................................................181<br/>
<a href="linux-command-lines.html#206"><i><b>15&#160;–&#160;Storage&#160;Media</b></i></a><i><b>.......................................................................................182</b></i><br/>
Mounting&#160;and&#160;Unmounting&#160;Storage&#160;Devices...............................................................182<br/>
Viewing&#160;a&#160;List&#160;of&#160;Mounted&#160;File&#160;Systems.................................................................184<br/>
Why&#160;Unmounting&#160;Is&#160;Important...........................................................................187<br/>
Determining&#160;Device&#160;Names....................................................................................188<br/>
Creating&#160;New&#160;File&#160;Systems.........................................................................................191<br/>
Manipulating&#160;Partitions&#160;with&#160;fdisk...........................................................................192<br/>Creating&#160;a&#160;New&#160;File&#160;System&#160;with&#160;mkfs...................................................................194<br/>
Testing&#160;and&#160;Repairing&#160;File&#160;Systems............................................................................195<br/>
What&#160;the&#160;fsck?...................................................................................................196<br/>
Moving&#160;Data&#160;Directly&#160;to&#160;and&#160;from&#160;Devices..................................................................196<br/>Creating&#160;CD-ROM&#160;Images..........................................................................................197<br/>
Creating&#160;an&#160;Image&#160;Copy&#160;of&#160;a&#160;CD-ROM..................................................................197<br/>Creating&#160;an&#160;Image&#160;From&#160;a&#160;Collection&#160;of&#160;Files........................................................197<br/>
A&#160;Program&#160;by&#160;Any&#160;Other&#160;Name.........................................................................198<br/>
Writing&#160;CD-ROM&#160;Images.............................................................................................198<br/>
Mounting&#160;an&#160;ISO&#160;Image&#160;Directly............................................................................198<br/>
vi<br/>
<hr/>
<a name=9></a>Blanking&#160;a&#160;Rewritable&#160;CD-ROM.............................................................................199<br/>Writing&#160;an&#160;Image....................................................................................................199<br/>
Summing&#160;Up................................................................................................................199<br/>Further&#160;Reading..........................................................................................................199<br/>Extra&#160;Credit..................................................................................................................199<br/>
<a href="linux-command-lines.html#225"><i><b>16&#160;–&#160;Networking</b></i></a><i><b>............................................................................................201</b></i><br/>
Examining&#160;and&#160;Monitoring&#160;a&#160;Network.........................................................................202<br/>
ping.........................................................................................................................202<br/>traceroute...............................................................................................................203<br/>ip.............................................................................................................................204<br/>netstat.....................................................................................................................205<br/>
Transporting&#160;Files&#160;Over&#160;a&#160;Network..............................................................................206<br/>
ftp............................................................................................................................206<br/>lftp&#160;–&#160;A&#160;Better&#160;ftp.....................................................................................................209<br/>wget........................................................................................................................209<br/>
Secure&#160;Communication&#160;with&#160;Remote&#160;Hosts................................................................209<br/>
ssh..........................................................................................................................210<br/>
Tunneling&#160;with&#160;SSH...........................................................................................213<br/>
scp&#160;and&#160;sftp............................................................................................................214<br/>
An&#160;SSH&#160;Client&#160;for&#160;Windows?.............................................................................215<br/>
Summing&#160;Up................................................................................................................215<br/>Further&#160;Reading..........................................................................................................215<br/>
<a href="linux-command-lines.html#241"><i><b>17&#160;–&#160;Searching&#160;for&#160;Files</b></i></a><i><b>...............................................................................217</b></i><br/>
locate&#160;–&#160;Find&#160;Files&#160;the&#160;Easy&#160;Way................................................................................217<br/>
Where&#160;Does&#160;the&#160;locate&#160;Database&#160;Come&#160;From?...............................................219<br/>
find&#160;–&#160;Find&#160;Files&#160;the&#160;Hard&#160;Way....................................................................................219<br/>
Tests.......................................................................................................................220<br/>Operators................................................................................................................222<br/>Predefined&#160;Actions..................................................................................................225<br/>User-Defined&#160;Actions..............................................................................................227<br/>Improving&#160;Efficiency...............................................................................................228<br/>xargs.......................................................................................................................228<br/>
Dealing&#160;with&#160;Funny&#160;Filenames..........................................................................229<br/>
A&#160;Return&#160;to&#160;the&#160;Playground....................................................................................229<br/>Options...................................................................................................................232<br/>
Summing&#160;Up................................................................................................................233<br/>Further&#160;Reading..........................................................................................................233<br/>
<a href="linux-command-lines.html#258"><i><b>18&#160;–&#160;Archiving&#160;and&#160;Backup.</b></i></a><i><b>........................................................................234</b></i><br/>
Compressing&#160;Files.......................................................................................................234<br/>
gzip.........................................................................................................................235<br/>bzip2.......................................................................................................................237<br/>
Don’t&#160;Be&#160;Compressive&#160;Compulsive...................................................................238<br/>
Archiving&#160;Files.............................................................................................................238<br/>
tar............................................................................................................................239<br/>zip...........................................................................................................................244<br/>
Synchronizing&#160;Files&#160;and&#160;Directories............................................................................246<br/>
Using&#160;rsync&#160;Over&#160;a&#160;Network...................................................................................249<br/>
vii<br/>
<hr/>
<a name=10></a>Summing&#160;Up................................................................................................................250<br/>Further&#160;Reading..........................................................................................................250<br/>
<a href="linux-command-lines.html#275"><i><b>19&#160;–&#160;Regular&#160;Expressions</b></i></a><i><b>...........................................................................251</b></i><br/>
What&#160;are&#160;Regular&#160;Expressions?.............................................................................251<br/>
grep.............................................................................................................................251<br/>Metacharacters&#160;and&#160;Literals........................................................................................253<br/>The&#160;Any&#160;Character......................................................................................................254<br/>Anchors.......................................................................................................................255<br/>
A&#160;Crossword&#160;Puzzle&#160;Helper...............................................................................256<br/>
Bracket&#160;Expressions&#160;and&#160;Character&#160;Classes..............................................................256<br/>
Negation.................................................................................................................257<br/>Traditional&#160;Character&#160;Ranges.................................................................................257<br/>POSIX&#160;Character&#160;Classes......................................................................................258<br/>
Reverting&#160;to&#160;Traditional&#160;Col&#160;ation&#160;Order............................................................261<br/>
POSIX&#160;Basic&#160;vs.&#160;Extended&#160;Regular&#160;Expressions.......................................................262<br/>
POSIX................................................................................................................263<br/>
Alternation...................................................................................................................263<br/>Quantifiers...................................................................................................................264<br/>
?&#160;-&#160;Match&#160;an&#160;Element&#160;Zero&#160;or&#160;One&#160;Time................................................................264<br/>*&#160;-&#160;Match&#160;an&#160;Element&#160;Zero&#160;or&#160;More&#160;Times.............................................................265<br/>+&#160;-&#160;Match&#160;an&#160;Element&#160;One&#160;or&#160;More&#160;Times.............................................................266<br/>{&#160;}&#160;-&#160;Match&#160;an&#160;Element&#160;a&#160;Specific&#160;Number&#160;of&#160;Times...............................................266<br/>
Putting&#160;Regular&#160;Expressions&#160;to&#160;Work..........................................................................267<br/>
Validating&#160;a&#160;Phone&#160;List&#160;With&#160;grep...........................................................................267<br/>Finding&#160;Ugly&#160;Filenames&#160;with&#160;find............................................................................269<br/>Searching&#160;for&#160;Files&#160;with&#160;locate...............................................................................269<br/>Searching&#160;for&#160;Text&#160;with&#160;less&#160;and&#160;vim......................................................................270<br/>
Summing&#160;Up................................................................................................................271<br/>Further&#160;Reading..........................................................................................................272<br/>
<a href="linux-command-lines.html#297"><i><b>20&#160;–&#160;Text&#160;Processing.</b></i></a><i><b>...................................................................................273</b></i><br/>
Applications&#160;of&#160;Text......................................................................................................273<br/>
Documents.............................................................................................................274<br/>Web&#160;Pages.............................................................................................................274<br/>Email.......................................................................................................................274<br/>Printer&#160;Output.........................................................................................................274<br/>Program&#160;Source&#160;Code............................................................................................274<br/>
Revisiting&#160;Some&#160;Old&#160;Friends.......................................................................................274<br/>
cat...........................................................................................................................275<br/>
MS-DOS&#160;Text&#160;vs.&#160;Unix&#160;Text...............................................................................276<br/>
sort..........................................................................................................................277<br/>uniq.........................................................................................................................284<br/>
Slicing&#160;and&#160;Dicing........................................................................................................286<br/>
cut...........................................................................................................................286<br/>
Expanding&#160;Tabs.................................................................................................289<br/>
paste.......................................................................................................................290<br/>join..........................................................................................................................291<br/>
Comparing&#160;Text...........................................................................................................293<br/>
comm......................................................................................................................294<br/>
viii<br/>
<hr/>
<a name=11></a>diff...........................................................................................................................295<br/>patch.......................................................................................................................297<br/>
Editing&#160;on&#160;the&#160;Fly.........................................................................................................298<br/>
tr..............................................................................................................................299<br/>
ROT13:&#160;The&#160;Not-So-Secret&#160;Decoder&#160;Ring........................................................300<br/>
sed..........................................................................................................................301<br/>
People&#160;Who&#160;Like&#160;sed&#160;Also&#160;Like.........................................................................309<br/>
aspel&#160;......................................................................................................................309<br/>
Summing&#160;Up................................................................................................................313<br/>Further&#160;Reading..........................................................................................................313<br/>Extra&#160;Credit..................................................................................................................314<br/>
<a href="linux-command-lines.html#339"><i><b>21&#160;–&#160;Formatting&#160;Output</b></i></a><i><b>................................................................................315</b></i><br/>
Simple&#160;Formatting&#160;Tools..............................................................................................315<br/>
nl&#160;–&#160;Number&#160;Lines..................................................................................................315<br/>fold&#160;–&#160;Wrap&#160;Each&#160;Line&#160;to&#160;a&#160;Specified&#160;Length.........................................................319<br/>fmt&#160;–&#160;A&#160;Simple&#160;Text&#160;Formatter................................................................................320<br/>pr&#160;–&#160;Format&#160;Text&#160;for&#160;Printing...................................................................................323<br/>printf&#160;–&#160;Format&#160;and&#160;Print&#160;Data................................................................................324<br/>
Document&#160;Formatting&#160;Systems...................................................................................328<br/>
groff.........................................................................................................................329<br/>
Summing&#160;Up................................................................................................................335<br/>Further&#160;Reading..........................................................................................................335<br/>
<a href="linux-command-lines.html#361"><i><b>22&#160;–&#160;Printing</b></i></a><i><b>..................................................................................................337</b></i><br/>
A&#160;Brief&#160;History&#160;of&#160;Printing............................................................................................337<br/>
Printing&#160;in&#160;the&#160;Dim&#160;Times........................................................................................337<br/>Character-Based&#160;Printers.......................................................................................338<br/>Graphical&#160;Printers...................................................................................................339<br/>
Printing&#160;with&#160;Linux.......................................................................................................340<br/>Preparing&#160;Files&#160;for&#160;Printing..........................................................................................340<br/>
pr&#160;–&#160;Convert&#160;Text&#160;Files&#160;for&#160;Printing.........................................................................340<br/>
Sending&#160;a&#160;Print&#160;Job&#160;to&#160;a&#160;Printer..................................................................................342<br/>
lpr&#160;–&#160;Print&#160;Files&#160;(Berkeley&#160;Style).............................................................................342<br/>lp&#160;–&#160;Print&#160;Files&#160;(System&#160;V&#160;Style).............................................................................343<br/>Another&#160;Option:&#160;a2ps..............................................................................................344<br/>
Monitoring&#160;and&#160;Control&#160;ing&#160;Print&#160;Jobs.........................................................................347<br/>
lpstat&#160;–&#160;Display&#160;Print&#160;System&#160;Status......................................................................347<br/>lpq&#160;–&#160;Display&#160;Printer&#160;Queue&#160;Status........................................................................348<br/>lprm&#160;/&#160;cancel&#160;–&#160;Cancel&#160;Print&#160;Jobs...........................................................................349<br/>
Summing&#160;Up................................................................................................................349<br/>Further&#160;Reading..........................................................................................................349<br/>
<a href="linux-command-lines.html#374"><i><b>23&#160;–&#160;Compiling&#160;Programs</b></i></a><i><b>............................................................................350</b></i><br/>
What&#160;is&#160;Compiling?.....................................................................................................350<br/>
Are&#160;All&#160;Programs&#160;Compiled?..................................................................................351<br/>
Compiling&#160;a&#160;C&#160;Program...............................................................................................352<br/>
Obtaining&#160;the&#160;Source&#160;Code....................................................................................352<br/>Examining&#160;the&#160;Source&#160;Tree....................................................................................355<br/>Building&#160;the&#160;Program..............................................................................................356<br/>
ix<br/>
<hr/>
<a name=12></a>Instal&#160;ing&#160;the&#160;Program.............................................................................................360<br/>
Summing&#160;Up................................................................................................................361<br/>Further&#160;Reading..........................................................................................................361<br/>
<a href="linux-command-lines.html#387"><b>Part&#160;4&#160;–&#160;Writing&#160;Shell&#160;Scripts.</b></a><b>......................................................363</b><br/>
<a href="linux-command-lines.html#388"><i><b>24&#160;–&#160;Writing&#160;Your&#160;First&#160;Script</b></i></a><i><b>......................................................................364</b></i><br/>
What&#160;are&#160;Shel&#160;&#160;Scripts?...............................................................................................364<br/>How&#160;to&#160;Write&#160;a&#160;Shell&#160;Script..........................................................................................364<br/>Script&#160;File&#160;Format........................................................................................................365<br/>Executable&#160;Permissions..............................................................................................366<br/>Script&#160;File&#160;Location......................................................................................................366<br/>
Good&#160;Locations&#160;for&#160;Scripts.....................................................................................368<br/>
More&#160;Formatting&#160;Tricks................................................................................................368<br/>
Long&#160;Option&#160;Names................................................................................................368<br/>Indentation&#160;and&#160;Line-Continuation.........................................................................368<br/>
Configuring&#160;vim&#160;For&#160;Script&#160;Writing.....................................................................369<br/>
Summing&#160;Up................................................................................................................370<br/>Further&#160;Reading..........................................................................................................370<br/>
<a href="linux-command-lines.html#395"><i><b>25&#160;–&#160;Starting&#160;a&#160;Project</b></i></a><i><b>..................................................................................371</b></i><br/>
First&#160;Stage:&#160;Minimal&#160;Document...................................................................................371<br/>Second&#160;Stage:&#160;Adding&#160;a&#160;Little&#160;Data............................................................................373<br/>Variables&#160;and&#160;Constants.............................................................................................374<br/>
Assigning&#160;Values&#160;to&#160;Variables&#160;and&#160;Constants........................................................377<br/>
Here&#160;Documents.........................................................................................................379<br/>Summing&#160;Up................................................................................................................381<br/>Further&#160;Reading..........................................................................................................382<br/>
<a href="linux-command-lines.html#407"><i><b>26&#160;–&#160;Top-Down&#160;Design.</b></i></a><i><b>................................................................................383</b></i><br/>
Shell&#160;Functions............................................................................................................384<br/>Local&#160;Variables............................................................................................................387<br/>Keep&#160;Scripts&#160;Running..................................................................................................388<br/>
Shell&#160;Functions&#160;In&#160;Your&#160;.bashrc&#160;File..................................................................391<br/>
Summing&#160;Up................................................................................................................391<br/>Further&#160;Reading..........................................................................................................392<br/>
<a href="linux-command-lines.html#417"><i><b>27&#160;–&#160;Flow&#160;Control:&#160;Branching&#160;with&#160;if</b></i></a><i><b>..........................................................393</b></i><br/>
if...................................................................................................................................393<br/>Exit&#160;Status...................................................................................................................394<br/>test...............................................................................................................................396<br/>
File&#160;Expressions.....................................................................................................396<br/>String&#160;Expressions..................................................................................................399<br/>Integer&#160;Expressions................................................................................................400<br/>
A&#160;More&#160;Modern&#160;Version&#160;of&#160;test....................................................................................402<br/>((&#160;))&#160;-&#160;Designed&#160;for&#160;Integers.........................................................................................403<br/>Combining&#160;Expressions...............................................................................................404<br/>
Portability&#160;is&#160;the&#160;Hobgoblin&#160;of&#160;Little&#160;Minds.........................................................407<br/>
x<br/>
<hr/>
<a name=13></a>Control&#160;Operators:&#160;Another&#160;Way&#160;to&#160;Branch.................................................................407<br/>Summing&#160;Up................................................................................................................408<br/>Further&#160;Reading..........................................................................................................409<br/>
<a href="linux-command-lines.html#434"><i><b>28&#160;–&#160;Reading&#160;Keyboard&#160;Input</b></i></a><i><b>......................................................................410</b></i><br/>
read&#160;–&#160;Read&#160;Values&#160;from&#160;Standard&#160;Input....................................................................411<br/>
Options...................................................................................................................413<br/>IFS..........................................................................................................................415<br/>
You&#160;Can’t&#160;Pipe&#160;read...........................................................................................417<br/>
Validating&#160;Input............................................................................................................418<br/>Menus..........................................................................................................................419<br/>Summing&#160;Up................................................................................................................421<br/>
Extra&#160;Credit.............................................................................................................421<br/>
Further&#160;Reading..........................................................................................................421<br/>
<a href="linux-command-lines.html#447"><i><b>29&#160;–&#160;Flow&#160;Control:&#160;Looping&#160;with&#160;while&#160;/&#160;until</b></i></a><i><b>............................................423</b></i><br/>
Looping........................................................................................................................423<br/>
while........................................................................................................................424<br/>
Breaking&#160;Out&#160;of&#160;a&#160;Loop...............................................................................................426<br/>
until.........................................................................................................................428<br/>
Reading&#160;Files&#160;with&#160;Loops............................................................................................428<br/>Summing&#160;Up................................................................................................................429<br/>Further&#160;Reading..........................................................................................................429<br/>
<a href="linux-command-lines.html#454"><i><b>30&#160;–&#160;Troubleshooting.</b></i></a><i><b>..................................................................................430</b></i><br/>
Syntactic&#160;Errors...........................................................................................................430<br/>
Missing&#160;Quotes.......................................................................................................431<br/>Missing&#160;or&#160;Unexpected&#160;Tokens...............................................................................432<br/>Unanticipated&#160;Expansions......................................................................................432<br/>
Logical&#160;Errors..............................................................................................................434<br/>
Defensive&#160;Programming.........................................................................................435<br/>Watch&#160;Out&#160;for&#160;Filenames........................................................................................436<br/>
Portable&#160;Filenames............................................................................................437<br/>
Verifying&#160;Input.........................................................................................................437<br/>
Design&#160;is&#160;a&#160;Function&#160;of&#160;Time.............................................................................437<br/>
Testing.........................................................................................................................438<br/>
Test&#160;Cases..............................................................................................................439<br/>
Debugging...................................................................................................................439<br/>
Finding&#160;the&#160;Problem&#160;Area.......................................................................................439<br/>Tracing....................................................................................................................440<br/>Examining&#160;Values&#160;During&#160;Execution......................................................................442<br/>
Summing&#160;Up................................................................................................................443<br/>Further&#160;Reading..........................................................................................................443<br/>
<a href="linux-command-lines.html#468"><i><b>31&#160;–&#160;Flow&#160;Control:&#160;Branching&#160;with&#160;case</b></i></a><i><b>....................................................444</b></i><br/>
case.............................................................................................................................444<br/>
Patterns..................................................................................................................446<br/>Performing&#160;Multiple&#160;Actions....................................................................................448<br/>
Summing&#160;Up................................................................................................................450<br/>
xi<br/>
<hr/>
<a name=14></a>Further&#160;Reading..........................................................................................................450<br/>
<a href="linux-command-lines.html#475"><i><b>32&#160;–&#160;Positional&#160;Parameters</b></i></a><i><b>.........................................................................451</b></i><br/>
Accessing&#160;the&#160;Command&#160;Line.....................................................................................451<br/>
Determining&#160;the&#160;Number&#160;of&#160;Arguments..................................................................452<br/>shift&#160;–&#160;Getting&#160;Access&#160;to&#160;Many&#160;Arguments.............................................................453<br/>Simple&#160;Applications................................................................................................455<br/>Using&#160;Positional&#160;Parameters&#160;with&#160;Shel&#160;&#160;Functions.................................................455<br/>
Handling&#160;Positional&#160;Parameters&#160;e<i>n&#160;Masse</i>.................................................................456<br/>A&#160;More&#160;Complete&#160;Application......................................................................................459<br/>Summing&#160;Up................................................................................................................462<br/>Further&#160;Reading..........................................................................................................465<br/>
<a href="linux-command-lines.html#490"><i><b>33&#160;–&#160;Flow&#160;Control:&#160;Looping&#160;with&#160;for</b></i></a><i><b>...........................................................466</b></i><br/>
for:&#160;Traditional&#160;Shel&#160;&#160;Form...........................................................................................466<br/>
Why&#160;i?................................................................................................................469<br/>
for:&#160;C&#160;Language&#160;Form.................................................................................................469<br/>Summing&#160;Up................................................................................................................471<br/>Further&#160;Reading..........................................................................................................472<br/>
<a href="linux-command-lines.html#497"><i><b>34&#160;–&#160;Strings&#160;and&#160;Numbers</b></i></a><i><b>...........................................................................473</b></i><br/>
Parameter&#160;Expansion..................................................................................................473<br/>
Basic&#160;Parameters...................................................................................................473<br/>Expansions&#160;to&#160;Manage&#160;Empty&#160;Variables................................................................474<br/>Expansions&#160;That&#160;Return&#160;Variable&#160;Names..............................................................476<br/>String&#160;Operations....................................................................................................476<br/>Case&#160;Conversion....................................................................................................480<br/>
Arithmetic&#160;Evaluation&#160;and&#160;Expansion..........................................................................482<br/>
Number&#160;Bases........................................................................................................482<br/>Unary&#160;Operators.....................................................................................................483<br/>Simple&#160;Arithmetic....................................................................................................483<br/>Assignment.............................................................................................................484<br/>Bit&#160;Operations.........................................................................................................487<br/>Logic.......................................................................................................................488<br/>
bc&#160;–&#160;An&#160;Arbitrary&#160;Precision&#160;Calculator&#160;Language........................................................491<br/>
Using&#160;bc..................................................................................................................491<br/>An&#160;Example&#160;Script..................................................................................................492<br/>
Summing&#160;Up................................................................................................................493<br/>Extra&#160;Credit..................................................................................................................494<br/>Further&#160;Reading..........................................................................................................494<br/>
<a href="linux-command-lines.html#519"><i><b>35&#160;–&#160;Arrays.</b></i></a><i><b>...................................................................................................495</b></i><br/>
What&#160;Are&#160;Arrays?........................................................................................................495<br/>Creating&#160;an&#160;Array........................................................................................................495<br/>Assigning&#160;Values&#160;to&#160;an&#160;Array.......................................................................................496<br/>Accessing&#160;Array&#160;Elements...........................................................................................497<br/>Array&#160;Operations.........................................................................................................499<br/>
Outputting&#160;the&#160;Entire&#160;Contents&#160;of&#160;an&#160;Array.............................................................499<br/>Determining&#160;the&#160;Number&#160;of&#160;Array&#160;Elements...........................................................500<br/>
xii<br/>
<hr/>
<a name=15></a>Finding&#160;the&#160;Subscripts&#160;Used&#160;by&#160;an&#160;Array...............................................................500<br/>Adding&#160;Elements&#160;to&#160;the&#160;End&#160;of&#160;an&#160;Array................................................................501<br/>Sorting&#160;an&#160;Array......................................................................................................501<br/>Deleting&#160;an&#160;Array....................................................................................................502<br/>
Associative&#160;Arrays.......................................................................................................503<br/>Summing&#160;Up................................................................................................................503<br/>Further&#160;Reading..........................................................................................................504<br/>
<a href="linux-command-lines.html#529"><i><b>36&#160;–&#160;Exotica</b></i></a><i><b>...................................................................................................505</b></i><br/>
Group&#160;Commands&#160;and&#160;Subshells...............................................................................505<br/>
Process&#160;Substitution...............................................................................................509<br/>
Traps............................................................................................................................511<br/>
Temporary&#160;Files.................................................................................................514<br/>
Asynchronous&#160;Execution.............................................................................................515<br/>
wait.........................................................................................................................515<br/>
Named&#160;Pipes...............................................................................................................516<br/>
Setting&#160;Up&#160;a&#160;Named&#160;Pipe.......................................................................................517<br/>Using&#160;Named&#160;Pipes................................................................................................517<br/>
Summing&#160;Up................................................................................................................518<br/>Further&#160;Reading..........................................................................................................518<br/>
<a href="linux-command-lines.html#15"><i><b>Index</b></i></a><i><b>..............................................................................................................519</b></i><br/>
xiii<br/>
<hr/>
<a name=16></a>xiv<br/>
<hr/>
<a name=17></a><i>For&#160;Karen</i><br/>
xv<br/>
<hr/>
<a name=18></a><i><b>Introduction</b></i><br/>
I want&#160;to tell&#160;you a&#160;story.<br/>No,&#160;not&#160;the&#160;story&#160;of&#160;how,&#160;in&#160;1991,&#160;Linus&#160;Torvalds&#160;wrote&#160;the&#160;first&#160;version&#160;of&#160;the&#160;Linux&#160;ker-<br/>nel.&#160;You can read&#160;that&#160;story in&#160;lots&#160;of Linux&#160;books. &#160;Nor am&#160;I going to tell&#160;you the&#160;story of<br/>how,&#160;some&#160;years&#160;earlier,&#160;Richard&#160;Stallman&#160;began&#160;the&#160;GNU&#160;Project&#160;to&#160;create&#160;a&#160;free&#160;Unix-<br/>like&#160;operating&#160;system.&#160;That's&#160;an important&#160;story too, but&#160;most&#160;other&#160;Linux books&#160;have&#160;that<br/>one, as&#160;well.<br/>No, I want&#160;to tell&#160;you the&#160;story of how&#160;you take&#160;back&#160;control&#160;of your computer.<br/>When&#160;I&#160;began&#160;working&#160;with&#160;computers&#160;as&#160;a&#160;college&#160;student&#160;in&#160;the&#160;late&#160;1970s,&#160;there&#160;was&#160;a<br/>revolution&#160;going&#160;on.&#160;The&#160;invention&#160;of&#160;the&#160;microprocessor&#160;had&#160;made&#160;it&#160;possible&#160;for&#160;ordi-<br/>nary&#160;people&#160;like&#160;you&#160;and&#160;me&#160;to&#160;actually&#160;own&#160;a&#160;computer.&#160;&#160;It's&#160;hard&#160;for&#160;many&#160;people&#160;today<br/>to&#160;imagine&#160;what&#160;the&#160;world&#160;was&#160;like&#160;when&#160;only&#160;big&#160;business&#160;and&#160;big&#160;government&#160;ran&#160;all<br/>the&#160;computers. Let's&#160;just&#160;say, you couldn't&#160;get&#160;much done.<br/>Today,&#160;the&#160;world&#160;is&#160;very&#160;different.&#160;Computers&#160;are&#160;everywhere,&#160;from&#160;tiny&#160;wristwatches&#160;to<br/>giant&#160;data&#160;centers&#160;to&#160;everything&#160;in&#160;between.&#160;In&#160;addition&#160;to&#160;ubiquitous&#160;computers,&#160;we&#160;also<br/>have&#160;a&#160;ubiquitous&#160;network&#160;connecting&#160;them&#160;together.&#160;This&#160;has&#160;created&#160;a&#160;wondrous&#160;new<br/>age&#160;of&#160;personal&#160;empowerment&#160;and&#160;creative&#160;freedom,&#160;but&#160;over&#160;the&#160;last&#160;couple&#160;of&#160;decades<br/>something&#160;else&#160;has&#160;been&#160;happening.&#160;A&#160;few&#160;giant&#160;corporations&#160;have&#160;been&#160;imposing&#160;their<br/>control&#160;over&#160;most&#160;of&#160;the&#160;world's&#160;computers&#160;and&#160;deciding&#160;what&#160;you&#160;can&#160;and&#160;cannot&#160;do<br/>with them. Fortunately, people&#160;from&#160;all&#160;over the&#160;world are&#160;doing something about&#160;it.&#160;They<br/>are&#160;fighting&#160;to&#160;maintain&#160;control&#160;of&#160;their&#160;computers&#160;by&#160;writing&#160;their&#160;own&#160;software.&#160;They<br/>are&#160;building Linux.<br/>Many&#160;people&#160;speak&#160;of&#160;“freedom”&#160;with&#160;regard&#160;to&#160;Linux,&#160;but&#160;I&#160;don't&#160;think&#160;most&#160;people<br/>know&#160;what&#160;this&#160;freedom&#160;really&#160;means.&#160;Freedom&#160;is&#160;the&#160;power&#160;to&#160;decide&#160;what&#160;your&#160;com-<br/>puter&#160;does,&#160;and&#160;the&#160;only&#160;way&#160;to&#160;have&#160;this&#160;freedom&#160;is&#160;to&#160;know&#160;what&#160;your&#160;computer&#160;is&#160;do-<br/>ing.&#160;Freedom&#160;is&#160;a&#160;computer&#160;that&#160;is&#160;without&#160;secrets,&#160;one&#160;where&#160;everything&#160;can&#160;be&#160;known&#160;if<br/>you care&#160;enough to find out.<br/>
<b>Why&#160;Use&#160;the&#160;Command&#160;Line?<br/></b>Have&#160;you&#160;ever&#160;noticed&#160;in&#160;the&#160;movies&#160;when&#160;the&#160;“super&#160;hacker,” — you&#160;know,&#160;the&#160;guy&#160;who<br/>can&#160;break&#160;into&#160;the&#160;ultra-secure&#160;military&#160;computer&#160;in&#160;less&#160;than&#160;30&#160;seconds — sits&#160;down&#160;at<br/>the&#160;computer,&#160;he&#160;never&#160;touches&#160;a&#160;mouse?&#160;It's&#160;because&#160;filmmakers&#160;realize&#160;that&#160;we,&#160;as&#160;hu-<br/>man&#160;beings,&#160;instinctively&#160;know&#160;the&#160;only&#160;way&#160;to&#160;really&#160;get&#160;anything&#160;done&#160;on&#160;a&#160;computer&#160;is<br/>
xvi<br/>
<hr/>
<a name=19></a>by typing on a&#160;keyboard!<br/>Most&#160;computer&#160;users&#160;today&#160;are&#160;familiar&#160;only&#160;with&#160;the&#160;<i>graphical&#160;user&#160;interface</i>&#160;(GUI)&#160;and<br/>have&#160;been&#160;taught&#160;by&#160;vendors&#160;and&#160;pundits&#160;that&#160;the&#160;<i>command&#160;line&#160;interface</i>&#160;(CLI)&#160;is&#160;a&#160;terri-<br/>fying&#160;thing&#160;of&#160;the&#160;past.&#160;This&#160;is&#160;unfortunate,&#160;because&#160;a&#160;good&#160;command&#160;line&#160;interface&#160;is&#160;a<br/>marvelously&#160;expressive&#160;way&#160;of&#160;communicating&#160;with&#160;a&#160;computer&#160;in&#160;much&#160;the&#160;same&#160;way<br/>the&#160;written&#160;word&#160;is&#160;for&#160;human&#160;beings.&#160;It's&#160;been&#160;said&#160;that&#160;“graphical&#160;user&#160;interfaces&#160;make<br/>easy&#160;tasks&#160;easy,&#160;while&#160;command&#160;line&#160;interfaces&#160;make&#160;difficult&#160;tasks&#160;possible”&#160;and&#160;this&#160;is<br/>still&#160;very true&#160;today.<br/>Since&#160;Linux&#160;is&#160;modeled&#160;after&#160;the&#160;&#160;Unix&#160;&#160;family&#160;of&#160;operating&#160;systems,&#160;it&#160;shares&#160;the&#160;same<br/>rich&#160;heritage&#160;of&#160;command&#160;line&#160;tools&#160;as&#160;Unix.&#160;Unix&#160;came&#160;into&#160;prominence&#160;during&#160;the&#160;early<br/>1980s&#160;(although&#160;it&#160;was&#160;first&#160;developed&#160;a&#160;decade&#160;earlier),&#160;before&#160;the&#160;widespread&#160;adoption<br/>of&#160;the&#160;graphical&#160;user&#160;interface&#160;and,&#160;as&#160;a&#160;result,&#160;developed&#160;an&#160;extensive&#160;command&#160;line&#160;in-<br/>terface&#160;instead.&#160;In&#160;fact,&#160;one&#160;of&#160;the&#160;strongest&#160;reasons&#160;early&#160;adopters&#160;of&#160;Linux&#160;chose&#160;it&#160;over,<br/>say,&#160;Windows&#160;NT&#160;was&#160;the&#160;powerful&#160;command&#160;line&#160;interface&#160;that&#160;made&#160;the&#160;“difficult&#160;tasks<br/>possible.”<br/>
<b>What&#160;This&#160;Book&#160;Is&#160;About<br/></b>This&#160;book&#160;is&#160;a&#160;broad&#160;overview&#160;of&#160;“living”&#160;on&#160;the&#160;Linux&#160;command&#160;line.&#160;Unlike&#160;some<br/>books&#160;that&#160;concentrate&#160;on&#160;just&#160;a&#160;single&#160;program,&#160;such&#160;as&#160;the&#160;shell&#160;program,&#160;&#160;bash,&#160;this<br/>book&#160;will&#160;try&#160;to&#160;convey&#160;how&#160;to&#160;get&#160;along&#160;with&#160;the&#160;command&#160;line&#160;interface&#160;in&#160;a&#160;larger<br/>sense.&#160;How&#160;does&#160;it&#160;all&#160;work?&#160;What&#160;can&#160;it&#160;do?&#160;What's&#160;the&#160;best&#160;way to use&#160;it?<br/><b>This&#160;is&#160;not a book&#160;about Linux system&#160;administration.</b>&#160;While&#160;any&#160;serious&#160;discussion of<br/>the&#160;command&#160;line&#160;will&#160;invariably&#160;lead&#160;to&#160;system&#160;administration&#160;topics,&#160;this&#160;book&#160;touches<br/>on&#160;only&#160;a&#160;few&#160;administration&#160;issues.&#160;It&#160;will,&#160;however,&#160;prepare&#160;the&#160;reader&#160;for&#160;additional<br/>study by providing a&#160;solid foundation&#160;in the&#160;use&#160;of the&#160;command&#160;line, an&#160;essential&#160;tool&#160;for<br/>any serious&#160;system&#160;administration task.<br/><b>This&#160;book&#160;is&#160;very&#160;Linux-centric.</b>&#160;Many&#160;other&#160;books&#160;try&#160;to&#160;broaden&#160;their&#160;appeal&#160;by&#160;in-<br/>cluding&#160;other&#160;platforms&#160;such&#160;as&#160;generic&#160;Unix&#160;and macOS. In&#160;doing so,&#160;they&#160;“water&#160;down”<br/>their&#160;content&#160;to&#160;feature&#160;only&#160;general&#160;topics.&#160;This&#160;book,&#160;on&#160;the&#160;other&#160;hand,&#160;only&#160;covers<br/>contemporary&#160;Linux&#160;distributions. Ninety-five&#160;percent&#160;of the&#160;content&#160;is&#160;useful&#160;for&#160;users&#160;of<br/>other&#160;Unix-like&#160;systems,&#160;but&#160;this&#160;book&#160;is&#160;highly&#160;targeted&#160;at&#160;the&#160;modern&#160;Linux&#160;command<br/>line&#160;user.&#160;<br/>
<b>Who&#160;Should&#160;Read&#160;This&#160;Book<br/></b>This&#160;book&#160;is&#160;for&#160;new&#160;Linux&#160;users&#160;who&#160;have&#160;migrated&#160;from&#160;other&#160;platforms.&#160;Most&#160;likely<br/>you&#160;are&#160;a&#160;“power&#160;user”&#160;of&#160;some&#160;version&#160;of&#160;Microsoft&#160;Windows.&#160;Perhaps&#160;your&#160;boss&#160;has<br/>told&#160;you&#160;to&#160;administer&#160;a&#160;Linux&#160;server,&#160;or&#160;you’re&#160;entering&#160;the&#160;exciting&#160;new&#160;world&#160;of&#160;single<br/>board&#160;computers&#160;(SBC)&#160;such&#160;as&#160;the&#160;Raspberry&#160;Pi.&#160;You&#160;may&#160;just&#160;be&#160;a&#160;desktop&#160;user&#160;who&#160;is<br/>tired&#160;of&#160;all&#160;the&#160;security&#160;problems&#160;and&#160;wants&#160;to&#160;give&#160;Linux&#160;a&#160;try.&#160;That's&#160;fine.&#160;&#160;All&#160;are&#160;wel-<br/>come&#160;here.<br/>
xvii<br/>
<hr/>
<a name=20></a>That&#160;being&#160;said,&#160;there&#160;is&#160;no&#160;shortcut&#160;to&#160;Linux&#160;enlightenment.&#160;Learning&#160;the&#160;command&#160;line<br/>is&#160;challenging&#160;and&#160;takes&#160;real&#160;effort.&#160;It's&#160;not&#160;that&#160;it's&#160;so&#160;hard,&#160;but&#160;rather&#160;it's&#160;so&#160;<i>vast</i>.&#160;The&#160;av-<br/>erage&#160;Linux&#160;system&#160;has&#160;literally&#160;<i>thousands</i>&#160;of&#160;programs&#160;you&#160;can&#160;employ&#160;on&#160;the&#160;command<br/>line.&#160;Consider&#160;yourself warned;&#160;learning&#160;the&#160;command&#160;line&#160;is&#160;not&#160;a&#160;casual&#160;endeavor.<br/>On&#160;the&#160;other&#160;hand,&#160;learning&#160;the&#160;Linux&#160;command&#160;line&#160;is&#160;extremely&#160;rewarding.&#160;If&#160;you&#160;think<br/>you're&#160;a&#160;“power&#160;user”&#160;now,&#160;just&#160;wait.&#160;You&#160;don't&#160;know&#160;what&#160;real&#160;power&#160;is — yet.&#160;And,&#160;un-<br/>like&#160;many&#160;other&#160;computer&#160;skills,&#160;knowledge&#160;of&#160;the&#160;command&#160;line&#160;is&#160;long&#160;lasting.&#160;The<br/>skills&#160;learned&#160;today&#160;will&#160;still&#160;be&#160;useful&#160;10&#160;years&#160;from&#160;now.&#160;The&#160;command&#160;line&#160;has&#160;sur-<br/>vived the&#160;test&#160;of time.&#160;<br/>It&#160;is&#160;also&#160;assumed&#160;that&#160;you&#160;have&#160;no&#160;programming&#160;experience,&#160;but&#160;don’t&#160;worry,&#160;we'll&#160;start<br/>you down that&#160;path&#160;as&#160;well.<br/>
<b>What's&#160;in&#160;This&#160;Book<br/></b>This&#160;material&#160;is&#160;presented&#160;in&#160;a&#160;carefully&#160;chosen&#160;sequence,&#160;much&#160;like&#160;a&#160;tutor&#160;sitting&#160;next&#160;to<br/>you&#160;guiding&#160;you&#160;along.&#160;Many&#160;authors&#160;treat&#160;this&#160;material&#160;in&#160;a&#160;“systematic”&#160;fashion,&#160;ex-<br/>haustively&#160;covering&#160;each&#160;topic&#160;in&#160;order.&#160;This&#160;makes&#160;sense&#160;from&#160;a&#160;writer’s&#160;perspective,&#160;but<br/>can be&#160;very confusing to new&#160;users.<br/>Another&#160;goal&#160;is&#160;to&#160;acquaint&#160;you&#160;with&#160;the&#160;Unix&#160;way&#160;of&#160;thinking,&#160;which&#160;is&#160;different&#160;from<br/>the&#160;Windows&#160;way&#160;of thinking.&#160;&#160;Along the&#160;way,&#160;we'll&#160;go&#160;on a&#160;few&#160;side&#160;trips&#160;to&#160;help&#160;you&#160;un-<br/>derstand&#160;why&#160;certain&#160;things&#160;work&#160;the&#160;way&#160;they&#160;do&#160;and&#160;how&#160;they&#160;got&#160;that&#160;way.&#160;&#160;Linux&#160;is<br/>not&#160;just&#160;a&#160;piece&#160;of&#160;software;&#160;it's&#160;also&#160;a&#160;small&#160;part&#160;of&#160;the&#160;larger&#160;Unix&#160;culture,&#160;which&#160;has&#160;its<br/>own language&#160;and history. I might&#160;throw&#160;in&#160;a&#160;rant&#160;or two, as&#160;well.<br/>This&#160;book&#160;is&#160;divided&#160;into&#160;four&#160;parts,&#160;each&#160;covering&#160;some&#160;aspect&#160;of&#160;the&#160;command&#160;line&#160;ex-<br/>perience:&#160;<br/>
●<br/>
<b>Part&#160;1&#160;–&#160;Learning&#160;The&#160;Shell</b>&#160;starts&#160;our&#160;exploration&#160;of&#160;the&#160;basic&#160;language&#160;of&#160;the<br/>command&#160;line&#160;including&#160;such&#160;things&#160;as&#160;the&#160;structure&#160;of&#160;commands,&#160;file&#160;system<br/>navigation,&#160;command&#160;line&#160;editing,&#160;and&#160;finding&#160;help&#160;and&#160;documentation&#160;for&#160;com-<br/>mands.<br/>
●<br/>
<b>Part&#160;2&#160;–&#160;Configuration&#160;And&#160;The&#160;&#160;Environment</b>&#160;&#160;covers&#160;editing&#160;configuration<br/>files&#160;that&#160;control&#160;the&#160;computer's&#160;operation from&#160;the&#160;command line.<br/>
●<br/>
<b>Part&#160;3&#160;–&#160;Common&#160;Tasks&#160;And&#160;Essential&#160;Tools</b>&#160;&#160;explores&#160;many&#160;of&#160;the&#160;ordinary<br/>tasks&#160;that&#160;are&#160;commonly&#160;performed&#160;from&#160;the&#160;command&#160;line.&#160;Unix-like&#160;operating<br/>systems,&#160;such&#160;as&#160;Linux,&#160;contain&#160;many&#160;“classic”&#160;command&#160;line&#160;programs&#160;that&#160;are<br/>used&#160;to perform&#160;powerful&#160;operations&#160;on data.<br/>
●<br/>
<b>Part&#160;4&#160;–&#160;Writing&#160;&#160;Shell&#160;Scripts</b>&#160;&#160;introduces&#160;shell&#160;&#160;programming,&#160;&#160;an&#160;admittedly<br/>rudimentary,&#160;but&#160;easy&#160;to&#160;learn,&#160;technique&#160;for&#160;automating&#160;many&#160;common&#160;comput-<br/>ing&#160;tasks.&#160;By&#160;learning&#160;shell&#160;programming,&#160;you&#160;will&#160;become&#160;familiar&#160;with&#160;concepts<br/>that&#160;can be&#160;applied&#160;to many&#160;other programming languages.<br/>
xviii<br/>
<hr/>
<a name=21></a><b>How&#160;To&#160;Read&#160;This&#160;Book<br/></b>Start&#160;at&#160;the&#160;beginning&#160;of&#160;the&#160;book&#160;and&#160;follow&#160;it&#160;to&#160;the&#160;end.&#160;It&#160;isn’t&#160;written&#160;as&#160;a&#160;reference<br/>work, it's&#160;really&#160;more&#160;like&#160;a&#160;story with&#160;a&#160;beginning,&#160;middle, and end.&#160;<br/>
Prerequisites<br/>To use&#160;this&#160;book,&#160;all&#160;you&#160;will&#160;need&#160;is&#160;a&#160;working&#160;Linux&#160;installation.&#160;You can&#160;get&#160;this&#160;in&#160;one<br/>of two ways:<br/>
1.&#160;<b>Install&#160;Linux&#160;on&#160;a&#160;(not&#160;so&#160;new)&#160;computer.</b>&#160;It&#160;doesn't&#160;matter&#160;which&#160;distribution<br/>
you&#160;choose,&#160;though&#160;most&#160;people&#160;today&#160;start&#160;out&#160;with&#160;either&#160;&#160;Ubuntu,&#160;&#160;Fedora,&#160;or<br/>OpenSUSE.&#160;If&#160;in&#160;doubt,&#160;try&#160;Ubuntu&#160;first.&#160;Installing&#160;a&#160;modern&#160;Linux&#160;distribution<br/>can&#160;be&#160;ridiculously&#160;easy&#160;or&#160;ridiculously&#160;difficult&#160;depending&#160;on&#160;your&#160;hardware.&#160;I<br/>suggest&#160;a&#160;desktop&#160;computer&#160;that&#160;is&#160;a&#160;couple&#160;of&#160;years&#160;old&#160;and&#160;has&#160;at&#160;least&#160;2&#160;GB&#160;of<br/>RAM&#160;and&#160;6&#160;GB&#160;of&#160;free&#160;hard&#160;disk&#160;space.&#160;Avoid&#160;laptops&#160;and&#160;wireless&#160;networks&#160;if&#160;at<br/>all&#160;possible,&#160;as&#160;these&#160;are&#160;often more&#160;difficult&#160;to&#160;get&#160;working.<br/>
2.&#160;<b>Use&#160;a&#160;“Live&#160;CD”&#160;or&#160;USB&#160;flash&#160;drive.</b>&#160;One&#160;of&#160;the&#160;cool&#160;things&#160;you&#160;can&#160;do&#160;with<br/>
many&#160;Linux&#160;distributions&#160;is&#160;run&#160;them&#160;directly&#160;from&#160;a&#160;CDROM&#160;or&#160;USB&#160;flash&#160;drive<br/>without&#160;installing&#160;them&#160;at&#160;all.&#160;Just&#160;go&#160;into&#160;your&#160;BIOS&#160;setup&#160;and&#160;set&#160;your&#160;computer<br/>to&#160;boot&#160;from&#160;a&#160;CDROM&#160;drive&#160;or&#160;USB&#160;device,&#160;and&#160;reboot.&#160;Using&#160;this&#160;method&#160;is&#160;a<br/>great&#160;way&#160;to&#160;test&#160;a&#160;computer&#160;for&#160;Linux&#160;compatibility&#160;prior&#160;to&#160;installation.&#160;The&#160;dis-<br/>advantage&#160;is&#160;that&#160;it&#160;may&#160;be&#160;very&#160;slow&#160;compared&#160;to&#160;having&#160;Linux&#160;installed&#160;on&#160;your<br/>hard drive.&#160;Both Ubuntu and Fedora&#160;(among others) have&#160;live&#160;versions.<br/>
Regardless&#160;of&#160;how&#160;you&#160;install&#160;Linux,&#160;you&#160;will&#160;need&#160;to&#160;have&#160;occasional&#160;superuser&#160;(i.e.,&#160;ad-<br/>ministrative)&#160;privileges&#160;to carry&#160;out&#160;the&#160;lessons&#160;in&#160;this&#160;book.<br/>After&#160;you&#160;have&#160;a&#160;working&#160;installation,&#160;start&#160;reading&#160;and&#160;follow&#160;along&#160;with&#160;your&#160;own&#160;com-<br/>puter.&#160;Most&#160;of the&#160;material&#160;in this&#160;book is&#160;“hands&#160;on,”&#160;so sit&#160;down and get&#160;typing!<br/>
<b>Why&#160;I&#160;Don't&#160;Call&#160;It&#160;“GNU/Linux”</b><br/>
In&#160;some&#160;quarters,&#160;it's&#160;politically&#160;correct&#160;to&#160;call&#160;the&#160;Linux&#160;operating&#160;system&#160;the<br/>“GNU/Linux&#160;operating&#160;system.”&#160;The&#160;problem&#160;with&#160;“Linux”&#160;is&#160;that&#160;there&#160;is&#160;no<br/>completely&#160;correct&#160;way&#160;to&#160;name&#160;it&#160;because&#160;it&#160;was&#160;written&#160;by&#160;many&#160;different&#160;peo-<br/>ple&#160;in&#160;a&#160;vast,&#160;distributed&#160;development&#160;effort.&#160;Technically&#160;speaking,&#160;Linux&#160;is&#160;the<br/>name&#160;of&#160;the&#160;operating&#160;system's&#160;kernel,&#160;nothing&#160;more.&#160;The&#160;kernel&#160;is&#160;very&#160;important<br/>of&#160;course,&#160;since&#160;it&#160;makes&#160;the&#160;operating&#160;system&#160;go,&#160;but&#160;it's&#160;not&#160;enough&#160;to&#160;form&#160;a<br/>complete&#160;operating&#160;system.<br/>Enter&#160;&#160;Richard&#160;Stallman,&#160;the&#160;genius-philosopher&#160;who&#160;founded&#160;the&#160;Free&#160;Software<br/>movement,&#160;started&#160;the&#160;Free&#160;Software&#160;Foundation,&#160;formed&#160;the&#160;GNU&#160;Project,&#160;wrote<br/>the&#160;first&#160;version&#160;of&#160;the&#160;GNU&#160;C&#160;Compiler&#160;(gcc),&#160;created&#160;the&#160;GNU&#160;General&#160;Public<br/>
xix<br/>
<hr/>
<a name=22></a>License&#160;(the&#160;GPL),&#160;etc.,&#160;etc.,&#160;etc.&#160;He&#160;<i>insists</i>&#160;that&#160;you&#160;call&#160;it&#160;“GNU/Linux”&#160;to&#160;prop-<br/>erly&#160;reflect&#160;the&#160;contributions&#160;of the&#160;GNU&#160;Project.&#160;While&#160;the&#160;GNU&#160;Project&#160;predates<br/>the&#160;Linux&#160;kernel,&#160;and&#160;the&#160;project's&#160;contributions&#160;are&#160;extremely&#160;deserving&#160;of&#160;recog-<br/>nition,&#160;placing&#160;them&#160;in&#160;the&#160;name&#160;is&#160;unfair&#160;to&#160;everyone&#160;else&#160;who&#160;made&#160;significant<br/>contributions.&#160;Besides,&#160;I&#160;think&#160;“Linux/GNU”&#160;would&#160;be&#160;more&#160;technically&#160;accurate<br/>since&#160;the&#160;kernel&#160;boots&#160;first&#160;and everything else&#160;runs&#160;on top of it.<br/>In&#160;popular&#160;usage,&#160;“Linux”&#160;refers&#160;to&#160;the&#160;kernel&#160;and&#160;all&#160;the&#160;other&#160;free&#160;and&#160;open<br/>source&#160;software&#160;found&#160;in&#160;the&#160;typical&#160;Linux&#160;distribution,&#160;that&#160;is,&#160;the&#160;entire&#160;Linux<br/>ecosystem,&#160;&#160;&#160;not&#160;&#160;&#160;just&#160;&#160;&#160;the&#160;&#160;&#160;GNU&#160;&#160;&#160;components.&#160;&#160;The&#160;&#160;&#160;operating&#160;&#160;&#160;system&#160;&#160;&#160;marketplace<br/>seems&#160;to&#160;prefer&#160;one-word&#160;names&#160;such&#160;as&#160;DOS,&#160;Windows,&#160;macOS,&#160;Solaris,&#160;Irix,<br/>and&#160;AIX.&#160;I&#160;have&#160;chosen&#160;to&#160;use&#160;the&#160;popular&#160;format.&#160;If,&#160;however,&#160;you&#160;prefer&#160;to&#160;use<br/>“GNU/Linux”&#160;instead,&#160;please&#160;perform&#160;a&#160;mental&#160;search-and-replace&#160;while&#160;reading<br/>this&#160;book. I won't&#160;mind.<br/>
<b>What's&#160;New&#160;in&#160;the&#160;Fifth&#160;Internet&#160;Edition<br/></b>Building&#160;on&#160;the&#160;work&#160;performed&#160;for&#160;the&#160;Fourth&#160;Internet&#160;Edition,&#160;this&#160;edition&#160;of&#160;<i>The&#160;Linux<br/>Command&#160;Line</i>&#160;&#160;has&#160;been&#160;extensively&#160;modernized.&#160;There&#160;are&#160;numerous&#160;small&#160;edits&#160;and<br/>corrections,&#160;new&#160;screenshots&#160;and&#160;diagrams,&#160;along&#160;with&#160;a&#160;few&#160;clarifications.&#160;I&#160;also&#160;fixed&#160;a<br/>couple&#160;of &#160;bugs&#160;;-).<br/>
<b>Acknowledgments<br/></b>I want&#160;to thank&#160;the&#160;following people, who helped&#160;make&#160;this&#160;book possible:<br/>
First&#160;Internet&#160;Edition<br/>Jenny&#160;Watson,&#160;Acquisitions&#160;Editor&#160;at&#160;Wiley&#160;Publishing&#160;who&#160;originally&#160;suggested&#160;that&#160;I<br/>write&#160;a&#160;shell&#160;scripting book.<br/>John&#160;C.&#160;Dvorak,&#160;noted&#160;columnist&#160;and&#160;pundit.&#160;In&#160;an&#160;episode&#160;of&#160;his&#160;video&#160;podcast,&#160;“Cranky<br/>Geeks,”&#160;Mr.&#160;Dvorak&#160;described&#160;the&#160;process&#160;of&#160;writing:&#160;“Hell.&#160;Write&#160;200&#160;words&#160;a&#160;day&#160;and<br/>in a&#160;year, you have&#160;a&#160;novel.”&#160;This&#160;advice&#160;led me&#160;to write&#160;a&#160;page&#160;a&#160;day until&#160;I had a&#160;book.<br/>Dmitri&#160;Popov&#160;wrote&#160;an&#160;article&#160;in&#160;Free&#160;Software&#160;Magazine&#160;titled,&#160;“Creating&#160;a&#160;Book&#160;Tem-<br/>plate&#160;with&#160;Writer,”&#160;which&#160;inspired&#160;me&#160;to&#160;use&#160;&#160;OpenOffice.org&#160;Writer&#160;&#160;for&#160;composing&#160;the<br/>text.&#160;As&#160;it&#160;turned&#160;out, it&#160;worked&#160;wonderfully.<br/>Mark Polesky performed&#160;an extraordinary review&#160;and test&#160;of the&#160;text.&#160;<br/>Jesse&#160;Becker,&#160;Tomasz&#160;Chrzczonowicz,&#160;Michael&#160;Levin,&#160;and&#160;Spence&#160;Miner&#160;also&#160;tested&#160;and<br/>reviewed&#160;portions&#160;of the&#160;text.&#160;<br/>Karen&#160;M.&#160;Shotts&#160;contributed&#160;a&#160;lot&#160;of&#160;hours,&#160;polishing&#160;my&#160;so-called&#160;English&#160;by&#160;editing&#160;the<br/>manuscript.<br/>
xx<br/>
<hr/>
<a name=23></a>Second&#160;Internet&#160;Edition<br/>Special&#160;thanks&#160;go&#160;out&#160;to&#160;the&#160;following&#160;individuals&#160;who&#160;provided&#160;valuable&#160;feedback&#160;incor-<br/>porated&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;Second&#160;&#160;&#160;Internet&#160;&#160;&#160;Edition:&#160;&#160;Adrian&#160;&#160;Arpidez,&#160;&#160;&#160;Hu&#160;&#160;&#160;Bo,&#160;&#160;&#160;Heriberto&#160;&#160;&#160;Cantú,<br/>Joshua&#160;&#160;&#160;Escamilla,&#160;&#160;&#160;Bruce&#160;&#160;&#160;Fowler,&#160;&#160;&#160;Ma&#160;&#160;&#160;Jun,&#160;&#160;&#160;Seth&#160;&#160;&#160;King,&#160;&#160;&#160;Mike&#160;&#160;&#160;O'Donnell,&#160;&#160;&#160;Parviz&#160;&#160;&#160;Ra-<br/>soulipour, Gabriel&#160;Stutzman, and&#160;Christian&#160;Wuethrich.<br/>
Third&#160;Internet&#160;Edition<br/>Special&#160;thanks&#160;go&#160;out&#160;to&#160;the&#160;following&#160;individuals&#160;who&#160;provided&#160;valuable&#160;feedback&#160;incor-<br/>porated&#160;&#160;into&#160;the&#160;&#160;Third&#160;Internet&#160;&#160;Edition:&#160;Steve&#160;&#160;Bragg,&#160;Lixin&#160;Duan,&#160;Sunil&#160;Joshi,&#160;Chris<br/>Knight,&#160;&#160;&#160;Jim&#160;&#160;&#160;Kovacs,&#160;&#160;&#160;Bartłomiej&#160;&#160;&#160;Majka,&#160;&#160;&#160;Bashar&#160;&#160;&#160;Maree,&#160;&#160;&#160;Frank&#160;&#160;&#160;McTipps,&#160;&#160;&#160;Justin&#160;&#160;&#160;Page,<br/>Waldo&#160;Ribeiro,&#160;Satej&#160;Kumar&#160;Sahu,&#160;Mikhail&#160;Sizov,&#160;Pickles&#160;Spill,&#160;Francesco&#160;Turco,&#160;Wol-<br/>fram&#160;Volpi, and Boyang&#160;Wang .<br/>
Fourth&#160;Internet&#160;Edition<br/>Special&#160;thanks&#160;go&#160;out&#160;to&#160;the&#160;following&#160;individuals&#160;who&#160;provided&#160;valuable&#160;feedback&#160;incor-<br/>porated&#160;into&#160;the&#160;Fourth&#160;Internet&#160;Edition:&#160;Enzo&#160;Cardinal,&#160;Devin&#160;Harper,&#160;Jørgen&#160;Heitmann,<br/>Jonathan&#160;Jones,&#160;Jaroslaw&#160;Kolosowski,&#160;Eric.Kammerer,&#160;Waldo&#160;Ribeiro,&#160;Nick&#160;Rose,&#160;Ben<br/>Slater,&#160;and Francesco&#160;Turco.<br/>
Fifth&#160;Internet&#160;Edition<br/>Special&#160;thanks&#160;go&#160;out&#160;to&#160;the&#160;following&#160;individuals&#160;who&#160;provided&#160;valuable&#160;feedback&#160;incor-<br/>porated&#160;into&#160;the&#160;Fifth&#160;Internet&#160;Edition:&#160;John&#160;Burns,&#160;Paolo&#160;Casati,&#160;Waldo&#160;Ribeiro,&#160;and&#160;Val-<br/>ter&#160;Wierzba.<br/>And&#160;lastly,&#160;many&#160;thanks&#160;to&#160;the&#160;many&#160;readers&#160;of<a href="http://linuxcommand.org/">&#160;LinuxCommand.org,</a>&#160;who&#160;have&#160;sent&#160;me<br/>so&#160;many&#160;kind&#160;emails.&#160;Their&#160;encouragement&#160;gave&#160;me&#160;the&#160;idea&#160;that&#160;I&#160;was&#160;really&#160;on&#160;to&#160;some-<br/>thing!&#160;<br/>
<b>Your&#160;Feedback&#160;Is&#160;Needed!<br/></b>This&#160;book&#160;is&#160;an&#160;ongoing&#160;project,&#160;like&#160;many&#160;open&#160;source&#160;software&#160;projects.&#160;If&#160;you&#160;find&#160;a<br/>technical&#160;error, drop me&#160;a&#160;line&#160;at:<br/><a href="mailto:bshotts@users.sourceforge.net">bshotts@users.sourceforge.net<br/></a>Be&#160;sure&#160;to&#160;indicate&#160;the&#160;exact&#160;edition&#160;of&#160;the&#160;book&#160;you&#160;are&#160;reading.&#160;Your&#160;changes&#160;and&#160;sug-<br/>gestions&#160;may&#160;get&#160;into&#160;future&#160;releases.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
Here&#160;are&#160;some&#160;Wikipedia&#160;articles&#160;about&#160;the&#160;famous&#160;people&#160;mentioned&#160;above:<br/><a href="http://en.wikipedia.org/wiki/Linux_Torvalds">http://en.wikipedia.org/wiki/Linus_Torvalds<br/></a><a href="http://en.wikipedia.org/wiki/Richard_Stallman">http://en.wikipedia.org/wiki/Richard_Stallman</a><br/>
xxi<br/>
<hr/>
<a name=24></a>●<br/>
The&#160;Free&#160;Software&#160;Foundation&#160;and&#160;the&#160;GNU&#160;Project:<br/><a href="http://en.wikipedia.org/wiki/Free_Software_Foundation">http://en.wikipedia.org/wiki/Free_Software_Foundation<br/></a><a href="http://www.fsf.org/">http://www.fsf.org<br/></a><a href="http://www.gnu.org/">http://www.gnu.org</a><br/>
●<br/>
Richard&#160;Stallman has&#160;written extensively on the&#160;“GNU/Linux”&#160;naming issue:<br/><a href="http://www.gnu.org/gnu/why-gnu-linux.html">http://www.gnu.org/gnu/why-gnu-linux.html<br/></a><a href="http://www.gnu.org/gnu/gnu-linux-faq.html#tools">http://www.gnu.org/gnu/gnu-linux-faq.html#tools</a><br/>
<b>Colophon<br/></b>This&#160;book&#160;was&#160;originally&#160;written&#160;using&#160;&#160;OpenOffice.org&#160;Writer&#160;&#160;in&#160;Liberation&#160;Serif&#160;and<br/>Sans&#160;fonts&#160;on&#160;a&#160;Dell&#160;Inspiron&#160;530N,&#160;factory&#160;configured&#160;with&#160;Ubuntu&#160;8.04.&#160;The&#160;PDF&#160;ver-<br/>sion&#160;of&#160;the&#160;text&#160;was&#160;generated&#160;directly&#160;by&#160;OpenOffice.org&#160;Writer.&#160;The&#160;Second&#160;Internet<br/>Edition&#160;was&#160;produced&#160;on&#160;the&#160;same&#160;computer&#160;using&#160;LibreOffice&#160;Writer&#160;on&#160;Ubuntu&#160;12.04.<br/>The&#160;Third&#160;and&#160;Fourth&#160;Internet&#160;Editions&#160;were&#160;produced&#160;with&#160;LibreOffice&#160;Writer&#160;on&#160;a&#160;Sys-<br/>tem76&#160;Ratel&#160;Pro&#160;computer,&#160;factory&#160;configured&#160;with&#160;Ubuntu&#160;14.04.&#160;The&#160;Fifth&#160;Internet&#160;Edi-<br/>tion was&#160;produced&#160;on the&#160;same&#160;computer&#160;using&#160;LibreOffice&#160;Writer and Ubuntu 18.04.<br/>
xxii<br/>
<hr/>
<a name=25></a>Part&#160;1&#160;–&#160;Learning&#160;the&#160;Shel<br/>
1<br/>
<hr/>
<a name=26></a>1 –&#160;What&#160;Is&#160;the&#160;Shell?<br/>
<i><b>1&#160;–&#160;What&#160;Is&#160;the&#160;Shell?</b></i><br/>
When&#160;we&#160;speak&#160;of&#160;the&#160;command&#160;line,&#160;we&#160;are&#160;really&#160;referring&#160;to&#160;the&#160;<i>shell</i>.&#160;The&#160;shell&#160;is&#160;a<br/>program&#160;that&#160;takes&#160;keyboard&#160;commands&#160;and&#160;passes&#160;them&#160;to&#160;the&#160;operating&#160;system&#160;to&#160;carry<br/>out.&#160;Almost&#160;all&#160;Linux&#160;distributions&#160;supply&#160;a&#160;shell&#160;program&#160;from&#160;the&#160;GNU&#160;Project&#160;called<br/>bash.&#160;The&#160;name&#160;“bash”&#160;is&#160;an&#160;acronym&#160;for&#160;“Bourne&#160;Again&#160;SHell”,&#160;a&#160;reference&#160;to&#160;the&#160;fact<br/>bash&#160;&#160;is&#160;an&#160;enhanced&#160;replacement&#160;for&#160;&#160;sh,&#160;the&#160;original&#160;Unix&#160;shell&#160;program&#160;written&#160;by<br/>Steve&#160;Bourne.<br/>
<b>Terminal&#160;Emulators<br/></b>When&#160;using&#160;a&#160;graphical&#160;user&#160;interface&#160;(GUI),&#160;we&#160;need&#160;another&#160;program&#160;called&#160;a&#160;<i>terminal<br/>emulator</i>&#160;to&#160;interact&#160;with&#160;the&#160;shell.&#160;If&#160;we&#160;look&#160;through&#160;our&#160;desktop&#160;menus,&#160;we&#160;will&#160;proba-<br/>bly&#160;find&#160;one.&#160;&#160;KDE&#160;&#160;uses&#160;&#160;konsole&#160;and&#160;GNOME&#160;uses&#160;gnome-terminal,&#160;though&#160;it's<br/>likely&#160;called&#160;simply&#160;“terminal”&#160;on&#160;our&#160;menu.&#160;A&#160;number&#160;of&#160;other&#160;terminal&#160;emulators&#160;are<br/>available&#160;for&#160;Linux,&#160;but&#160;they&#160;all&#160;basically&#160;do&#160;the&#160;same&#160;thing;&#160;give&#160;us&#160;access&#160;to&#160;the&#160;shell.<br/>You&#160;will&#160;probably&#160;develop&#160;a&#160;preference&#160;for&#160;one&#160;or&#160;another&#160;terminal&#160;emulator&#160;based&#160;on&#160;the<br/>number of bells&#160;and whistles&#160;it&#160;has.<br/>
<b>Making&#160;Your&#160;First&#160;Keystrokes<br/></b>So let's&#160;get&#160;started. Launch&#160;the&#160;terminal&#160;emulator!&#160;Once&#160;it&#160;comes&#160;up, we&#160;should see&#160;some-<br/>thing like&#160;this:<br/>
[me@linuxbox ~]$<br/>
This&#160;is&#160;called&#160;a&#160;<i>shell&#160;prompt</i>&#160;and&#160;it&#160;will&#160;appear&#160;whenever&#160;the&#160;shell&#160;is&#160;ready&#160;to&#160;accept&#160;in-<br/>put.&#160;While&#160;it&#160;may&#160;vary&#160;in&#160;appearance&#160;somewhat&#160;depending&#160;on&#160;the&#160;distribution,&#160;it&#160;will&#160;typ-<br/>ically&#160;include&#160;your&#160;<i>username@machinename</i>,&#160;followed&#160;by&#160;the&#160;current&#160;working&#160;directory<br/>(more&#160;about&#160;that&#160;in a&#160;little&#160;bit) and a&#160;dollar sign.<br/>
Note:&#160;If&#160;the&#160;last&#160;character&#160;of&#160;the&#160;prompt&#160;is&#160;a&#160;pound&#160;sign&#160;(“#”)&#160;rather&#160;than&#160;a&#160;dollar<br/>
2<br/>
<hr/>
<a name=27></a>Making&#160;Your First&#160;Keystrokes<br/>
sign,&#160;the&#160;terminal&#160;session&#160;has&#160;&#160;<i>superuser</i>&#160;&#160;privileges.&#160;This&#160;means&#160;either&#160;we&#160;are<br/>logged&#160;in&#160;as&#160;the&#160;root&#160;user&#160;or&#160;we&#160;selected&#160;a&#160;terminal&#160;emulator&#160;that&#160;provides&#160;supe-<br/>ruser (administrative)&#160;privileges.<br/>
Assuming&#160;things&#160;are&#160;good&#160;so&#160;far,&#160;let's&#160;try&#160;some&#160;typing.&#160;&#160;Enter&#160;&#160;some&#160;&#160;gibberish&#160;&#160;at&#160;the<br/>prompt&#160;like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>kaekfjaeifj</b><br/>
Because&#160;this&#160;command&#160;makes&#160;no sense, the&#160;shell&#160;tells&#160;us&#160;so and give&#160;us&#160;another chance.<br/>
bash:&#160;kaekfjaeifj: command not found<br/>[me@linuxbox ~]$<br/>
Command&#160;History<br/>If&#160;we&#160;press&#160;the&#160;up-arrow&#160;key,&#160;we&#160;will&#160;see&#160;that&#160;the&#160;previous&#160;command&#160;&#160;kaekfjaeifj<br/>reappears&#160;after&#160;the&#160;prompt.&#160;This&#160;is&#160;called&#160;<i>command&#160;history</i>.&#160;Most&#160;Linux&#160;distributions&#160;re-<br/>member&#160;the&#160;last&#160;1000&#160;commands&#160;by&#160;default.&#160;Press&#160;the&#160;down-arrow&#160;key&#160;and&#160;the&#160;previous<br/>command&#160;disappears.<br/>
Cursor&#160;Movement<br/>Recall&#160;the&#160;previous&#160;command&#160;by&#160;pressing&#160;the&#160;up-arrow&#160;key&#160;again.&#160;If&#160;we&#160;try&#160;the&#160;left&#160;and<br/>right-arrow&#160;keys,&#160;we'll&#160;see&#160;how&#160;we&#160;can&#160;position&#160;the&#160;cursor&#160;anywhere&#160;on&#160;the&#160;command<br/>line.&#160;This&#160;makes&#160;editing&#160;commands&#160;easy.<br/>
<b>A&#160;Few&#160;Words&#160;About&#160;Mice&#160;and&#160;Focus</b><br/>
While&#160;the&#160;shell&#160;is&#160;all&#160;about&#160;the&#160;keyboard,&#160;you&#160;can&#160;also&#160;use&#160;a&#160;mouse&#160;with&#160;your&#160;ter-<br/>minal&#160;emulator.&#160;A&#160;mechanism&#160;built&#160;into&#160;the&#160;&#160;X&#160;Window&#160;System&#160;&#160;(the&#160;underlying<br/>engine&#160;that&#160;makes&#160;the&#160;GUI&#160;go)&#160;supports&#160;a&#160;quick&#160;copy&#160;and&#160;paste&#160;technique.&#160;If&#160;you<br/>highlight&#160;some&#160;text&#160;by&#160;holding&#160;down&#160;the&#160;left&#160;mouse&#160;button&#160;and&#160;dragging&#160;the<br/>mouse&#160;over&#160;it&#160;(or&#160;double&#160;clicking&#160;on&#160;a&#160;word),&#160;it&#160;is&#160;copied&#160;into&#160;a&#160;buffer&#160;maintained<br/>by X. Pressing&#160;the&#160;middle&#160;mouse&#160;button&#160;will&#160;cause&#160;the&#160;text&#160;to&#160;be&#160;pasted&#160;at&#160;the&#160;cur-<br/>sor location.&#160;Try it.<br/>
3<br/>
<hr/>
<a name=28></a>1 –&#160;What&#160;Is&#160;the&#160;Shell?<br/>
<b>Note</b>:&#160;Don't&#160;be&#160;tempted&#160;to&#160;use&#160;Ctrl-c&#160;and&#160;Ctrl-v&#160;to&#160;perform&#160;copy&#160;and&#160;paste<br/>inside&#160;a&#160;terminal&#160;window.&#160;They&#160;don't&#160;work.&#160;These&#160;control&#160;codes&#160;have&#160;different<br/>meanings&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;shell&#160;&#160;&#160;and&#160;&#160;&#160;were&#160;&#160;&#160;assigned&#160;&#160;&#160;many&#160;&#160;&#160;years&#160;&#160;&#160;before&#160;&#160;&#160;the&#160;&#160;&#160;release&#160;&#160;&#160;of<br/>Microsoft&#160;Windows.<br/>Your&#160;graphical&#160;desktop&#160;environment&#160;(most&#160;likely&#160;KDE&#160;or&#160;GNOME),&#160;in&#160;an&#160;effort<br/>to&#160;behave&#160;like&#160;Windows,&#160;probably&#160;has&#160;its&#160;<i>focus&#160;policy</i>&#160;set&#160;to&#160;“click&#160;to&#160;focus.”&#160;This<br/>means&#160;for&#160;a&#160;window&#160;to&#160;get&#160;focus&#160;(become&#160;active)&#160;you&#160;need&#160;to&#160;click&#160;on&#160;it.&#160;This&#160;is<br/>contrary&#160;to&#160;the&#160;traditional&#160;X&#160;behavior&#160;of&#160;“focus&#160;follows&#160;mouse”&#160;which&#160;means&#160;that<br/>a&#160;window&#160;gets&#160;focus&#160;just&#160;by&#160;passing&#160;the&#160;mouse&#160;over&#160;it.&#160;The&#160;window&#160;will&#160;not&#160;come<br/>to&#160;the&#160;foreground&#160;until&#160;you&#160;click&#160;on&#160;it&#160;but&#160;it&#160;will&#160;be&#160;able&#160;to&#160;receive&#160;input.&#160;Setting<br/>the&#160;focus&#160;policy&#160;to&#160;“focus&#160;follows&#160;mouse”&#160;will&#160;make&#160;the&#160;copy&#160;and&#160;paste&#160;technique<br/>even&#160;more&#160;useful.&#160;Give&#160;it&#160;a&#160;try&#160;if&#160;you&#160;can&#160;(some&#160;desktop&#160;environments&#160;such&#160;as<br/>Ubuntu's&#160;Unity&#160;no&#160;longer&#160;support&#160;it).&#160;I&#160;think&#160;if&#160;you&#160;give&#160;it&#160;a&#160;chance&#160;you&#160;will&#160;pre-<br/>fer&#160;it.&#160;You&#160;will&#160;find&#160;this&#160;setting&#160;in&#160;the&#160;configuration&#160;program&#160;for&#160;your&#160;window<br/>manager.<br/>
<b>Try&#160;Some&#160;Simple&#160;Commands<br/></b>Now&#160;that&#160;we&#160;have&#160;learned&#160;to&#160;enter&#160;text&#160;in&#160;our&#160;terminal&#160;emulator,&#160;let's&#160;try&#160;a&#160;few&#160;simple<br/>commands.&#160;Let's&#160;begin&#160;with&#160;the&#160;&#160;date&#160;&#160;command,&#160;which&#160;displays&#160;the&#160;current&#160;time&#160;and<br/>date.<br/>
[me@linuxbox ~]$&#160;<b>date<br/></b>Thu Mar &#160;8 15:09:41 EST 2018<br/>
A&#160;related command is&#160;cal&#160;which,&#160;by default,&#160;displays&#160;a&#160;calendar&#160;of the&#160;current&#160;month.<br/>
[me@linuxbox ~]$&#160;<b>cal<br/></b>&#160; &#160; &#160;March 2018 &#160; &#160; &#160;&#160;<br/>Su Mo Tu We Th Fr Sa &#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160;1 &#160;2 &#160;3 &#160;<br/>&#160;4 &#160;5 &#160;6 &#160;7 &#160;8 &#160;9 10 &#160;<br/>11 12 13 14 15 16 17 &#160;<br/>18 19 20 21 22 23 24 &#160;<br/>25 26 27 28 29 30 31<br/>
To see&#160;the&#160;current&#160;amount&#160;of free&#160;space&#160;on our disk drives, enter&#160;df.<br/>
4<br/>
<hr/>
<a name=29></a>Try Some&#160;Simple&#160;Commands<br/>
[me@linuxbox ~]$&#160;<b>df<br/></b>Filesystem &#160; &#160; &#160; &#160; &#160; 1K-blocks &#160; &#160; &#160;Used Available Use% Mounted on<br/>/dev/sda2 &#160; &#160; &#160; &#160; &#160; &#160; 15115452 &#160; 5012392 &#160; 9949716 &#160;34% /<br/>/dev/sda5 &#160; &#160; &#160; &#160; &#160; &#160; 59631908 &#160;26545424 &#160;30008432 &#160;47% /home<br/>/dev/sda1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; 147764 &#160; &#160; 17370 &#160; &#160;122765 &#160;13% /boot<br/>tmpfs &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 256856 &#160; &#160; &#160; &#160; 0 &#160; &#160;256856 &#160; 0% /dev/shm<br/>
Likewise,&#160;to display&#160;the&#160;amount&#160;of free&#160;memory,&#160;enter&#160;the&#160;free&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>free<br/></b>&#160; &#160; &#160; &#160; &#160;total &#160; &#160; &#160; used &#160; &#160; &#160; free &#160; &#160; shared &#160; &#160;buffers &#160; &#160; cached<br/>Mem: &#160; &#160;513712 &#160; &#160; 503976 &#160; &#160; &#160; 9736 &#160; &#160; &#160; &#160; &#160;0 &#160; &#160; &#160; 5312 &#160; &#160; 122916<br/>-/+ buffers/cache: 375748 &#160; &#160; 137964<br/>Swap: &#160;1052248 &#160; &#160; 104712 &#160; &#160; 947536<br/>
<b>Ending&#160;a&#160;Terminal&#160;Session<br/></b>We&#160;can&#160;end&#160;a&#160;terminal&#160;session&#160;by&#160;either&#160;closing&#160;the&#160;terminal&#160;emulator&#160;window,&#160;by&#160;enter-<br/>ing the&#160;exit&#160;command&#160;at&#160;the&#160;shell&#160;prompt, or pressing&#160;Ctrl-d.<br/>
[me@linuxbox ~]$&#160;<b>exit</b><br/>
<b>The&#160;Console&#160;Behind&#160;the&#160;Curtain</b><br/>
Even&#160;if&#160;we&#160;have&#160;no&#160;terminal&#160;emulator&#160;running,&#160;several&#160;terminal&#160;sessions&#160;continue<br/>to&#160;run&#160;behind&#160;the&#160;graphical&#160;desktop.,&#160;We&#160;can&#160;access&#160;these&#160;sessions,&#160;called&#160;<i>virtual<br/>terminals</i>&#160;or&#160;<i>virtual&#160;consoles</i>,&#160;by&#160;pressing&#160;Ctrl-Alt-F1&#160;through&#160;Ctrl-Alt-<br/>F6&#160;on&#160;most&#160;Linux&#160;distributions.&#160;When&#160;a&#160;session&#160;is&#160;accessed,&#160;it&#160;presents&#160;a&#160;&#160;login<br/>prompt&#160;into&#160;which&#160;we&#160;can&#160;enter&#160;our&#160;username&#160;and&#160;password.&#160;To&#160;switch&#160;from&#160;one<br/>virtual&#160;console&#160;to&#160;another,&#160;press&#160;Alt-F1&#160;through&#160;Alt-F6.&#160;On&#160;most&#160;system&#160;we<br/>can return&#160;to the&#160;graphical&#160;desktop by pressing&#160;Alt-F7.<br/>
<b>Summing&#160;Up<br/></b>This&#160;chapter&#160;marks&#160;the&#160;beginning&#160;of&#160;our&#160;journey&#160;into&#160;the&#160;Linux&#160;command&#160;line&#160;with&#160;an&#160;in-<br/>troduction&#160;to&#160;the&#160;shell&#160;and&#160;a&#160;brief&#160;glimpse&#160;at&#160;the&#160;command&#160;line&#160;and&#160;a&#160;lesson&#160;on&#160;how&#160;to<br/>
5<br/>
<hr/>
<a name=30></a>1 –&#160;What&#160;Is&#160;the&#160;Shell?<br/>
start&#160;and&#160;end&#160;a&#160;terminal&#160;session.&#160;We&#160;also&#160;saw&#160;how&#160;to&#160;issue&#160;some&#160;simple&#160;commands&#160;and<br/>perform&#160;a&#160;little&#160;light&#160;command&#160;line&#160;editing.&#160;That&#160;wasn't&#160;so scary was&#160;it?<br/>In&#160;the&#160;next&#160;chapter,&#160;we'll&#160;learn&#160;a&#160;few&#160;more&#160;commands&#160;and&#160;wander&#160;around&#160;the&#160;Linux&#160;file<br/>system.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
To&#160;learn&#160;more&#160;about&#160;Steve&#160;Bourne,&#160;father&#160;of&#160;the&#160;Bourne&#160;Shell,&#160;see&#160;this&#160;Wikipedia<br/>article:<br/><a href="http://en.wikipedia.org/wiki/Steve_Bourne">http://en.wikipedia.org/wiki/Steve_Bourne</a><br/>
●<br/>
This&#160;Wikipedia&#160;article&#160;is&#160;about&#160;Brian&#160;Fox, the&#160;original&#160;author&#160;of&#160;bash:<br/><a href="https://en.wikipedia.org/wiki/Brian_Fox_(computer_programmer)">https://en.wikipedia.org/wiki/Brian_Fox_(computer_programmer)</a><br/>
●<br/>
Here&#160;is&#160;an article&#160;about&#160;the&#160;concept&#160;of shells&#160;in&#160;computing:<br/><a href="http://en.wikipedia.org/wiki/Shell_(computing)">http://en.wikipedia.org/wiki/Shell_(computing)</a><br/>
6<br/>
<hr/>
<a name=31></a>2 – Navigation<br/>
<i><b>2&#160;–&#160;Navigation</b></i><br/>
The&#160;first&#160;thing&#160;we&#160;need&#160;to&#160;learn&#160;(besides&#160;how&#160;to&#160;type)&#160;is&#160;how&#160;to&#160;navigate&#160;the&#160;file&#160;system<br/>on our Linux system.&#160;In this&#160;chapter we&#160;will&#160;introduce&#160;the&#160;following commands:<br/>
●<br/>
pwd&#160;– Print&#160;name&#160;of current&#160;working directory<br/>
●<br/>
cd&#160;– Change&#160;directory<br/>
●<br/>
ls&#160;– List&#160;directory&#160;contents<br/>
<b>Understanding&#160;the&#160;File&#160;System&#160;Tree<br/></b>Like&#160;Windows,&#160;a&#160;Unix-like&#160;operating&#160;system&#160;such&#160;as&#160;Linux&#160;organizes&#160;its&#160;files&#160;in&#160;what&#160;is<br/>called&#160;a&#160;<i>hierarchical&#160;directory&#160;structure</i>.&#160;This&#160;means&#160;they&#160;are&#160;organized&#160;in&#160;a&#160;tree-like&#160;pat-<br/>tern&#160;of&#160;<i>directories</i>&#160;(sometimes&#160;called&#160;folders&#160;in&#160;other&#160;systems),&#160;which&#160;may&#160;contain&#160;files<br/>and&#160;other&#160;directories.&#160;The&#160;first&#160;directory&#160;in&#160;the&#160;file&#160;system&#160;is&#160;called&#160;the&#160;<i>root&#160;directory</i>.&#160;The<br/>root&#160;directory&#160;contains&#160;files&#160;and&#160;subdirectories,&#160;which&#160;contain&#160;more&#160;files&#160;and&#160;subdirecto-<br/>ries&#160;and so on.<br/>Note&#160;that&#160;unlike&#160;Windows,&#160;which&#160;has&#160;a&#160;separate&#160;file&#160;system&#160;tree&#160;for&#160;each&#160;storage&#160;device,<br/>Unix-like&#160;systems&#160;such&#160;as&#160;Linux&#160;always&#160;have&#160;a&#160;single&#160;file&#160;system&#160;tree,&#160;regardless&#160;of&#160;how<br/>many&#160;drives&#160;or&#160;storage&#160;devices&#160;are&#160;attached&#160;to&#160;the&#160;computer.&#160;Storage&#160;devices&#160;are&#160;attached<br/>(or&#160;more&#160;correctly,&#160;<i>mounted</i>)&#160;at&#160;various&#160;points&#160;on&#160;the&#160;tree&#160;according&#160;to&#160;the&#160;whims&#160;of&#160;the<br/><i>system&#160;administrator</i>,&#160;the&#160;person&#160;(or&#160;people)&#160;responsible&#160;for&#160;the&#160;maintenance&#160;of&#160;the&#160;sys-<br/>tem.<br/>
<b>The&#160;Current&#160;Working&#160;Directory<br/></b>Most&#160;of us&#160;are&#160;probably familiar with a&#160;graphical&#160;file&#160;manager which represents&#160;the&#160;file&#160;<br/>system&#160;tree&#160;as&#160;in Figure&#160;1. Notice&#160;that&#160;the&#160;tree&#160;is&#160;usually shown upended, that&#160;is, with the&#160;<br/>root&#160;at&#160;the&#160;top&#160;and the&#160;various&#160;branches&#160;descending&#160;below.<br/>However,&#160;the&#160;command&#160;line&#160;has&#160;no pictures, so to navigate&#160;the&#160;file&#160;system&#160;tree&#160;we&#160;need&#160;<br/>to think&#160;of it&#160;in&#160;a&#160;different&#160;way.<br/>
7<br/>
<hr/>
<a name=32></a><img src="linux-command-line-32_1.png"/><br/>
2 – Navigation<br/>
Imagine&#160;that&#160;the&#160;file&#160;system&#160;is&#160;a&#160;maze&#160;shaped&#160;like&#160;an&#160;upside-down&#160;tree&#160;and&#160;we&#160;are&#160;able&#160;to<br/>
<i>Figure&#160;1: File&#160;system&#160;tree&#160;as&#160;shown by&#160;a&#160;<br/>graphical&#160;file&#160;manager</i><br/>
stand&#160;in&#160;the&#160;middle&#160;of&#160;it.&#160;At&#160;any&#160;given&#160;time,&#160;we&#160;are&#160;inside&#160;a&#160;single&#160;directory&#160;and&#160;we&#160;can<br/>see&#160;the&#160;files&#160;contained&#160;in&#160;the&#160;directory&#160;and&#160;the&#160;pathway&#160;to&#160;the&#160;directory&#160;above&#160;us&#160;(called<br/>the&#160;<i>parent&#160;directory</i>)&#160;and&#160;any&#160;subdirectories&#160;below&#160;us.&#160;The&#160;directory&#160;we&#160;are&#160;standing&#160;in&#160;is<br/>called&#160;the&#160;<i>current&#160;working&#160;directory</i>.&#160;To&#160;display&#160;the&#160;current&#160;working&#160;directory,&#160;we&#160;use&#160;the<br/>pwd&#160;(print&#160;working directory)&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>pwd<br/></b>/home/me<br/>
When&#160;we&#160;first&#160;log&#160;in&#160;to&#160;our&#160;system&#160;(or&#160;start&#160;a&#160;terminal&#160;emulator&#160;session)&#160;our&#160;current<br/>working&#160;directory&#160;is&#160;set&#160;to&#160;our&#160;<i>home&#160;directory</i>.&#160;Each&#160;user&#160;account&#160;is&#160;given&#160;its&#160;own&#160;home<br/>directory&#160;and it&#160;is&#160;the&#160;only&#160;place&#160;a&#160;regular&#160;user is&#160;allowed&#160;to write&#160;files.<br/>
<b>Listing&#160;the&#160;Contents&#160;of&#160;a&#160;Directory<br/></b>To list&#160;the&#160;files&#160;and directories&#160;in&#160;the&#160;current&#160;working directory, we&#160;use&#160;the&#160;ls&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>ls</b><br/>
8<br/>
<hr/>
<a name=33></a>Listing&#160;the&#160;Contents&#160;of a&#160;Directory<br/>
Desktop &#160;Documents &#160;Music &#160;Pictures &#160;Public &#160;Templates &#160;Videos<br/>
Actually,&#160;we&#160;can&#160;use&#160;the&#160;ls&#160;command&#160;to&#160;list&#160;the&#160;contents&#160;of&#160;any&#160;directory,&#160;not&#160;just&#160;the<br/>current&#160;working&#160;directory,&#160;and&#160;there&#160;are&#160;many&#160;other&#160;fun&#160;things&#160;it&#160;can&#160;do&#160;as&#160;well.&#160;We'll<br/>spend&#160;more&#160;time&#160;with&#160;ls&#160;in the&#160;next&#160;chapter.<br/>
<b>Changing&#160;the&#160;Current&#160;Working&#160;Directory<br/></b>To&#160;change&#160;our&#160;working&#160;directory&#160;(where&#160;we&#160;are&#160;standing&#160;in&#160;our&#160;tree-shaped&#160;maze)&#160;we&#160;use<br/>the&#160;cd&#160;command.&#160;To&#160;do&#160;this,&#160;type&#160;cd&#160;followed&#160;by&#160;the&#160;<i>pathname</i>&#160;of&#160;the&#160;desired&#160;working<br/>directory.&#160;A&#160;pathname&#160;is&#160;the&#160;route&#160;we&#160;take&#160;along&#160;the&#160;branches&#160;of&#160;the&#160;tree&#160;to&#160;get&#160;to&#160;the&#160;di-<br/>rectory&#160;we&#160;want.&#160;We&#160;can&#160;specify&#160;pathnames&#160;in&#160;one&#160;of&#160;two&#160;different&#160;ways;&#160;as&#160;&#160;<i>absolute<br/>pathnames</i>&#160;or as&#160;<i>relative&#160;pathnames</i>. Let's&#160;deal&#160;with absolute&#160;pathnames&#160;first.<br/>
Absolute&#160;Pathnames<br/>An&#160;&#160;absolute&#160;&#160;pathname&#160;begins&#160;with&#160;the&#160;root&#160;directory&#160;and&#160;follows&#160;the&#160;tree&#160;branch&#160;by<br/>branch&#160;until&#160;the&#160;path&#160;to&#160;the&#160;desired&#160;directory&#160;or&#160;file&#160;is&#160;completed.&#160;For&#160;example,&#160;there&#160;is&#160;a<br/>directory&#160;on&#160;our&#160;system&#160;in&#160;which&#160;most&#160;of&#160;our&#160;system's&#160;programs&#160;are&#160;installed.&#160;The&#160;direc-<br/>tory’s&#160;pathname&#160;is&#160;/usr/bin.&#160;This&#160;means&#160;from&#160;the&#160;root&#160;directory&#160;(represented&#160;by&#160;the<br/>leading&#160;slash&#160;in&#160;the&#160;pathname)&#160;there&#160;is&#160;a&#160;directory&#160;called&#160;&#34;usr&#34;&#160;which&#160;contains&#160;a&#160;directory<br/>called &#34;bin&#34;.<br/>
[me@linuxbox ~]$&#160;<b>cd /usr/bin<br/></b>[me@linuxbox bin]$&#160;<b>pwd<br/></b>/usr/bin<br/>[me@linuxbox bin]$&#160;<b>ls<br/></b>...Listing of many, many files ...<br/>
Now&#160;we&#160;can&#160;see&#160;that&#160;we&#160;have&#160;changed&#160;the&#160;current&#160;working&#160;directory&#160;to&#160;/usr/bin&#160;and<br/>that&#160;it&#160;is&#160;full&#160;of&#160;files.&#160;Notice&#160;how&#160;the&#160;shell&#160;prompt&#160;has&#160;changed?&#160;As&#160;a&#160;convenience,&#160;it&#160;is<br/>usually set&#160;up to automatically&#160;display&#160;the&#160;name&#160;of the&#160;working&#160;directory.<br/>
Relative&#160;Pathnames<br/>Where&#160;an&#160;absolute&#160;pathname&#160;starts&#160;from&#160;the&#160;root&#160;directory&#160;and&#160;leads&#160;to&#160;its&#160;destination,&#160;a<br/>relative&#160;pathname&#160;starts&#160;from&#160;the&#160;working&#160;directory.&#160;To&#160;do&#160;this,&#160;it&#160;uses&#160;a&#160;couple&#160;of&#160;special<br/>notations&#160;to&#160;represent&#160;relative&#160;positions&#160;in&#160;the&#160;file&#160;system&#160;tree.&#160;These&#160;special&#160;notations&#160;are<br/>&#34;.&#34; (dot) and &#34;..&#34; (dot&#160;dot).<br/>The&#160;&#34;.&#34;&#160;notation&#160;refers&#160;to&#160;the&#160;working&#160;directory&#160;and&#160;the&#160;&#34;..&#34;&#160;notation&#160;refers&#160;to&#160;the&#160;working<br/>
9<br/>
<hr/>
<a name=34></a>2 – Navigation<br/>
directory's&#160;parent&#160;directory.&#160;Here&#160;is&#160;how&#160;it&#160;works.&#160;Let's&#160;change&#160;the&#160;working&#160;directory&#160;to&#160;/<br/>usr/bin&#160;again.<br/>
[me@linuxbox ~]$&#160;<b>cd /usr/bin<br/></b>[me@linuxbox bin]$&#160;<b>pwd<br/></b>/usr/bin<br/>
Now&#160;let's&#160;say&#160;that&#160;we&#160;wanted&#160;to&#160;change&#160;the&#160;working&#160;directory&#160;to&#160;the&#160;parent&#160;of&#160;&#160;/usr/<br/>bin&#160;which&#160;is&#160;/usr.&#160;We&#160;could&#160;do&#160;that&#160;two&#160;different&#160;ways,&#160;either&#160;using&#160;an&#160;absolute&#160;path-<br/>name.<br/>
[me@linuxbox bin]$&#160;<b>cd /usr<br/></b>[me@linuxbox usr]$&#160;<b>pwd<br/></b>/usr<br/>
or, using a&#160;relative&#160;pathname.<br/>
[me@linuxbox bin]$&#160;<b>cd ..<br/></b>[me@linuxbox usr]$&#160;<b>pwd<br/></b>/usr<br/>
Two different&#160;methods&#160;with identical&#160;results.&#160;Which one&#160;should&#160;we&#160;use?&#160;The&#160;one&#160;that&#160;<br/>requires&#160;the&#160;least&#160;typing!<br/>Likewise,&#160;we&#160;can change&#160;the&#160;working directory&#160;from&#160;/usr&#160;to&#160;/usr/bin&#160;in&#160;two&#160;<br/>different&#160;ways, either&#160;using&#160;an absolute&#160;pathname:<br/>
[me@linuxbox usr]$&#160;<b>cd /usr/bin<br/></b>[me@linuxbox bin]$&#160;<b>pwd<br/></b>/usr/bin<br/>
or, using a&#160;relative&#160;pathname.<br/>
[me@linuxbox usr]$&#160;<b>cd ./bin<br/></b>[me@linuxbox bin]$&#160;<b>pwd<br/></b>/usr/bin<br/>
10<br/>
<hr/>
<a name=35></a>Changing the&#160;Current&#160;Working Directory<br/>
Now,&#160;there&#160;is&#160;something&#160;important&#160;to&#160;point&#160;out&#160;here.&#160;In&#160;almost&#160;all&#160;cases,&#160;we&#160;can&#160;omit&#160;the<br/>&#34;./&#34;. It&#160;is&#160;implied.&#160;Typing:<br/>
[me@linuxbox usr]$&#160;<b>cd bin</b><br/>
does&#160;the&#160;same&#160;thing.&#160;In&#160;general,&#160;if&#160;we&#160;do&#160;not&#160;specify&#160;a&#160;pathname&#160;to&#160;something,&#160;the&#160;work-<br/>ing directory will&#160;be&#160;assumed.<br/>
Some&#160;Helpful&#160;Shortcuts<br/>In&#160;Table&#160;2-1&#160;we&#160;see&#160;some&#160;useful&#160;ways&#160;the&#160;current&#160;working&#160;directory&#160;can&#160;be&#160;quickly<br/>changed.<br/>
<i>Table&#160;2-1:&#160;cd&#160;Shortcuts</i><br/>
<b>Shortcut</b><br/>
<b>Result</b><br/>
cd<br/>
Changes&#160;the&#160;working directory to&#160;your home&#160;directory.<br/>
cd -<br/>
Changes&#160;the&#160;working directory to&#160;the&#160;previous&#160;working directory.<br/>
cd ~<i>user_name&#160;</i>Changes&#160;the&#160;working directory to&#160;the&#160;home&#160;directory&#160;of&#160;<br/>
<i>user_name</i>. For example,&#160;cd ~bob&#160;will&#160;change&#160;the&#160;directory&#160;to&#160;<br/>the&#160;home&#160;directory&#160;of user&#160;“bob.”<br/>
<b>Important&#160;Facts&#160;About&#160;Filenames</b><br/>
On&#160;Linux&#160;systems,&#160;files&#160;are&#160;named&#160;in&#160;a&#160;manner&#160;similar&#160;to&#160;other&#160;systems&#160;such&#160;as<br/>Windows, but&#160;there&#160;are&#160;some&#160;important&#160;differences.<br/>1.&#160;Filenames&#160;that&#160;begin&#160;with&#160;a&#160;period&#160;character&#160;are&#160;hidden.&#160;This&#160;only&#160;means&#160;that<br/>
ls&#160;will&#160;not&#160;list&#160;them&#160;unless&#160;you&#160;say&#160;ls&#160;-a.&#160;When&#160;your&#160;account&#160;was&#160;created,<br/>several&#160;&#160;hidden&#160;files&#160;&#160;were&#160;placed&#160;in&#160;your&#160;home&#160;directory&#160;to&#160;configure&#160;things<br/>for&#160;your&#160;account.&#160;In&#160;Chapter&#160;11&#160;we&#160;will&#160;take&#160;a&#160;closer&#160;look&#160;at&#160;some&#160;of&#160;these<br/>files&#160;to&#160;see&#160;how&#160;you can&#160;customize&#160;your environment.&#160;In&#160;addition,&#160;some&#160;appli-<br/>cations&#160;place&#160;their&#160;configuration&#160;and&#160;settings&#160;files&#160;in&#160;your&#160;home&#160;directory&#160;as<br/>hidden files.<br/>
11<br/>
<hr/>
<a name=36></a>2 – Navigation<br/>
2.&#160;Filenames&#160;and&#160;commands&#160;in&#160;Linux,&#160;like&#160;Unix,&#160;are&#160;&#160;case&#160;sensitive.&#160;The&#160;file-<br/>
names&#160;“File1”&#160;and&#160;“file1”&#160;refer&#160;to different&#160;files.<br/>
3.&#160;Linux&#160;has&#160;no&#160;concept&#160;of&#160;a&#160;“file&#160;extension”&#160;like&#160;some&#160;other&#160;operating&#160;systems.<br/>
You&#160;may&#160;name&#160;files&#160;any&#160;way&#160;you&#160;like.&#160;The&#160;contents&#160;and/or&#160;purpose&#160;of&#160;a&#160;file&#160;is<br/>determined&#160;by&#160;other&#160;means.&#160;Although&#160;Unix-like&#160;operating&#160;systems&#160;don’t&#160;use<br/>file&#160;&#160;extensions&#160;&#160;to&#160;determine&#160;the&#160;contents/purpose&#160;of&#160;files,&#160;many&#160;application<br/>programs&#160;do.<br/>
4.&#160;Though&#160;Linux&#160;supports&#160;long&#160;filenames&#160;that&#160;may&#160;contain&#160;embedded&#160;spaces&#160;and<br/>
punctuation&#160;characters,&#160;limit&#160;the&#160;punctuation&#160;characters&#160;in&#160;the&#160;names&#160;of&#160;files<br/>you&#160;create&#160;to&#160;period,&#160;dash,&#160;and&#160;underscore.&#160;&#160;<i>Most&#160;importantly,&#160;do&#160;not&#160;embed<br/>spaces&#160;in&#160;filenames.</i>&#160;If&#160;you&#160;want&#160;to&#160;represent&#160;spaces&#160;between&#160;words&#160;in&#160;a&#160;file-<br/>name,&#160;use&#160;underscore&#160;characters.&#160;You will&#160;thank&#160;yourself&#160;later.<br/>
<b>Summing&#160;Up<br/></b>This&#160;chapter&#160;explained&#160;how&#160;the&#160;shell&#160;treats&#160;the&#160;directory&#160;structure&#160;of&#160;the&#160;system.&#160;We<br/>learned&#160;about&#160;absolute&#160;and&#160;relative&#160;pathnames&#160;and&#160;the&#160;basic&#160;commands&#160;that&#160;we&#160;use&#160;to<br/>move&#160;about&#160;that&#160;structure.&#160;In&#160;the&#160;next&#160;chapter&#160;we&#160;will&#160;use&#160;this&#160;knowledge&#160;to&#160;go&#160;on&#160;a&#160;tour<br/>of a&#160;modern&#160;Linux system.<br/>
12<br/>
<hr/>
<a name=37></a>3 – Exploring the&#160;System<br/>
<i><b>3&#160;–&#160;Exploring&#160;the&#160;System</b></i><br/>
Now&#160;that&#160;we&#160;know&#160;how&#160;to&#160;move&#160;around&#160;the&#160;file&#160;system,&#160;it's&#160;time&#160;for&#160;a&#160;guided&#160;tour&#160;of&#160;our<br/>Linux&#160;system.&#160;Before&#160;we&#160;start&#160;however,&#160;we’re&#160;going&#160;to&#160;learn&#160;some&#160;more&#160;commands&#160;that<br/>will&#160;be&#160;useful&#160;along&#160;the&#160;way.<br/>
●<br/>
ls&#160;– List&#160;directory&#160;contents<br/>
●<br/>
file&#160;– Determine&#160;file&#160;type<br/>
●<br/>
less&#160;–&#160;View&#160;file&#160;contents<br/>
<b>Having&#160;More&#160;Fun&#160;with&#160;ls<br/></b>The&#160;ls&#160;command&#160;is&#160;probably&#160;the&#160;most&#160;used&#160;command,&#160;and&#160;for&#160;good&#160;reason.&#160;With&#160;it,&#160;we<br/>can&#160;see&#160;directory&#160;contents&#160;and&#160;determine&#160;a&#160;variety&#160;of&#160;important&#160;file&#160;and&#160;directory&#160;at-<br/>tributes.&#160;As&#160;we&#160;have&#160;seen,&#160;we&#160;can&#160;simply&#160;enter&#160;ls&#160;to&#160;get&#160;a&#160;list&#160;of&#160;files&#160;and&#160;subdirectories<br/>contained in&#160;the&#160;current&#160;working directory.<br/>
[me@linuxbox ~]$&#160;<b>ls<br/></b>Desktop &#160;Documents &#160;Music &#160;Pictures &#160;Public &#160;Templates &#160;Videos<br/>
Besides&#160;the&#160;current&#160;working directory,&#160;we&#160;can specify&#160;the&#160;directory to&#160;list, like&#160;so:<br/>
me@linuxbox ~]$&#160;<b>ls /usr<br/></b>bin &#160;games &#160;include&#160; lib &#160;local &#160;sbin &#160;share &#160;src<br/>
We&#160;can even&#160;specify multiple&#160;directories.&#160;In the&#160;following&#160;example, we&#160;list&#160;both the&#160;user's<br/>home&#160;directory&#160;(symbolized&#160;by the&#160;“~”&#160;character) and&#160;the&#160;/usr&#160;directory.<br/>
[me@linuxbox ~]$&#160;<b>ls ~ /usr<br/></b>/home/me:<br/>Desktop &#160;Documents &#160;Music &#160;Pictures &#160;Public &#160;Templates &#160;Videos<br/>
13<br/>
<hr/>
<a name=38></a>3 – Exploring&#160;the&#160;System<br/>
/usr:<br/>bin &#160;games &#160;include &#160;lib &#160;local &#160;sbin &#160;share &#160;src<br/>
We&#160;can also change&#160;the&#160;format&#160;of the&#160;output&#160;to reveal&#160;more&#160;detail.<br/>
[me@linuxbox ~]$&#160;<b>ls -l<br/></b>total 56<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Desktop<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Documents<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Music<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Pictures<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Public<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Templates<br/>drwxrwxr-x 2 me me 4096 2017-10-26 17:20 Videos<br/>
By adding “-l”&#160;to&#160;the&#160;command, we&#160;changed&#160;the&#160;output&#160;to&#160;the&#160;long format.<br/>
Options&#160;and&#160;Arguments<br/>This&#160;brings&#160;us&#160;to&#160;a&#160;very&#160;important&#160;point&#160;about&#160;how&#160;most&#160;commands&#160;work. Commands&#160;are<br/>often&#160;followed&#160;by&#160;one&#160;or&#160;more&#160;<i>options</i>&#160;that&#160;modify&#160;their&#160;behavior,&#160;and&#160;further,&#160;by&#160;one&#160;or<br/>more&#160;<i>arguments</i>,&#160;the&#160;items&#160;upon&#160;which&#160;the&#160;command&#160;acts.&#160;So&#160;most&#160;commands&#160;look&#160;kind<br/>of like&#160;this:<br/>
<b>command -options arguments</b><br/>
Most&#160;commands&#160;use&#160;options&#160;which&#160;consist&#160;of&#160;a&#160;single&#160;character&#160;preceded&#160;by&#160;a&#160;dash,&#160;for<br/>example,&#160;“-l”.&#160;Many&#160;commands,&#160;however,&#160;including&#160;those&#160;from&#160;the&#160;&#160;GNU&#160;Project,&#160;also<br/>support&#160;&#160;<i>long&#160;options</i>,&#160;consisting&#160;of&#160;a&#160;word&#160;preceded&#160;by&#160;two&#160;dashes.&#160;Also,&#160;many&#160;com-<br/>mands&#160;allow&#160;multiple&#160;short&#160;options&#160;to&#160;be&#160;strung&#160;together.&#160;In&#160;the&#160;following&#160;example,&#160;the<br/>ls&#160;command&#160;is&#160;given&#160;two&#160;options,&#160;which&#160;are&#160;the&#160;l&#160;option&#160;to&#160;produce&#160;long&#160;format&#160;output,<br/>and the&#160;t&#160;option to&#160;sort&#160;the&#160;result&#160;by the&#160;file's&#160;modification&#160;time.<br/>
[me@linuxbox ~]$&#160;<b>ls -lt</b><br/>
We'll&#160;add the&#160;long option&#160;“--reverse”&#160;to reverse&#160;the&#160;order of the&#160;sort.<br/>
14<br/>
<hr/>
<a name=39></a>Having More&#160;Fun with ls<br/>
[me@linuxbox ~]$&#160;<b>ls -lt --reverse</b><br/>
Note&#160;that&#160;command&#160;options, like&#160;filenames&#160;in&#160;Linux, are&#160;case-sensitive.<br/>
The&#160;ls&#160;command&#160;has&#160;a&#160;large&#160;number&#160;of&#160;possible&#160;options.&#160;The&#160;most&#160;common&#160;are&#160;listed&#160;in<br/>Table&#160;3-1.<br/>
<i>Table&#160;3-&#160;1: Common&#160;ls&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-a<br/>
--all<br/>
List&#160;all&#160;files, even those&#160;with names&#160;that&#160;begin<br/>with a&#160;period,&#160;which are&#160;normally&#160;not&#160;listed&#160;<br/>(that&#160;is, hidden).<br/>
-A<br/>
--almost-all<br/>
Like&#160;the&#160;-a&#160;option&#160;above&#160;except&#160;it&#160;does&#160;not&#160;<br/>list&#160;&#160;.&#160;(current&#160;directory) and&#160;..&#160;(parent&#160;<br/>directory).<br/>
-d<br/>
--directory<br/>
Ordinarily,&#160;if a&#160;directory&#160;is&#160;specified,&#160;ls&#160;will&#160;<br/>list&#160;the&#160;contents&#160;of the&#160;directory,&#160;not&#160;the&#160;<br/>directory&#160;itself.&#160;Use&#160;this&#160;option in&#160;conjunction<br/>with the&#160;-l&#160;option to&#160;see&#160;details&#160;about&#160;the&#160;<br/>directory&#160;rather&#160;than its&#160;contents.<br/>
-F<br/>
--classify<br/>
This&#160;option&#160;will&#160;append&#160;an indicator&#160;character<br/>to the&#160;end of each&#160;listed&#160;name. For example,&#160;a<br/>forward&#160;slash (/) if the&#160;name&#160;is&#160;a&#160;directory.&#160;<br/>
-h<br/>
--human-readable<br/>
In long format&#160;listings, display file&#160;sizes&#160;in&#160;<br/>human readable&#160;format&#160;rather than in bytes.<br/>
-l<br/>
Display results&#160;in&#160;long format.<br/>
-r<br/>
--reverse<br/>
Display the&#160;results&#160;in reverse&#160;order. Normally,<br/>ls&#160;displays&#160;its&#160;results&#160;in ascending&#160;<br/>alphabetical&#160;order.<br/>
-S<br/>
Sort&#160;results&#160;by file&#160;size.<br/>
-t<br/>
Sort&#160;by modification time.<br/>
15<br/>
<hr/>
<a name=40></a>3 – Exploring&#160;the&#160;System<br/>
A&#160;Longer&#160;Look&#160;at&#160;Long&#160;Format<br/>As&#160;we&#160;saw&#160;earlier,&#160;the&#160;-l&#160;option&#160;causes&#160;ls&#160;to&#160;display&#160;its&#160;results&#160;in&#160;long&#160;format.&#160;This&#160;for-<br/>mat&#160;contains&#160;a&#160;great&#160;deal&#160;of&#160;useful&#160;information.&#160;Here&#160;is&#160;the&#160;Examples&#160;directory&#160;from&#160;an<br/>Ubuntu&#160;system:<br/>
-rw-r--r-- 1 root root 3576296 2017-04-03 11:05 Experience ubuntu.ogg<br/>-rw-r--r-- 1 root root 1186219 2017-04-03 11:05 kubuntu-leaflet.png<br/>-rw-r--r-- 1 root root &#160; 47584 2017-04-03 11:05 logo-Edubuntu.png<br/>-rw-r--r-- 1 root root &#160; 44355 2017-04-03 11:05 logo-Kubuntu.png<br/>-rw-r--r-- 1 root root &#160; 34391 2017-04-03 11:05 logo-Ubuntu.png<br/>-rw-r--r-- 1 root root &#160; 32059 2017-04-03 11:05 oo-cd-cover.odf<br/>-rw-r--r-- 1 root root &#160;159744 2017-04-03 11:05 oo-derivatives.doc<br/>-rw-r--r-- 1 root root &#160; 27837 2017-04-03 11:05 oo-maxwell.odt<br/>-rw-r--r-- 1 root root &#160; 98816 2017-04-03 11:05 oo-trig.xls<br/>-rw-r--r-- 1 root root &#160;453764 2017-04-03 11:05 oo-welcome.odt<br/>-rw-r--r-- 1 root root &#160;358374 2017-04-03 11:05 ubuntu Sax.ogg<br/>
Table&#160;3-2&#160;provides&#160;us&#160;with&#160;a&#160;look&#160;at&#160;the&#160;different&#160;fields&#160;from&#160;one&#160;of&#160;the&#160;files&#160;and&#160;their<br/>meanings.<br/>
<i>Table&#160;3-2:&#160;ls&#160;Long Listing Fields</i><br/>
<b>Field</b><br/>
<b>Meaning</b><br/>
-rw-r--r--<br/>
Access&#160;rights&#160;to the&#160;file.&#160;The&#160;first&#160;character indicates&#160;the&#160;<br/>type&#160;of file.&#160;Among the&#160;different&#160;types,&#160;a&#160;leading&#160;dash&#160;<br/>means&#160;a&#160;regular file, while&#160;a&#160;“d”&#160;indicates&#160;a&#160;directory.&#160;<br/>The&#160;next&#160;three&#160;characters&#160;are&#160;the&#160;access&#160;rights&#160;for the&#160;<br/>file's&#160;owner, the&#160;next&#160;three&#160;are&#160;for members&#160;of the&#160;file's&#160;<br/>group, and the&#160;final&#160;three&#160;are&#160;for everyone&#160;else. Chapter&#160;9<br/>&#34;Permissions&#34; discusses&#160;the&#160;full&#160;meaning&#160;of this&#160;in more&#160;<br/>detail.<br/>
1<br/>
File's&#160;number of hard&#160;links. See&#160;the&#160;sections&#160;&#34;Symbolic&#160;<br/>Links&#34; and &#34;Hard Links&#34;&#160; later&#160;in this&#160;chapter.<br/>
root<br/>
The&#160;username&#160;of the&#160;file's&#160;owner.<br/>
root<br/>
The&#160;name&#160;of the&#160;group that&#160;owns&#160;the&#160;file.<br/>
32059<br/>
Size&#160;of the&#160;file&#160;in bytes.<br/>
2007-04-03 11:05<br/>
Date&#160;and&#160;time&#160;of the&#160;file's&#160;last&#160;modification.<br/>
oo-cd-cover.odf<br/>
Name&#160;of the&#160;file.<br/>
16<br/>
<hr/>
<a name=41></a>Having More&#160;Fun with ls<br/>
<b>Determining&#160;a&#160;File's&#160;Type&#160;with&#160;file<br/></b>As&#160;we&#160;explore&#160;the&#160;system&#160;it&#160;will&#160;be&#160;useful&#160;to&#160;know&#160;what&#160;files&#160;contain.&#160;To&#160;do&#160;this&#160;we&#160;will<br/>use&#160;the&#160;file&#160;command&#160;to&#160;determine&#160;a&#160;file's&#160;type.&#160;As&#160;we&#160;discussed&#160;earlier,&#160;filenames&#160;in<br/>Linux&#160;are&#160;not&#160;required&#160;to&#160;reflect&#160;a&#160;file's&#160;contents.&#160;While&#160;a&#160;filename&#160;like&#160;“picture.jpg”<br/>would&#160;normally&#160;be&#160;expected&#160;to&#160;contain&#160;a&#160;JPEG&#160;compressed&#160;image,&#160;it&#160;is&#160;not&#160;required&#160;to&#160;in<br/>Linux. &#160;We&#160;can&#160;invoke&#160;the&#160;file&#160;command&#160;this&#160;way:<br/>
<b>file&#160;<i>filename</i></b><br/>
When&#160;invoked,&#160;the&#160;&#160;file&#160;command&#160;will&#160;print&#160;a&#160;brief&#160;description&#160;of&#160;the&#160;file's&#160;contents.<br/>For example:<br/>
[me@linuxbox ~]$&#160;<b>file picture.jpg<br/></b>picture.jpg: JPEG image data, JFIF standard 1.01<br/>
There&#160;are&#160;many&#160;kinds&#160;of&#160;files.&#160;In&#160;fact,&#160;one&#160;of&#160;the&#160;common&#160;ideas&#160;in&#160;Unix-like&#160;operating<br/>systems&#160;such&#160;as&#160;Linux&#160;is&#160;that&#160;“everything&#160;is&#160;a&#160;file.”&#160;As&#160;we&#160;proceed&#160;with&#160;our&#160;lessons,&#160;we<br/>will&#160;see&#160;just&#160;how&#160;true&#160;that&#160;statement&#160;is.<br/>While&#160;many&#160;of&#160;the&#160;files&#160;on&#160;our&#160;system&#160;are&#160;familiar,&#160;for&#160;example&#160;MP3&#160;and&#160;JPEG,&#160;there&#160;are<br/>many kinds&#160;that&#160;are&#160;a&#160;little&#160;less&#160;obvious&#160;and a&#160;few&#160;that&#160;are&#160;quite&#160;strange.<br/>
<b>Viewing&#160;File&#160;Contents&#160;with&#160;less<br/></b>The&#160;less&#160;command&#160;is&#160;a&#160;program&#160;to&#160;view&#160;text&#160;files.&#160;Throughout&#160;our&#160;Linux&#160;system,&#160;there<br/>are&#160;many&#160;files&#160;that&#160;contain&#160;human-readable&#160;text.&#160;The&#160;less&#160;program&#160;provides&#160;a&#160;conve-<br/>nient&#160;way to examine&#160;them.<br/>
<b>What&#160;Is&#160;“Text”?</b><br/>
There&#160;are&#160;many&#160;ways&#160;to&#160;represent&#160;information&#160;on&#160;a&#160;computer.&#160;All&#160;methods&#160;in-<br/>volve&#160;defining&#160;a&#160;relationship&#160;between&#160;the&#160;information&#160;and&#160;some&#160;numbers&#160;that&#160;will<br/>be&#160;used&#160;to&#160;represent&#160;it.&#160;Computers,&#160;after&#160;all,&#160;only&#160;understand&#160;numbers&#160;and&#160;all&#160;data<br/>is&#160;converted&#160;to numeric&#160;representation.<br/>
17<br/>
<hr/>
<a name=42></a>3 – Exploring&#160;the&#160;System<br/>
Some&#160;&#160;of&#160;&#160;these&#160;&#160;&#160;representation&#160;&#160;systems&#160;&#160;are&#160;&#160;&#160;very&#160;&#160;complex&#160;&#160;(such&#160;&#160;as&#160;&#160;compressed<br/>video&#160;files),&#160;while&#160;others&#160;are&#160;rather&#160;simple.&#160;One&#160;of&#160;the&#160;earliest&#160;and&#160;simplest&#160;is<br/>called&#160;<i>ASCII&#160;text</i>.&#160;ASCII&#160;(pronounced&#160;&#34;As-Key&#34;)&#160;is&#160;short&#160;for&#160;American&#160;Standard<br/>Code&#160;for Information&#160;Interchange.&#160;This&#160;is&#160;a&#160;simple&#160;encoding&#160;scheme&#160;that&#160;was&#160;first<br/>used&#160;on&#160;Teletype&#160;machines&#160;to map&#160;keyboard characters&#160;to numbers.<br/>Text&#160;is&#160;a&#160;simple&#160;one-to-one&#160;mapping&#160;of&#160;characters&#160;to&#160;numbers.&#160;It&#160;is&#160;very&#160;compact.<br/>Fifty&#160;characters&#160;of&#160;text&#160;translates&#160;to&#160;fifty&#160;bytes&#160;of&#160;data.&#160;It&#160;is&#160;important&#160;to&#160;under-<br/>stand&#160;that&#160;text&#160;only&#160;contains&#160;a&#160;simple&#160;mapping&#160;of&#160;characters&#160;to&#160;numbers.&#160;It&#160;is&#160;not<br/>the&#160;same&#160;as&#160;a&#160;word processor&#160;document&#160;such&#160;as&#160;one&#160;created&#160;by Microsoft&#160;Word&#160;or<br/>LibreOffice&#160;Writer.&#160;Those&#160;files,&#160;in&#160;contrast&#160;to&#160;simple&#160;ASCII&#160;text,&#160;contain&#160;many<br/>non-text&#160;elements&#160;that&#160;are&#160;used&#160;to&#160;describe&#160;its&#160;structure&#160;and&#160;formatting.&#160;Plain<br/>ASCII&#160;text&#160;files&#160;contain&#160;only&#160;the&#160;characters&#160;themselves&#160;and&#160;a&#160;few&#160;rudimentary<br/>control&#160;codes&#160;such as&#160;tabs,&#160;carriage&#160;returns&#160;and&#160;line&#160;feeds.<br/>Throughout&#160;a&#160;Linux&#160;system,&#160;many&#160;files&#160;are&#160;stored&#160;in&#160;text&#160;format&#160;and&#160;there&#160;are<br/>many&#160;Linux&#160;tools&#160;that&#160;work&#160;with&#160;text&#160;files.&#160;Even&#160;Windows&#160;recognizes&#160;the&#160;impor-<br/>tance&#160;of&#160;this&#160;format.&#160;The&#160;well-known&#160;NOTEPAD.EXE&#160;program&#160;is&#160;an&#160;editor&#160;for<br/>plain&#160;ASCII text&#160;files.<br/>
Why&#160;would&#160;we&#160;want&#160;to&#160;examine&#160;text&#160;files?&#160;Because&#160;many&#160;of&#160;the&#160;files&#160;that&#160;contain&#160;system<br/>settings&#160;(called&#160;<i>configuration&#160;files</i>)&#160;are&#160;stored&#160;in&#160;this&#160;format,&#160;and&#160;being&#160;able&#160;to&#160;read&#160;them<br/>gives&#160;us&#160;insight&#160;about&#160;how&#160;the&#160;system&#160;works.&#160;In&#160;addition,&#160;some&#160;of&#160;the&#160;actual&#160;programs<br/>that&#160;the&#160;system&#160;uses&#160;(called&#160;<i>scripts</i>)&#160;are&#160;stored&#160;in&#160;this&#160;format.&#160;In&#160;later&#160;chapters,&#160;we&#160;will<br/>learn&#160;how&#160;to&#160;edit&#160;text&#160;files&#160;in&#160;order&#160;to&#160;modify&#160;systems&#160;settings&#160;and&#160;write&#160;our&#160;own&#160;scripts,<br/>but&#160;for now&#160;we&#160;will&#160;just&#160;look at&#160;their&#160;contents.<br/>The&#160;less&#160;command is&#160;used like&#160;this:<br/>
<b>less&#160;<i>filename</i></b><br/>
Once&#160;started,&#160;the&#160;less&#160;program&#160;allows&#160;us&#160;to&#160;scroll&#160;forward&#160;and&#160;backward&#160;through&#160;a&#160;text<br/>file.&#160;For&#160;example,&#160;to&#160;examine&#160;the&#160;file&#160;that&#160;defines&#160;all&#160;the&#160;system's&#160;user&#160;accounts,&#160;enter&#160;the<br/>following command:<br/>
[me@linuxbox ~]$&#160;<b>less /etc/passwd</b><br/>
Once&#160;the&#160;less&#160;program&#160;starts,&#160;we&#160;can&#160;view&#160;the&#160;contents&#160;of&#160;the&#160;file.&#160;If&#160;the&#160;file&#160;is&#160;longer<br/>
18<br/>
<hr/>
<a name=43></a>Viewing&#160;File&#160;Contents&#160;with less<br/>
than one&#160;page, we&#160;can&#160;scroll&#160;up and down.&#160;To exit&#160;less, press&#160;the&#160;q&#160;key.<br/>The&#160;table&#160;below&#160;lists&#160;the&#160;most&#160;common&#160;keyboard commands&#160;used by&#160;less.<br/>
<i>Table&#160;3-3:&#160;less&#160;Commands</i><br/>
<b>Command</b><br/>
<b>Action</b><br/>
Page&#160;Up or&#160;b<br/>
Scroll&#160;back&#160;one&#160;page<br/>
Page&#160;Down or space<br/>
Scroll&#160;forward one&#160;page<br/>
Up arrow<br/>
Scroll&#160;up one&#160;line<br/>
Down arrow<br/>
Scroll&#160;down one&#160;line<br/>
G<br/>
Move&#160;to the&#160;end of the&#160;text&#160;file<br/>
1G&#160;or&#160;g<br/>
Move&#160;to the&#160;beginning&#160;of the&#160;text&#160;file<br/>
/<i>characters</i><br/>
Search forward to&#160;the&#160;next&#160;occurrence&#160;of&#160;<i>characters</i><br/>
n<br/>
Search for the&#160;next&#160;occurrence&#160;of the&#160;previous&#160;search<br/>
h<br/>
Display help&#160;screen<br/>
q<br/>
Quit&#160;less<br/>
<b>Less&#160;Is&#160;More</b><br/>
The&#160;less&#160;program&#160;was&#160;designed&#160;as&#160;an&#160;improved&#160;replacement&#160;of&#160;an&#160;earlier&#160;Unix<br/>program&#160;called&#160;more.&#160;The&#160;name&#160;“less”&#160;is&#160;a&#160;play&#160;on&#160;the&#160;phrase&#160;“less&#160;is&#160;more” — a<br/>motto&#160;of modernist&#160;architects&#160;and&#160;designers.<br/>
less&#160;&#160;falls&#160;into&#160;the&#160;class&#160;of&#160;programs&#160;called&#160;“pagers,”&#160;programs&#160;that&#160;allow&#160;the<br/>easy&#160;viewing&#160;of&#160;long&#160;text&#160;documents&#160;in&#160;a&#160;page&#160;by&#160;page&#160;manner.&#160;Whereas&#160;the<br/>more&#160;program&#160;could&#160;only&#160;page&#160;forward,&#160;the&#160;less&#160;program&#160;allows&#160;paging&#160;both<br/>forward&#160;and backward and&#160;has&#160;many other&#160;features&#160;as&#160;well.&#160;<br/>
<b>Taking&#160;a&#160;Guided&#160;Tour<br/></b>The&#160;file&#160;system&#160;layout&#160;on&#160;a&#160;Linux&#160;system&#160;is&#160;much&#160;like&#160;that&#160;found&#160;on&#160;other&#160;Unix-like&#160;sys-<br/>tems.&#160;The&#160;design&#160;is&#160;actually&#160;specified&#160;in&#160;a&#160;published&#160;standard&#160;called&#160;the&#160;<i>Linux&#160;Filesystem<br/>Hierarchy&#160;Standard</i>.&#160;Not&#160;all&#160;Linux&#160;distributions&#160;conform&#160;to&#160;the&#160;standard&#160;exactly&#160;but&#160;most<br/>come&#160;pretty&#160;close.<br/>
19<br/>
<hr/>
<a name=44></a>3 – Exploring&#160;the&#160;System<br/>
Next,&#160;we&#160;are&#160;going&#160;to&#160;wander&#160;around&#160;the&#160;file&#160;system&#160;ourselves&#160;to&#160;see&#160;what&#160;makes&#160;our<br/>Linux&#160;system&#160;tick.&#160;This&#160;will&#160;give&#160;us&#160;a&#160;chance&#160;to&#160;practice&#160;our&#160;navigation&#160;skills.&#160;One&#160;of&#160;the<br/>things&#160;we&#160;will&#160;discover&#160;is&#160;that&#160;many&#160;of&#160;the&#160;interesting&#160;files&#160;are&#160;in&#160;plain&#160;human-readable<br/>text.&#160;As&#160;we&#160;go about&#160;our tour, try&#160;the&#160;following:<br/>
1.&#160;cd&#160;into a&#160;given directory<br/>2.&#160;List&#160;the&#160;directory contents&#160;with&#160;ls -l<br/>3.&#160;If you see&#160;an interesting&#160;file,&#160;determine&#160;its&#160;contents&#160;with&#160;file<br/>4.&#160;If it&#160;looks&#160;like&#160;it&#160;might&#160;be&#160;text, try&#160;viewing it&#160;with&#160;less<br/>5.&#160;If&#160;we&#160;accidentally&#160;attempt&#160;to&#160;view&#160;a&#160;non-text&#160;file&#160;and&#160;it&#160;scrambles&#160;the&#160;terminal<br/>
window, we&#160;can recover&#160;by entering&#160;the&#160;reset&#160;command.&#160;<br/>
<b>Remember&#160;the&#160;copy&#160;and&#160;paste&#160;trick!&#160;</b>If&#160;you&#160;are&#160;using&#160;a&#160;mouse,&#160;you&#160;can&#160;double<br/>click on a&#160;filename&#160;to&#160;copy it&#160;and middle&#160;click to&#160;paste&#160;it&#160;into&#160;commands.<br/>
As&#160;we&#160;wander&#160;around, don't&#160;be&#160;afraid&#160;to&#160;look&#160;at&#160;stuff. Regular&#160;users&#160;are&#160;largely&#160;prohibited<br/>from&#160;messing&#160;things&#160;up.&#160;That's&#160;the&#160;system&#160;administrator's&#160;job!&#160;If&#160;a&#160;command&#160;complains<br/>about&#160;something,&#160;just&#160;move&#160;on&#160;to&#160;something&#160;else.&#160;Spend&#160;some&#160;time&#160;looking&#160;around.&#160;The<br/>system&#160;is&#160;ours&#160;to explore.&#160;Remember, in&#160;Linux, there&#160;are&#160;no secrets!<br/>Table&#160;3-4&#160;lists&#160;just&#160;a&#160;few&#160;of&#160;the&#160;directories&#160;we&#160;can&#160;explore.&#160;There&#160;may&#160;be&#160;some&#160;slight&#160;dif-<br/>ferences&#160;depending&#160;on&#160;our&#160;Linux&#160;distribution.&#160;Don't&#160;be&#160;afraid&#160;to&#160;look&#160;around&#160;and&#160;try<br/>more!<br/>
<i>Table&#160;3-4: Directories&#160;Found&#160;on Linux&#160;Systems</i><br/>
<b>Directory</b><br/>
<b>Comments</b><br/>
/<br/>
The&#160;root&#160;directory.&#160;Where&#160;everything begins.<br/>
/bin<br/>
Contains&#160;binaries&#160;(programs) that&#160;must&#160;be&#160;present&#160;for the&#160;<br/>system&#160;to boot&#160;and run.<br/>
/boot<br/>
Contains&#160;the&#160;Linux&#160;kernel, initial&#160;RAM&#160;disk image&#160;(for&#160;<br/>drivers&#160;needed at&#160;boot&#160;time), and&#160;the&#160;boot&#160;loader.<br/>
Interesting files:<br/>
●<br/>
/boot/grub/grub.conf&#160;or&#160;menu.lst, which&#160;<br/>are&#160;used&#160;to configure&#160;the&#160;boot&#160;loader.<br/>
●<br/>
/boot/vmlinuz&#160;(or something similar), the&#160;Linux<br/>kernel<br/>
20<br/>
<hr/>
<a name=45></a>Taking&#160;a&#160;Guided&#160;Tour<br/>
<b>Directory</b><br/>
<b>Comments</b><br/>
/dev<br/>
This&#160;is&#160;a&#160;special&#160;directory that&#160;contains&#160;<i>device&#160;nodes</i>.&#160;<br/>“Everything&#160;is&#160;a&#160;file”&#160;also applies&#160;to&#160;devices. Here&#160;is&#160;where&#160;<br/>the&#160;kernel&#160;maintains&#160;a&#160;list&#160;of all&#160;the&#160;devices&#160;it&#160;understands.<br/>
/etc<br/>
The&#160;/etc&#160;directory&#160;contains&#160;all&#160;of the&#160;system-wide&#160;<br/>configuration&#160;files. It&#160;also contains&#160;a&#160;collection of shell&#160;<br/>scripts&#160;that&#160;start&#160;each&#160;of the&#160;system&#160;services&#160;at&#160;boot&#160;time.&#160;<br/>Everything&#160;in this&#160;directory should be&#160;readable&#160;text.<br/>
Interesting files:&#160;While&#160;everything&#160;in&#160;/etc&#160;is&#160;interesting,&#160;<br/>here&#160;are&#160;some&#160;all-time&#160;favorites:<br/>
●<br/>
/etc/crontab, a&#160;file&#160;that&#160;defines&#160;when&#160;<br/>automated jobs&#160;will&#160;run.<br/>
●<br/>
/etc/fstab, a&#160;table&#160;of storage&#160;devices&#160;and their&#160;<br/>associated mount&#160;points.<br/>
●<br/>
/etc/passwd, a&#160;list&#160;of the&#160;user&#160;accounts.<br/>
/home<br/>
In normal&#160;configurations, each user is&#160;given&#160;a&#160;directory in&#160;<br/>/home. Ordinary&#160;users&#160;can&#160;only write&#160;files&#160;in their home&#160;<br/>directories.&#160;This&#160;limitation protects&#160;the&#160;system&#160;from&#160;errant&#160;<br/>user activity.<br/>
/lib<br/>
Contains&#160;shared&#160;library&#160;files&#160;used by the&#160;core&#160;system&#160;<br/>programs.&#160;These&#160;are&#160;similar&#160;to dynamic&#160;link&#160;libraries&#160;<br/>(DLLs) in&#160;Windows.<br/>
/lost+found<br/>
Each formatted&#160;partition or device&#160;using a&#160;Linux file&#160;system,<br/>such as&#160;ext4,&#160;will&#160;have&#160;this&#160;directory.&#160;It&#160;is&#160;used in the&#160;case&#160;of<br/>a&#160;partial&#160;recovery&#160;from&#160;a&#160;file&#160;system&#160;corruption event.&#160;<br/>Unless&#160;something&#160;really&#160;bad has&#160;happened&#160;to our system,&#160;<br/>this&#160;directory&#160;will&#160;remain&#160;empty.<br/>
/media<br/>
On modern&#160;Linux systems&#160;the&#160;/media&#160;directory&#160;will&#160;<br/>contain the&#160;mount&#160;points&#160;for removable&#160;media&#160;such as&#160;USB&#160;<br/>drives,&#160;CD-ROMs, etc. that&#160;are&#160;mounted automatically at&#160;<br/>insertion.<br/>
/mnt<br/>
On older&#160;Linux systems, the&#160;/mnt&#160;directory&#160;contains&#160;mount<br/>points&#160;for removable&#160;devices&#160;that&#160;have&#160;been&#160;mounted&#160;<br/>manually.<br/>
21<br/>
<hr/>
<a name=46></a>3 – Exploring&#160;the&#160;System<br/>
<b>Directory</b><br/>
<b>Comments</b><br/>
/opt<br/>
The&#160;/opt&#160;directory&#160;is&#160;used to install&#160;“optional”&#160;software.&#160;<br/>This&#160;is&#160;mainly&#160;used to hold commercial&#160;software&#160;products&#160;<br/>that&#160;might&#160;be&#160;installed&#160;on the&#160;system.<br/>
/proc<br/>
The&#160;/proc&#160;directory&#160;is&#160;special. It's&#160;not&#160;a&#160;real&#160;file&#160;system&#160;in&#160;<br/>the&#160;sense&#160;of files&#160;stored&#160;on the&#160;hard drive.&#160;Rather,&#160;it&#160;is&#160;a&#160;<br/>virtual&#160;file&#160;system&#160;maintained&#160;by the&#160;Linux kernel.&#160;The&#160;<br/>“files”&#160;it&#160;contains&#160;are&#160;peepholes&#160;into&#160;the&#160;kernel&#160;itself.&#160;The&#160;<br/>files&#160;are&#160;readable&#160;and will&#160;give&#160;us&#160;a&#160;picture&#160;of how&#160;the&#160;<br/>kernel&#160;sees&#160;the&#160;computer.<br/>
/root<br/>
This&#160;is&#160;the&#160;home&#160;directory&#160;for the&#160;root&#160;account.<br/>
/sbin<br/>
This&#160;directory&#160;contains&#160;“system”&#160;binaries.&#160;These&#160;are&#160;<br/>programs&#160;that&#160;perform&#160;vital&#160;system&#160;tasks&#160;that&#160;are&#160;generally&#160;<br/>reserved&#160;for the&#160;superuser.<br/>
/tmp<br/>
The&#160;/tmp&#160;directory&#160;is&#160;intended for the&#160;storage&#160;of temporary,<br/>transient&#160;files&#160;created by various&#160;programs. Some&#160;<br/>configurations&#160;cause&#160;this&#160;directory to&#160;be&#160;emptied each time&#160;<br/>the&#160;system&#160;is&#160;rebooted.<br/>
/usr<br/>
The&#160;/usr&#160;directory&#160;tree&#160;is&#160;likely the&#160;largest&#160;one&#160;on a&#160;Linux&#160;<br/>system.&#160;It&#160;contains&#160;all&#160;the&#160;programs&#160;and&#160;support&#160;files&#160;used&#160;<br/>by regular users.<br/>
/usr/bin<br/>
/usr/bin&#160;contains&#160;the&#160;executable&#160;programs&#160;installed by&#160;<br/>the&#160;Linux&#160;distribution.&#160;It&#160;is&#160;not&#160;uncommon for this&#160;directory&#160;<br/>to&#160;hold thousands&#160;of programs.<br/>
/usr/lib<br/>
The&#160;shared libraries&#160;for the&#160;programs&#160;in&#160;/usr/bin.<br/>
/usr/local<br/>
The&#160;/usr/local&#160;tree&#160;is&#160;where&#160;programs&#160;that&#160;are&#160;not&#160;<br/>included with&#160;the&#160;distribution&#160;but&#160;are&#160;intended&#160;for system-<br/>wide&#160;use&#160;are&#160;installed. Programs&#160;compiled&#160;from&#160;source&#160;code&#160;<br/>are&#160;normally installed&#160;in&#160;/usr/local/bin. On a&#160;newly&#160;<br/>installed&#160;Linux system,&#160;this&#160;tree&#160;exists, but&#160;it&#160;will&#160;be&#160;empty&#160;<br/>until&#160;the&#160;system&#160;administrator&#160;puts&#160;something&#160;in it.<br/>
/usr/sbin<br/>
Contains&#160;more&#160;system&#160;administration&#160;programs.<br/>
/usr/share<br/>
/usr/share&#160;contains&#160;all&#160;the&#160;shared&#160;data&#160;used&#160;by&#160;<br/>programs&#160;in&#160;/usr/bin.&#160;This&#160;includes&#160;things&#160;such as&#160;<br/>default&#160;configuration&#160;files,&#160;icons, screen backgrounds, sound<br/>files, etc.<br/>
22<br/>
<hr/>
<a name=47></a>Taking&#160;a&#160;Guided&#160;Tour<br/>
<b>Directory</b><br/>
<b>Comments</b><br/>
/usr/share/doc<br/>
Most&#160;packages&#160;installed on the&#160;system&#160;will&#160;include&#160;some&#160;<br/>kind&#160;of documentation.&#160;In&#160;/usr/share/doc, we&#160;will&#160;find<br/>documentation files&#160;organized&#160;by package.<br/>
/var<br/>
With the&#160;exception of&#160;/tmp&#160;and&#160;/home, the&#160;directories&#160;we&#160;<br/>have&#160;looked at&#160;so far remain relatively static, that&#160;is, their&#160;<br/>contents&#160;don't&#160;change.&#160;The&#160;/var&#160;directory tree&#160;is&#160;where&#160;<br/>data&#160;that&#160;is&#160;likely to&#160;change&#160;is&#160;stored.&#160;Various&#160;databases,&#160;<br/>spool&#160;files, user mail, etc.&#160;are&#160;located&#160;here.<br/>
/var/log<br/>
/var/log&#160;contains&#160;<i>log&#160;files</i>, records&#160;of various&#160;system&#160;<br/>activity.&#160;These&#160;are&#160;important&#160;and should be&#160;monitored from&#160;<br/>time&#160;to time.&#160;The&#160;most&#160;useful&#160;ones&#160;are&#160;<br/>/var/log/messages&#160;and&#160;/var/log/syslog. Note&#160;<br/>that&#160;for security reasons&#160;on some&#160;systems&#160;only the&#160;superuser<br/>may&#160;view&#160;log files.<br/>
<b>Symbolic&#160;Links<br/></b>As&#160;we&#160;look&#160;around,&#160;we&#160;are&#160;likely&#160;to&#160;see&#160;a&#160;directory&#160;listing&#160;(for&#160;example,&#160;/lib)&#160;with&#160;an<br/>entry like&#160;this:<br/>
lrwxrwxrwx 1 root root &#160; 11 2007-08-11 07:34 libc.so.6 -&gt; libc-2.6.so<br/>
Notice&#160;how&#160;the&#160;first&#160;letter&#160;of&#160;the&#160;listing&#160;is&#160;“l”&#160;and&#160;the&#160;entry&#160;seems&#160;to&#160;have&#160;two&#160;filenames?<br/>This&#160;is&#160;a&#160;special&#160;kind&#160;of&#160;a&#160;file&#160;called&#160;a&#160;<i>symbolic&#160;link</i>&#160;(also&#160;known&#160;as&#160;a&#160;<i>soft&#160;link</i>&#160;or&#160;<i>sym-<br/>link</i>).&#160;In&#160;most&#160;Unix-like&#160;systems&#160;it&#160;is&#160;possible&#160;to&#160;have&#160;a&#160;file&#160;referenced&#160;by multiple&#160;names.<br/>While&#160;the&#160;value&#160;of this&#160;might&#160;not&#160;be&#160;obvious, it&#160;is&#160;really a&#160;useful&#160;feature.<br/>Picture&#160;this&#160;scenario:&#160;A&#160;program&#160;requires&#160;the&#160;use&#160;of&#160;a&#160;shared&#160;resource&#160;of&#160;some&#160;kind&#160;con-<br/>tained&#160;in&#160;a&#160;file&#160;named&#160;“foo,”&#160;but&#160;“foo”&#160;has&#160;frequent&#160;version&#160;changes.&#160;It&#160;would&#160;be&#160;good&#160;to<br/>include&#160;the&#160;version&#160;number&#160;in&#160;the&#160;filename&#160;so&#160;the&#160;administrator&#160;or&#160;other&#160;interested&#160;party<br/>could&#160;see&#160;what&#160;version&#160;of&#160;“foo”&#160;is&#160;installed.&#160;This&#160;presents&#160;a&#160;problem.&#160;If&#160;we&#160;change&#160;the<br/>name&#160;of&#160;the&#160;shared&#160;resource,&#160;we&#160;have&#160;to&#160;track&#160;down&#160;every&#160;program&#160;that&#160;might&#160;use&#160;it&#160;and<br/>change&#160;it&#160;to&#160;look&#160;for&#160;a&#160;new&#160;resource&#160;name&#160;every&#160;time&#160;a&#160;new&#160;version&#160;of&#160;the&#160;resource&#160;is&#160;in-<br/>stalled.&#160;That&#160;doesn't&#160;sound like&#160;fun at&#160;all.<br/>Here&#160;is&#160;where&#160;symbolic&#160;links&#160;save&#160;the&#160;day.&#160;Suppose&#160;we&#160;install&#160;version&#160;2.6 of “foo,”&#160;which<br/>has&#160;the&#160;filename&#160;“foo-2.6”&#160;and&#160;then&#160;create&#160;a&#160;symbolic&#160;link&#160;simply&#160;called&#160;“foo”&#160;that&#160;points<br/>to&#160;“foo-2.6.”&#160;This&#160;means&#160;that&#160;when&#160;a&#160;program&#160;opens&#160;the&#160;file&#160;“foo”,&#160;it&#160;is&#160;actually&#160;opening<br/>the&#160;file&#160;“foo-2.6”.&#160;Now&#160;everybody&#160;is&#160;happy.&#160;The&#160;programs&#160;that&#160;rely&#160;on&#160;“foo”&#160;can&#160;find&#160;it<br/>
23<br/>
<hr/>
<a name=48></a>3 – Exploring&#160;the&#160;System<br/>
and&#160;we&#160;can&#160;still&#160;see&#160;what&#160;actual&#160;version&#160;is&#160;installed.&#160;When&#160;it&#160;is&#160;time&#160;to&#160;upgrade&#160;to&#160;“foo-<br/>2.7,”&#160;we&#160;just&#160;add&#160;the&#160;file&#160;to&#160;our&#160;system,&#160;delete&#160;the&#160;symbolic&#160;link&#160;“foo”&#160;and&#160;create&#160;a&#160;new<br/>one&#160;that&#160;points&#160;to&#160;the&#160;new&#160;version.&#160;Not&#160;only&#160;does&#160;this&#160;solve&#160;the&#160;problem&#160;of&#160;the&#160;version<br/>upgrade,&#160;but&#160;it&#160;also&#160;allows&#160;us&#160;to&#160;keep&#160;both&#160;versions&#160;on&#160;our&#160;machine.&#160;Imagine&#160;that&#160;“foo-<br/>2.7”&#160;has&#160;a&#160;bug&#160;(damn&#160;those&#160;developers!)&#160;and&#160;we&#160;need&#160;to&#160;revert&#160;to&#160;the&#160;old&#160;version.&#160;Again,<br/>we&#160;just&#160;delete&#160;the&#160;symbolic&#160;link&#160;pointing&#160;to&#160;the&#160;new&#160;version&#160;and&#160;create&#160;a&#160;new&#160;symbolic<br/>link pointing to&#160;the&#160;old&#160;version.&#160;<br/>The&#160;directory&#160;listing&#160;at&#160;the&#160;beginning&#160;of&#160;this&#160;section&#160;(from&#160;the&#160;&#160;/lib&#160;&#160;directory&#160;of&#160;a<br/>Fedora&#160;system)&#160;shows&#160;a&#160;symbolic&#160;link&#160;called&#160;libc.so.6&#160;that&#160;points&#160;to&#160;a&#160;shared&#160;library<br/>file&#160;called&#160;libc-2.6.so.&#160;This&#160;means&#160;that&#160;programs&#160;looking&#160;for&#160;libc.so.6&#160;will&#160;ac-<br/>tually&#160;get&#160;the&#160;file&#160;libc-2.6.so.&#160;We&#160;will&#160;learn&#160;how&#160;to&#160;create&#160;symbolic&#160;links&#160;in&#160;the&#160;next<br/>chapter.<br/>
<b>Hard&#160;Links<br/></b>While&#160;we&#160;are&#160;on&#160;the&#160;subject&#160;of&#160;links,&#160;we&#160;need&#160;to&#160;mention&#160;that&#160;there&#160;is&#160;a&#160;second&#160;type&#160;of<br/>link&#160;called&#160;a&#160;<i>hard&#160;link</i>.&#160;Hard&#160;links&#160;also&#160;allow&#160;files&#160;to&#160;have&#160;multiple&#160;names,&#160;but&#160;they&#160;do&#160;it<br/>in&#160;a&#160;different&#160;way.&#160;We’ll&#160;talk&#160;more&#160;about&#160;the&#160;differences&#160;between&#160;symbolic&#160;and&#160;hard&#160;links<br/>in the&#160;next&#160;chapter.<br/>
<b>Summing&#160;Up<br/></b>With&#160;our&#160;tour&#160;behind&#160;us,&#160;we&#160;have&#160;learned&#160;a&#160;lot&#160;about&#160;our&#160;system.&#160;We've&#160;seen&#160;various&#160;files<br/>and&#160;directories&#160;and&#160;their&#160;contents.&#160;One&#160;thing&#160;we&#160;should&#160;take&#160;away&#160;from&#160;this&#160;is&#160;how&#160;open<br/>the&#160;system&#160;is.&#160;In&#160;Linux&#160;there&#160;are&#160;many&#160;important&#160;files&#160;that&#160;are&#160;plain&#160;human-readable&#160;text.<br/>Unlike&#160;many&#160;proprietary&#160;systems,&#160;Linux&#160;makes&#160;everything&#160;available&#160;for&#160;examination&#160;and<br/>study.&#160;<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;full&#160;version of the&#160;<i>Linux&#160;Filesystem&#160;Hierarchy&#160;Standard</i>&#160;can&#160;be&#160;found here:<br/><a href="http://www.pathname.com/fhs/">http://www.pathname.com/fhs/</a><br/>
●<br/>
An article&#160;about&#160;the&#160;directory&#160;structure&#160;of Unix and&#160;Unix-like&#160;systems:<a href="http://en.wikipedia.org/wiki/Unix_directory_structure">&#160;http://<br/>en.wikipedia.org/wiki/Unix_directory_structure</a><br/>
●<br/>
A&#160;detailed&#160;description&#160;of the&#160;ASCII text&#160;format:&#160;<a href="http://en.wikipedia.org/wiki/ASCII">http://en.wikipedia.org/wiki/<br/>ASCII</a><br/>
24<br/>
<hr/>
<a name=49></a>4 – Manipulating&#160;Files&#160;and Directories<br/>
<i><b>4&#160;–&#160;Manipulating&#160;Files&#160;and&#160;Directories</b></i><br/>
At&#160;this&#160;point,&#160;we&#160;are&#160;ready&#160;for&#160;some&#160;real&#160;work!&#160;This&#160;chapter&#160;will&#160;introduce&#160;the&#160;following<br/>commands:<br/>
●<br/>
cp&#160;– Copy files&#160;and&#160;directories<br/>
●<br/>
mv&#160;– Move/rename&#160;files&#160;and directories<br/>
●<br/>
mkdir&#160;– Create&#160;directories<br/>
●<br/>
rm&#160;– Remove&#160;files&#160;and directories<br/>
●<br/>
ln&#160;– Create&#160;hard and symbolic&#160;links<br/>
These&#160;five&#160;commands&#160;are&#160;among&#160;the&#160;most&#160;frequently&#160;used&#160;Linux&#160;commands.&#160;They&#160;are<br/>used&#160;for manipulating&#160;both files&#160;and directories.<br/>Now,&#160;to&#160;be&#160;frank,&#160;some&#160;of&#160;the&#160;tasks&#160;performed&#160;by&#160;these&#160;commands&#160;are&#160;more&#160;easily&#160;done<br/>with&#160;a&#160;graphical&#160;file&#160;manager.&#160;With&#160;a&#160;file&#160;manager,&#160;we&#160;can&#160;drag&#160;and&#160;drop&#160;a&#160;file&#160;from&#160;one<br/>directory&#160;to another, cut&#160;and paste&#160;files, delete&#160;files, and so on. So why use&#160;these&#160;old com-<br/>mand line&#160;programs?<br/>The&#160;answer&#160;is&#160;power&#160;and&#160;flexibility.&#160;While&#160;it&#160;is&#160;easy&#160;to&#160;perform&#160;simple&#160;file&#160;manipulations<br/>with&#160;a&#160;graphical&#160;file&#160;manager,&#160;complicated&#160;tasks&#160;can&#160;be&#160;easier&#160;with&#160;the&#160;command&#160;line<br/>programs.&#160;For&#160;example,&#160;how&#160;could&#160;we&#160;copy&#160;all&#160;the&#160;HTML&#160;files&#160;from&#160;one&#160;directory&#160;to&#160;an-<br/>other&#160;but&#160;only&#160;copy&#160;files&#160;that&#160;do&#160;not&#160;exist&#160;in&#160;the&#160;destination&#160;directory&#160;or&#160;are&#160;newer&#160;than<br/>the&#160;versions&#160;in&#160;the&#160;destination&#160;directory?&#160;It's&#160;pretty&#160;hard&#160;with&#160;a&#160;file&#160;manager&#160;but&#160;pretty<br/>easy with the&#160;command line.<br/>
<b>cp -u *.html destination</b><br/>
<b>Wildcards<br/></b>Before&#160;we&#160;begin&#160;using&#160;our&#160;commands,&#160;we&#160;need&#160;to&#160;talk&#160;about&#160;a&#160;shell&#160;feature&#160;that&#160;makes<br/>these&#160;commands&#160;so&#160;powerful.&#160;Since&#160;the&#160;shell&#160;uses&#160;filenames&#160;so&#160;much,&#160;it&#160;provides&#160;special<br/>characters&#160;to&#160;help&#160;us&#160;rapidly&#160;specify&#160;groups&#160;of&#160;filenames.&#160;These&#160;special&#160;characters&#160;are<br/>
25<br/>
<hr/>
<a name=50></a>4 – Manipulating Files&#160;and Directories<br/>
called&#160;<i>wildcards</i>.&#160;Using&#160;wildcards&#160;(which&#160;is&#160;also&#160;known&#160;as&#160;<i>globbing</i>)&#160;allows&#160;us&#160;to&#160;select<br/>filenames&#160;based&#160;on&#160;patterns&#160;of&#160;characters.&#160;Table&#160;4-1&#160;lists&#160;the&#160;wildcards&#160;and&#160;what&#160;they&#160;se-<br/>lect.<br/>
<i>Table&#160;4-1: Wildcards</i><br/>
<b>Wildcard</b><br/>
<b>Meaning</b><br/>
*<br/>
Matches&#160;any characters<br/>
?<br/>
Matches&#160;any single&#160;character<br/>
[<i>characters</i>]<br/>
Matches&#160;any character that&#160;is&#160;a&#160;member of the&#160;set&#160;<i>characters</i>&#160;<br/>
[!<i>characters</i>]<br/>
Matches&#160;any character that&#160;is&#160;not&#160;a&#160;member&#160;of the&#160;set&#160;<br/><i>characters</i><br/>
[[:<i>class</i>:]]<br/>
Matches&#160;any character that&#160;is&#160;a&#160;member of the&#160;specified&#160;<br/><i>class</i><br/>
Table&#160;4-2 lists&#160;the&#160;most&#160;commonly used&#160;character classes.<br/>
<i>Table&#160;4-2: Commonly&#160;Used Character&#160;Classes</i><br/>
<b>Character&#160;Class</b><br/>
<b>Meaning</b><br/>
[:alnum:]<br/>
Matches&#160;any alphanumeric&#160;character<br/>
[:alpha:]<br/>
Matches&#160;any alphabetic&#160;character<br/>
[:digit:]<br/>
Matches&#160;any numeral<br/>
[:lower:]<br/>
Matches&#160;any lowercase&#160;letter<br/>
[:upper:]<br/>
Matches&#160;any uppercase&#160;letter<br/>
Using&#160;wildcards&#160;makes&#160;it&#160;possible&#160;to&#160;construct&#160;sophisticated&#160;selection&#160;criteria&#160;for&#160;file-<br/>names.&#160;Table&#160;4-3 provides&#160;some&#160;examples&#160;of patterns&#160;and&#160;what&#160;they match.<br/>
<i>Table&#160;4-3: Wildcard&#160;Examples</i><br/>
<b>Pattern</b><br/>
<b>Matches</b><br/>
*<br/>
All&#160;files<br/>
g*<br/>
Any file&#160;beginning&#160;with “g”<br/>
b*.txt<br/>
Any file&#160;beginning&#160;with “b”&#160;followed by&#160;<br/>any&#160;characters&#160;and ending&#160;with “.txt”<br/>
26<br/>
<hr/>
<a name=51></a>Wildcards<br/>
Data???<br/>
Any file&#160;beginning&#160;with “Data”&#160;followed&#160;<br/>by exactly&#160;three&#160;characters<br/>
[abc]*<br/>
Any file&#160;beginning&#160;with either an&#160;“a”, a&#160;<br/>“b”,&#160;or a&#160;“c”<br/>
BACKUP.[0-9][0-9][0-9]<br/>
Any file&#160;beginning&#160;with “BACKUP.”&#160;<br/>followed&#160;by exactly three&#160;numerals<br/>
[[:upper:]]*<br/>
Any file&#160;beginning&#160;with an uppercase&#160;letter<br/>
[![:digit:]]*<br/>
Any file&#160;not&#160;beginning with a&#160;numeral<br/>
*[[:lower:]123]<br/>
Any file&#160;ending with&#160;a&#160;lowercase&#160;letter or&#160;<br/>the&#160;numerals&#160;“1”, “2”,&#160;or “3”<br/>
Wildcards&#160;can&#160;be&#160;used&#160;with&#160;any&#160;command&#160;that&#160;accepts&#160;filenames&#160;as&#160;arguments,&#160;but&#160;we’ll<br/>talk&#160;more&#160;about&#160;that&#160;in Chapter&#160;7, &#34;Seeing&#160;the&#160;World&#160;As&#160;the&#160;Shell&#160;Sees&#160;It.<br/>
<b>Character&#160;Ranges</b><br/>
If&#160;you&#160;are&#160;coming&#160;from&#160;another&#160;Unix-like&#160;environment&#160;or&#160;have&#160;been&#160;reading<br/>some&#160;other&#160;books&#160;on&#160;this&#160;subject,&#160;you&#160;may&#160;have&#160;encountered&#160;the&#160;[A-Z]&#160;and&#160;[a-<br/>z]&#160;character&#160;range&#160;notations.&#160;These&#160;are&#160;traditional&#160;Unix&#160;notations&#160;and&#160;worked&#160;in<br/>older&#160;versions&#160;of&#160;Linux&#160;as&#160;well.&#160;They&#160;can&#160;still&#160;work,&#160;but&#160;you&#160;have&#160;to&#160;be&#160;careful<br/>with&#160;them&#160;because&#160;they&#160;will&#160;not&#160;produce&#160;the&#160;expected&#160;results&#160;unless&#160;properly&#160;con-<br/>figured. For now, you should avoid&#160;using&#160;them&#160;and&#160;use&#160;character classes&#160;instead.<br/>
<b>Wildcards&#160;Work&#160;in&#160;the&#160;GUI&#160;Too</b><br/>
Wildcards&#160;are&#160;especially&#160;valuable&#160;not&#160;only&#160;because&#160;they&#160;are&#160;used&#160;so&#160;frequently&#160;on<br/>the&#160;command&#160;line,&#160;but&#160;because&#160;they&#160;are&#160;also&#160;supported&#160;by&#160;some&#160;graphical&#160;file<br/>managers.<br/>
●<br/>
In&#160;&#160;Nautilus&#160;&#160;(the&#160;file&#160;manager&#160;for&#160;&#160;GNOME),&#160;you&#160;can&#160;select&#160;files&#160;using&#160;the<br/>Edit/Select&#160;Pattern&#160;menu&#160;item.&#160;Just&#160;enter&#160;a&#160;file&#160;selection&#160;pattern&#160;with&#160;wild-<br/>cards&#160;and&#160;the&#160;files&#160;in&#160;the&#160;currently&#160;viewed&#160;directory&#160;will&#160;be&#160;highlighted&#160;for&#160;se-<br/>lection.<br/>
27<br/>
<hr/>
<a name=52></a>4 – Manipulating Files&#160;and Directories<br/>
●<br/>
In&#160;some&#160;versions&#160;of&#160;Dolphin&#160;and&#160;Konqueror&#160;(the&#160;file&#160;managers&#160;for&#160;KDE),&#160;you<br/>can&#160;enter&#160;wildcards&#160;directly&#160;on&#160;the&#160;location&#160;bar.&#160;For&#160;example,&#160;if&#160;you&#160;want&#160;to<br/>see&#160;all&#160;the&#160;files&#160;starting&#160;with&#160;a&#160;lowercase&#160;“u”&#160;in&#160;the&#160;/usr/bin&#160;directory,&#160;enter&#160;“/<br/>usr/bin/u*”&#160;in the&#160;location bar and&#160;it&#160;will&#160;display&#160;the&#160;result.<br/>
Many&#160;ideas&#160;originally&#160;found&#160;in&#160;the&#160;command&#160;line&#160;interface&#160;make&#160;their&#160;way&#160;into<br/>the&#160;graphical&#160;interface,&#160;too.&#160;It&#160;is&#160;one&#160;of the&#160;many&#160;things&#160;that&#160;make&#160;the&#160;Linux&#160;desk-<br/>top so powerful.<br/>
<b>mkdir&#160;–&#160;Create&#160;Directories<br/></b>The&#160;mkdir&#160;command is&#160;used to&#160;create&#160;directories. It&#160;works&#160;like&#160;this:<br/>
<b>mkdir&#160;<i>directory...</i></b><br/>
<b>A&#160;note&#160;on&#160;notation:</b>&#160;When&#160;three&#160;periods&#160;follow&#160;an&#160;argument&#160;in&#160;the&#160;description&#160;of&#160;a&#160;com-<br/>mand&#160;(as&#160;above),&#160;it&#160;means&#160;that&#160;the&#160;argument&#160;can&#160;be&#160;repeated,&#160;thus&#160;the&#160;following&#160;com-<br/>mand:<br/>
<b>mkdir dir1</b><br/>
would&#160;create&#160;a&#160;single&#160;directory named&#160;dir1, while&#160;the&#160;following:<br/>
<b>mkdir dir1 dir2 dir3</b><br/>
would&#160;create&#160;three&#160;directories&#160;named&#160;dir1,&#160;dir2, and&#160;dir3.<br/>
<b>cp&#160;–&#160;Copy&#160;Files&#160;and&#160;Directories<br/></b>The&#160;cp&#160;command&#160;copies&#160;files&#160;or&#160;directories.&#160;It&#160;can&#160;be&#160;used&#160;two&#160;different&#160;ways.&#160;The&#160;fol-<br/>lowing:<br/>
<b>cp&#160;<i>item1</i></b><b>&#160;<i>item2</i></b><br/>
copies&#160;the&#160;single&#160;file&#160;or&#160;directory&#160;item1&#160;to&#160;the&#160;file&#160;or&#160;directory&#160;item2&#160;and&#160;the&#160;follow-<br/>ing:<br/>
28<br/>
<hr/>
<a name=53></a>cp&#160;– Copy Files&#160;and Directories<br/>
<b>cp&#160;<i>item</i></b><b>...&#160;<i>directory</i></b><br/>
copies&#160;multiple&#160;items&#160;(either files&#160;or directories) into&#160;a&#160;directory.<br/>
Useful&#160;Options&#160;and&#160;Examples<br/>Table&#160;4-4 lists&#160;some&#160;of the&#160;commonly&#160;used options&#160;for&#160;cp.<br/>
<i>Table&#160;4-4:&#160;cp&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Meaning</b><br/>
-a<br/>
--archive<br/>
Copy the&#160;files&#160;and&#160;directories&#160;and all&#160;of their&#160;<br/>attributes, including ownerships&#160;and&#160;<br/>permissions. Normally,&#160;copies&#160;take&#160;on the&#160;<br/>default&#160;attributes&#160;of the&#160;user performing the&#160;<br/>copy.&#160;We'll&#160;take&#160;a&#160;look at&#160;file&#160;permissions&#160;in&#160;<br/>Chapter 9 &#34;Permissions.&#34;<br/>
-i<br/>
--interactive<br/>
Before&#160;overwriting&#160;an existing&#160;file,&#160;prompt&#160;the&#160;<br/>user for confirmation.&#160;<b>If this&#160;option&#160;is&#160;not&#160;<br/>specified,&#160;cp&#160;will&#160;silently (meaning there&#160;will<br/>be&#160;no warning) overwrite&#160;files.</b>&#160;<br/>
-r<br/>
--recursive<br/>
Recursively copy&#160;directories&#160;and their contents.<br/>This&#160;option (or the&#160;-a&#160;option) is&#160;required when<br/>copying&#160;directories.<br/>
-u<br/>
--update<br/>
When&#160;copying files&#160;from&#160;one&#160;directory&#160;to&#160;<br/>another, only&#160;copy files&#160;that&#160;either&#160;don't&#160;exist&#160;or<br/>are&#160;newer than&#160;the&#160;existing corresponding&#160;files,<br/>in&#160;the&#160;destination&#160;directory.&#160;This&#160;is&#160;useful&#160;when<br/>copying&#160;large&#160;numbers&#160;of files&#160;as&#160;it&#160;skips&#160;files&#160;<br/>that&#160;don't&#160;need&#160;to be&#160;copied.<br/>
-v<br/>
--verbose<br/>
Display&#160;informative&#160;messages&#160;as&#160;the&#160;copy is&#160;<br/>performed.<br/>
<i>Table&#160;4-5:&#160;cp&#160;Examples</i><br/>
<b>Command</b><br/>
<b>Results</b><br/>
cp&#160;<i>file1</i>&#160;<i>file2</i><br/>
Copy&#160;<i>file1</i>&#160;to&#160;<i>file2</i>.&#160;<b>If&#160;<i>file2</i></b><b>&#160;exists, it&#160;is&#160;overwritten&#160;<br/>with&#160;the&#160;contents&#160;of&#160;<i>file1</i></b><b>.</b>&#160;If&#160;<i>file2</i>&#160;does&#160;not&#160;exist, it&#160;<br/>
29<br/>
<hr/>
<a name=54></a>4 – Manipulating Files&#160;and Directories<br/>
is&#160;created.<br/>
cp -i&#160;<i>file1</i>&#160;<i>file2</i><br/>
Same&#160;as&#160;previous&#160;command, except&#160;that&#160;if&#160;<i>file2</i>&#160;<br/>exists,&#160;the&#160;user is&#160;prompted&#160;before&#160;it&#160;is&#160;overwritten.<br/>
cp&#160;<i>file1</i>&#160;<i>file2</i>&#160;<i>dir1</i><br/>
Copy&#160;<i>file1</i>&#160;and&#160;<i>file2</i>&#160;into directory&#160;<i>dir1</i>.&#160;The&#160;<br/>directory&#160;<i>dir1</i>&#160;must&#160;already&#160;exist.<br/>
cp dir1/* dir2<br/>
Using a&#160;wildcard, copy all&#160;the&#160;files&#160;in&#160;<i>dir1</i>&#160;into&#160;<br/><i>dir2</i>.&#160;The&#160;directory&#160;<i>dir2</i>&#160;must&#160;already exist.<br/>
cp -r&#160;<i>dir1</i>&#160;<i>dir2</i><br/>
Copy the&#160;contents&#160;of directory&#160;<i>dir1</i>&#160;to directory&#160;<br/><i>dir2</i>. If directory&#160;<i>dir2</i>&#160;does&#160;not&#160;exist, it&#160;is&#160;created&#160;<br/>and,&#160;after the&#160;copy, will&#160;contain the&#160;same&#160;contents&#160;<br/>as&#160;directory&#160;<i>dir1</i>.<br/>If directory&#160;<i>dir2</i>&#160;does&#160;exist,&#160;then directory&#160;<i>dir1</i>&#160;(and<br/>its&#160;contents) will&#160;be&#160;copied into&#160;<i>dir2</i>.&#160;<br/>
<b>mv&#160;–&#160;Move&#160;and&#160;Rename&#160;Files<br/></b>The&#160;mv&#160;command&#160;performs&#160;both&#160;file&#160;moving&#160;and&#160;file&#160;renaming,&#160;depending&#160;on&#160;how&#160;it&#160;is<br/>used.&#160;In&#160;either&#160;case,&#160;the&#160;original&#160;filename&#160;no&#160;longer&#160;exists&#160;after&#160;the&#160;operation.&#160;mv&#160;is&#160;used<br/>in much&#160;the&#160;same&#160;way as&#160;cp, as&#160;shown here:<br/>
<b>mv&#160;<i>item1</i></b><b>&#160;<i>item2</i></b><br/>
to move&#160;or rename&#160;the&#160;file&#160;or directory&#160;item1&#160;to&#160;item2&#160;or:<br/>
<b>mv&#160;<i>item</i></b><b>...&#160;<i>directory</i></b><br/>
to move&#160;one&#160;or more&#160;items&#160;from&#160;one&#160;directory to&#160;another.<br/>
Useful&#160;Options&#160;and&#160;Examples<br/>mv&#160;shares&#160;many of the&#160;same&#160;options&#160;as&#160;cp&#160;as&#160;described in&#160;Table&#160;4-6.<br/>
<i>Table&#160;4-6:&#160;mv&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Meaning</b><br/>
-i<br/>
--interactive<br/>
Before&#160;overwriting&#160;an existing&#160;file,&#160;prompt&#160;the&#160;<br/>
30<br/>
<hr/>
<a name=55></a>mv&#160;– Move&#160;and Rename&#160;Files<br/>
user for confirmation.&#160;<b>If this&#160;option&#160;is&#160;not&#160;<br/>specified,&#160;mv&#160;will&#160;silently overwrite&#160;files.</b>&#160;<br/>
-u<br/>
--update<br/>
When&#160;moving files&#160;from&#160;one&#160;directory&#160;to&#160;<br/>another, only&#160;move&#160;files&#160;that&#160;either&#160;don't&#160;exist,&#160;<br/>or are&#160;newer than&#160;the&#160;existing corresponding&#160;<br/>files&#160;in the&#160;destination directory.<br/>
-v<br/>
--verbose<br/>
Display&#160;informative&#160;messages&#160;as&#160;the&#160;move&#160;is&#160;<br/>performed.<br/>
Table&#160;4-7 provides&#160;some&#160;examples&#160;of&#160;mv&#160;usage.<br/>
<i>Table&#160;4-7:&#160;mv&#160;Examples</i><br/>
<b>Command</b><br/>
<b>Results</b><br/>
mv&#160;<i>file1</i>&#160;<i>file2</i><br/>
Move&#160;<i>file1</i>&#160;to&#160;<i>file2</i>.&#160;<b>If&#160;<i>file2</i></b><b>&#160;exists, it&#160;is&#160;overwritten&#160;<br/>with&#160;the&#160;contents&#160;of&#160;<i>file1</i></b><b>.</b>&#160;If&#160;<i>file2</i>&#160;does&#160;not&#160;exist, it&#160;<br/>is&#160;created.&#160;<b>In&#160;either&#160;case,&#160;<i>file1</i></b><b>&#160;ceases&#160;to exist.</b><br/>
mv -i&#160;<i>file1</i>&#160;<i>file2</i><br/>
Same&#160;as&#160;the&#160;previous&#160;command,&#160;except&#160;that&#160;if&#160;<i>file2</i>&#160;<br/>exists,&#160;the&#160;user is&#160;prompted&#160;before&#160;it&#160;is&#160;overwritten.<br/>
mv&#160;<i>file1</i>&#160;<i>file2</i>&#160;<i>dir1</i><br/>
Move&#160;<i>file1</i>&#160;and&#160;<i>file2</i>&#160;into directory&#160;<i>dir1</i>.&#160;The&#160;<br/>dierctory&#160;<i>dir1</i>&#160;must&#160;already&#160;exist.<br/>
mv&#160;<i>dir1</i>&#160;<i>dir2</i><br/>
If directory&#160;<i>dir2</i>&#160;does&#160;not&#160;exist, create&#160;directory&#160;<br/><i>dir2</i>&#160;and&#160;move&#160;the&#160;contents&#160;of directory&#160;<i>dir1</i>&#160;into&#160;<br/><i>dir2</i>&#160;and&#160;delete&#160;directory&#160;<i>dir1</i>.<br/>If directory&#160;<i>dir2</i>&#160;does&#160;exist,&#160;move&#160;directory&#160;<i>dir1</i>&#160;<br/>(and&#160;its&#160;contents) into directory&#160;<i>dir2</i>.<br/>
<b>rm&#160;–&#160;Remove&#160;Files&#160;and&#160;Directories<br/></b>The&#160;rm&#160;command is&#160;used to&#160;remove&#160;(delete)&#160;files&#160;and directories, as&#160;shown here:<br/>
<b>rm&#160;<i>item</i></b><b>...</b><br/>
where&#160;item&#160;is&#160;one&#160;or more&#160;files&#160;or directories.<br/>
31<br/>
<hr/>
<a name=56></a>4 – Manipulating Files&#160;and Directories<br/>
Useful&#160;Options&#160;and&#160;Examples<br/>Table&#160;4-8 describes&#160;some&#160;of the&#160;common&#160;options&#160;for&#160;rm.<br/>
<i>Table&#160;4-8:&#160;rm&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Meaning</b><br/>
-i<br/>
--interactive<br/>
Before&#160;deleting&#160;an existing&#160;file,&#160;prompt&#160;the&#160;user&#160;<br/>for confirmation.&#160;<b>If this&#160;option&#160;is&#160;not specified,<br/>rm&#160;will&#160;silently delete&#160;files.</b>&#160;<br/>
-r<br/>
--recursive<br/>
Recursively&#160;delete&#160;directories.&#160;This&#160;means&#160;that&#160;if<br/>a&#160;directory being&#160;deleted has&#160;subdirectories,&#160;<br/>delete&#160;them&#160;too.&#160;To delete&#160;a&#160;directory, this&#160;option<br/>must&#160;be&#160;specified.<br/>
-f<br/>
--force<br/>
Ignore&#160;nonexistent&#160;files&#160;and do not&#160;prompt.&#160;This&#160;<br/>overrides&#160;the&#160;--interactive&#160;option.&#160;<br/>
-v<br/>
--verbose<br/>
Display informative&#160;messages&#160;as&#160;the&#160;deletion&#160;is&#160;<br/>performed.<br/>
Table&#160;4-9 provides&#160;some&#160;examples&#160;of using the&#160;rm&#160;command.<br/><i>Table&#160;4-9:&#160;rm&#160;Examples</i><br/>
<b>Command</b><br/>
<b>Results</b><br/>
rm&#160;<i>file1</i><br/>
Delete&#160;<i>file1</i>&#160;silently.<br/>
rm -i&#160;<i>file1</i><br/>
Same&#160;as&#160;the&#160;previous&#160;command,&#160;except&#160;that&#160;the&#160;<br/>user is&#160;prompted for confirmation&#160;before&#160;the&#160;<br/>deletion&#160;is&#160;performed.<br/>
rm -r&#160;<i>file1</i>&#160;<i>dir1</i><br/>
Delete<i>&#160;file1</i>&#160;and&#160;<i>dir1</i>&#160;and&#160;its&#160;contents.<br/>
rm -rf&#160;<i>file1</i>&#160;<i>dir1</i><br/>
Same&#160;as&#160;the&#160;previous&#160;command,&#160;except&#160;that&#160;if&#160;<br/>either&#160;<i>file1</i>&#160;or&#160;<i>dir1</i>&#160;do not&#160;exist,&#160;rm&#160;will&#160;continue&#160;<br/>silently.<br/>
32<br/>
<hr/>
<a name=57></a>rm&#160;– Remove&#160;Files&#160;and Directories<br/>
<b>Be&#160;Careful&#160;with&#160;rm!</b><br/>
Unix-like&#160;operating&#160;systems&#160;such&#160;as&#160;Linux&#160;do&#160;not&#160;have&#160;an&#160;undelete&#160;command.<br/>Once&#160;you&#160;delete&#160;something&#160;with&#160;&#160;rm,&#160;it's&#160;gone.&#160;Linux&#160;assumes&#160;you're&#160;smart&#160;and<br/>you know&#160;what&#160;you're&#160;doing.<br/>Be&#160;particularly&#160;careful&#160;with&#160;wildcards.&#160;Consider&#160;this&#160;classic&#160;example.&#160;Let's&#160;say<br/>you&#160;want&#160;to&#160;delete&#160;just&#160;the&#160;HTML&#160;files&#160;in&#160;a&#160;directory.&#160;To&#160;do&#160;this,&#160;you&#160;type&#160;the&#160;fol-<br/>lowing:<br/>rm *.html<br/>This&#160;&#160;is&#160;&#160;correct,&#160;&#160;but&#160;&#160;&#160;if&#160;&#160;you&#160;&#160;accidentally&#160;&#160;place&#160;&#160;&#160;a&#160;&#160;space&#160;&#160;between&#160;&#160;&#160;the&#160;&#160;*&#160;&#160;and&#160;the<br/>.html&#160;like&#160;so:<br/>rm * .html<br/>the&#160;rm&#160;command&#160;will&#160;delete&#160;all&#160;the&#160;files&#160;in&#160;the&#160;directory&#160;and&#160;then&#160;complain&#160;that<br/>there&#160;is&#160;no file&#160;called&#160;.html.<br/><b>Here&#160;is&#160;a&#160;useful&#160;tip:</b>&#160;&#160;whenever&#160;you&#160;use&#160;wildcards&#160;with&#160;&#160;rm&#160;&#160;(besides&#160;carefully<br/>checking&#160;your&#160;typing!),&#160;test&#160;the&#160;wildcard&#160;first&#160;with&#160;ls.&#160;This&#160;will&#160;let&#160;you&#160;see&#160;the<br/>files&#160;that&#160;will&#160;be&#160;deleted.&#160;Then&#160;press&#160;the&#160;up&#160;arrow&#160;key&#160;to&#160;recall&#160;the&#160;command&#160;and<br/>replace&#160;ls&#160;with&#160;rm.<br/>
<b>ln&#160;–&#160;Create&#160;Links<br/></b>The&#160;ln&#160;command&#160;is&#160;used&#160;to&#160;create&#160;either&#160;hard&#160;or&#160;symbolic&#160;links.&#160;It&#160;is&#160;used&#160;in&#160;one&#160;of&#160;two<br/>ways.&#160;The&#160;following creates&#160;a&#160;hard link:<br/>
<b>ln&#160;<i>file</i></b><b>&#160;<i>link</i></b><br/>
The&#160;following creates&#160;a&#160;symbolic&#160;link:<br/>
<b>ln -s&#160;<i>item</i></b><b>&#160;<i>link</i></b><br/>
to create&#160;a&#160;symbolic&#160;link where&#160;item&#160;is&#160;either a&#160;file&#160;or a&#160;directory.<br/>
Hard&#160;Links<br/>Hard links&#160;are&#160;the&#160;original&#160;Unix way&#160;of creating&#160;links,&#160;compared&#160;to symbolic&#160;links,&#160;which<br/>
33<br/>
<hr/>
<a name=58></a>4 – Manipulating Files&#160;and Directories<br/>
are&#160;more&#160;modern.&#160;By&#160;default,&#160;every&#160;file&#160;has&#160;a&#160;single&#160;hard&#160;link&#160;that&#160;gives&#160;the&#160;file&#160;its&#160;name.<br/>When&#160;we&#160;create&#160;a&#160;hard&#160;link,&#160;we&#160;create&#160;an&#160;additional&#160;directory&#160;entry&#160;for&#160;a&#160;file.&#160;&#160;Hard&#160;links<br/>have&#160;two important&#160;limitations:<br/>
1.&#160;A&#160;hard&#160;link&#160;cannot&#160;reference&#160;a&#160;file&#160;outside&#160;its&#160;own&#160;file&#160;system.&#160;This&#160;means&#160;a&#160;link<br/>
cannot&#160;reference&#160;a&#160;file&#160;that&#160;is&#160;not&#160;on the&#160;same&#160;disk partition&#160;as&#160;the&#160;link itself.<br/>
2.&#160;A&#160;hard link&#160;may not&#160;reference&#160;a&#160;directory.<br/>
A&#160;hard&#160;link&#160;is&#160;indistinguishable&#160;from&#160;the&#160;file&#160;itself.&#160;Unlike&#160;a&#160;symbolic&#160;link,&#160;when&#160;we&#160;list&#160;a<br/>directory&#160;containing&#160;a&#160;hard&#160;link&#160;we&#160;will&#160;see&#160;no&#160;special&#160;indication&#160;of&#160;the&#160;link.&#160;When&#160;a&#160;hard<br/>link&#160;is&#160;deleted,&#160;the&#160;link&#160;is&#160;removed&#160;but&#160;the&#160;contents&#160;of&#160;the&#160;file&#160;itself&#160;continue&#160;to&#160;exist&#160;(that<br/>is, its&#160;space&#160;is&#160;not&#160;deallocated) until&#160;all&#160;links&#160;to&#160;the&#160;file&#160;are&#160;deleted.<br/>It&#160;is&#160;important&#160;to&#160;be&#160;aware&#160;of&#160;hard&#160;links&#160;because&#160;you&#160;might&#160;encounter&#160;them&#160;from&#160;time&#160;to<br/>time, but&#160;modern&#160;practice&#160;prefers&#160;symbolic&#160;links, which we&#160;will&#160;cover next.<br/>
Symbolic&#160;Links<br/>Symbolic&#160;links&#160;were&#160;created&#160;to&#160;overcome&#160;the&#160;limitations&#160;of&#160;hard&#160;links.&#160;Symbolic&#160;links<br/>work&#160;by&#160;creating&#160;a&#160;special&#160;type&#160;of&#160;file&#160;that&#160;contains&#160;a&#160;text&#160;pointer&#160;to&#160;the&#160;referenced&#160;file&#160;or<br/>directory.&#160;In&#160;this&#160;regard,&#160;they&#160;operate&#160;in&#160;much&#160;the&#160;same&#160;way&#160;as&#160;a&#160;Windows&#160;shortcut,<br/>though of course&#160;they&#160;predate&#160;the&#160;Windows&#160;feature&#160;by many years.<br/>A&#160;file&#160;pointed&#160;to&#160;by&#160;a&#160;symbolic&#160;link,&#160;and&#160;the&#160;symbolic&#160;link&#160;itself&#160;are&#160;largely&#160;indistinguish-<br/>able&#160;from&#160;one&#160;another.&#160;For&#160;example,&#160;if we&#160;write&#160;something&#160;to&#160;the&#160;symbolic&#160;link,&#160;the&#160;refer-<br/>enced&#160;file&#160;is&#160;written&#160;to.&#160;However&#160;when&#160;we&#160;delete&#160;a&#160;symbolic&#160;link,&#160;only&#160;the&#160;link&#160;is&#160;deleted,<br/>not&#160;the&#160;file&#160;itself.&#160;If&#160;the&#160;file&#160;is&#160;deleted&#160;before&#160;the&#160;symbolic&#160;link,&#160;the&#160;link&#160;will&#160;continue&#160;to<br/>exist&#160;but&#160;will&#160;point&#160;to&#160;nothing.&#160;In&#160;this&#160;case,&#160;the&#160;link&#160;is&#160;said&#160;to&#160;be&#160;<i>broken</i>.&#160;In&#160;many&#160;imple-<br/>mentations,&#160;the&#160;ls&#160;command&#160;will&#160;display&#160;broken&#160;links&#160;in&#160;a&#160;distinguishing&#160;color,&#160;such&#160;as<br/>red, to reveal&#160;their presence.<br/>The&#160;concept&#160;of&#160;links&#160;can&#160;seem&#160;confusing,&#160;but&#160;hang&#160;in&#160;there.&#160;We're&#160;going&#160;to&#160;try&#160;all&#160;this<br/>stuff and it&#160;will, hopefully, become&#160;clear.&#160;<br/>
<b>Let's&#160;Build&#160;a&#160;Playground<br/></b>Since&#160;we&#160;are&#160;going&#160;to&#160;do&#160;some&#160;real&#160;file&#160;manipulation,&#160;let's&#160;build&#160;a&#160;safe&#160;place&#160;to&#160;“play”<br/>with&#160;our&#160;file&#160;manipulation&#160;commands.&#160;First&#160;we&#160;need&#160;a&#160;directory&#160;to&#160;work&#160;in.&#160;We'll&#160;create<br/>one&#160;in our home&#160;directory and call&#160;it&#160;playground.<br/>
Creating&#160;Directories<br/>The&#160;mkdir&#160;command is&#160;used to&#160;create&#160;a&#160;directory.&#160;To create&#160;our playground directory we<br/>will&#160;first&#160;make&#160;sure&#160;we&#160;are&#160;in our home&#160;directory and will&#160;then&#160;create&#160;the&#160;new&#160;directory.<br/>
34<br/>
<hr/>
<a name=59></a>Let's&#160;Build&#160;a&#160;Playground<br/>
[me@linuxbox ~]$&#160;<b>cd<br/></b>[me@linuxbox ~]$&#160;<b>mkdir playground</b><br/>
To make&#160;our playground&#160;a&#160;little&#160;more&#160;interesting,&#160;let's&#160;create&#160;a&#160;couple&#160;of directories&#160;inside<br/>it&#160;called&#160;&#160;dir1&#160;and&#160;dir2.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;change&#160;our&#160;current&#160;working&#160;directory&#160;to<br/>playground&#160;and execute&#160;another&#160;mkdir.<br/>
[me@linuxbox ~]$&#160;<b>cd playground<br/></b>[me@linuxbox playground]$&#160;<b>mkdir dir1 dir2</b><br/>
Notice&#160;that&#160;the&#160;&#160;mkdir&#160;&#160;command&#160;will&#160;accept&#160;multiple&#160;arguments&#160;allowing&#160;us&#160;to&#160;create<br/>both directories&#160;with a&#160;single&#160;command.<br/>
Copying&#160;Files<br/>Next,&#160;let's&#160;get&#160;some&#160;data&#160;into&#160;our&#160;playground.&#160;We'll&#160;do&#160;this&#160;by&#160;copying&#160;a&#160;file.&#160;Using&#160;the<br/>cp&#160;command,&#160;we'll&#160;copy&#160;the&#160;passwd&#160;file&#160;from&#160;the&#160;/etc&#160;directory&#160;to&#160;the&#160;current&#160;work-<br/>ing directory.<br/>
[me@linuxbox playground]$&#160;<b>cp /etc/passwd .</b><br/>
Notice&#160;how&#160;we&#160;used&#160;shorthand&#160;for&#160;the&#160;current&#160;working&#160;directory,&#160;the&#160;single&#160;trailing&#160;pe-<br/>riod. So now&#160;if we&#160;perform&#160;an&#160;ls, we&#160;will&#160;see&#160;our file.<br/>
[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 12<br/>drwxrwxr-x 2 me &#160;me 4096 2018-01-10 16:40 dir1<br/>drwxrwxr-x 2 me &#160;me 4096 2018-01-10 16:40 dir2<br/>-rw-r--r-- 1 me &#160;me 1650 2018-01-10 16:07 passwd<br/>
Now, just&#160;for fun, let's&#160;repeat&#160;the&#160;copy&#160;using&#160;the&#160;“-v”&#160;option (verbose)&#160;to see&#160;what&#160;it&#160;does.<br/>
[me@linuxbox playground]$&#160;<b>cp -v /etc/passwd .<br/></b>`/etc/passwd' -&gt; `./passwd'<br/>
The&#160;cp&#160;command&#160;performed&#160;the&#160;copy&#160;again,&#160;but&#160;this&#160;time&#160;displayed&#160;a&#160;concise&#160;message<br/>indicating&#160;what&#160;operation&#160;it&#160;was&#160;performing.&#160;Notice&#160;that&#160;&#160;cp&#160;&#160;overwrote&#160;the&#160;first&#160;copy<br/>
35<br/>
<hr/>
<a name=60></a>4 – Manipulating Files&#160;and Directories<br/>
without&#160;any&#160;warning.&#160;Again&#160;this&#160;is&#160;a&#160;case&#160;of&#160;cp&#160;assuming that&#160;we&#160;know&#160;what&#160;we're&#160;doing.<br/>To get&#160;a&#160;warning,&#160;we'll&#160;include&#160;the&#160;“-i”&#160;(interactive)&#160;option.<br/>
[me@linuxbox playground]$&#160;<b>cp -i /etc/passwd .<br/></b>cp: overwrite `./passwd'?<br/>
Responding&#160;to&#160;the&#160;prompt&#160;by&#160;entering&#160;a&#160;y&#160;will&#160;cause&#160;the&#160;file&#160;to&#160;be&#160;overwritten,&#160;any&#160;other<br/>character (for example,&#160;n) will&#160;cause&#160;cp&#160;to leave&#160;the&#160;file&#160;alone.<br/>
Moving&#160;and&#160;Renaming&#160;Files<br/>Now,&#160;the&#160;name&#160;&#160;passwd&#160;&#160;doesn't&#160;seem&#160;very&#160;playful&#160;and&#160;this&#160;is&#160;a&#160;playground,&#160;so&#160;let's<br/>change&#160;it&#160;to&#160;something else.<br/>
[me@linuxbox playground]$&#160;<b>mv&#160;passwd fun</b><br/>
Let's&#160;pass&#160;the&#160;fun around a&#160;little&#160;by moving our renamed file&#160;to&#160;each of the&#160;directories&#160;and<br/>back again.&#160;The&#160;following moves&#160;it&#160;first&#160;to&#160;the&#160;directory&#160;dir1:<br/>
[me@linuxbox playground]$&#160;<b>mv fun dir1</b><br/>
The&#160;following then&#160;moves&#160;it&#160;from&#160;dir1&#160;to&#160;dir2:<br/>
[me@linuxbox playground]$&#160;<b>mv dir1/fun dir2</b><br/>
Finally,&#160;the&#160;following brings&#160;it&#160;back to&#160;the&#160;current&#160;working directory:<br/>
[me@linuxbox playground]$&#160;<b>mv dir2/fun .</b><br/>
Next,&#160;let's&#160;see&#160;the&#160;effect&#160;of&#160;mv&#160;on&#160;directories.&#160;First&#160;we&#160;will&#160;move&#160;our&#160;data&#160;file&#160;into&#160;dir1<br/>again,&#160;like&#160;this:<br/>
[me@linuxbox playground]$&#160;<b>mv fun dir1</b><br/>
Then we&#160;move&#160;dir1&#160;into&#160;dir2&#160;and&#160;confirm&#160;it&#160;with&#160;ls.<br/>
36<br/>
<hr/>
<a name=61></a>Let's&#160;Build&#160;a&#160;Playground<br/>
[me@linuxbox playground]$&#160;<b>mv dir1 dir2<br/></b>[me@linuxbox playground]$&#160;<b>ls -l dir2<br/></b>total 4<br/>drwxrwxr-x 2 me &#160;me &#160; 4096 2018-01-11 06:06 dir1<br/>[me@linuxbox playground]$&#160;<b>ls -l dir2/dir1<br/></b>total 4<br/>-rw-r--r-- 1 me &#160;me &#160; 1650 2018-01-10 16:33 fun<br/>
Note&#160;that&#160;since&#160;dir2&#160;already&#160;existed,&#160;mv&#160;moved&#160;dir1&#160;into&#160;dir2.&#160;If&#160;dir2&#160;had&#160;not&#160;ex-<br/>isted,&#160;mv&#160;would have&#160;renamed&#160;dir1&#160;to&#160;dir2. Lastly, let's&#160;put&#160;everything back.<br/>
[me@linuxbox playground]$&#160;<b>mv dir2/dir1 .<br/></b>[me@linuxbox playground]$&#160;<b>mv dir1/fun .</b><br/>
Creating&#160;Hard&#160;Links<br/>Now&#160;we'll&#160;try&#160;some&#160;links.&#160;We’ll&#160;first&#160;create&#160;some&#160;hard&#160;links&#160;to our data&#160;file&#160;like&#160;so:<br/>
[me@linuxbox playground]$&#160;<b>ln fun fun-hard<br/></b>[me@linuxbox playground]$&#160;<b>ln fun dir1/fun-hard<br/></b>[me@linuxbox playground]$&#160;<b>ln fun dir2/fun-hard</b><br/>
So&#160;now&#160;we&#160;have&#160;four&#160;instances&#160;of&#160;the&#160;file&#160;fun.&#160;Let's&#160;take&#160;a&#160;look&#160;at&#160;our&#160;playground&#160;direc-<br/>tory.<br/>
[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 16<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-14 16:17 dir1<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-14 16:17 dir2<br/>-rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun<br/>-rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun-hard<br/>
One&#160;thing&#160;we&#160;notice&#160;is&#160;that&#160;both&#160;the&#160;second&#160;fields&#160;in&#160;the&#160;listings&#160;for&#160;fun&#160;and&#160;fun-hard<br/>contain&#160;a&#160;4&#160;which&#160;is&#160;the&#160;number&#160;of&#160;hard&#160;links&#160;that&#160;now&#160;exist&#160;for&#160;the&#160;file.&#160;Remember&#160;that&#160;a<br/>file&#160;will&#160;always&#160;have&#160;at&#160;least&#160;one&#160;link&#160;because&#160;the&#160;file's&#160;name&#160;is&#160;created&#160;by a&#160;link.&#160;So,&#160;how<br/>do&#160;we&#160;know&#160;that&#160;fun&#160;and&#160;fun-hard&#160;are,&#160;in&#160;fact,&#160;the&#160;same&#160;file?&#160;In&#160;this&#160;case,&#160;ls&#160;is&#160;not<br/>very&#160;helpful.&#160;While&#160;we&#160;can&#160;see&#160;that&#160;fun&#160;and&#160;fun-hard&#160;are&#160;both&#160;the&#160;same&#160;size&#160;(field&#160;5),<br/>our&#160;listing&#160;provides&#160;no&#160;way&#160;to&#160;be&#160;sure.&#160;To&#160;solve&#160;this&#160;problem,&#160;we're&#160;going&#160;to&#160;have&#160;to&#160;dig&#160;a<br/>
37<br/>
<hr/>
<a name=62></a>4 – Manipulating Files&#160;and Directories<br/>
little&#160;deeper.<br/>When&#160;thinking&#160;about&#160;hard&#160;links,&#160;it&#160;is&#160;helpful&#160;to&#160;imagine&#160;that&#160;files&#160;are&#160;made&#160;up&#160;of&#160;two<br/>parts.<br/>
1.&#160;The&#160;data&#160;part&#160;containing the&#160;file's&#160;contents.<br/>2.&#160;The&#160;name&#160;part&#160;that&#160;holds&#160;the&#160;file's&#160;name.<br/>
When&#160;we&#160;create&#160;hard&#160;links,&#160;we&#160;are&#160;actually&#160;creating&#160;additional&#160;name&#160;parts&#160;that&#160;all&#160;refer&#160;to<br/>the&#160;same&#160;data&#160;part.&#160;The&#160;system&#160;assigns&#160;a&#160;chain&#160;of&#160;disk&#160;blocks&#160;to&#160;what&#160;is&#160;called&#160;an&#160;<i>inode</i>,<br/>which&#160;is&#160;then&#160;associated&#160;with&#160;the&#160;name&#160;part.&#160;Each&#160;hard&#160;link&#160;therefore&#160;refers&#160;to&#160;a&#160;specific<br/>inode&#160;containing&#160;the&#160;file's&#160;contents.<br/>The&#160;ls&#160;command has&#160;a&#160;way to reveal&#160;this&#160;information.&#160;It&#160;is&#160;invoked&#160;with the&#160;-i&#160;option.<br/>
[me@linuxbox playground]$&#160;<b>ls -li<br/></b>total 16<br/>12353539 drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-14 16:17 dir1<br/>12353540 drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-14 16:17 dir2<br/>12353538 -rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun<br/>12353538 -rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun-hard<br/>
In&#160;this&#160;version&#160;of&#160;the&#160;listing,&#160;the&#160;first&#160;field&#160;is&#160;the&#160;inode&#160;number&#160;and,&#160;as&#160;we&#160;can&#160;see,&#160;both<br/>fun&#160;&#160;and&#160;&#160;fun-hard&#160;&#160;share&#160;the&#160;same&#160;inode&#160;number,&#160;which&#160;confirms&#160;they&#160;are&#160;the&#160;same<br/>file.<br/>
Creating&#160;Symbolic&#160;Links<br/>Symbolic&#160;links&#160;were&#160;created&#160;to overcome&#160;the&#160;two disadvantages&#160;of hard links.<br/>
1.&#160;Hard links&#160;cannot&#160;span physical&#160;devices.<br/>2.&#160;Hard links&#160;cannot&#160;reference&#160;directories,&#160;only files.<br/>
Symbolic&#160;links&#160;are&#160;a&#160;special&#160;type&#160;of&#160;file&#160;that&#160;contains&#160;a&#160;text&#160;pointer&#160;to&#160;the&#160;target&#160;file&#160;or&#160;di-<br/>rectory.<br/>Creating&#160;symbolic&#160;links&#160;is&#160;similar to&#160;creating hard links.<br/>
[me@linuxbox playground]$&#160;<b>ln -s fun fun-sym<br/></b>[me@linuxbox playground]$&#160;<b>ln -s ../fun dir1/fun-sym<br/></b>[me@linuxbox playground]$&#160;<b>ln -s ../fun dir2/fun-sym</b><br/>
The&#160;first&#160;example&#160;is&#160;pretty&#160;straightforward;&#160;we&#160;simply&#160;add&#160;the&#160;“-s”&#160;option&#160;to&#160;create&#160;a<br/>
38<br/>
<hr/>
<a name=63></a>Let's&#160;Build&#160;a&#160;Playground<br/>
symbolic&#160;link&#160;rather&#160;than&#160;a&#160;hard&#160;link.&#160;But&#160;what&#160;about&#160;the&#160;next&#160;two?&#160;Remember,&#160;when&#160;we<br/>create&#160;a&#160;symbolic&#160;link,&#160;we&#160;are&#160;creating&#160;a&#160;text&#160;description&#160;of&#160;where&#160;the&#160;target&#160;file&#160;is&#160;rela-<br/>tive&#160;to the&#160;symbolic&#160;link. It's&#160;easier&#160;to see&#160;if we&#160;look&#160;at&#160;the&#160;ls&#160;output&#160;shown here:<br/>
[me@linuxbox playground]$&#160;<b>ls -l dir1<br/></b>total 4<br/>-rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun-hard<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;6 2018-01-15 15:17 fun-sym -&gt; ../fun<br/>
The&#160;listing&#160;for&#160;fun-sym&#160;in&#160;dir1&#160;shows&#160;that&#160;it&#160;is&#160;a&#160;symbolic&#160;link&#160;by&#160;the&#160;leading&#160;l&#160;in&#160;the<br/>first&#160;field&#160;and&#160;that&#160;it&#160;points&#160;to&#160;../fun,&#160;which&#160;is&#160;correct.&#160;Relative&#160;to&#160;the&#160;location&#160;of&#160;fun-<br/>sym,&#160;fun&#160;is&#160;in&#160;the&#160;directory&#160;above&#160;it.&#160;Notice&#160;too,&#160;that&#160;the&#160;length&#160;of&#160;the&#160;symbolic&#160;link&#160;file<br/>is&#160;6,&#160;the&#160;number&#160;of&#160;characters&#160;in&#160;the&#160;string&#160;../fun&#160;rather&#160;than&#160;the&#160;length&#160;of&#160;the&#160;file&#160;to<br/>which it&#160;is&#160;pointing.<br/>When creating&#160;symbolic&#160;links, we&#160;can either&#160;use&#160;absolute&#160;pathnames, as&#160;shown here:<br/>
[me@linuxbox playground]$&#160;<b>ln -s /home/me/playground/fun dir1/fun-sym</b><br/>
or&#160;relative&#160;pathnames,&#160;as&#160;we&#160;did&#160;in&#160;our&#160;earlier&#160;example.&#160;In&#160;most&#160;cases,&#160;using&#160;relative<br/>pathnames&#160;is&#160;more&#160;desirable&#160;because&#160;it&#160;allows&#160;a&#160;directory&#160;tree&#160;containing&#160;symbolic&#160;links<br/>and their&#160;referenced files&#160;to be&#160;renamed and/or moved&#160;without&#160;breaking the&#160;links.<br/>In addition to regular files, symbolic&#160;links&#160;can&#160;also reference&#160;directories.<br/>
[me@linuxbox playground]$&#160;<b>ln -s dir1 dir1-sym<br/></b>[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 16<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir1<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;4 2018-01-16 14:45 dir1-sym -&gt; dir1<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir2<br/>-rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun<br/>-rw-r--r-- 4 me &#160; me &#160; 1650 2018-01-10 16:33 fun-hard<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;3 2018-01-15 15:15 fun-sym -&gt; fun<br/>
Removing&#160;Files&#160;and&#160;Directories<br/>As&#160;we&#160;covered&#160;earlier,&#160;the&#160;rm&#160;command&#160;is&#160;used&#160;to&#160;delete&#160;files&#160;and&#160;directories.&#160;We&#160;are&#160;go-<br/>ing to use&#160;it&#160;to clean up our playground a&#160;little&#160;bit.&#160;First, let's&#160;delete&#160;one&#160;of our hard links.<br/>
39<br/>
<hr/>
<a name=64></a>4 – Manipulating Files&#160;and Directories<br/>
[me@linuxbox playground]$&#160;<b>rm fun-hard<br/></b>[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 12<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir1<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;4 2018-01-16 14:45 dir1-sym -&gt; dir1<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir2<br/>-rw-r--r-- 3 me &#160; me &#160; 1650 2018-01-10 16:33 fun<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;3 2018-01-15 15:15 fun-sym -&gt; fun<br/>
That&#160;worked&#160;as&#160;expected.&#160;The&#160;file&#160;fun-hard&#160;is&#160;gone&#160;and&#160;the&#160;link&#160;count&#160;shown&#160;for&#160;fun<br/>is&#160;reduced&#160;from&#160;four&#160;to&#160;three,&#160;as&#160;indicated&#160;in&#160;the&#160;second&#160;field&#160;of&#160;the&#160;directory&#160;listing.<br/>Next,&#160;we'll&#160;delete&#160;the&#160;file&#160;&#160;fun,&#160;and&#160;just&#160;for&#160;enjoyment,&#160;we'll&#160;include&#160;the&#160;&#160;-i&#160;&#160;option&#160;to<br/>show&#160;what&#160;that&#160;does.<br/>
[me@linuxbox playground]$&#160;<b>rm -i fun<br/></b>rm: remove regular file `fun'?<br/>
Enter&#160;y&#160;at&#160;the&#160;prompt&#160;and&#160;the&#160;file&#160;is&#160;deleted.&#160;But&#160;let's&#160;look&#160;at&#160;the&#160;output&#160;of&#160;ls&#160;now.&#160;No-<br/>tice&#160;what&#160;happened&#160;to&#160;fun-sym?&#160;Since&#160;it's&#160;a&#160;symbolic&#160;link&#160;pointing&#160;to&#160;a&#160;now-nonexis-<br/>tent&#160;file,&#160;the&#160;link&#160;is&#160;<i>broken</i>.<br/>
[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 8<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir1<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;4 2018-01-16 14:45 dir1-sym -&gt; dir1<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir2<br/>lrwxrwxrwx 1 me &#160; me &#160; &#160; &#160;3 2018-01-15 15:15&#160;fun-sym&#160;-&gt;&#160;fun<br/>
Most&#160;Linux&#160;distributions&#160;configure&#160;ls&#160;to&#160;display&#160;broken&#160;links.&#160;The&#160;presence&#160;of&#160;a&#160;broken<br/>link&#160;is&#160;not&#160;in&#160;and&#160;of&#160;itself&#160;dangerous,&#160;but&#160;it&#160;is&#160;rather&#160;messy.&#160;If&#160;we&#160;try&#160;to&#160;use&#160;a&#160;broken&#160;link<br/>we&#160;will&#160;see&#160;this:<br/>
[me@linuxbox playground]$&#160;<b>less fun-sym<br/></b>fun-sym: No such file or directory<br/>
Let's&#160;clean up a&#160;little.&#160;We'll&#160;delete&#160;the&#160;symbolic&#160;links&#160;here:<br/>
40<br/>
<hr/>
<a name=65></a>Let's&#160;Build&#160;a&#160;Playground<br/>
[me@linuxbox playground]$&#160;<b>rm fun-sym dir1-sym<br/></b>[me@linuxbox playground]$&#160;<b>ls -l<br/></b>total 8<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir1<br/>drwxrwxr-x 2 me &#160; me &#160; 4096 2018-01-15 15:17 dir2<br/>
One&#160;thing&#160;to&#160;remember&#160;about&#160;symbolic&#160;links&#160;is&#160;that&#160;most&#160;file&#160;operations&#160;are&#160;carried&#160;out<br/>on&#160;the&#160;link's&#160;target,&#160;not&#160;the&#160;link&#160;itself.&#160;rm&#160;is&#160;an&#160;exception.&#160;When&#160;we&#160;delete&#160;a&#160;link,&#160;it&#160;is&#160;the<br/>link that&#160;is&#160;deleted,&#160;not&#160;the&#160;target.<br/>Finally,&#160;we&#160;will&#160;remove&#160;our&#160;playground.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;return&#160;to&#160;our&#160;home&#160;directory<br/>and&#160;use&#160;rm&#160;with&#160;the&#160;recursive&#160;option&#160;(-r)&#160;to&#160;delete&#160;playground&#160;and&#160;all&#160;of&#160;its&#160;contents,<br/>including its&#160;subdirectories.<br/>
[me@linuxbox playground]$&#160;<b>cd<br/></b>[me@linuxbox ~]$&#160;<b>rm -r playground</b><br/>
<b>Creating&#160;Symlinks&#160;With&#160;The&#160;GUI</b><br/>
The&#160;file&#160;managers&#160;in&#160;both&#160;&#160;GNOME&#160;&#160;and&#160;&#160;KDE&#160;&#160;provide&#160;an&#160;easy&#160;and&#160;automatic<br/>method&#160;of&#160;&#160;creating&#160;&#160;symbolic&#160;links.&#160;With&#160;GNOME,&#160;holding&#160;the&#160;Ctrl+Shift&#160;keys<br/>while&#160;dragging&#160;a&#160;file&#160;will&#160;create&#160;a&#160;link&#160;rather&#160;than&#160;copying&#160;(or&#160;moving)&#160;the&#160;file.&#160;In<br/>KDE, a&#160;small&#160;menu appears&#160;whenever a&#160;file&#160;is&#160;dropped, offering&#160;a&#160;choice&#160;of copy-<br/>ing, moving,&#160;or linking&#160;the&#160;file.<br/>
<b>Summing&#160;Up<br/></b>We've&#160;covered&#160;a&#160;lot&#160;of&#160;ground&#160;here&#160;and&#160;it&#160;will&#160;take&#160;a&#160;while&#160;for&#160;it&#160;all&#160;to&#160;fully&#160;sink&#160;in.&#160;Per-<br/>form&#160;the&#160;playground&#160;exercise&#160;over&#160;and&#160;over&#160;until&#160;it&#160;makes&#160;sense.&#160;It&#160;is&#160;important&#160;to&#160;get&#160;a<br/>good&#160;understanding&#160;of&#160;basic&#160;file&#160;manipulation&#160;commands&#160;and&#160;wildcards.&#160;Feel&#160;free&#160;to&#160;ex-<br/>pand&#160;on&#160;the&#160;playground&#160;exercise&#160;by&#160;adding&#160;more&#160;files&#160;and&#160;directories,&#160;using&#160;wildcards&#160;to<br/>specify&#160;files&#160;for&#160;various&#160;operations.&#160;The&#160;concept&#160;of&#160;links&#160;is&#160;a&#160;little&#160;confusing&#160;at&#160;first,&#160;but<br/>take&#160;the&#160;time&#160;to&#160;learn&#160;how&#160;they&#160;work.&#160;They&#160;can be&#160;a&#160;real&#160;lifesaver.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
A&#160;discussion&#160;of symbolic&#160;links:<a href="http://en.wikipedia.org/wiki/Symbolic_link">&#160;http://en.wikipedia.org/wiki/Symbolic_link</a><br/>
41<br/>
<hr/>
<a name=66></a>5 –&#160;Working&#160;with Commands<br/>
<i><b>5&#160;–&#160;Working&#160;with&#160;Commands</b></i><br/>
Up&#160;to&#160;this&#160;point,&#160;we&#160;have&#160;seen&#160;a&#160;series&#160;of&#160;mysterious&#160;commands,&#160;each&#160;with&#160;its&#160;own&#160;mys-<br/>terious&#160;options&#160;and&#160;arguments.&#160;In&#160;this&#160;chapter,&#160;we&#160;will&#160;attempt&#160;to&#160;remove&#160;some&#160;of&#160;that<br/>mystery&#160;and&#160;even&#160;create&#160;our&#160;own&#160;commands.&#160;The&#160;commands&#160;introduced&#160;in&#160;this&#160;chapter<br/>are:<br/>
●<br/>
type&#160;– Indicate&#160;how&#160;a&#160;command name&#160;is&#160;interpreted<br/>
●<br/>
which&#160;– Display which executable&#160;program&#160;will&#160;be&#160;executed<br/>
●<br/>
help&#160;– Get&#160;help&#160;for shell&#160;builtins<br/>
●<br/>
man&#160;– Display a&#160;command's&#160;manual&#160;page<br/>
●<br/>
apropos&#160;– Display a&#160;list&#160;of appropriate&#160;commands<br/>
●<br/>
info&#160;– Display a&#160;command's&#160;info entry<br/>
●<br/>
whatis&#160;– Display one-line&#160;manual&#160;page&#160;descriptions<br/>
●<br/>
alias&#160;– Create&#160;an alias&#160;for a&#160;command<br/>
<b>What&#160;Exactly&#160;Are&#160;Commands?<br/></b>A&#160;command&#160;can be&#160;one&#160;of four different&#160;things:<br/>
1.&#160;<b>An&#160;executable&#160;program</b>&#160;&#160;like&#160;all&#160;those&#160;files&#160;we&#160;saw&#160;in&#160;&#160;/usr/bin.&#160;Within&#160;this<br/>
category,&#160;programs&#160;can&#160;be&#160;<i>compiled&#160;binaries</i>&#160;such&#160;as&#160;programs&#160;written&#160;in&#160;C&#160;and<br/>C++,&#160;or&#160;programs&#160;written&#160;in&#160;<i>scripting&#160;languages</i>&#160;such&#160;as&#160;the&#160;shell,&#160;Perl,&#160;Python,<br/>Ruby, and so on.<br/>
2.&#160;<b>A&#160;command&#160;built&#160;into the&#160;shell&#160;itself</b>.&#160;bash&#160;supports&#160;a&#160;number&#160;of commands&#160;in-<br/>
ternally called&#160;<i>shell&#160;builtins</i>.&#160;The&#160;cd&#160;command,&#160;for example, is&#160;a&#160;shell&#160;builtin.<br/>
3.&#160;<b>A&#160;shell&#160;function.</b>&#160;Shell&#160;functions&#160;are&#160;miniature&#160;shell&#160;scripts&#160;incorporated&#160;into&#160;the<br/>
<i>environment</i>.&#160;We&#160;will&#160;cover&#160;configuring&#160;the&#160;environment&#160;and&#160;writing&#160;shell&#160;func-<br/>tions&#160;in later&#160;chapters, but&#160;for now, just&#160;be&#160;aware&#160;that&#160;they exist.<br/>
4.&#160;<b>An&#160;&#160;alias.</b>&#160;Aliases&#160;are&#160;commands&#160;that&#160;we&#160;can&#160;define&#160;ourselves,&#160;built&#160;from&#160;other<br/>
commands.<br/>
42<br/>
<hr/>
<a name=67></a>Identifying&#160;Commands<br/>
<b>Identifying&#160;Commands<br/></b>It&#160;is&#160;often&#160;useful&#160;to&#160;know&#160;exactly&#160;which&#160;of&#160;the&#160;four&#160;kinds&#160;of&#160;commands&#160;is&#160;being&#160;used&#160;and<br/>Linux provides&#160;a&#160;couple&#160;of ways&#160;to&#160;find out.<br/>
type&#160;–&#160;Display&#160;a&#160;Command's&#160;Type<br/>The&#160;type&#160;command&#160;is&#160;a&#160;shell&#160;builtin&#160;that&#160;displays&#160;the&#160;kind&#160;of&#160;command&#160;the&#160;shell&#160;will<br/>execute, given&#160;a&#160;particular&#160;command&#160;name.&#160;It&#160;works&#160;like&#160;this:<br/>
<b>type&#160;<i>command</i></b><br/>
where&#160;“command”&#160;is&#160;the&#160;name&#160;of&#160;the&#160;command&#160;we&#160;want&#160;to&#160;examine.&#160;Here&#160;are&#160;some&#160;ex-<br/>amples:<br/>
[me@linuxbox ~]$&#160;<b>type type<br/></b>type is a shell builtin<br/>[me@linuxbox ~]$&#160;<b>type ls<br/></b>ls is aliased to `ls --color=tty'<br/>[me@linuxbox ~]$&#160;<b>type cp<br/></b>cp is /bin/cp<br/>
Here&#160;we&#160;see&#160;the&#160;results&#160;for three&#160;different&#160;commands.&#160;Notice&#160;the&#160;one&#160;for&#160;ls&#160;(taken&#160;from&#160;a<br/>Fedora&#160;system)&#160;and&#160;how&#160;the&#160;ls&#160;command&#160;is&#160;actually&#160;an&#160;alias&#160;for&#160;the&#160;ls&#160;command&#160;with<br/>the&#160;“--color=tty”&#160;option&#160;added.&#160;Now&#160;we&#160;know&#160;why&#160;the&#160;output&#160;from&#160;&#160;ls&#160;is&#160;displayed&#160;in<br/>color!<br/>
which&#160;–&#160;Display&#160;an&#160;Executable's&#160;Location<br/>Sometimes&#160;there&#160;is&#160;more&#160;than&#160;one&#160;version&#160;of&#160;an&#160;executable&#160;program&#160;installed&#160;on&#160;a&#160;sys-<br/>tem.&#160;While&#160;this&#160;is&#160;not&#160;common&#160;on&#160;desktop&#160;systems,&#160;it's&#160;not&#160;unusual&#160;on&#160;large&#160;servers.&#160;To<br/>determine&#160;the&#160;exact&#160;location&#160;of a&#160;given&#160;executable, the&#160;which&#160;command is&#160;used.<br/>
[me@linuxbox ~]$&#160;<b>which ls<br/></b>/bin/ls<br/>
which&#160;only&#160;works&#160;for&#160;executable&#160;programs,&#160;not&#160;builtins&#160;nor&#160;aliases&#160;that&#160;are&#160;substitutes<br/>for&#160;actual&#160;executable&#160;programs.&#160;When&#160;we&#160;try&#160;to&#160;use&#160;which&#160;on&#160;a&#160;shell&#160;builtin&#160;for&#160;exam-<br/>ple,&#160;cd, we&#160;either get&#160;no response&#160;or get&#160;an&#160;error message:<br/>
43<br/>
<hr/>
<a name=68></a>5 –&#160;Working&#160;with Commands<br/>
[me@linuxbox ~]$&#160;<b>which cd<br/></b>/usr/bin/which: no cd in (/usr/local/bin:/usr/bin:/bin:/usr/local<br/>/games:/usr/games)<br/>
This&#160;response&#160;is&#160;a&#160;fancy&#160;way of saying “command not&#160;found.”<br/>
<b>Getting&#160;a&#160;Command's&#160;Documentation<br/></b>With&#160;this&#160;knowledge&#160;of&#160;what&#160;a&#160;command&#160;is,&#160;we&#160;can&#160;now&#160;search&#160;for&#160;the&#160;documentation<br/>available&#160;for each&#160;kind of command.<br/>
help&#160;–&#160;Get&#160;Help&#160;for&#160;Shell&#160;Builtins<br/>bash&#160;has&#160;a&#160;built-in&#160;help&#160;facility&#160;available&#160;for&#160;each&#160;of&#160;the&#160;shell&#160;builtins.&#160;To&#160;use&#160;it,&#160;type<br/>“help”&#160;followed&#160;by the&#160;name&#160;of the&#160;shell&#160;builtin.&#160;Here&#160;is&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>help cd<br/></b>cd: cd [-L|[-P [-e]] [-@]] [dir]&#160;<br/>&#160; &#160; Change the shell working directory.&#160;<br/>
&#160; &#160; Change the current directory to DIR. &#160;The default DIR is the<br/>&#160; &#160; value of the HOME shell variable.&#160;<br/>
&#160; &#160; The variable CDPATH defines the search path for the directory<br/>&#160; &#160; containing DIR. &#160;Alternative directory names in CDPATH are<br/>&#160; &#160; separated by a colon (:). A null directory name is the same as<br/>&#160; &#160; the current directory. &#160;If DIR begins with a slash (/), then<br/>&#160; &#160; CDPATH is not used.&#160;<br/>
&#160; &#160; If the directory is not found, and the shell option `cdable_vars'<br/>&#160; &#160; is set, the word is assumed to be &#160;a variable name. &#160;If that<br/>&#160; &#160; variable has a value, its value is used for DIR.&#160;<br/>
&#160; &#160; Options:&#160;<br/>&#160; &#160; &#160; &#160;-L<br/>
force symbolic links to be followed: resolve symbolic<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;links in DIR after processing instances of `..'&#160;<br/>&#160; &#160; &#160; &#160;-P<br/>
use the physical directory structure without following<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;symbolic links: resolve symbolic links in DIR before<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160;processing instances of `..'&#160;<br/>&#160; &#160; &#160; &#160;-e<br/>
if the -P option is supplied, and the current working<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160;directory cannot be determined successfully, exit with<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160;a non-zero status&#160;<br/>
44<br/>
<hr/>
<a name=69></a>Getting a&#160;Command's&#160;Documentation<br/>
&#160; &#160; &#160; &#160;-@ &#160; &#160;on systems that support it, present a file with extended<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160;attributes as a directory containing the file attributes<br/>
&#160; &#160; &#160;The default is to follow symbolic links, as if `-L' were<br/>&#160; &#160; specified. `..' is processed by removing the immediately previous<br/>&#160; &#160; pathname component back to a slash or the beginning of DIR.&#160;<br/>
&#160; &#160; Exit Status:&#160;<br/>&#160; &#160; Returns 0 if the directory is changed, and if $PWD is set<br/>&#160; &#160; successfully when -P is used; non-zero otherwise.<br/>
<b>A&#160;note&#160;on&#160;notation:</b>&#160;When&#160;square&#160;brackets&#160;appear&#160;in&#160;the&#160;description&#160;of&#160;a&#160;command's&#160;syn-<br/>tax,&#160;they&#160;indicate&#160;optional&#160;items.&#160;A&#160;vertical&#160;bar&#160;character&#160;indicates&#160;mutually&#160;exclusive<br/>items. In the&#160;case&#160;of the&#160;cd&#160;command above:<br/>cd [-L|[-P[-e]]] [dir]<br/>This&#160;notation&#160;says&#160;that&#160;the&#160;command&#160;cd&#160;may&#160;be&#160;followed&#160;optionally&#160;by&#160;either&#160;a&#160;“-L”&#160;or&#160;a<br/>“-P”&#160;and&#160;further,&#160;if&#160;the&#160;“-P”&#160;option&#160;is&#160;specified&#160;the&#160;“-e”&#160;option&#160;may&#160;also&#160;be&#160;included&#160;fol-<br/>lowed by the&#160;optional&#160;argument&#160;“dir”.<br/>While&#160;the&#160;output&#160;of&#160;&#160;help&#160;&#160;for&#160;the&#160;&#160;cd&#160;&#160;commands&#160;is&#160;concise&#160;and&#160;accurate,&#160;it&#160;is&#160;by&#160;no<br/>means&#160;tutorial&#160;and&#160;as&#160;we&#160;can&#160;see,&#160;it&#160;also&#160;seems&#160;to&#160;mention&#160;a&#160;lot&#160;of&#160;things&#160;we&#160;haven't<br/>talked&#160;about&#160;yet! Don't&#160;worry.&#160;We'll&#160;get&#160;there.<br/>
--help&#160;–&#160;Display&#160;Usage&#160;Information<br/>Many&#160;executable&#160;programs&#160;support&#160;a&#160;“--help”&#160;option&#160;that&#160;displays&#160;a&#160;description&#160;of&#160;the<br/>command's&#160;supported syntax&#160;and options. For example:<br/>
[me@linuxbox ~]$&#160;<b>mkdir --help<br/></b>Usage: mkdir [OPTION] DIRECTORY...<br/>Create the DIRECTORY(ies), if they do not already exist.<br/>
&#160; -Z, --context=CONTEXT (SELinux) set security context to CONTEXT<br/>Mandatory arguments to long options are mandatory for short options&#160;<br/>too.<br/>&#160; -m, --mode=MODE &#160; set file mode (as in chmod), not a=rwx – umask<br/>&#160; -p, --parents &#160; &#160; no error if existing, make parent directories as<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; needed<br/>&#160; -v, --verbose &#160; &#160; print a message for each created directory<br/>&#160; &#160; &#160; --help &#160; &#160; &#160; &#160;display this help and exit<br/>
45<br/>
<hr/>
<a name=70></a>5 –&#160;Working&#160;with Commands<br/>
&#160; &#160; &#160; --version &#160; &#160; output version information and exit<br/>Report bugs to &lt;bug-coreutils@gnu.org&gt;.<br/>
Some&#160;programs&#160;don't&#160;support&#160;the&#160;“--help”&#160;option,&#160;but&#160;try&#160;it&#160;anyway.&#160;Often&#160;it&#160;results&#160;in&#160;an<br/>error message&#160;that&#160;will&#160;reveal&#160;the&#160;same&#160;usage&#160;information.<br/>
man&#160;–&#160;Display&#160;a&#160;Program's&#160;Manual&#160;Page<br/>Most&#160;executable&#160;programs&#160;intended&#160;for&#160;command&#160;line&#160;use&#160;provide&#160;a&#160;formal&#160;piece&#160;of&#160;doc-<br/>umentation&#160;called&#160;a&#160;<i>manual</i>&#160;or&#160;<i>man&#160;page</i>.&#160;A&#160;special&#160;paging&#160;program&#160;called&#160;man&#160;is&#160;used&#160;to<br/>view&#160;them.&#160;It&#160;is&#160;used like&#160;this:<br/>
<b>man&#160;<i>program</i></b><br/>
where&#160;“program”&#160;is&#160;the&#160;name&#160;of the&#160;command to&#160;view.<br/>Man pages&#160;vary somewhat&#160;in format&#160;but&#160;generally&#160;contain&#160;the&#160;following:<br/>
•<br/>
A&#160;title&#160;(the&#160;page’s&#160;name)<br/>
•<br/>
A&#160;synopsis&#160;of the&#160;command's&#160;syntax<br/>
•<br/>
A&#160;description&#160;of the&#160;command's&#160;purpose<br/>
•<br/>
A&#160;listing&#160;and description of each&#160;of the&#160;command's&#160;options<br/>
Man&#160;pages,&#160;however,&#160;do&#160;not&#160;usually&#160;include&#160;examples,&#160;and&#160;are&#160;intended&#160;as&#160;a&#160;reference,<br/>not&#160;a&#160;tutorial.&#160;As&#160;an example, let's&#160;try viewing the&#160;man&#160;page&#160;for the&#160;ls&#160;command:<br/>
[me@linuxbox ~]$&#160;<b>man ls</b><br/>
On most&#160;Linux systems,&#160;man&#160;uses&#160;less&#160;to&#160;display the&#160;manual&#160;page, so all&#160;of the&#160;familiar<br/>less&#160;commands&#160;work while&#160;displaying&#160;the&#160;page.<br/>The&#160;“manual”&#160;that&#160;man&#160;displays&#160;is&#160;broken&#160;into&#160;sections&#160;and&#160;covers&#160;not&#160;only&#160;user&#160;com-<br/>mands&#160;but&#160;also&#160;system&#160;administration&#160;commands,&#160;programming&#160;interfaces,&#160;file&#160;formats<br/>and more.&#160;Table&#160;5-1 describes&#160;the&#160;layout&#160;of the&#160;manual.<br/>
<i>Table&#160;5-1: Man Page&#160;Organization</i><br/>
<b>Section</b><br/>
<b>Contents</b><br/>
1<br/>
User commands<br/>
46<br/>
<hr/>
<a name=71></a>Getting a&#160;Command's&#160;Documentation<br/>
2<br/>
Programming&#160;interfaces&#160;for&#160;kernel&#160;system&#160;calls<br/>
3<br/>
Programming&#160;interfaces&#160;to the&#160;C library<br/>
4<br/>
Special&#160;files&#160;such as&#160;device&#160;nodes&#160;and&#160;drivers<br/>
5<br/>
File&#160;formats<br/>
6<br/>
Games&#160;and amusements&#160;such as&#160;screen&#160;savers<br/>
7<br/>
Miscellaneous&#160;<br/>
8<br/>
System&#160;administration commands<br/>
Sometimes&#160;we&#160;need&#160;to&#160;refer&#160;to&#160;a&#160;specific&#160;section&#160;of&#160;the&#160;manual&#160;to&#160;find&#160;what&#160;we&#160;are&#160;look-<br/>ing&#160;for.&#160;This&#160;is&#160;particularly&#160;true&#160;if&#160;we&#160;are&#160;looking&#160;for&#160;a&#160;file&#160;format&#160;that&#160;is&#160;also&#160;the&#160;name&#160;of<br/>a&#160;command.&#160;Without&#160;specifying&#160;a&#160;section&#160;number,&#160;we&#160;will&#160;always&#160;get&#160;the&#160;first&#160;instance&#160;of<br/>a&#160;match, probably&#160;in section&#160;1.&#160;To specify a&#160;section number, we&#160;use&#160;man&#160;like&#160;this:<br/>
<b>man&#160;<i>section</i></b><b>&#160;<i>search_term</i></b>&#160;<br/>
Here's&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>man 5 passwd</b><br/>
This&#160;will&#160;display the&#160;man&#160;page&#160;describing&#160;the&#160;file&#160;format&#160;of the&#160;/etc/passwd&#160;file.&#160;<br/>
apropos&#160;–&#160;Display&#160;Appropriate&#160;Commands<br/>It&#160;is&#160;also&#160;possible&#160;to&#160;search&#160;the&#160;list&#160;of&#160;man&#160;pages&#160;for&#160;possible&#160;matches&#160;based&#160;on&#160;a&#160;search<br/>term.&#160;It's&#160;crude&#160;but&#160;sometimes&#160;helpful.&#160;Here&#160;is&#160;an&#160;example&#160;of&#160;a&#160;search&#160;for&#160;man&#160;pages&#160;us-<br/>ing the&#160;search term&#160;<i>partition</i>:<br/>
[me@linuxbox ~]$&#160;<b>apropos partiton<br/></b>addpart (8) &#160; &#160; &#160; &#160; &#160;- simple wrapper around the &#34;add partition&#34;...<br/>all-swaps (7) &#160; &#160; &#160; &#160;- event signalling that all swap partitions...&#160;<br/>cfdisk (8) &#160; &#160; &#160; &#160; &#160; - display or manipulate disk partition table&#160;<br/>cgdisk (8) &#160; &#160; &#160; &#160; &#160; - Curses-based GUID partition table (GPT)...&#160;<br/>delpart (8) &#160; &#160; &#160; &#160; &#160;- simple wrapper around the &#34;del partition&#34;...&#160;<br/>fdisk (8) &#160; &#160; &#160; &#160; &#160; &#160;- manipulate disk partition table&#160;<br/>fixparts (8) &#160; &#160; &#160; &#160; - MBR partition table repair utility&#160;<br/>
47<br/>
<hr/>
<a name=72></a>5 –&#160;Working&#160;with Commands<br/>
gdisk (8) &#160; &#160; &#160; &#160; &#160; &#160;- Interactive GUID partition table (GPT)...&#160;<br/>mpartition (1) &#160; &#160; &#160; - partition an MSDOS hard disk&#160;<br/>partprobe (8) &#160; &#160; &#160; &#160;- inform the OS of partition table changes&#160;<br/>partx (8) &#160; &#160; &#160; &#160; &#160; &#160;- tell the Linux kernel about the presence...<br/>resizepart (8) &#160; &#160; &#160; - simple wrapper around the &#34;resize partition...<br/>
sfdisk (8) &#160; &#160; &#160; &#160; &#160; - partition table manipulator for Linux&#160;<br/>sgdisk (8) &#160; &#160; &#160; &#160; &#160; - Command-line GUID partition table (GPT)...&#160;<br/>
The&#160;first&#160;field&#160;in&#160;each&#160;line&#160;of&#160;output&#160;is&#160;the&#160;name&#160;of&#160;the&#160;man&#160;page,&#160;and&#160;the&#160;second&#160;field<br/>shows&#160;the&#160;section.&#160;Note&#160;that&#160;the&#160;man&#160;command&#160;with&#160;the&#160;“-k”&#160;option&#160;performs&#160;the&#160;same<br/>function&#160;as&#160;apropos.<br/>
whatis&#160;–&#160;Display&#160;One-line&#160;Manual&#160;Page&#160;Descriptions<br/>The&#160;whatis&#160;program&#160;displays&#160;the&#160;name&#160;and a&#160;one-line&#160;description of a&#160;man page&#160;match-<br/>ing a&#160;specified keyword:<br/>
[me@linuxbox ~]$&#160;<b>whatis ls<br/></b>ls &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; (1) &#160;- list directory contents<br/>
<b>The&#160;Most&#160;Brutal&#160;Man&#160;Page&#160;Of&#160;Them&#160;All</b><br/>
As&#160;we&#160;have&#160;seen,&#160;the&#160;manual&#160;pages&#160;supplied&#160;with&#160;Linux&#160;and&#160;other&#160;Unix-like&#160;sys-<br/>tems&#160;are&#160;intended&#160;as&#160;reference&#160;documentation&#160;and&#160;not&#160;as&#160;tutorials.&#160;Many&#160;man<br/>pages&#160;are&#160;hard&#160;to&#160;read,&#160;but&#160;I&#160;think&#160;that&#160;the&#160;grand&#160;prize&#160;for&#160;difficulty&#160;has&#160;got&#160;to&#160;go<br/>to the&#160;man page&#160;for&#160;bash.&#160;As&#160;I was&#160;doing research for this&#160;book, I gave&#160;the&#160;bash<br/>man&#160;page&#160;careful&#160;review&#160;to&#160;ensure&#160;that&#160;I&#160;was&#160;covering&#160;most&#160;of&#160;its&#160;topics.&#160;When<br/>printed,&#160;it's&#160;more&#160;than&#160;80&#160;pages&#160;long&#160;and&#160;extremely&#160;dense,&#160;and&#160;its&#160;structure&#160;makes<br/>absolutely&#160;no sense&#160;to a&#160;new&#160;user.<br/>On&#160;the&#160;other&#160;hand,&#160;it&#160;is&#160;very&#160;accurate&#160;and&#160;concise,&#160;as&#160;well&#160;as&#160;being&#160;extremely<br/>complete.&#160;So&#160;check&#160;it&#160;out&#160;if&#160;you&#160;dare&#160;and&#160;look&#160;forward&#160;to&#160;the&#160;day&#160;when&#160;you&#160;can<br/>read it&#160;and it&#160;all&#160;makes&#160;sense.<br/>
info&#160;–&#160;Display&#160;a&#160;Program's&#160;Info&#160;Entry<br/>The&#160;GNU&#160;Project&#160;provides&#160;an&#160;alternative&#160;to&#160;man&#160;pages&#160;for&#160;their&#160;programs,&#160;called&#160;“info.”<br/>
48<br/>
<hr/>
<a name=73></a>Getting a&#160;Command's&#160;Documentation<br/>
Info&#160;manuals&#160;are&#160;displayed&#160;with&#160;a&#160;reader&#160;program&#160;named,&#160;appropriately&#160;enough,&#160;info.<br/>Info pages&#160;are&#160;<i>hyperlinked</i>&#160;much like&#160;web pages. Here&#160;is&#160;a&#160;sample:<br/>
File:&#160;coreutils.info, &#160;Node: ls invocation, &#160;Next: dir invocation,&#160;<br/>Up: Directory listing<br/>10.1 `ls': List directory contents<br/>==================================<br/>The `ls' program lists information about files (of any type,&#160;<br/>including directories). &#160;Options and file arguments can be intermixed<br/>arbitrarily, as usual.<br/>&#160; &#160;For non-option command-line arguments that are directories, by&#160;<br/>default `ls' lists the contents of directories, not recursively, and&#160;<br/>omitting files with names beginning with `.'. &#160;For other non-option&#160;<br/>arguments, by default `ls' lists just the filename. &#160;If no non-option<br/>argument is specified, `ls' operates on the current directory, acting<br/>as if it had been invoked with a single argument of `.'.<br/>&#160; &#160;By default, the output is sorted alphabetically, according to the<br/>--zz-Info: (coreutils.info.gz)ls invocation, 63 lines --Top----------<br/>
The&#160;info&#160;program&#160;reads&#160;<i>info&#160;files</i>,&#160;which&#160;are&#160;tree&#160;structured&#160;into&#160;individual&#160;<i>nodes</i>,&#160;each<br/>containing&#160;a&#160;single&#160;topic.&#160;Info&#160;files&#160;contain&#160;hyperlinks&#160;that&#160;can&#160;move&#160;the&#160;reader&#160;from<br/>node&#160;to&#160;node.&#160;A&#160;hyperlink&#160;can&#160;be&#160;identified&#160;by&#160;its&#160;leading&#160;asterisk&#160;and&#160;is&#160;activated&#160;by<br/>placing&#160;the&#160;cursor upon it&#160;and pressing the&#160;Enter&#160;key.<br/>To invoke&#160;info, type&#160;info&#160;followed optionally&#160;by the&#160;name&#160;of a&#160;program.&#160;Table&#160;5-2 de-<br/>scribes&#160;the&#160;commands&#160;used to&#160;control&#160;the&#160;reader&#160;while&#160;displaying an&#160;info page.<br/>
<i>Table&#160;5-2:&#160;info&#160;Commands</i><br/>
<b>Command</b><br/>
<b>Action</b><br/>
?<br/>
Display command help<br/>
PgUp&#160;or&#160;Backspace<br/>
Display previous&#160;page<br/>
PgDn&#160;or&#160;Space<br/>
Display next&#160;page<br/>
n<br/>
Next&#160;- Display the&#160;next&#160;node<br/>
p<br/>
Previous&#160;- Display the&#160;previous&#160;node<br/>
u<br/>
Up - Display&#160;the&#160;parent&#160;node&#160;of the&#160;currently displayed&#160;<br/>node, usually&#160;a&#160;menu<br/>
Enter<br/>
Follow&#160;the&#160;hyperlink at&#160;the&#160;cursor location<br/>
49<br/>
<hr/>
<a name=74></a>5 –&#160;Working&#160;with Commands<br/>
q<br/>
Quit<br/>
Most&#160;of&#160;the&#160;command&#160;line&#160;programs&#160;we&#160;have&#160;discussed&#160;so&#160;far&#160;are&#160;part&#160;of&#160;the&#160;GNU<br/>Project's&#160;<i>coreutils</i>&#160;package, so typing&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>info coreutils</b><br/>
will&#160;display&#160;a&#160;menu&#160;page&#160;with&#160;hyperlinks&#160;to&#160;each&#160;program&#160;contained&#160;in&#160;the&#160;coreutils<br/>package.<br/>
README&#160;and&#160;Other&#160;Program&#160;Documentation&#160;Files<br/>Many&#160;software&#160;packages&#160;installed&#160;on&#160;our&#160;system&#160;have&#160;documentation&#160;files&#160;residing&#160;in&#160;the<br/>/usr/share/doc&#160;directory.&#160;Most&#160;of&#160;these&#160;are&#160;stored&#160;in&#160;plain&#160;text&#160;format&#160;and&#160;can&#160;be<br/>viewed&#160;with&#160;less.&#160;Some&#160;of&#160;the&#160;files&#160;are&#160;in&#160;HTML&#160;format&#160;and&#160;can&#160;be&#160;viewed&#160;with&#160;a&#160;web<br/>browser.&#160;We&#160;may&#160;encounter&#160;some&#160;files&#160;ending&#160;with&#160;a&#160;“.gz”&#160;extension.&#160;This&#160;indicates&#160;that<br/>they&#160;have&#160;been&#160;compressed&#160;with&#160;the&#160;gzip&#160;compression&#160;program.&#160;The&#160;gzip&#160;package&#160;in-<br/>cludes&#160;a&#160;special&#160;version&#160;of&#160;&#160;less&#160;&#160;called&#160;&#160;zless&#160;&#160;that&#160;will&#160;display&#160;the&#160;contents&#160;of&#160;gzip-<br/>compressed text&#160;files.&#160;<br/>
<b>Creating&#160;Our&#160;Own&#160;Commands&#160;with&#160;alias<br/></b>Now&#160;for&#160;our&#160;first&#160;experience&#160;with&#160;programming!&#160;We&#160;will&#160;create&#160;a&#160;command&#160;of&#160;our&#160;own<br/>using&#160;the&#160;alias&#160;command.&#160;But&#160;before&#160;we&#160;start,&#160;we&#160;need&#160;to&#160;reveal&#160;a&#160;small&#160;command&#160;line<br/>trick.&#160;It's&#160;possible&#160;to&#160;put&#160;more&#160;than&#160;one&#160;command&#160;on&#160;a&#160;line&#160;by&#160;separating&#160;each&#160;command<br/>with a&#160;semicolon.&#160;It&#160;works&#160;like&#160;this:<br/>
<i>command1</i>;&#160;<i>command2</i>;&#160;<i>command3</i>...<br/>
Here's&#160;the&#160;example&#160;we&#160;will&#160;use:<br/>
[me@linuxbox ~]$&#160;<b>cd /usr; ls; cd -<br/></b>bin &#160;games &#160;include &#160;lib &#160;local &#160;sbin &#160;share &#160;src<br/>/home/me<br/>[me@linuxbox ~]$<br/>
As&#160;we&#160;can&#160;see,&#160;we&#160;have&#160;combined&#160;three&#160;commands&#160;on&#160;one&#160;line.&#160;First&#160;we&#160;change&#160;directory<br/>to&#160;/usr&#160;then&#160;list&#160;the&#160;directory&#160;and&#160;finally&#160;return&#160;to&#160;the&#160;original&#160;directory&#160;(by&#160;using&#160;'cd<br/>
50<br/>
<hr/>
<a name=75></a>Creating Our Own Commands&#160;with alias<br/>
-') so we&#160;end&#160;up where&#160;we&#160;started.&#160;Now&#160;let's&#160;turn&#160;this&#160;sequence&#160;into&#160;a&#160;new&#160;command&#160;us-<br/>ing&#160;&#160;alias.&#160;The&#160;first&#160;thing&#160;we&#160;have&#160;to&#160;do&#160;is&#160;dream&#160;up&#160;a&#160;name&#160;for&#160;our&#160;new&#160;command.<br/>Let's&#160;try&#160;“test”.&#160;Before&#160;we&#160;do&#160;that,&#160;it&#160;would&#160;be&#160;a&#160;good&#160;idea&#160;to&#160;find&#160;out&#160;if&#160;the&#160;name&#160;“test”&#160;is<br/>already&#160;being used.&#160;To find out,&#160;we&#160;can use&#160;the&#160;type&#160;command&#160;again:<br/>
[me@linuxbox ~]$&#160;<b>type test<br/></b>test is a shell builtin<br/>
&#160;Oops!&#160;The&#160;name&#160;test&#160;is&#160;already taken. Let's&#160;try&#160;foo:<br/>
[me@linuxbox ~]$&#160;<b>type foo<br/></b>bash: type: foo: not found<br/>
Great! “foo”&#160;is&#160;not&#160;taken.&#160;So let's&#160;create&#160;our alias:<br/>
[me@linuxbox ~]$&#160;<b>alias foo=</b>'<b>cd /usr; ls; cd -'</b><br/>
Notice&#160;the&#160;structure&#160;of this&#160;command&#160;shown here:<br/>
<b>alias&#160;<i>name</i></b><b>='<i>string</i></b><b>'</b><br/>
After&#160;the&#160;command&#160;alias,&#160;we&#160;give&#160;alias&#160;a&#160;name&#160;followed&#160;immediately&#160;(no&#160;whitespace<br/>allowed)&#160;by&#160;an&#160;equal&#160;sign,&#160;followed&#160;immediately&#160;by&#160;a&#160;quoted&#160;string&#160;containing&#160;the&#160;mean-<br/>ing&#160;to be&#160;assigned&#160;to&#160;the&#160;name.&#160;After&#160;we&#160;define&#160;our&#160;alias,&#160;we&#160;can&#160;use&#160;it&#160;anywhere&#160;the&#160;shell<br/>would&#160;expect&#160;a&#160;command. Let's&#160;try&#160;it:<br/>
[me@linuxbox ~]$&#160;<b>foo<br/></b>bin &#160;games &#160;include &#160;lib &#160;local &#160;sbin &#160;share &#160;src<br/>/home/me<br/>[me@linuxbox ~]$<br/>
We&#160;can also use&#160;the&#160;type&#160;command&#160;again&#160;to see&#160;our alias:<br/>
[me@linuxbox ~]$&#160;<b>type foo<br/></b>foo is aliased to `cd /usr; ls; cd -'<br/>
51<br/>
<hr/>
<a name=76></a>5 –&#160;Working&#160;with Commands<br/>
To remove&#160;an alias,&#160;the&#160;unalias&#160;command is&#160;used, like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>unalias foo<br/></b>[me@linuxbox ~]$&#160;<b>type foo<br/></b>bash: type: foo: not found<br/>
While&#160;we&#160;purposefully&#160;avoided&#160;naming&#160;our&#160;alias&#160;with&#160;an&#160;existing&#160;command&#160;name,&#160;it&#160;is<br/>not&#160;uncommon&#160;to&#160;do&#160;so.&#160;This&#160;is&#160;often&#160;done&#160;to&#160;apply&#160;a&#160;commonly&#160;desired&#160;option&#160;to&#160;each<br/>invocation&#160;of&#160;a&#160;common&#160;command.&#160;For&#160;instance,&#160;we&#160;saw&#160;earlier&#160;how&#160;the&#160;ls&#160;command&#160;is<br/>often aliased to&#160;add color&#160;support:<br/>
[me@linuxbox ~]$&#160;<b>type ls<br/></b>ls is aliased to `ls --color=tty'<br/>
To&#160;see&#160;all&#160;the&#160;aliases&#160;defined&#160;in&#160;the&#160;environment,&#160;use&#160;the&#160;alias&#160;command&#160;without&#160;argu-<br/>ments.&#160;Here&#160;are&#160;some&#160;of&#160;the&#160;aliases&#160;defined&#160;by&#160;default&#160;on&#160;a&#160;Fedora&#160;system.&#160;Try&#160;to&#160;figure<br/>out&#160;what&#160;they&#160;all&#160;do:<br/>
[me@linuxbox ~]$&#160;<b>alias<br/></b>alias l.='ls -d .* --color=tty'<br/>alias ll='ls -l --color=tty'<br/>alias ls='ls --color=tty'<br/>
There&#160;is&#160;one&#160;tiny&#160;problem&#160;with&#160;defining&#160;aliases&#160;on&#160;the&#160;command&#160;line.&#160;They&#160;vanish&#160;when<br/>our&#160;shell&#160;session&#160;ends.&#160;In&#160;Chapter&#160;11,&#160;&#34;The&#160;Environment&#34;,&#160;we&#160;will&#160;see&#160;how&#160;to&#160;add&#160;our<br/>own&#160;aliases&#160;to&#160;the&#160;files&#160;that&#160;establish&#160;the&#160;environment&#160;each&#160;time&#160;we&#160;log&#160;on,&#160;but&#160;for&#160;now,<br/>enjoy&#160;the&#160;fact&#160;that&#160;we&#160;have&#160;taken&#160;our&#160;first,&#160;albeit&#160;tiny,&#160;step&#160;into&#160;the&#160;world&#160;of&#160;shell&#160;pro-<br/>gramming!<br/>
<b>Summing&#160;Up<br/></b>Now&#160;that&#160;we&#160;have&#160;learned&#160;how&#160;to&#160;find&#160;the&#160;documentation&#160;for&#160;commands,&#160;go&#160;and&#160;look&#160;up<br/>the&#160;documentation&#160;for&#160;all&#160;the&#160;commands&#160;we&#160;have&#160;encountered&#160;so&#160;far.&#160;Study&#160;what&#160;addi-<br/>tional&#160;options&#160;are&#160;available&#160;and try them!<br/>
<b>Further&#160;Reading<br/></b>There&#160;are&#160;many&#160;online&#160;sources&#160;of&#160;documentation&#160;for&#160;Linux&#160;and&#160;the&#160;command&#160;line.&#160;Here<br/>are&#160;some&#160;of the&#160;best:<br/>
52<br/>
<hr/>
<a name=77></a>Further&#160;Reading<br/>
●<br/>
The&#160;<i>Bash&#160;Reference&#160;Manual</i>&#160;is&#160;a&#160;reference&#160;guide&#160;to&#160;the&#160;bash&#160;shell.&#160;It’s&#160;still&#160;a&#160;ref-<br/>erence&#160;work&#160;but&#160;contains&#160;examples&#160;and&#160;is&#160;easier&#160;to&#160;read&#160;than&#160;the&#160;bash&#160;man&#160;page.<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html">http://www.gnu.org/software/bash/manual/bashref.html</a><br/>
●<br/>
The&#160;&#160;<i>Bash&#160;FAQ</i>&#160;&#160;contains&#160;answers&#160;to&#160;frequently&#160;asked&#160;questions&#160;regarding&#160;&#160;bash.<br/>This&#160;list&#160;is&#160;aimed&#160;at&#160;intermediate&#160;to&#160;advanced&#160;users,&#160;but&#160;contains&#160;a&#160;lot&#160;of&#160;good&#160;in-<br/>formation.<br/><a href="http://mywiki.wooledge.org/BashFAQ">http://mywiki.wooledge.org/BashFAQ</a><br/>
●<br/>
The&#160;GNU&#160;Project&#160;provides&#160;extensive&#160;documentation&#160;for&#160;its&#160;programs,&#160;which&#160;form<br/>the&#160;core&#160;of&#160;the&#160;Linux&#160;command&#160;line&#160;experience.&#160;You&#160;can&#160;see&#160;a&#160;complete&#160;list&#160;here:<br/><a href="http://www.gnu.org/manual/manual.html">http://www.gnu.org/manual/manual.html</a><br/>
●<br/>
Wikipedia&#160;has&#160;an interesting article&#160;on man&#160;pages:<br/><a href="http://en.wikipedia.org/wiki/Man_page">http://en.wikipedia.org/wiki/Man_page</a><br/>
53<br/>
<hr/>
<a name=78></a>6 – Redirection<br/>
<i><b>6&#160;–&#160;Redirection</b></i><br/>
In&#160;this&#160;lesson&#160;we&#160;are&#160;going&#160;to&#160;unleash&#160;what&#160;may&#160;be&#160;the&#160;coolest&#160;feature&#160;of&#160;the&#160;command<br/>line.&#160;It's&#160;called&#160;<i>I/O&#160;redirection</i>.&#160;The&#160;“I/O”&#160;stands&#160;for&#160;<i>input/output</i>&#160;and&#160;with&#160;this&#160;facility&#160;we<br/>can redirect&#160;the&#160;input&#160;and output&#160;of commands&#160;to and from&#160;files, as&#160;well&#160;as&#160;connect&#160;multi-<br/>ple&#160;commands&#160;together&#160;into&#160;powerful&#160;command&#160;<i>pipelines</i>.&#160;To&#160;show&#160;off&#160;this&#160;facility,&#160;we<br/>will&#160;introduce&#160;the&#160;following&#160;commands:<br/>
●<br/>
cat&#160;– Concatenate&#160;files<br/>
●<br/>
sort&#160;– Sort&#160;lines&#160;of text<br/>
●<br/>
uniq&#160;– Report&#160;or omit&#160;repeated&#160;lines<br/>
●<br/>
grep&#160;– Print&#160;lines&#160;matching a&#160;pattern<br/>
●<br/>
wc&#160;– Print&#160;newline, word, and byte&#160;counts&#160;for each&#160;file<br/>
●<br/>
head&#160;– Output&#160;the&#160;first&#160;part&#160;of a&#160;file<br/>
●<br/>
tail&#160;– Output&#160;the&#160;last&#160;part&#160;of a&#160;file<br/>
●<br/>
tee&#160;– Read from&#160;standard input&#160;and write&#160;to standard output&#160;and files<br/>
<b>Standard&#160;Input,&#160;Output,&#160;and&#160;Error<br/></b>Many&#160;of&#160;the&#160;programs&#160;that&#160;we&#160;have&#160;used&#160;so&#160;far&#160;produce&#160;output&#160;of&#160;some&#160;kind.&#160;This&#160;output<br/>often consists&#160;of two types:<br/>
•<br/>
The&#160;program's&#160;results, that&#160;is, the&#160;data&#160;the&#160;program&#160;is&#160;designed to&#160;produce<br/>
•<br/>
Status&#160;and error&#160;messages&#160;that&#160;tell&#160;us&#160;how&#160;the&#160;program&#160;is&#160;getting&#160;along<br/>
If&#160;we&#160;look&#160;at&#160;a&#160;command&#160;like&#160;ls,&#160;we&#160;can&#160;see&#160;that&#160;it&#160;displays&#160;its&#160;results&#160;and&#160;its&#160;error&#160;mes-<br/>sages&#160;on the&#160;screen.<br/>Keeping&#160;with&#160;the&#160;Unix&#160;theme&#160;of “everything&#160;is&#160;a&#160;file,”&#160;programs&#160;such as&#160;ls&#160;actually&#160;send<br/>their&#160;results&#160;to&#160;a&#160;special&#160;file&#160;called&#160;<i>standard&#160;output</i>&#160;(often&#160;expressed&#160;as&#160;<i>stdout</i>)&#160;and&#160;their<br/>status&#160;messages&#160;to&#160;another&#160;file&#160;called&#160;s<i>tandard&#160;error</i>&#160;(<i>stderr</i>).&#160;By&#160;default,&#160;both&#160;standard<br/>output&#160;and&#160;standard error are&#160;linked&#160;to the&#160;screen and not&#160;saved into&#160;a&#160;disk file.<br/>
54<br/>
<hr/>
<a name=79></a>Standard&#160;Input, Output,&#160;and Error<br/>
In&#160;addition,&#160;many&#160;programs&#160;take&#160;input&#160;from&#160;a&#160;facility&#160;called&#160;<i>standard&#160;input</i>&#160;(<i>stdin</i>),&#160;which<br/>is, by default,&#160;attached&#160;to the&#160;keyboard.<br/>I/O&#160;redirection&#160;allows&#160;us&#160;to&#160;change&#160;where&#160;output&#160;goes&#160;and&#160;where&#160;input&#160;comes&#160;from.&#160;Nor-<br/>mally,&#160;output&#160;goes&#160;to&#160;the&#160;screen&#160;and&#160;input&#160;comes&#160;from&#160;the&#160;keyboard,&#160;but&#160;with&#160;I/O&#160;redi-<br/>rection,&#160;we&#160;can change&#160;that.<br/>
<b>Redirecting&#160;Standard&#160;Output<br/></b>I/O&#160;redirection&#160;allows&#160;us&#160;to&#160;redefine&#160;where&#160;standard&#160;output&#160;goes.&#160;To&#160;redirect&#160;standard<br/>output&#160;to&#160;another&#160;file&#160;instead&#160;of&#160;the&#160;screen,&#160;we&#160;use&#160;the&#160;&gt;&#160;redirection&#160;operator&#160;followed&#160;by<br/>the&#160;name&#160;of the&#160;file.&#160;Why would&#160;we&#160;want&#160;to do this?&#160;It's&#160;often useful&#160;to&#160;store&#160;the&#160;output&#160;of<br/>a&#160;command&#160;in&#160;a&#160;file.&#160;For&#160;example,&#160;we&#160;could&#160;tell&#160;the&#160;shell&#160;to&#160;send&#160;the&#160;output&#160;of&#160;the&#160;ls<br/>command&#160;to the&#160;file&#160;ls-output.txt&#160;instead&#160;of the&#160;screen:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt; ls-output.txt</b><br/>
Here,&#160;we&#160;created&#160;a&#160;long&#160;listing&#160;of&#160;the&#160;/usr/bin&#160;directory&#160;and&#160;sent&#160;the&#160;results&#160;to&#160;the&#160;file<br/>ls-output.txt. Let's&#160;examine&#160;the&#160;redirected&#160;output&#160;of the&#160;command, shown here:<br/>
[me@linuxbox ~]$&#160;<b>ls -l ls-output.txt<br/></b>-rw-rw-r-- 1 me &#160; me &#160; 167878 2018-02-01 15:07 ls-output.txt<br/>
Good&#160;—&#160;a&#160;nice,&#160;large,&#160;text&#160;file.&#160;If&#160;we&#160;look&#160;at&#160;the&#160;file&#160;with&#160;less,&#160;we&#160;will&#160;see&#160;that&#160;the&#160;file<br/>ls-output.txt&#160;does&#160;indeed&#160;contain&#160;the&#160;results&#160;from&#160;our&#160;ls&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>less ls-output.txt</b><br/>
Now,&#160;let's&#160;repeat&#160;our&#160;redirection&#160;test,&#160;but&#160;this&#160;time&#160;with&#160;a&#160;twist.&#160;We'll&#160;change&#160;the&#160;name&#160;of<br/>the&#160;directory&#160;to one&#160;that&#160;does&#160;not&#160;exist:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr &gt; ls-output.txt<br/></b>ls: cannot access /bin/usr: No such file or directory<br/>
We&#160;received&#160;an&#160;error&#160;message.&#160;This&#160;makes&#160;sense&#160;since&#160;we&#160;specified&#160;the&#160;nonexistent&#160;direc-<br/>tory&#160;/bin/usr,&#160;but&#160;why&#160;was&#160;the&#160;error&#160;message&#160;displayed&#160;on&#160;the&#160;screen&#160;rather&#160;than&#160;be-<br/>ing&#160;redirected&#160;to&#160;the&#160;file&#160;ls-output.txt?&#160;The&#160;answer&#160;is&#160;that&#160;the&#160;ls&#160;program&#160;does&#160;not<br/>send its&#160;error messages&#160;to&#160;standard output.&#160;Instead, like&#160;most&#160;well-written Unix programs,<br/>
55<br/>
<hr/>
<a name=80></a>6 – Redirection<br/>
it&#160;sends&#160;its&#160;error&#160;messages&#160;to&#160;standard&#160;error.&#160;Since&#160;we&#160;only&#160;redirected&#160;standard&#160;output&#160;and<br/>not&#160;standard&#160;error,&#160;the&#160;error&#160;message&#160;was&#160;still&#160;sent&#160;to&#160;the&#160;screen.&#160;We'll&#160;see&#160;how&#160;to&#160;redirect<br/>standard error&#160;in just&#160;a&#160;minute,&#160;but&#160;first&#160;let's&#160;look at&#160;what&#160;happened to&#160;our output&#160;file:<br/>
[me@linuxbox ~]$&#160;<b>ls -l ls-output.txt<br/></b>-rw-rw-r-- 1 me &#160; me &#160; 0 2018-02-01 15:08 ls-output.txt<br/>
The&#160;file&#160;now&#160;has&#160;zero&#160;length!&#160;This&#160;is&#160;because&#160;when&#160;we&#160;redirect&#160;output&#160;with&#160;the&#160;“&gt;”&#160;redi-<br/>rection&#160;operator,&#160;the&#160;destination&#160;file&#160;is&#160;always&#160;rewritten&#160;from&#160;the&#160;beginning.&#160;Since&#160;our&#160;ls<br/>command&#160;&#160;&#160;generated&#160;&#160;&#160;no&#160;&#160;&#160;results&#160;&#160;&#160;and&#160;&#160;&#160;only&#160;&#160;&#160;an&#160;&#160;&#160;error&#160;&#160;&#160;message,&#160;&#160;&#160;the&#160;&#160;&#160;redirection&#160;&#160;&#160;operation<br/>started&#160;to&#160;rewrite&#160;the&#160;file&#160;and&#160;then&#160;stopped&#160;because&#160;of&#160;the&#160;error,&#160;resulting&#160;in&#160;its&#160;truncation.<br/>In&#160;fact,&#160;if&#160;we&#160;ever&#160;need&#160;to&#160;actually&#160;truncate&#160;a&#160;file&#160;(or&#160;create&#160;a&#160;new,&#160;empty&#160;file),&#160;we&#160;can&#160;use<br/>a&#160;trick&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>&gt; ls-output.txt</b><br/>
Simply&#160;using&#160;the&#160;redirection&#160;operator&#160;with&#160;no&#160;command&#160;preceding&#160;it&#160;will&#160;truncate&#160;an&#160;ex-<br/>isting file&#160;or create&#160;a&#160;new, empty&#160;file.<br/>So,&#160;how&#160;can&#160;we&#160;append&#160;redirected&#160;output&#160;to&#160;a&#160;file&#160;instead&#160;of&#160;overwriting&#160;the&#160;file&#160;from&#160;the<br/>beginning?&#160;For that,&#160;we&#160;use&#160;the&#160;&gt;&gt;&#160;redirection operator, like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt;&gt; ls-output.txt</b><br/>
Using&#160;the&#160;&gt;&gt;&#160;operator&#160;will&#160;result&#160;in&#160;the&#160;output&#160;being&#160;appended&#160;to&#160;the&#160;file.&#160;If&#160;the&#160;file&#160;does<br/>not&#160;already&#160;exist,&#160;it&#160;is&#160;created&#160;just&#160;as&#160;though&#160;the&#160;&gt;&#160;operator&#160;had&#160;been&#160;used.&#160;Let's&#160;put&#160;it&#160;to<br/>the&#160;test:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt;&gt; ls-output.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt;&gt; ls-output.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt;&gt; ls-output.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l ls-output.txt<br/></b>-rw-rw-r-- 1 me &#160; me &#160; 503634 2018-02-01 15:45 ls-output.txt<br/>
We&#160;repeated the&#160;command&#160;three&#160;times&#160;resulting in&#160;an output&#160;file&#160;three&#160;times&#160;as&#160;large.<br/>
56<br/>
<hr/>
<a name=81></a>Redirecting&#160;Standard Error<br/>
<b>Redirecting&#160;Standard&#160;Error<br/></b>Redirecting&#160;standard&#160;error&#160;lacks&#160;the&#160;ease&#160;of&#160;a&#160;dedicated&#160;redirection&#160;operator.&#160;To&#160;redirect<br/>standard&#160;error&#160;we&#160;must&#160;refer&#160;to&#160;its&#160;<i>file&#160;descriptor</i>.&#160;A&#160;program&#160;can&#160;produce&#160;output&#160;on&#160;any<br/>of&#160;several&#160;numbered&#160;file&#160;streams.&#160;While&#160;we&#160;have&#160;referred&#160;to&#160;the&#160;first&#160;three&#160;of&#160;these&#160;file<br/>streams&#160;as&#160;standard&#160;input,&#160;output&#160;and&#160;error,&#160;the&#160;shell&#160;references&#160;them&#160;internally&#160;as&#160;file&#160;de-<br/>scriptors&#160;0,&#160;1,&#160;and&#160;2,&#160;respectively.&#160;The&#160;shell&#160;provides&#160;a&#160;notation&#160;for&#160;redirecting&#160;files&#160;using<br/>the&#160;file&#160;descriptor&#160;number.&#160;Since&#160;standard&#160;error&#160;is&#160;the&#160;same&#160;as&#160;file&#160;descriptor&#160;number&#160;2,<br/>we&#160;can redirect&#160;standard error with&#160;this&#160;notation:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr 2&gt; ls-error.txt</b><br/>
The&#160;file&#160;descriptor&#160;“2”&#160;is&#160;placed&#160;immediately&#160;before&#160;the&#160;redirection&#160;operator&#160;to&#160;perform<br/>the&#160;redirection of standard&#160;error to the&#160;file&#160;ls-error.txt.<br/>
Redirecting&#160;Standard&#160;Output&#160;and&#160;Standard&#160;Error&#160;to&#160;One&#160;File<br/>There&#160;are&#160;cases&#160;in&#160;which&#160;we&#160;may&#160;want&#160;to&#160;capture&#160;all&#160;of&#160;the&#160;output&#160;of&#160;a&#160;command&#160;to&#160;a&#160;sin-<br/>gle&#160;file.&#160;To&#160;do&#160;this,&#160;we&#160;must&#160;redirect&#160;both&#160;standard&#160;output&#160;and&#160;standard&#160;error&#160;at&#160;the&#160;same<br/>time.&#160;There&#160;are&#160;two&#160;ways&#160;to&#160;do&#160;this.&#160;Shown&#160;here&#160;is&#160;the&#160;traditional&#160;way,&#160;which&#160;works&#160;with<br/>old versions&#160;of the&#160;shell:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr &gt; ls-output.txt 2&gt;&amp;1</b><br/>
Using&#160;this&#160;method,&#160;we&#160;perform&#160;two&#160;redirections.&#160;First&#160;we&#160;redirect&#160;standard&#160;output&#160;to&#160;the<br/>file&#160;ls-output.txt&#160;and&#160;then&#160;we&#160;redirect&#160;file&#160;descriptor&#160;2&#160;(standard&#160;error)&#160;to&#160;file&#160;de-<br/>scriptor 1 (standard&#160;output)&#160;using&#160;the&#160;notation&#160;2&gt;&amp;1.<br/>
<b>Notice&#160;that&#160;the&#160;order&#160;of&#160;the&#160;redirections&#160;is&#160;significant.</b>&#160;The&#160;redirection&#160;of&#160;stan-<br/>dard&#160;error&#160;must&#160;always&#160;occur&#160;<i>after</i>&#160;redirecting&#160;standard&#160;output&#160;or&#160;it&#160;doesn't&#160;work.<br/>The&#160;following&#160;example&#160;redirects&#160;standard&#160;error to the&#160;file&#160;ls-output.txt:<br/>
&gt;ls-output.txt 2&gt;&amp;1<br/>
However,&#160;if&#160;the&#160;order&#160;is&#160;changed&#160;to&#160;the&#160;following,&#160;standard&#160;error&#160;is&#160;directed&#160;to<br/>the&#160;screen.<br/>
&#160;2&gt;&amp;1 &gt;ls-output.txt<br/>
57<br/>
<hr/>
<a name=82></a>6 – Redirection<br/>
Recent&#160;versions&#160;of&#160;bash&#160;provide&#160;a&#160;second,&#160;more&#160;streamlined&#160;method&#160;for&#160;performing&#160;this<br/>combined&#160;redirection&#160;shown here:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr&#160;&amp;&gt;&#160;ls-output.txt</b><br/>
In&#160;this&#160;example,&#160;we&#160;use&#160;the&#160;single&#160;notation&#160;&amp;&gt;&#160;to&#160;redirect&#160;both&#160;standard&#160;output&#160;and&#160;stan-<br/>dard&#160;error&#160;to&#160;the&#160;file&#160;&#160;ls-output.txt.&#160;We&#160;can&#160;also&#160;append&#160;the&#160;standard&#160;output&#160;and<br/>standard error&#160;streams&#160;to a&#160;single&#160;file&#160;like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr&#160;&amp;&gt;&gt;&#160;ls-output.txt</b><br/>
Disposing&#160;of&#160;Unwanted&#160;Output<br/>Sometimes&#160;“silence&#160;is&#160;golden,”&#160;and&#160;we&#160;don't&#160;want&#160;output&#160;from&#160;a&#160;command,&#160;we&#160;just&#160;want<br/>to&#160;throw&#160;it&#160;away.&#160;This&#160;applies&#160;particularly&#160;to&#160;error&#160;and&#160;status&#160;messages.&#160;The&#160;system&#160;pro-<br/>vides&#160;a&#160;way&#160;to&#160;do&#160;this&#160;by&#160;redirecting&#160;output&#160;to&#160;a&#160;special&#160;file&#160;called&#160;“/dev/null”.&#160;This&#160;file&#160;is<br/>a&#160;system&#160;device&#160;often&#160;referred&#160;to&#160;as&#160;a&#160;<i>bit&#160;bucket</i>,&#160;which&#160;accepts&#160;input&#160;and&#160;does&#160;nothing<br/>with it.&#160;To suppress&#160;error messages&#160;from&#160;a&#160;command,&#160;we&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /bin/usr 2&gt; /dev/null</b><br/>
<b>/dev/null&#160;In&#160;Unix&#160;Culture</b><br/>
The&#160;bit&#160;bucket&#160;is&#160;an&#160;ancient&#160;Unix&#160;concept&#160;and&#160;because&#160;of&#160;its&#160;universality,&#160;it&#160;has<br/>appeared&#160;in&#160;many&#160;parts&#160;of&#160;Unix&#160;culture.&#160;When&#160;someone&#160;says&#160;he/she&#160;is&#160;sending<br/>your&#160;comments&#160;to&#160;/dev/null,&#160;now&#160;you&#160;know&#160;what&#160;it&#160;means.&#160;For&#160;more&#160;exam-<br/>ples, see&#160;the&#160;<a href="http://en.wikipedia.org/wiki//dev/null">W</a><br/>
<a href="http://en.wikipedia.org/wiki//dev/null">&#160;&#160;ikipedia&#160;article&#160;on&#160;&#160;/</a><br/>
<a href="http://en.wikipedia.org/wiki//dev/null">&#160;&#160;dev/null</a><br/>
<a href="http://en.wikipedia.org/wiki//dev/null">&#160;</a><br/>
<a href="http://en.wikipedia.org/wiki//dev/null">&#160;.</a><br/>
<b>Redirecting&#160;Standard&#160;Input<br/></b>Up&#160;to&#160;now,&#160;we&#160;haven't&#160;encountered&#160;any&#160;commands&#160;that&#160;make&#160;use&#160;of&#160;standard&#160;input&#160;(actu-<br/>ally&#160;we&#160;have, but&#160;we’ll&#160;reveal&#160;that&#160;surprise&#160;a&#160;little&#160;bit&#160;later),&#160;so we&#160;need to introduce&#160;one.<br/>
58<br/>
<hr/>
<a name=83></a>Redirecting&#160;Standard Input<br/>
cat&#160;–&#160;Concatenate&#160;Files<br/>The&#160;cat&#160;command reads&#160;one&#160;or more&#160;files&#160;and copies&#160;them&#160;to standard&#160;output&#160;like&#160;so:<br/>
<b>cat [<i>file...</i></b><b>]</b><br/>
In&#160;most&#160;cases,&#160;we&#160;can&#160;think&#160;of&#160;cat&#160;as&#160;being&#160;analogous&#160;to&#160;the&#160;TYPE&#160;command&#160;in&#160;DOS.<br/>We&#160;can&#160;use&#160;it&#160;to&#160;display&#160;files&#160;without&#160;paging.&#160;For&#160;example,&#160;the&#160;following&#160;will&#160;display&#160;the<br/>contents&#160;of the&#160;file&#160;ls-output.txt:<br/>
[me@linuxbox ~]$&#160;<b>cat</b>&#160;<b>ls-output.txt</b><br/>
cat&#160;is&#160;often&#160;used&#160;to&#160;display&#160;short&#160;text&#160;files.&#160;Since&#160;cat&#160;can&#160;accept&#160;more&#160;than&#160;one&#160;file&#160;as<br/>an&#160;argument,&#160;it&#160;can&#160;also&#160;be&#160;used&#160;to&#160;join&#160;files&#160;together.&#160;Say&#160;we&#160;have&#160;downloaded&#160;a&#160;large<br/>file&#160;that&#160;has&#160;been&#160;split&#160;into&#160;multiple&#160;parts&#160;(multimedia&#160;files&#160;are&#160;often&#160;split&#160;this&#160;way&#160;on<br/>Usenet),&#160;and we&#160;want&#160;to&#160;join them&#160;back&#160;together. If the&#160;files&#160;were&#160;named:<br/>movie.mpeg.001 movie.mpeg.002 ... movie.mpeg.099<br/>we&#160;could join&#160;them&#160;back together&#160;with this&#160;command as&#160;follows:<br/>
<b>cat movie.mpeg.0* &gt; movie.mpeg</b><br/>
Since&#160;wildcards&#160;always&#160;expand&#160;in&#160;sorted&#160;order,&#160;the&#160;arguments&#160;will&#160;be&#160;arranged&#160;in&#160;the&#160;cor-<br/>rect&#160;order.<br/>This&#160;is&#160;all&#160;well&#160;and&#160;good,&#160;but&#160;what&#160;does&#160;this&#160;have&#160;to&#160;do&#160;with&#160;standard&#160;input?&#160;Nothing&#160;yet,<br/>but&#160;let's&#160;try&#160;something&#160;else.&#160;What&#160;happens&#160;if we&#160;enter&#160;cat&#160;with no arguments?<br/>
[me@linuxbox ~]$&#160;<b>cat</b><br/>
Nothing&#160;happens,&#160;it&#160;just&#160;sits&#160;there&#160;like&#160;it's&#160;hung.&#160;It&#160;might&#160;seem&#160;that&#160;way,&#160;but&#160;it's&#160;really&#160;do-<br/>ing exactly&#160;what&#160;it's&#160;supposed to&#160;do.<br/>If&#160;cat&#160;is&#160;not&#160;given&#160;any&#160;arguments,&#160;it&#160;reads&#160;from&#160;standard&#160;input&#160;and&#160;since&#160;standard&#160;input<br/>is,&#160;by&#160;default,&#160;attached&#160;to&#160;the&#160;keyboard,&#160;it's&#160;waiting&#160;for&#160;us&#160;to&#160;type&#160;something!&#160;Try&#160;adding<br/>the&#160;following text&#160;and pressing Enter:<br/>
[me@linuxbox ~]$&#160;<b>cat</b><br/>
59<br/>
<hr/>
<a name=84></a>6 – Redirection<br/>
<b>The quick brown fox jumped over the lazy dog.</b><br/>
Next,&#160;type&#160;a&#160;Ctrl-d&#160;(i.e.,&#160;hold&#160;down&#160;the&#160;Ctrl&#160;key&#160;and&#160;press&#160;“d”)&#160;to&#160;tell&#160;cat&#160;that&#160;it&#160;has<br/>reached&#160;<i>end of&#160;file</i>&#160;(EOF) on standard input:<br/>
[me@linuxbox ~]$&#160;<b>cat<br/>The quick brown fox jumped over the lazy dog.<br/></b>The quick brown fox jumped over the lazy dog.<br/>
In&#160;the&#160;absence&#160;of&#160;filename&#160;arguments,&#160;cat&#160;copies&#160;standard&#160;input&#160;to&#160;standard&#160;output,&#160;so<br/>we&#160;see&#160;our&#160;line&#160;of&#160;text&#160;repeated.&#160;We&#160;can&#160;use&#160;this&#160;behavior&#160;to&#160;create&#160;short&#160;text&#160;files.&#160;Let's<br/>say&#160;we&#160;wanted&#160;to&#160;create&#160;a&#160;file&#160;called&#160;lazy_dog.txt&#160;containing&#160;the&#160;text&#160;in&#160;our&#160;exam-<br/>ple.&#160;We&#160;would do this:<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; lazy_dog.txt<br/>The quick brown fox jumped over the lazy dog.</b><br/>
Type&#160;the&#160;command&#160;followed&#160;by&#160;the&#160;text&#160;we&#160;want&#160;to&#160;place&#160;in&#160;the&#160;file.&#160;Remember&#160;to&#160;type<br/>Ctrl-d&#160;at&#160;the&#160;end.&#160;Using&#160;the&#160;command&#160;line,&#160;we&#160;have&#160;implemented&#160;the&#160;world's&#160;dumbest<br/>word processor!&#160;To see&#160;our results, we&#160;can&#160;use&#160;cat&#160;to copy the&#160;file&#160;to stdout&#160;again.<br/>
[me@linuxbox ~]$&#160;<b>cat lazy_dog.txt<br/></b>The quick brown fox jumped over the lazy dog.<br/>
Now&#160;that&#160;we&#160;know&#160;how&#160;cat&#160;accepts&#160;standard&#160;input,&#160;in&#160;addition&#160;to&#160;filename&#160;arguments,<br/>let's&#160;try redirecting standard&#160;input.<br/>
[me@linuxbox ~]$&#160;<b>cat &lt; lazy_dog.txt<br/></b>The quick brown fox jumped over the lazy dog.<br/>
Using&#160;the&#160;&lt;&#160;redirection&#160;operator,&#160;we&#160;change&#160;the&#160;source&#160;of&#160;standard&#160;input&#160;from&#160;the&#160;key-<br/>board&#160;to&#160;the&#160;file&#160;lazy_dog.txt.&#160;We&#160;see&#160;that&#160;the&#160;result&#160;is&#160;the&#160;same&#160;as&#160;passing&#160;a&#160;single<br/>filename&#160;argument.&#160;This&#160;is&#160;not&#160;particularly&#160;useful&#160;compared&#160;to&#160;passing&#160;a&#160;filename&#160;argu-<br/>ment,&#160;but&#160;it&#160;serves&#160;to&#160;demonstrate&#160;using&#160;a&#160;file&#160;as&#160;a&#160;source&#160;of&#160;standard&#160;input.&#160;Other&#160;com-<br/>mands&#160;make&#160;better use&#160;of standard input, as&#160;we&#160;will&#160;soon see.<br/>Before&#160;we&#160;move&#160;on,&#160;check&#160;out&#160;the&#160;man&#160;page&#160;for&#160;cat,&#160;because&#160;it&#160;has&#160;several&#160;interesting<br/>
60<br/>
<hr/>
<a name=85></a>Redirecting&#160;Standard Input<br/>
options.<br/>
<b>Pipelines<br/></b>The&#160;capability&#160;of&#160;commands&#160;to&#160;read&#160;data&#160;from&#160;standard&#160;input&#160;and&#160;send&#160;to&#160;standard&#160;output<br/>is&#160;utilized&#160;by&#160;a&#160;shell&#160;feature&#160;called&#160;<i>pipelines</i>.&#160;Using&#160;the&#160;pipe&#160;operator&#160;|&#160;(vertical&#160;bar),&#160;the<br/>standard output&#160;of one&#160;command can&#160;be&#160;<i>piped</i>&#160;into the&#160;standard&#160;input&#160;of another.<br/>
<i>command1</i>&#160;|&#160;<i>command2</i><br/>
To fully&#160;demonstrate&#160;this,&#160;we&#160;are&#160;going to&#160;need&#160;some&#160;commands. Remember&#160;how&#160;we&#160;said<br/>there&#160;was&#160;one&#160;we&#160;already&#160;knew&#160;that&#160;accepts&#160;standard&#160;input?&#160;It's&#160;less.&#160;We&#160;can&#160;use&#160;less<br/>to&#160;display,&#160;page&#160;by page,&#160;the&#160;output&#160;of any&#160;command&#160;that&#160;sends&#160;its&#160;results&#160;to standard&#160;out-<br/>put:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin | less</b><br/>
This&#160;is&#160;extremely&#160;handy!&#160;Using&#160;this&#160;technique,&#160;we&#160;can&#160;conveniently&#160;examine&#160;the&#160;output<br/>of any command that&#160;produces&#160;standard&#160;output.<br/>
<b>The&#160;Difference&#160;Between&#160;&gt;&#160;and&#160;|</b><br/>
At&#160;first&#160;glance,&#160;it&#160;may&#160;be&#160;hard&#160;to&#160;understand&#160;the&#160;redirection&#160;performed&#160;by&#160;the<br/>pipeline&#160;operator&#160;|&#160;versus&#160;the&#160;redirection&#160;operator&#160;&gt;.&#160;Simply&#160;put,&#160;the&#160;redirection<br/>operator&#160;connects&#160;a&#160;command&#160;with&#160;a&#160;file,&#160;while&#160;the&#160;pipeline&#160;operator&#160;connects&#160;the<br/>output&#160;of one&#160;command&#160;with the&#160;input&#160;of a&#160;second command.<br/><i>command1</i>&#160;&gt;&#160;<i>file1<br/>command1</i>&#160;|&#160;<i>command2<br/></i>A&#160;lot&#160;of&#160;people&#160;will&#160;try&#160;the&#160;following&#160;when&#160;they&#160;are&#160;learning&#160;about&#160;pipelines, “just<br/>to see&#160;what&#160;happens”:<br/><i>command1</i>&#160;&gt;&#160;<i>command2<br/></i>Answer:&#160;sometimes&#160;something really&#160;bad.<br/>
61<br/>
<hr/>
<a name=86></a>6 – Redirection<br/>
Here&#160;is&#160;an&#160;actual&#160;example&#160;submitted&#160;by&#160;a&#160;reader&#160;who&#160;was&#160;administering&#160;a&#160;Linux-<br/>based server appliance.&#160;&#160;As&#160;the&#160;superuser, he&#160;did&#160;this:<br/># cd /usr/bin<br/># ls &gt; less<br/>The&#160;first&#160;command&#160;put&#160;him&#160;in&#160;the&#160;directory&#160;where&#160;most&#160;programs&#160;are&#160;stored&#160;and<br/>the&#160;second&#160;command&#160;told&#160;the&#160;shell&#160;to&#160;overwrite&#160;the&#160;file&#160;less&#160;with&#160;&#160;the&#160;output&#160;of<br/>the&#160;ls&#160;command.&#160;Since&#160;the&#160;/usr/bin&#160;directory&#160;already&#160;contained&#160;a&#160;file&#160;named<br/>less&#160;(the&#160;less&#160;program),&#160;the&#160;second&#160;command&#160;overwrote&#160;the&#160;less&#160;program<br/>file&#160;with the&#160;text&#160;from&#160;ls, thus&#160;destroying the&#160;less&#160;program&#160;on his&#160;system.<br/>The&#160;lesson&#160;here&#160;is&#160;that&#160;the&#160;redirection&#160;operator&#160;silently&#160;creates&#160;or&#160;overwrites&#160;files,<br/>so you need&#160;to treat&#160;it&#160;with a&#160;lot&#160;of respect.&#160;<br/>
Filters<br/>Pipelines&#160;are&#160;often&#160;used&#160;to&#160;perform&#160;complex&#160;operations&#160;on&#160;data.&#160;It&#160;is&#160;possible&#160;to&#160;put&#160;sev-<br/>eral&#160;commands&#160;together&#160;into&#160;a&#160;pipeline.&#160;Frequently,&#160;the&#160;commands&#160;used&#160;this&#160;way&#160;are&#160;re-<br/>ferred&#160;to&#160;as&#160;<i>filters</i>.&#160;&#160;Filters&#160;take&#160;input,&#160;change&#160;it&#160;somehow,&#160;and&#160;then&#160;output&#160;it.&#160;The&#160;first&#160;one<br/>we&#160;will&#160;try&#160;is&#160;sort.&#160;Imagine&#160;we&#160;wanted&#160;to&#160;make&#160;a&#160;combined&#160;list&#160;of&#160;all&#160;the&#160;executable<br/>programs&#160;in&#160;/bin&#160;and&#160;/usr/bin, put&#160;them&#160;in sorted&#160;order and view&#160;the&#160;resulting&#160;list:<br/>
[me@linuxbox ~]$&#160;<b>ls /bin /usr/bin | sort | less</b><br/>
Since&#160;we&#160;specified&#160;two&#160;directories&#160;(/bin&#160;and&#160;/usr/bin),&#160;the&#160;output&#160;of&#160;ls&#160;would&#160;have<br/>consisted&#160;of&#160;two&#160;sorted&#160;lists,&#160;one&#160;for&#160;each&#160;directory.&#160;By&#160;including&#160;sort&#160;in&#160;our&#160;pipeline,<br/>we&#160;changed the&#160;data&#160;to produce&#160;a&#160;single,&#160;sorted&#160;list.<br/>
uniq&#160;-&#160;Report&#160;or&#160;Omit&#160;Repeated&#160;Lines<br/>The&#160;uniq&#160;command&#160;is&#160;often&#160;used&#160;in&#160;conjunction&#160;with&#160;sort.&#160;uniq&#160;accepts&#160;a&#160;sorted&#160;list<br/>of&#160;data&#160;from&#160;either&#160;standard&#160;input&#160;or&#160;a&#160;single&#160;filename&#160;argument&#160;(see&#160;the&#160;uniq&#160;man&#160;page<br/>for&#160;details)&#160;and,&#160;by&#160;default,&#160;removes&#160;any&#160;duplicates&#160;from&#160;the&#160;list.&#160;So,&#160;to&#160;make&#160;sure&#160;our&#160;list<br/>has&#160;no&#160;duplicates&#160;(that&#160;is,&#160;any&#160;programs&#160;of&#160;the&#160;same&#160;name&#160;that&#160;appear&#160;in&#160;both&#160;the&#160;/bin<br/>and&#160;/usr/bin&#160;directories), we&#160;will&#160;add&#160;uniq&#160;to our pipeline.<br/>
[me@linuxbox ~]$&#160;<b>ls /bin /usr/bin | sort | uniq | less</b><br/>
62<br/>
<hr/>
<a name=87></a>Pipelines<br/>
In&#160;this&#160;example,&#160;we&#160;use&#160;&#160;uniq&#160;&#160;to&#160;remove&#160;any&#160;duplicates&#160;from&#160;the&#160;output&#160;of&#160;the&#160;&#160;sort<br/>command.&#160;If we&#160;want&#160;to see&#160;the&#160;list&#160;of duplicates&#160;instead, we&#160;add the&#160;“-d”&#160;option to&#160;uniq<br/>like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>ls /bin /usr/bin | sort | uniq -d | less</b><br/>
wc&#160;–&#160;Print&#160;Line,&#160;Word,&#160;and&#160;Byte&#160;Counts<br/>The&#160;wc&#160;(word&#160;count)&#160;command&#160;is&#160;used&#160;to&#160;display&#160;the&#160;number&#160;of&#160;lines,&#160;words,&#160;and&#160;bytes<br/>contained in&#160;files. Here's&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>wc ls-output.txt<br/></b>&#160;7902 &#160;64566 503634 ls-output.txt<br/>
In&#160;this&#160;case,&#160;it&#160;prints&#160;out&#160;three&#160;numbers:&#160;lines,&#160;words,&#160;and&#160;bytes&#160;contained&#160;in&#160;ls-out-<br/>put.txt.&#160;Like&#160;our&#160;previous&#160;commands,&#160;if&#160;executed&#160;without&#160;command&#160;line&#160;arguments,<br/>wc&#160;accepts&#160;standard&#160;input.&#160;The&#160;“-l”&#160;option&#160;limits&#160;its&#160;output&#160;to&#160;only&#160;report&#160;lines.&#160;&#160;Adding&#160;it<br/>to&#160;a&#160;pipeline&#160;is&#160;a&#160;handy&#160;way&#160;to&#160;count&#160;things.&#160;To&#160;see&#160;the&#160;number&#160;of&#160;items&#160;we&#160;have&#160;in&#160;our<br/>sorted list,&#160;we&#160;can do this:<br/>
[me@linuxbox ~]$&#160;<b>ls /bin /usr/bin | sort | uniq | wc -l<br/></b>2728<br/>
grep&#160;–&#160;Print&#160;Lines&#160;Matching&#160;a&#160;Pattern<br/>grep&#160;is&#160;a&#160;powerful&#160;program&#160;used to find text&#160;patterns&#160;within&#160;files. It's&#160;used like&#160;this:<br/>
grep&#160;<i>pattern</i>&#160;[<i>file...</i>]<br/>
When&#160;grep&#160;encounters&#160;a&#160;“pattern”&#160;in&#160;the&#160;file,&#160;it&#160;prints&#160;out&#160;the&#160;lines&#160;containing&#160;it.&#160;The<br/>patterns&#160;that&#160;grep&#160;can&#160;match&#160;can&#160;be&#160;very&#160;complex,&#160;but&#160;for&#160;now&#160;we&#160;will&#160;concentrate&#160;on<br/>simple&#160;text&#160;matches.&#160;We'll&#160;cover&#160;the&#160;advanced&#160;patterns,&#160;called&#160;&#160;<i>regular&#160;expressions</i>&#160;&#160;in<br/>Chapter&#160;19.<br/>Let's&#160;say&#160;we&#160;wanted&#160;to&#160;find&#160;all&#160;the&#160;files&#160;in our&#160;list&#160;of&#160;programs&#160;that&#160;had the&#160;word&#160;zip&#160;em-<br/>bedded&#160;in&#160;the&#160;name.&#160;Such&#160;a&#160;search&#160;might&#160;give&#160;us&#160;an&#160;idea&#160;of&#160;some&#160;of&#160;the&#160;programs&#160;on&#160;our<br/>system&#160;that&#160;had something to do with&#160;file&#160;compression.&#160;We&#160;would do this:<br/>
63<br/>
<hr/>
<a name=88></a>6 – Redirection<br/>
[me@linuxbox ~]$&#160;<b>ls /bin /usr/bin | sort | uniq | grep zip<br/></b>bunzip2<br/>bzip2<br/>gunzip<br/>gzip<br/>unzip<br/>zip<br/>zipcloak<br/>zipgrep<br/>zipinfo<br/>zipnote<br/>zipsplit<br/>
There&#160;are&#160;a&#160;couple&#160;of handy options&#160;for&#160;grep:<br/>
•<br/>
-i,&#160;which&#160;causes&#160;&#160;grep&#160;&#160;to&#160;ignore&#160;case&#160;when&#160;performing&#160;the&#160;search&#160;(normally<br/>searches&#160;are&#160;case&#160;sensitive)<br/>
•<br/>
-v, which tells&#160;grep&#160;to print&#160;only those&#160;lines&#160;that&#160;do not&#160;match the&#160;pattern.<br/>
head&#160;/&#160;tail&#160;–&#160;Print&#160;First&#160;/&#160;Last&#160;Part&#160;of&#160;Files<br/>Sometimes&#160;we&#160;don't&#160;want&#160;all&#160;the&#160;output&#160;from&#160;a&#160;command.&#160;We&#160;may&#160;only&#160;want&#160;the&#160;first&#160;few<br/>lines&#160;or&#160;the&#160;last&#160;few&#160;lines.&#160;The&#160;head&#160;command&#160;prints&#160;the&#160;first&#160;ten&#160;lines&#160;of&#160;a&#160;file,&#160;and&#160;the<br/>tail&#160;&#160;command&#160;prints&#160;the&#160;last&#160;ten&#160;lines.&#160;By&#160;default,&#160;both&#160;commands&#160;print&#160;ten&#160;lines&#160;of<br/>text,&#160;but&#160;this&#160;can&#160;be&#160;adjusted&#160;with the&#160;-n&#160;option.<br/>
[me@linuxbox ~]$&#160;<b>head -n 5 ls-output.txt<br/></b>total 343496<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 31316 2007-12-05 08:58 [<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;8240 2007-12-09 13:39 411toppm<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160;111276 2007-11-26 14:27 a2p<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 25368 2006-10-06 20:16 a52dec<br/>[me@linuxbox ~]$&#160;<b>tail -n 5 ls-output.txt<br/></b>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;5234 2007-06-27 10:56 znew<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160; 691 2005-09-10 04:21 zonetab2pot.py<br/>-rw-r--r-- 1 root root &#160; &#160; &#160; &#160; 930 2007-11-01 12:23 zonetab2pot.pyc<br/>-rw-r--r-- 1 root root &#160; &#160; &#160; &#160; 930 2007-11-01 12:23 zonetab2pot.pyo<br/>lrwxrwxrwx 1 root root &#160; &#160; &#160; &#160; &#160; 6 2016-01-31 05:22 zsoelim -&gt; soelim<br/>
These&#160;can&#160;be&#160;used in pipelines&#160;as&#160;well:<br/>
64<br/>
<hr/>
<a name=89></a>Pipelines<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | tail -n 5<br/></b>znew<br/>zonetab2pot.py<br/>zonetab2pot.pyc<br/>zonetab2pot.pyo<br/>zsoelim<br/>
tail&#160;has&#160;an option&#160;which&#160;allows&#160;us&#160;to&#160;view&#160;files&#160;in&#160;real&#160;time.&#160;This&#160;is&#160;useful&#160;for watching<br/>the&#160;progress&#160;of&#160;log&#160;files&#160;as&#160;they&#160;are&#160;being&#160;written.&#160;In&#160;the&#160;following&#160;example,&#160;we&#160;will&#160;look<br/>at&#160;the&#160;messages&#160;file&#160;in&#160;/var/log&#160;(or&#160;the&#160;/var/log/syslog&#160;file&#160;if&#160;messages&#160;is<br/>missing).&#160;Superuser&#160;privileges&#160;are&#160;required&#160;to&#160;do&#160;this&#160;on&#160;some&#160;Linux&#160;distributions,&#160;be-<br/>cause&#160;the&#160;/var/log/messages&#160;file&#160;may contain security information:<br/>
[me@linuxbox ~]$&#160;<b>tail -f /var/log/messages<br/></b>Feb &#160;8 13:40:05 twin4 dhclient: DHCPACK from 192.168.1.1<br/>Feb &#160;8 13:40:05 twin4 dhclient: bound to 192.168.1.4 -- renewal in&#160;<br/>1652 seconds.<br/>Feb &#160;8 13:55:32 twin4 mountd[3953]: /var/NFSv4/musicbox exported to&#160;<br/>both 192.168.1.0/24 and twin7.localdomain in&#160;<br/>192.168.1.0/24,twin7.localdomain<br/>Feb &#160;8 14:07:37 twin4 dhclient: DHCPREQUEST on eth0 to 192.168.1.1&#160;<br/>port 67<br/>Feb &#160;8 14:07:37 twin4 dhclient: DHCPACK from 192.168.1.1<br/>Feb &#160;8 14:07:37 twin4 dhclient: bound to 192.168.1.4 -- renewal in&#160;<br/>1771 seconds.<br/>Feb &#160;8 14:09:56 twin4 smartd[3468]: Device: /dev/hda, SMART&#160;<br/>Prefailure Attribute: 8 Seek_Time_Performance changed from 237 to 236<br/>Feb &#160;8 14:10:37 twin4 mountd[3953]: /var/NFSv4/musicbox exported to&#160;<br/>both 192.168.1.0/24 and twin7.localdomain in&#160;<br/>192.168.1.0/24,twin7.localdomain<br/>Feb &#160;8 14:25:07 twin4 sshd(pam_unix)[29234]: session opened for user&#160;<br/>me by (uid=0)<br/>Feb &#160;8 14:25:36 twin4 su(pam_unix)[29279]: session opened for user&#160;<br/>root by me(uid=500)<br/>
Using&#160;the&#160;“-f”&#160;option,&#160;tail&#160;continues&#160;to&#160;monitor&#160;the&#160;file,&#160;and&#160;when&#160;new&#160;lines&#160;are&#160;ap-<br/>pended, they&#160;immediately&#160;appear on the&#160;display.&#160;This&#160;continues&#160;until&#160;we&#160;press&#160;Ctrl-c.<br/>
tee&#160;–&#160;Read&#160;from&#160;Stdin&#160;and&#160;Output&#160;to&#160;Stdout&#160;and&#160;Files<br/>In&#160;keeping&#160;with&#160;our&#160;plumbing&#160;metaphor,&#160;Linux&#160;provides&#160;a&#160;command&#160;called&#160;tee&#160;which<br/>
65<br/>
<hr/>
<a name=90></a>6 – Redirection<br/>
creates&#160;a&#160;“tee”&#160;fitting&#160;on&#160;our&#160;pipe.&#160;The&#160;tee&#160;program&#160;reads&#160;standard&#160;input&#160;and&#160;copies&#160;it&#160;to<br/>both standard&#160;output&#160;(allowing the&#160;data&#160;to continue&#160;down the&#160;pipeline)&#160;and to one&#160;or more<br/>files.&#160;This&#160;is&#160;useful&#160;for&#160;capturing&#160;a&#160;pipeline's&#160;contents&#160;at&#160;an&#160;intermediate&#160;stage&#160;of&#160;process-<br/>ing.&#160;&#160;Here&#160;we&#160;repeat&#160;one&#160;of&#160;our&#160;earlier&#160;examples,&#160;this&#160;time&#160;including&#160;tee&#160;to&#160;capture&#160;the<br/>entire&#160;directory listing to the&#160;file&#160;ls.txt&#160;before&#160;grep&#160;filters&#160;the&#160;pipeline's&#160;contents:<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | tee ls.txt | grep zip<br/></b>bunzip2<br/>bzip2<br/>gunzip<br/>gzip<br/>unzip<br/>zip<br/>zipcloak<br/>zipgrep<br/>zipinfo<br/>zipnote<br/>zipsplit<br/>
<b>Summing&#160;Up<br/></b>As&#160;always,&#160;check&#160;out&#160;the&#160;documentation&#160;of&#160;each&#160;of&#160;the&#160;commands&#160;we&#160;have&#160;covered&#160;in<br/>this&#160;chapter.&#160;We&#160;have&#160;seen&#160;only&#160;their&#160;most&#160;basic&#160;usage.&#160;They&#160;all&#160;have&#160;a&#160;number&#160;of&#160;inter-<br/>esting&#160;options.&#160;As&#160;we&#160;gain&#160;Linux&#160;experience,&#160;we&#160;will&#160;see&#160;that&#160;the&#160;redirection&#160;feature&#160;of<br/>the&#160;command&#160;line&#160;is&#160;extremely&#160;useful&#160;for&#160;solving&#160;specialized&#160;problems.&#160;There&#160;are&#160;many<br/>commands&#160;that&#160;make&#160;use&#160;of&#160;standard&#160;input&#160;and&#160;output,&#160;and&#160;almost&#160;all&#160;command&#160;line&#160;pro-<br/>grams&#160;use&#160;standard error&#160;to display&#160;their&#160;informative&#160;messages.<br/>
<b>Linux&#160;Is&#160;About&#160;Imagination</b><br/>
When&#160;I&#160;am&#160;asked&#160;to&#160;explain&#160;the&#160;difference&#160;between&#160;Windows&#160;and&#160;Linux,&#160;I&#160;often<br/>use&#160;a&#160;toy analogy.<br/>Windows&#160;is&#160;like&#160;a&#160;Game&#160;Boy.&#160;You go to the&#160;store&#160;and buy one&#160;all&#160;shiny&#160;new&#160;in&#160;the<br/>box.&#160;You&#160;take&#160;it&#160;home,&#160;turn&#160;it&#160;on,&#160;and&#160;play&#160;with&#160;it.&#160;Pretty&#160;graphics,&#160;cute&#160;sounds.<br/>After&#160;a&#160;while,&#160;though,&#160;you&#160;get&#160;tired&#160;of&#160;the&#160;game&#160;that&#160;came&#160;with&#160;it,&#160;so&#160;you&#160;go&#160;back<br/>to&#160;the&#160;store&#160;and&#160;buy&#160;another&#160;one.&#160;This&#160;cycle&#160;repeats&#160;over&#160;and&#160;over.&#160;Finally,&#160;you&#160;go<br/>back&#160;to&#160;the&#160;store&#160;and&#160;say&#160;to&#160;the&#160;person&#160;behind&#160;the&#160;counter,&#160;“I&#160;want&#160;a&#160;game&#160;that<br/>does&#160;this!”&#160;only&#160;to&#160;be&#160;told&#160;that&#160;no&#160;such&#160;game&#160;exists&#160;because&#160;there&#160;is&#160;no&#160;“market<br/>
66<br/>
<hr/>
<a name=91></a>Summing&#160;Up<br/>
demand”&#160;for&#160;it.&#160;Then&#160;you&#160;say,&#160;“But&#160;I&#160;only&#160;need&#160;to&#160;change&#160;this&#160;one&#160;thing!”&#160;The<br/>person&#160;behind&#160;the&#160;counter&#160;says&#160;you&#160;can't&#160;change&#160;it.&#160;The&#160;games&#160;are&#160;all&#160;sealed&#160;up&#160;in<br/>their&#160;cartridges.&#160;You&#160;discover&#160;that&#160;your&#160;toy&#160;is&#160;limited&#160;to&#160;the&#160;games&#160;others&#160;have&#160;de-<br/>cided&#160;that&#160;you need.<br/>Linux,&#160;on&#160;the&#160;other&#160;hand,&#160;is&#160;like&#160;the&#160;world's&#160;largest&#160;Erector&#160;Set.&#160;You&#160;open&#160;it,&#160;and<br/>it's&#160;just&#160;a&#160;huge&#160;collection&#160;of&#160;parts.&#160;There's&#160;a&#160;lot&#160;of&#160;steel&#160;struts,&#160;screws,&#160;nuts,&#160;gears,<br/>pulleys,&#160;motors,&#160;and&#160;a&#160;few&#160;suggestions&#160;on&#160;what&#160;to&#160;build.&#160;So,&#160;you&#160;start&#160;to&#160;play&#160;with<br/>it.&#160;You&#160;build&#160;one&#160;of&#160;the&#160;suggestions&#160;and&#160;then&#160;another.&#160;After&#160;a&#160;while&#160;you&#160;discover<br/>that&#160;you&#160;have&#160;your&#160;own&#160;ideas&#160;of&#160;what&#160;to&#160;make.&#160;You&#160;don't&#160;ever&#160;have&#160;to&#160;go&#160;back&#160;to<br/>the&#160;store,&#160;as&#160;you&#160;already&#160;have&#160;everything&#160;you&#160;need.&#160;The&#160;Erector&#160;Set&#160;takes&#160;on&#160;the<br/>shape&#160;of your imagination. It&#160;does&#160;what&#160;you want.<br/>Your&#160;choice&#160;of&#160;toys&#160;is,&#160;of&#160;course,&#160;a&#160;personal&#160;thing,&#160;so&#160;which&#160;toy&#160;would&#160;you&#160;find<br/>more&#160;satisfying?&#160;<br/>
67<br/>
<hr/>
<a name=92></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
<i><b>7&#160;–&#160;Seeing&#160;the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It</b></i><br/>
In&#160;this&#160;chapter&#160;we&#160;are&#160;going&#160;to&#160;look&#160;at&#160;some&#160;of&#160;the&#160;“magic”&#160;that&#160;occurs&#160;on&#160;the&#160;command<br/>line&#160;when&#160;we&#160;press&#160;the&#160;Enter&#160;key.&#160;While&#160;we&#160;will&#160;examine&#160;several&#160;interesting&#160;and&#160;complex<br/>features&#160;of the&#160;shell,&#160;we&#160;will&#160;do it&#160;with just&#160;one&#160;new&#160;command.<br/>
●<br/>
echo&#160;– Display a&#160;line&#160;of text<br/>
<b>Expansion<br/></b>Each&#160;time&#160;we&#160;type&#160;a&#160;command&#160;and&#160;press&#160;the&#160;Enter&#160;key,&#160;bash&#160;performs&#160;several&#160;substitu-<br/>tions&#160;upon&#160;the&#160;text&#160;before&#160;it&#160;carries&#160;out&#160;our&#160;command.&#160;We&#160;have&#160;seen&#160;a&#160;couple&#160;of&#160;cases&#160;of<br/>how&#160;a&#160;simple&#160;character&#160;sequence,&#160;for&#160;example&#160;*,&#160;can&#160;have&#160;a&#160;lot&#160;of&#160;meaning&#160;to&#160;the&#160;shell.<br/>The&#160;process&#160;that&#160;makes&#160;this&#160;happen&#160;is&#160;called&#160;<i>expansion</i>.&#160;With&#160;expansion,&#160;we&#160;enter&#160;some-<br/>thing&#160;and&#160;it&#160;is&#160;expanded&#160;into&#160;something&#160;else&#160;before&#160;the&#160;shell&#160;acts&#160;upon&#160;it.&#160;To&#160;demonstrate<br/>what&#160;we&#160;mean&#160;by this, let's&#160;take&#160;a&#160;look&#160;at&#160;the&#160;echo&#160;command.&#160;echo&#160;is&#160;a&#160;shell&#160;builtin that<br/>performs&#160;a&#160;very&#160;simple&#160;task. It&#160;prints&#160;its&#160;text&#160;arguments&#160;on standard&#160;output.<br/>
[me@linuxbox ~]$&#160;<b>echo this is a test<br/></b>this is a test<br/>
That's&#160;pretty&#160;straightforward.&#160;Any&#160;argument&#160;passed&#160;to&#160;echo&#160;gets&#160;displayed.&#160;Let's&#160;try&#160;an-<br/>other example.<br/>
[me@linuxbox ~]$&#160;<b>echo *<br/></b>Desktop Documents ls-output.txt Music Pictures Public Templates&#160;<br/>Videos<br/>
So what&#160;just&#160;happened?&#160;Why&#160;didn't&#160;echo&#160;print&#160;*?&#160;As&#160;we&#160;recall&#160;from&#160;our work&#160;with&#160;wild-<br/>cards, the&#160;*&#160;character&#160;means&#160;match&#160;any characters&#160;in a&#160;filename, but&#160;what&#160;we&#160;didn't&#160;see&#160;in<br/>our&#160;original&#160;discussion&#160;was&#160;how&#160;the&#160;shell&#160;does&#160;that.&#160;The&#160;simple&#160;answer&#160;is&#160;that&#160;the&#160;shell<br/>expands&#160;the&#160;*&#160;into&#160;something&#160;else&#160;(in&#160;this&#160;instance,&#160;the&#160;names&#160;of&#160;the&#160;files&#160;in&#160;the&#160;current<br/>working&#160;&#160;&#160;directory)&#160;&#160;&#160;before&#160;&#160;&#160;the&#160;&#160;echo&#160;&#160;command&#160;&#160;&#160;is&#160;&#160;&#160;executed.&#160;&#160;When&#160;&#160;&#160;the&#160;&#160;&#160;Enter&#160;&#160;&#160;key&#160;&#160;&#160;is<br/>
68<br/>
<hr/>
<a name=93></a>Expansion<br/>
pressed,&#160;the&#160;shell&#160;automatically&#160;expands&#160;any&#160;qualifying&#160;characters&#160;on&#160;the&#160;command&#160;line<br/>before&#160;the&#160;command&#160;is&#160;carried&#160;out,&#160;so&#160;the&#160;echo&#160;command&#160;never&#160;saw&#160;the&#160;*,&#160;only&#160;its&#160;ex-<br/>panded result.&#160;Knowing&#160;this, we&#160;can see&#160;that&#160;echo&#160;behaved as&#160;expected.<br/>
Pathname&#160;Expansion<br/>The&#160;mechanism&#160;by&#160;which&#160;wildcards&#160;work&#160;is&#160;called&#160;<i>pathname&#160;expansion</i>.&#160;If&#160;we&#160;try&#160;some<br/>of&#160;the&#160;techniques&#160;that&#160;we&#160;employed&#160;in&#160;earlier&#160;chapters,&#160;we&#160;will&#160;see&#160;that&#160;they&#160;are&#160;really&#160;ex-<br/>pansions. Given a&#160;home&#160;directory&#160;that&#160;looks&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ls<br/></b>Desktop &#160; &#160;ls-output.txt &#160;Pictures &#160;Templates<br/>Documents &#160;Music &#160; &#160; &#160; &#160; &#160;Public &#160; &#160;Videos<br/>
we&#160;could carry&#160;out&#160;the&#160;following expansions:<br/>
[me@linuxbox ~]$&#160;<b>echo D*<br/></b>Desktop Documents<br/>
and this:<br/>
[me@linuxbox ~]$&#160;<b>echo *s<br/></b>Documents Pictures Templates Videos<br/>
or even this:<br/>
[me@linuxbox ~]$&#160;<b>echo [[:upper:]]*<br/></b>Desktop Documents Music Pictures Public Templates Videos<br/>
and looking&#160;beyond our home&#160;directory,&#160;we&#160;could do this:<br/>
[me@linuxbox ~]$&#160;<b>echo /usr/*/share<br/></b>/usr/kerberos/share /usr/local/share<br/>
69<br/>
<hr/>
<a name=94></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
<b>Pathname&#160;Expansion&#160;of&#160;Hidden&#160;Files</b><br/>
As&#160;we&#160;know,&#160;filenames&#160;that&#160;begin&#160;with&#160;a&#160;period&#160;character&#160;are&#160;hidden.&#160;Pathname<br/>expansion&#160;also&#160;respects&#160;this&#160;behavior.&#160;An&#160;expansion&#160;such&#160;as&#160;the&#160;following&#160;does<br/>not&#160;reveal&#160;hidden&#160;files.<br/>echo *<br/>It&#160;might&#160;appear&#160;at&#160;first&#160;glance&#160;that&#160;we&#160;could&#160;include&#160;hidden&#160;files&#160;in&#160;an&#160;expansion<br/>by starting&#160;the&#160;pattern with&#160;a&#160;leading period,&#160;like&#160;this:<br/>echo .*<br/>It&#160;almost&#160;works.&#160;However,&#160;if&#160;we&#160;examine&#160;the&#160;results&#160;closely,&#160;we&#160;will&#160;see&#160;that&#160;the<br/>names&#160;.&#160;and&#160;..&#160;will&#160;also&#160;appear&#160;in&#160;the&#160;results.&#160;Because&#160;these&#160;names&#160;refer&#160;to&#160;the<br/>current&#160;working&#160;directory&#160;and&#160;its&#160;parent&#160;directory,&#160;using&#160;this&#160;pattern&#160;will&#160;likely<br/>produce&#160;an&#160;incorrect&#160;result.&#160;We&#160;can&#160;see&#160;this&#160;if&#160;we&#160;try the&#160;following command:<br/>ls -d .* | less<br/>To&#160;better&#160;perform&#160;pathname&#160;expansion&#160;in&#160;this&#160;situation,&#160;we&#160;have&#160;to&#160;employ&#160;a<br/>more&#160;specific&#160;pattern.<br/>echo .[!.]*<br/>This&#160;pattern&#160;expands&#160;into&#160;every&#160;filename&#160;that&#160;begins&#160;with&#160;only&#160;one&#160;period&#160;fol-<br/>lowed&#160;by&#160;any&#160;other&#160;characters.&#160;This&#160;will&#160;work&#160;correctly&#160;with&#160;most&#160;hidden&#160;files<br/>(though&#160;it&#160;still&#160;won't&#160;include&#160;filenames&#160;with&#160;multiple&#160;leading&#160;periods).&#160;The&#160;&#160;ls<br/>command&#160;with&#160;the&#160;-A&#160;option&#160;(“almost&#160;all”)&#160;will&#160;provide&#160;a&#160;correct&#160;listing&#160;of&#160;hid-<br/>den files.<br/>ls -A<br/>
Tilde&#160;Expansion<br/>As&#160;we&#160;may&#160;recall&#160;from&#160;our&#160;introduction&#160;to&#160;the&#160;cd&#160;command,&#160;the&#160;tilde&#160;character&#160;(~)&#160;has&#160;a<br/>special&#160;meaning.&#160;When&#160;used&#160;at&#160;the&#160;beginning&#160;of&#160;a&#160;word,&#160;it&#160;expands&#160;into&#160;the&#160;name&#160;of&#160;the<br/>home&#160;directory&#160;of&#160;the&#160;named&#160;user&#160;or,&#160;if&#160;no&#160;user&#160;is&#160;named,&#160;the&#160;home&#160;directory&#160;of&#160;the&#160;cur-<br/>rent&#160;user.<br/>
[me@linuxbox ~]$&#160;<b>echo ~<br/></b>/home/me<br/>
If user&#160;“foo”&#160;has&#160;an account, then it&#160;expands&#160;into&#160;this:<br/>
70<br/>
<hr/>
<a name=95></a>Expansion<br/>
[me@linuxbox ~]$&#160;<b>echo ~foo<br/></b>/home/foo<br/>
Arithmetic&#160;Expansion<br/>The&#160;shell&#160;allows&#160;arithmetic&#160;to&#160;be&#160;performed&#160;by&#160;expansion.&#160;This&#160;allows&#160;us&#160;to&#160;use&#160;the&#160;shell<br/>prompt&#160;as&#160;a&#160;calculator.<br/>
[me@linuxbox ~]$&#160;<b>echo $((2 + 2))<br/></b>4<br/>
Arithmetic&#160;expansion uses&#160;the&#160;following&#160;form:<br/>$((<i>expression</i>))<br/>where&#160;<i>expression</i>&#160;is&#160;an&#160;arithmetic&#160;expression&#160;consisting&#160;of&#160;values&#160;and&#160;arithmetic&#160;opera-<br/>tors.<br/>Arithmetic&#160;expansion&#160;supports&#160;only&#160;integers&#160;(whole&#160;numbers,&#160;no&#160;decimals)&#160;but&#160;can&#160;per-<br/>form&#160;quite&#160;a&#160;number&#160;of&#160;different&#160;operations.&#160;Table&#160;7-1&#160;describes&#160;a&#160;few&#160;of&#160;the&#160;supported<br/>operators.<br/>
<i>Table&#160;7-1:&#160;Arithmetic&#160;Operators</i><br/>
<b>Operator</b><br/>
<b>Description</b><br/>
+<br/>
Addition<br/>
-<br/>
Subtraction<br/>
*<br/>
Multiplication<br/>
/<br/>
Division (but&#160;remember, since&#160;expansion supports&#160;only integer&#160;<br/>arithmetic, results&#160;are&#160;integers).<br/>
%<br/>
Modulo,&#160;which simply&#160;means&#160;“remainder.”<br/>
**<br/>
Exponentiation<br/>
Spaces&#160;are&#160;not&#160;significant&#160;in&#160;arithmetic&#160;expressions&#160;and&#160;expressions&#160;may&#160;be&#160;nested.&#160;For<br/>example, to&#160;multiply 5 squared by 3, we&#160;can&#160;use&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>echo $(($((5**2)) * 3))</b><br/>
71<br/>
<hr/>
<a name=96></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
75<br/>
Single&#160;parentheses&#160;may&#160;be&#160;used&#160;to&#160;group&#160;multiple&#160;subexpressions.&#160;With&#160;this&#160;technique,<br/>we&#160;can&#160;rewrite&#160;the&#160;previous&#160;example&#160;and&#160;get&#160;the&#160;same&#160;result&#160;using&#160;a&#160;single&#160;expansion&#160;in-<br/>stead of two.<br/>
[me@linuxbox ~]$&#160;<b>echo $(((5**2) * 3))<br/></b>75<br/>
Here&#160;is&#160;an&#160;example&#160;using&#160;the&#160;division&#160;and&#160;remainder&#160;operators.&#160;Notice&#160;the&#160;effect&#160;of&#160;inte-<br/>ger division.<br/>
[me@linuxbox ~]$&#160;<b>echo Five divided by two equals $((5/2))<br/></b>Five divided by two equals 2<br/>[me@linuxbox ~]$&#160;<b>echo with $((5%2)) left over.<br/></b>with 1 left over.<br/>
Arithmetic&#160;expansion is&#160;covered&#160;in greater detail&#160;in Chapter&#160;34.<br/>
Brace&#160;Expansion<br/>Perhaps&#160;the&#160;strangest&#160;expansion&#160;is&#160;called&#160;<i>brace&#160;expansion</i>.&#160;With&#160;it,&#160;we&#160;can&#160;create&#160;multiple<br/>text&#160;strings&#160;from&#160;a&#160;pattern containing&#160;braces. Here's&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>echo Front-{A,B,C}-Back<br/></b>Front-A-Back Front-B-Back Front-C-Back<br/>
Patterns&#160;to&#160;be&#160;brace&#160;expanded&#160;may&#160;contain&#160;a&#160;leading&#160;portion&#160;called&#160;a&#160;&#160;<i>preamble</i>&#160;&#160;and&#160;a<br/>trailing&#160;&#160;&#160;portion&#160;&#160;&#160;called&#160;&#160;&#160;a&#160;&#160;<i>postscript</i>.&#160;&#160;The&#160;&#160;&#160;brace&#160;&#160;&#160;expression&#160;&#160;&#160;itself&#160;&#160;&#160;may&#160;&#160;&#160;contain&#160;&#160;&#160;either&#160;&#160;&#160;a<br/>comma-separated&#160;list&#160;of&#160;strings&#160;or&#160;a&#160;range&#160;of&#160;integers&#160;or&#160;single&#160;characters.&#160;The&#160;pattern<br/>may not&#160;contain&#160;unquoted whitespace. Here&#160;is&#160;an example&#160;using a&#160;range&#160;of integers:<br/>
[me@linuxbox ~]$&#160;<b>echo Number_{1..5}<br/></b>Number_1 Number_2 Number_3 Number_4 Number_5<br/>
In&#160;bash&#160;version 4.0 and newer,&#160;integers&#160;may also be&#160;<i>zero-padded</i>&#160;like&#160;so:<br/>
72<br/>
<hr/>
<a name=97></a>Expansion<br/>
[me@linuxbox ~]$&#160;<b>echo {01..15}<br/></b>01 02 03 04 05 06 07 08 09 10 11 12 13 14 15<br/>[me@linuxbox ~]$&#160;<b>echo {001..15}<br/></b>001 002 003 004 005 006 007 008 009 010 011 012 013 014 015<br/>
Here&#160;is&#160;a&#160;range&#160;of letters&#160;in reverse&#160;order:<br/>
[me@linuxbox ~]$&#160;<b>echo {Z..A}<br/></b>Z Y X W V U T S R Q P O N M L K J I H G F E D C B A<br/>
Brace&#160;expansions&#160;may be&#160;nested.<br/>
[me@linuxbox ~]$&#160;<b>echo a{A{1,2},B{3,4}}b<br/></b>aA1b aA2b aB3b aB4b<br/>
So,&#160;what&#160;is&#160;this&#160;good&#160;for?&#160;The&#160;most&#160;common&#160;application&#160;is&#160;to&#160;make&#160;lists&#160;of&#160;files&#160;or&#160;direc-<br/>tories&#160;to&#160;be&#160;created.&#160;For&#160;example,&#160;if&#160;we&#160;were&#160;photographers&#160;and&#160;had&#160;a&#160;large&#160;collection&#160;of<br/>images&#160;that&#160;we&#160;wanted&#160;to&#160;organize&#160;into&#160;years&#160;and&#160;months,&#160;the&#160;first&#160;thing&#160;we&#160;might&#160;do&#160;is<br/>create&#160;a&#160;series&#160;of&#160;directories&#160;named&#160;in&#160;numeric&#160;“Year-Month”&#160;format.&#160;This&#160;way,&#160;the&#160;direc-<br/>tory&#160;names&#160;would&#160;sort&#160;in&#160;chronological&#160;order.&#160;We&#160;could&#160;type&#160;out&#160;a&#160;complete&#160;list&#160;of&#160;direc-<br/>tories, but&#160;that's&#160;a&#160;lot&#160;of work and&#160;it's&#160;error-prone.&#160;Instead, we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>mkdir Photos<br/></b>[me@linuxbox ~]$&#160;<b>cd Photos<br/></b>[me@linuxbox Photos]$&#160;<b>mkdir {2007..2009}-{01..12}<br/></b>[me@linuxbox Photos]$&#160;<b>ls<br/></b>2007-01 &#160;2007-07 &#160;2008-01 &#160;2008-07 &#160;2009-01 &#160;2009-07<br/>2007-02 &#160;2007-08 &#160;2008-02 &#160;2008-08 &#160;2009-02 &#160;2009-08<br/>2007-03 &#160;2007-09 &#160;2008-03 &#160;2008-09 &#160;2009-03 &#160;2009-09<br/>2007-04 &#160;2007-10 &#160;2008-04 &#160;2008-10 &#160;2009-04 &#160;2009-10<br/>2007-05 &#160;2007-11 &#160;2008-05 &#160;2008-11 &#160;2009-05 &#160;2009-11<br/>2007-06 &#160;2007-12 &#160;2008-06 &#160;2008-12 &#160;2009-06 &#160;2009-12<br/>
Pretty slick!<br/>
Parameter&#160;Expansion<br/>We're&#160;going&#160;to&#160;touch&#160;only&#160;briefly&#160;on&#160;&#160;parameter&#160;expansion&#160;&#160;in&#160;this&#160;chapter,&#160;but&#160;we'll&#160;be<br/>covering&#160;it&#160;extensively&#160;later.&#160;It's&#160;a&#160;feature&#160;that&#160;is&#160;more&#160;useful&#160;in&#160;shell&#160;scripts&#160;than&#160;directly<br/>
73<br/>
<hr/>
<a name=98></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
on&#160;the&#160;command&#160;line.&#160;Many&#160;of&#160;its&#160;capabilities&#160;have&#160;to&#160;do&#160;with&#160;the&#160;system's&#160;ability&#160;to&#160;store<br/>small&#160;chunks&#160;of&#160;data&#160;and&#160;to&#160;give&#160;each&#160;chunk&#160;a&#160;name.&#160;Many&#160;such&#160;chunks,&#160;more&#160;properly<br/>called&#160;&#160;<i>variables</i>,&#160;are&#160;available&#160;for&#160;our&#160;examination.&#160;For&#160;example,&#160;the&#160;variable&#160;named<br/>USER&#160;contains&#160;our&#160;username.&#160;To&#160;invoke&#160;parameter&#160;expansion&#160;and&#160;reveal&#160;the&#160;contents&#160;of<br/>USER&#160;we&#160;would&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>echo $USER<br/></b>me<br/>
To see&#160;a&#160;list&#160;of available&#160;variables, try this:<br/>
[me@linuxbox ~]$&#160;<b>printenv | less</b><br/>
You&#160;may&#160;have&#160;noticed&#160;that&#160;with&#160;other&#160;types&#160;of&#160;expansion,&#160;if&#160;we&#160;mistype&#160;a&#160;pattern,&#160;the&#160;ex-<br/>pansion&#160;will&#160;not&#160;take&#160;place,&#160;and&#160;the&#160;&#160;echo&#160;&#160;command&#160;will&#160;simply&#160;display&#160;the&#160;mistyped<br/>pattern.&#160;With&#160;parameter&#160;expansion,&#160;if&#160;we&#160;misspell&#160;the&#160;name&#160;of&#160;a&#160;variable,&#160;the&#160;expansion<br/>will&#160;still&#160;take&#160;place&#160;but&#160;will&#160;result&#160;in an&#160;empty string:<br/>
[me@linuxbox ~]$&#160;<b>echo $SUER</b><br/>
[me@linuxbox ~]$&#160;<br/>
Command&#160;Substitution<br/>Command&#160;substitution&#160;allows&#160;us&#160;to use&#160;the&#160;output&#160;of a&#160;command&#160;as&#160;an&#160;expansion.<br/>
[me@linuxbox ~]$&#160;<b>echo $(ls)<br/></b>Desktop Documents ls-output.txt Music Pictures Public Templates&#160;<br/>Videos<br/>
One&#160;of my favorites&#160;goes&#160;something&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ls -l $(which cp)<br/></b>-rwxr-xr-x 1 root root 71516 2007-12-05 08:58 /bin/cp<br/>
Here&#160;we&#160;passed&#160;the&#160;results&#160;of&#160;which&#160;cp&#160;as&#160;an&#160;argument&#160;to&#160;the&#160;ls&#160;command,&#160;thereby<br/>
74<br/>
<hr/>
<a name=99></a>Expansion<br/>
getting&#160;the&#160;listing&#160;of&#160;the&#160;cp&#160;program&#160;without&#160;having&#160;to&#160;know&#160;its&#160;full&#160;pathname.&#160;We&#160;are<br/>not&#160;limited&#160;to&#160;just&#160;simple&#160;commands.&#160;Entire&#160;pipelines&#160;can&#160;be&#160;used&#160;(only&#160;partial&#160;output&#160;is<br/>shown here):<br/>
[me@linuxbox ~]$&#160;<b>file $(ls -d /usr/bin/* | grep zip)<br/></b>/usr/bin/bunzip2: &#160; &#160; &#160;symbolic link to `bzip2'<br/>/usr/bin/bzip2: &#160; &#160; &#160; &#160;ELF 32-bit LSB executable, Intel 80386,&#160;<br/>version 1 (SYSV), dynamically linked (uses shared libs), for&#160;<br/>GNU/Linux 2.6.9, stripped<br/>/usr/bin/bzip2recover: ELF 32-bit LSB executable, Intel 80386,&#160;<br/>version 1 (SYSV), dynamically linked (uses shared libs), for&#160;<br/>GNU/Linux 2.6.9, stripped<br/>/usr/bin/funzip: &#160; &#160; &#160; ELF 32-bit LSB executable, Intel 80386,&#160;<br/>version 1 (SYSV), dynamically linked (uses shared libs), for&#160;<br/>GNU/Linux 2.6.9, stripped<br/>/usr/bin/gpg-zip: &#160; &#160; &#160;Bourne shell script text executable<br/>/usr/bin/gunzip: &#160; &#160; &#160; symbolic link to `../../bin/gunzip'<br/>/usr/bin/gzip: &#160; &#160; &#160; &#160; symbolic link to `../../bin/gzip'<br/>/usr/bin/mzip: &#160; &#160; &#160; &#160; symbolic link to `mtools'<br/>
In&#160;this&#160;example,&#160;the&#160;results&#160;of&#160;the&#160;pipeline&#160;became&#160;the&#160;argument&#160;list&#160;of&#160;the&#160;file&#160;com-<br/>mand.<br/>There&#160;is&#160;an&#160;alternate&#160;syntax&#160;for&#160;command&#160;substitution&#160;in&#160;older&#160;shell&#160;programs&#160;that&#160;is&#160;also<br/>supported in&#160;bash. It&#160;uses&#160;<i>backquotes</i>&#160;instead of the&#160;dollar&#160;sign and parentheses.<br/>
[me@linuxbox ~]$&#160;<b>ls -l `which cp`<br/></b>-rwxr-xr-x 1 root root 71516 2007-12-05 08:58 /bin/cp<br/>
<b>Quoting<br/></b>Now&#160;that&#160;we've&#160;seen&#160;how&#160;many&#160;ways&#160;the&#160;shell&#160;can&#160;perform&#160;expansions,&#160;it's&#160;time&#160;to&#160;learn<br/>how&#160;we&#160;can&#160;control&#160;it.&#160;Take&#160;for example&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>echo this is a &#160; &#160; test<br/></b>this is a test<br/>
or this&#160;one:<br/>
75<br/>
<hr/>
<a name=100></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
[me@linuxbox ~]$&#160;<b>echo The total is $100.00<br/></b>The total is 00.00<br/>
In&#160;the&#160;first&#160;example,&#160;<i>word-splitting</i>&#160;by&#160;the&#160;shell&#160;removed&#160;extra&#160;whitespace&#160;from&#160;the&#160;echo<br/>command's&#160;list&#160;of&#160;arguments.&#160;In&#160;the&#160;second&#160;example,&#160;parameter&#160;expansion&#160;substituted&#160;an<br/>empty&#160;string&#160;for&#160;the&#160;value&#160;of&#160;$1&#160;because&#160;it&#160;was&#160;an&#160;undefined&#160;variable.&#160;The&#160;shell&#160;provides<br/>a&#160;mechanism&#160;called&#160;<i>quoting</i>&#160;to&#160;selectively&#160;suppress&#160;unwanted expansions.<br/>
Double&#160;Quotes<br/>The&#160;first&#160;type&#160;of&#160;quoting&#160;we&#160;will&#160;look&#160;at&#160;is&#160;<i>double&#160;quotes</i>.&#160;If&#160;we&#160;place&#160;text&#160;inside&#160;double<br/>quotes,&#160;all&#160;the&#160;special&#160;characters&#160;used&#160;by&#160;the&#160;shell&#160;lose&#160;their&#160;special&#160;meaning&#160;and&#160;are<br/>treated&#160;as&#160;ordinary&#160;characters.&#160;The&#160;exceptions&#160;are&#160;$,&#160;\&#160;(backslash),&#160;and&#160;`&#160;(back-quote).<br/>This&#160;means&#160;that&#160;&#160;word-splitting,&#160;pathname&#160;expansion,&#160;tilde&#160;expansion,&#160;and&#160;&#160;brace&#160;expan-<br/>sion&#160;are&#160;suppressed,&#160;but&#160;parameter&#160;expansion,&#160;arithmetic&#160;expansion,&#160;and&#160;command&#160;sub-<br/>stitution&#160;are&#160;still&#160;carried&#160;out.&#160;Using&#160;double&#160;quotes,&#160;we&#160;can&#160;cope&#160;with&#160;filenames&#160;containing<br/>embedded&#160;&#160;spaces.&#160;Say&#160;we&#160;were&#160;the&#160;&#160;unfortunate&#160;&#160;victim&#160;of&#160;a&#160;&#160;file&#160;&#160;called&#160;&#160;two word-<br/>s.txt. If&#160;we&#160;tried&#160;to use&#160;this&#160;on the&#160;command&#160;line,&#160;word-splitting&#160;would cause&#160;this&#160;to&#160;be<br/>treated as&#160;two separate&#160;arguments&#160;rather&#160;than the&#160;desired single&#160;argument.<br/>
[me@linuxbox ~]$&#160;<b>ls -l two words.txt<br/></b>ls: cannot access two: No such file or directory<br/>ls: cannot access words.txt: No such file or directory<br/>
By&#160;using&#160;double&#160;quotes,&#160;we&#160;stop&#160;the&#160;word-splitting&#160;and&#160;get&#160;the&#160;desired&#160;result;&#160;further,&#160;we<br/>can even&#160;repair&#160;the&#160;damage.<br/>
[me@linuxbox ~]$&#160;<b>ls -l &#34;two words.txt&#34;<br/></b>-rw-rw-r-- 1 me &#160; me &#160; 18 2016-02-20 13:03 two words.txt<br/>[me@linuxbox ~]$&#160;<b>mv &#34;two words.txt&#34; two_words.txt</b><br/>
There!&#160;Now&#160;we&#160;don't&#160;have&#160;to&#160;keep typing&#160;those&#160;pesky double&#160;quotes.<br/>Remember,&#160;&#160;parameter&#160;&#160;expansion,&#160;&#160;arithmetic&#160;&#160;expansion,&#160;and&#160;&#160;command&#160;substitution&#160;&#160;still<br/>take&#160;place&#160;within double&#160;quotes.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;$USER $((2+2)) $(cal)&#34;<br/></b>me 4 &#160; &#160;February 2019<br/>Su Mo Tu We Th Fr Sa<br/>
76<br/>
<hr/>
<a name=101></a>Quoting<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 1 &#160;2<br/>&#160;3 &#160;4 &#160;5 &#160;6 &#160;7 &#160;8 &#160;9<br/>10 11 12 13 14 15 16<br/>17 18 19 20 21 22 23<br/>24 25 26 27 28 29<br/>
We&#160;should&#160;take&#160;a&#160;moment&#160;to look&#160;at&#160;the&#160;effect&#160;of double&#160;quotes&#160;on&#160;command&#160;substitution.<br/>First&#160;let's&#160;look&#160;a&#160;little&#160;deeper&#160;at&#160;how&#160;word&#160;splitting&#160;works.&#160;In&#160;our&#160;earlier&#160;example,&#160;we&#160;saw<br/>how&#160;word-splitting appears&#160;to remove&#160;extra&#160;spaces&#160;in our text.<br/>
[me@linuxbox ~]$&#160;<b>echo this is a &#160; &#160; test<br/></b>this is a test<br/>
By&#160;default,&#160;word-splitting&#160;looks&#160;for&#160;the&#160;presence&#160;of&#160;spaces,&#160;tabs,&#160;and&#160;newlines&#160;(linefeed<br/>characters)&#160;and&#160;treats&#160;them&#160;as&#160;&#160;<i>delimiters</i>&#160;&#160;between&#160;words.&#160;This&#160;means&#160;unquoted&#160;spaces,<br/>tabs,&#160;and&#160;newlines&#160;are&#160;not&#160;considered&#160;to&#160;be&#160;part&#160;of&#160;the&#160;text.&#160;They&#160;serve&#160;only&#160;as&#160;separators.<br/>Since&#160;they&#160;separate&#160;the&#160;words&#160;into&#160;different&#160;arguments,&#160;our&#160;example&#160;command&#160;line&#160;con-<br/>tains&#160;a&#160;command&#160;followed by four distinct&#160;arguments. If we&#160;add double&#160;quotes:<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;this is a &#160; &#160; test&#34;<br/></b>this is a &#160; &#160; test<br/>
word-splitting&#160;is&#160;suppressed&#160;and&#160;the&#160;embedded&#160;spaces&#160;are&#160;not&#160;treated&#160;as&#160;delimiters;&#160;rather<br/>they&#160;become&#160;part&#160;of&#160;the&#160;argument.&#160;Once&#160;the&#160;double&#160;quotes&#160;are&#160;added,&#160;our&#160;command&#160;line<br/>contains&#160;a&#160;command followed&#160;by a&#160;single&#160;argument.<br/>The&#160;fact&#160;that&#160;newlines&#160;are&#160;considered&#160;delimiters&#160;by&#160;the&#160;word-splitting&#160;mechanism&#160;causes<br/>an interesting,&#160;albeit&#160;subtle,&#160;effect&#160;on command&#160;substitution.&#160;Consider&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>echo $(cal)<br/></b>February 2019 Su Mo Tu We Th Fr Sa 1 2 3 4 5 6 7 8 9 10 11 12 13 14&#160;<br/>15 16 17 18 19 20 21 22 23 24 25 26 27 28 29<br/>[me@linuxbox ~]$&#160;<b>echo &#34;$(cal)&#34;<br/></b>&#160; &#160;February 2019<br/>Su Mo Tu We Th Fr Sa<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 1 &#160;2<br/>&#160;3 &#160;4 &#160;5 &#160;6 &#160;7 &#160;8 &#160;9<br/>10 11 12 13 14 15 16<br/>17 18 19 20 21 22 23<br/>
77<br/>
<hr/>
<a name=102></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
24 25 26 27 28 29<br/>
In&#160;the&#160;first&#160;instance,&#160;the&#160;unquoted&#160;command&#160;substitution&#160;resulted&#160;in&#160;a&#160;command&#160;line&#160;con-<br/>taining&#160;38&#160;arguments.&#160;In&#160;the&#160;second,&#160;it&#160;resulted&#160;in&#160;a&#160;command&#160;line&#160;with&#160;one&#160;argument&#160;that<br/>includes&#160;the&#160;embedded spaces&#160;and&#160;newlines.<br/>
Single&#160;Quotes<br/>If&#160;we&#160;need&#160;to&#160;suppress&#160;<i>all</i>&#160;expansions,&#160;we&#160;use&#160;<i>single&#160;quotes</i>.&#160;Here&#160;is&#160;a&#160;comparison&#160;of&#160;un-<br/>quoted, double&#160;quotes, and single&#160;quotes:<br/>
[me@linuxbox ~]$&#160;<b>echo text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER<br/></b>text /home/me/ls-output.txt a b foo 4 me<br/>[me@linuxbox ~]$&#160;<b>echo &#34;text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER&#34;<br/></b>text ~/*.txt {a,b} foo 4 me<br/>[me@linuxbox ~]$&#160;<b>echo 'text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER'<br/></b>text ~/*.txt {a,b} $(echo foo) $((2+2)) $USER<br/>
As&#160;we&#160;can&#160;see,&#160;with&#160;each&#160;succeeding&#160;level&#160;of&#160;quoting,&#160;more&#160;and&#160;more&#160;of&#160;the&#160;expansions<br/>are&#160;suppressed.<br/>
Escaping&#160;Characters<br/>Sometimes&#160;we&#160;want&#160;to&#160;quote&#160;only&#160;a&#160;single&#160;character.&#160;To&#160;do&#160;this,&#160;we&#160;can&#160;precede&#160;a&#160;charac-<br/>ter&#160;with&#160;a&#160;backslash,&#160;which&#160;in&#160;this&#160;context&#160;is&#160;called&#160;the&#160;&#160;<i>escape&#160;character</i>.&#160;Often&#160;this&#160;is<br/>done&#160;inside&#160;double&#160;quotes&#160;to&#160;selectively&#160;prevent&#160;an expansion.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;The balance for user $USER is: \$5.00&#34;<br/></b>The balance for user me is: $5.00<br/>
It&#160;is&#160;also&#160;common&#160;to&#160;use&#160;escaping&#160;to&#160;eliminate&#160;the&#160;special&#160;meaning&#160;of&#160;a&#160;character&#160;in&#160;a<br/>filename.&#160;For&#160;example,&#160;it&#160;is&#160;possible&#160;to&#160;use&#160;characters&#160;in&#160;filenames&#160;that&#160;normally&#160;have<br/>special&#160;meaning&#160;to&#160;the&#160;shell.&#160;These&#160;would&#160;include&#160;$,&#160;!,&#160;&amp;,&#160;spaces,&#160;and&#160;others.&#160;To&#160;include<br/>a&#160;special&#160;character&#160;in a&#160;filename&#160;we&#160;can do this:<br/>
[me@linuxbox ~]$&#160;<b>mv bad\&amp;filename good_filename</b><br/>
To&#160;allow&#160;a&#160;backslash&#160;character&#160;to&#160;appear,&#160;escape&#160;it&#160;by&#160;typing&#160;\\.&#160;Note&#160;that&#160;within&#160;single<br/>
78<br/>
<hr/>
<a name=103></a>Quoting<br/>
quotes, the&#160;backslash loses&#160;its&#160;special&#160;meaning&#160;and is&#160;treated as&#160;an ordinary&#160;character.<br/>
<b>Backslash&#160;Escape&#160;Sequences</b><br/>
In&#160;addition&#160;to&#160;its&#160;role&#160;as&#160;the&#160;escape&#160;character,&#160;the&#160;backslash&#160;is&#160;also&#160;used&#160;as&#160;part&#160;of<br/>a&#160;notation&#160;to&#160;represent&#160;certain&#160;special&#160;characters&#160;called&#160;<i>control&#160;codes</i>.&#160;The&#160;first&#160;32<br/>characters&#160;in&#160;the&#160;&#160;ASCII&#160;&#160;coding&#160;scheme&#160;are&#160;used&#160;to&#160;transmit&#160;commands&#160;to&#160;tele-<br/>type-like&#160;devices.&#160;Some&#160;of&#160;these&#160;codes&#160;are&#160;familiar&#160;(tab,&#160;backspace,&#160;linefeed,&#160;and<br/>carriage&#160;return),&#160;while&#160;others&#160;are&#160;not&#160;(null,&#160;end-of-transmission,&#160;and&#160;acknowl-<br/>edge).<br/>
<b>Escape&#160;Sequence</b><br/>
<b>Meaning</b><br/>
\a<br/>
Bell&#160;(an alert&#160;that&#160;causes&#160;the&#160;computer to&#160;<br/>beep)<br/>
\b<br/>
Backspace<br/>
\n<br/>
Newline.&#160; On Unix-like&#160;systems, this&#160;<br/>produces&#160;a&#160;linefeed.&#160;<br/>
\r<br/>
Carriage&#160;return<br/>
\t<br/>
Tab<br/>
The&#160;table&#160;above&#160;lists&#160;some&#160;of&#160;the&#160;common&#160;backslash&#160;escape&#160;sequences.&#160;The&#160;idea<br/>behind&#160;this&#160;representation&#160;using&#160;the&#160;backslash&#160;originated&#160;in&#160;the&#160;C&#160;programming<br/>language&#160;and has&#160;been&#160;adopted by many&#160;others, including the&#160;shell.<br/>Adding&#160;the&#160;&#160;-e&#160;&#160;option&#160;to&#160;&#160;echo&#160;&#160;will&#160;enable&#160;interpretation&#160;of&#160;escape&#160;sequences.<br/>You&#160;may&#160;also&#160;place&#160;them&#160;inside&#160;$'&#160;'.&#160;Here,&#160;using&#160;the&#160;sleep&#160;command,&#160;a&#160;sim-<br/>ple&#160;program&#160;that&#160;just&#160;waits&#160;for&#160;the&#160;specified&#160;number&#160;of&#160;seconds&#160;and&#160;then&#160;exits,&#160;we<br/>can create&#160;a&#160;primitive&#160;countdown timer:<br/><b>sleep 10; echo -e &#34;Time's up\a&#34;</b><br/>
We&#160;could also&#160;do this:<br/><b>sleep 10; echo &#34;Time's up&#34; $'\a'</b><br/>
<b>Summing&#160;Up<br/></b>As&#160;we&#160;move&#160;forward&#160;with&#160;using&#160;the&#160;shell,&#160;we&#160;will&#160;find&#160;that&#160;expansions&#160;and&#160;quoting&#160;will<br/>be&#160;used&#160;with&#160;increasing&#160;frequency,&#160;so&#160;it&#160;makes&#160;sense&#160;to&#160;get&#160;a&#160;good&#160;understanding&#160;of&#160;the<br/>way&#160;they&#160;work.&#160;In&#160;fact,&#160;it&#160;could&#160;be&#160;argued&#160;that&#160;they&#160;are&#160;the&#160;most&#160;important&#160;subjects&#160;to<br/>
79<br/>
<hr/>
<a name=104></a>7 – Seeing the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It<br/>
learn&#160;about&#160;the&#160;shell.&#160;Without&#160;a&#160;proper&#160;understanding&#160;of&#160;expansion,&#160;the&#160;shell&#160;will&#160;always<br/>be&#160;a&#160;source&#160;of mystery and confusion,&#160;with much of its&#160;potential&#160;power&#160;wasted.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;&#160;bash&#160;&#160;man&#160;page&#160;has&#160;major&#160;sections&#160;on&#160;both&#160;expansion&#160;and&#160;quoting&#160;which<br/>cover these&#160;topics&#160;in&#160;a&#160;more&#160;formal&#160;manner.<br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;also contains&#160;chapters&#160;on expansion and quoting:<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html">http://www.gnu.org/software/bash/manual/bashref.html</a>&#160;<br/>
80<br/>
<hr/>
<a name=105></a>8 –&#160;Advanced Keyboard&#160;Tricks<br/>
<i><b>8&#160;–&#160;Advanced&#160;Keyboard&#160;Tricks</b></i><br/>
I&#160;often&#160;kiddingly&#160;describe&#160;Unix&#160;as&#160;“the&#160;operating&#160;system&#160;for&#160;people&#160;who&#160;like&#160;to&#160;type.”&#160;Of<br/>course,&#160;the&#160;fact&#160;that&#160;it&#160;even&#160;has&#160;a&#160;command&#160;line&#160;is&#160;a&#160;testament&#160;to&#160;that.&#160;But&#160;command&#160;line<br/>users&#160;don't&#160;like&#160;to&#160;type&#160;<i>that</i>&#160;much.&#160;Why&#160;else&#160;would&#160;so&#160;many&#160;commands&#160;have&#160;such&#160;short<br/>names&#160;like&#160;cp,&#160;ls,&#160;mv,&#160;and&#160;rm?&#160;In&#160;fact,&#160;one&#160;of&#160;the&#160;most&#160;cherished&#160;goals&#160;of&#160;the&#160;command<br/>line&#160;is&#160;laziness;&#160;doing&#160;the&#160;most&#160;work&#160;with&#160;the&#160;fewest&#160;number&#160;of&#160;keystrokes.&#160;Another&#160;goal<br/>is&#160;never&#160;having&#160;to&#160;lift&#160;our&#160;fingers&#160;from&#160;the&#160;keyboard&#160;and&#160;reach&#160;for&#160;the&#160;mouse.&#160;In&#160;this<br/>chapter, we&#160;will&#160;look at&#160;bash&#160;features&#160;that&#160;make&#160;keyboard&#160;use&#160;faster and more&#160;efficient.<br/>The&#160;following commands&#160;will&#160;make&#160;an&#160;appearance:<br/>
●<br/>
clear&#160;– Clear&#160;the&#160;screen<br/>
●<br/>
history&#160;– Display the&#160;contents&#160;of the&#160;history list<br/>
<b>Command&#160;Line&#160;Editing<br/></b>bash&#160;&#160;uses&#160;a&#160;library&#160;(a&#160;shared&#160;collection&#160;of&#160;routines&#160;that&#160;different&#160;programs&#160;can&#160;use)<br/>called&#160;<i>Readline</i>&#160;to&#160;implement&#160;command&#160;line&#160;editing.&#160;We&#160;have&#160;already&#160;seen&#160;some&#160;of&#160;this.<br/>We&#160;know,&#160;for example,&#160;that&#160;the&#160;arrow&#160;keys&#160;move&#160;the&#160;cursor,&#160;but&#160;there&#160;are&#160;many&#160;more&#160;fea-<br/>tures.&#160;Think&#160;of&#160;these&#160;as&#160;additional&#160;tools&#160;that&#160;we&#160;can&#160;employ&#160;in&#160;our&#160;work.&#160;It’s&#160;not&#160;impor-<br/>tant&#160;to learn&#160;all&#160;of them,&#160;but&#160;many&#160;of them&#160;are&#160;very useful.&#160;Pick and choose&#160;as&#160;desired.<br/>
<b>Note:</b>&#160;Some&#160;of the&#160;key&#160;sequences&#160;below&#160;(particularly&#160;those&#160;that&#160;use&#160;the&#160;Alt&#160;key)<br/>may&#160;be&#160;intercepted&#160;by&#160;the&#160;&#160;GUI&#160;&#160;for&#160;other&#160;functions.&#160;All&#160;of&#160;the&#160;key&#160;sequences<br/>should work properly&#160;when using a&#160;virtual&#160;console.<br/>
Cursor&#160;Movement<br/>The&#160;following table&#160;lists&#160;the&#160;keys&#160;used to move&#160;the&#160;cursor:<br/>
<i>Table&#160;8-1: Cursor&#160;Movement&#160;Commands</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
81<br/>
<hr/>
<a name=106></a>8 –&#160;Advanced&#160;Keyboard&#160;Tricks<br/>
Ctrl-a<br/>
Move&#160;cursor to the&#160;beginning of the&#160;line.<br/>
Ctrl-e<br/>
Move&#160;cursor to the&#160;end of the&#160;line.<br/>
Ctrl-f<br/>
Move&#160;cursor forward&#160;one&#160;character;&#160;same&#160;as&#160;the&#160;right&#160;arrow&#160;key.<br/>
Ctrl-b<br/>
Move&#160;cursor backward one&#160;character;&#160;same&#160;as&#160;the&#160;left&#160;arrow&#160;key.<br/>
Alt-f<br/>
Move&#160;cursor forward&#160;one&#160;word.<br/>
Alt-b<br/>
Move&#160;cursor backward one&#160;word.<br/>
Ctrl-l<br/>
Clear&#160;the&#160;screen&#160;and move&#160;the&#160;cursor to the&#160;top-left&#160;corner.&#160;The&#160;<br/>clear&#160;command&#160;does&#160;the&#160;same&#160;thing.<br/>
Modifying&#160;Text<br/>Since&#160;it's&#160;possible&#160;we&#160;might&#160;make&#160;a&#160;mistake&#160;when&#160;composing a&#160;command,&#160;we&#160;need a&#160;way<br/>to&#160;correct&#160;them&#160;efficiently.&#160;Table&#160;8-2&#160;describes&#160;keyboard&#160;commands&#160;that&#160;are&#160;used&#160;to&#160;edit<br/>characters&#160;on the&#160;command&#160;line.<br/>
<i>Table&#160;8-2: Text&#160;Editing Commands</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
Ctrl-d<br/>
Delete&#160;the&#160;character at&#160;the&#160;cursor location.<br/>
Ctrl-t<br/>
Transpose&#160;(exchange)&#160;the&#160;character&#160;at&#160;the&#160;cursor location with&#160;the&#160;<br/>one&#160;preceding it.<br/>
Alt-t<br/>
Transpose&#160;the&#160;word at&#160;the&#160;cursor location&#160;with the&#160;one&#160;preceding&#160;it.<br/>
Alt-l<br/>
Convert&#160;the&#160;characters&#160;from&#160;the&#160;cursor location&#160;to the&#160;end&#160;of the&#160;<br/>word to&#160;lowercase.<br/>
Alt-u<br/>
Convert&#160;the&#160;characters&#160;from&#160;the&#160;cursor location&#160;to the&#160;end&#160;of the&#160;<br/>word to&#160;uppercase.<br/>
Cutting&#160;and&#160;Pasting&#160;(Kil&#160;ing&#160;and&#160;Yanking)&#160;Text<br/>The&#160;Readline&#160;documentation&#160;uses&#160;the&#160;terms&#160;<i>killing</i>&#160;and&#160;<i>yanking</i>&#160;to&#160;refer&#160;to&#160;what&#160;we&#160;would<br/>commonly&#160;call&#160;cutting&#160;and&#160;pasting.&#160;Items&#160;that&#160;are&#160;cut&#160;are&#160;stored&#160;in&#160;a&#160;buffer&#160;(a&#160;temporary<br/>storage&#160;area&#160;in memory) called&#160;the&#160;<i>kill-ring</i>.<br/>
82<br/>
<hr/>
<a name=107></a>Command Line&#160;Editing<br/>
<i>Table&#160;8-3: Cut&#160;and Paste&#160;Commands</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
Ctrl-k<br/>
Kill&#160;text&#160;from&#160;the&#160;cursor location&#160;to the&#160;end of line.<br/>
Ctrl-u<br/>
Kill&#160;text&#160;from&#160;the&#160;cursor location&#160;to the&#160;beginning&#160;of the&#160;line.<br/>
Alt-d<br/>
Kill&#160;text&#160;from&#160;the&#160;cursor location&#160;to the&#160;end of the&#160;current&#160;word.<br/>
Alt-<br/>
Kill&#160;text&#160;from&#160;the&#160;cursor location&#160;to the&#160;beginning&#160;of the&#160;current&#160;<br/>
Backspace<br/>
word. If the&#160;cursor is&#160;at&#160;the&#160;beginning of a&#160;word, kill&#160;the&#160;previous&#160;<br/>word.<br/>
Ctrl-y<br/>
Yank text&#160;from&#160;the&#160;kill-ring and insert&#160;it&#160;at&#160;the&#160;cursor location.<br/>
<b>The&#160;Meta&#160;Key</b><br/>
If&#160;&#160;&#160;you&#160;&#160;&#160;venture&#160;&#160;&#160;into&#160;&#160;&#160;the&#160;&#160;&#160;Readline&#160;&#160;&#160;documentation,&#160;&#160;&#160;which&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;found&#160;&#160;&#160;in&#160;&#160;&#160;the<br/>“READLINE”&#160;section&#160;of&#160;the&#160;bash&#160;man&#160;page,&#160;you&#160;will&#160;encounter&#160;the&#160;term&#160;<i>meta<br/>key</i>. On modern keyboards&#160;this&#160;maps&#160;to the&#160;Alt&#160;key but&#160;it&#160;wasn't&#160;always&#160;so.<br/>Back&#160;in&#160;the&#160;dim&#160;times&#160;(before&#160;PCs&#160;but&#160;after&#160;Unix),&#160;not&#160;everybody&#160;had&#160;their&#160;own<br/>computer.&#160;What&#160;they&#160;might&#160;have&#160;had&#160;was&#160;a&#160;device&#160;called&#160;a&#160;<i>terminal</i>.&#160;A&#160;terminal<br/>was&#160;a&#160;communication&#160;device&#160;that&#160;featured&#160;a&#160;text&#160;display&#160;screen&#160;and&#160;a&#160;keyboard<br/>and&#160;just&#160;enough&#160;electronics&#160;inside&#160;to&#160;display&#160;text&#160;characters&#160;and&#160;move&#160;the&#160;cursor<br/>around.&#160;It&#160;was&#160;attached&#160;(usually&#160;by&#160;serial&#160;cable)&#160;to&#160;a&#160;larger&#160;computer&#160;or&#160;the&#160;com-<br/>munication&#160;network&#160;of&#160;a&#160;larger&#160;computer.&#160;There&#160;were&#160;many&#160;different&#160;brands&#160;of<br/>terminals, and&#160;they all&#160;had different&#160;keyboards&#160;and&#160;display feature&#160;sets. Since&#160;they<br/>all&#160;tended&#160;to&#160;at&#160;least&#160;understand&#160;ASCII,&#160;software&#160;developers&#160;wanting&#160;portable&#160;ap-<br/>plications&#160;wrote&#160;to&#160;the&#160;lowest&#160;common&#160;denominator.&#160;Unix&#160;systems&#160;have&#160;an&#160;elabo-<br/>rate&#160;way&#160;of&#160;dealing&#160;with&#160;terminals&#160;and&#160;their&#160;different&#160;display&#160;features.&#160;Since&#160;the<br/>developers&#160;of&#160;Readline&#160;could&#160;not&#160;be&#160;sure&#160;of&#160;the&#160;presence&#160;of&#160;a&#160;dedicated&#160;extra&#160;con-<br/>trol&#160;key,&#160;they&#160;invented&#160;one&#160;and&#160;called&#160;it&#160;<i>meta</i>.&#160;While&#160;the&#160;Alt&#160;key&#160;serves&#160;as&#160;the<br/>meta&#160;key&#160;on&#160;modern&#160;keyboards,&#160;you&#160;can&#160;also&#160;press&#160;and&#160;release&#160;the&#160;Esc&#160;key&#160;to&#160;get<br/>the&#160;same&#160;effect&#160;as&#160;holding&#160;down&#160;the&#160;&#160;Alt&#160;&#160;key&#160;if&#160;you're&#160;still&#160;using&#160;a&#160;terminal<br/>(which you can&#160;still&#160;do in Linux!).<br/>
<b>Completion<br/></b>Another&#160;way&#160;that&#160;the&#160;shell&#160;can&#160;help&#160;us&#160;is&#160;through&#160;a&#160;mechanism&#160;called&#160;<i>completion</i>.&#160;Com-<br/>pletion&#160;occurs&#160;when&#160;we&#160;press&#160;the&#160;tab&#160;key&#160;while&#160;typing&#160;a&#160;command.&#160;Let's&#160;see&#160;how&#160;this<br/>
83<br/>
<hr/>
<a name=108></a>8 –&#160;Advanced&#160;Keyboard&#160;Tricks<br/>
works. Given a&#160;home&#160;directory that&#160;looks&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ls<br/></b>Desktop &#160; &#160;ls-output.txt &#160;Pictures &#160;Templates &#160; &#160; &#160;Videos<br/>Documents &#160;Music &#160; &#160; &#160; &#160; &#160;Public<br/>
Try typing&#160;the&#160;following&#160;but&#160;<b>don't press&#160;the&#160;Enter&#160;key</b>:<br/>
[me@linuxbox ~]$&#160;<b>ls l</b><br/>
Now&#160;press&#160;the&#160;Tab&#160;key.<br/>
[me@linuxbox ~]$&#160;<b>ls ls-output.txt</b><br/>
See&#160;how&#160;the&#160;shell&#160;completed&#160;the&#160;line&#160;for&#160;us?&#160;Let's&#160;try&#160;another&#160;one.&#160;Again,&#160;don't&#160;press&#160;En-<br/>ter.<br/>
[me@linuxbox ~]$&#160;<b>ls D</b><br/>
Press&#160;Tab.<br/>
[me@linuxbox ~]$&#160;<b>ls D</b><br/>
No&#160;completion,&#160;just&#160;nothing.&#160;This&#160;happened&#160;because&#160;D&#160;matches&#160;more&#160;than&#160;one&#160;entry&#160;in<br/>the&#160;directory.&#160;For&#160;completion&#160;to&#160;be&#160;successful,&#160;the&#160;“clue”&#160;we&#160;give&#160;it&#160;has&#160;to&#160;be&#160;unambigu-<br/>ous. If we&#160;go further&#160;as&#160;with the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>ls Do</b><br/>
&#160;and then&#160;press&#160;Tab:<br/>
[me@linuxbox ~]$&#160;<b>ls Documents</b><br/>
the&#160;completion is&#160;successful.<br/>
84<br/>
<hr/>
<a name=109></a>Completion<br/>
While&#160;this&#160;example&#160;shows&#160;completion&#160;of&#160;pathnames,&#160;which&#160;is&#160;its&#160;most&#160;common&#160;use,<br/>completion&#160;will&#160;also&#160;work&#160;on&#160;variables&#160;(if&#160;the&#160;beginning&#160;of&#160;the&#160;word&#160;is&#160;a&#160;$),&#160;user&#160;names<br/>(if&#160;the&#160;word&#160;begins&#160;with&#160;~), commands&#160;(if the&#160;word&#160;is&#160;the&#160;first&#160;word on&#160;the&#160;line)&#160;and&#160;host-<br/>names&#160;(if&#160;the&#160;beginning&#160;of&#160;the&#160;word&#160;is&#160;&#160;@).&#160;Hostname&#160;completion&#160;works&#160;only&#160;for&#160;host-<br/>names&#160;listed in&#160;/etc/hosts.<br/>There&#160;are&#160;a&#160;number&#160;of&#160;control&#160;and&#160;meta&#160;key&#160;sequences&#160;that&#160;are&#160;associated&#160;with&#160;comple-<br/>tion, as&#160;listed in&#160;Table&#160;8-4.<br/>
<i>Table&#160;8-4: Completion Commands</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
Alt-?<br/>
Display a&#160;list&#160;of possible&#160;completions.&#160;<i>On most&#160;systems&#160;you can&#160;<br/>also do this&#160;by&#160;pressing&#160;the&#160;</i>Tab<i>&#160;key&#160;a second time,&#160;which is&#160;much&#160;<br/>easier.</i><br/>
Alt-*<br/>
Insert&#160;all&#160;possible&#160;completions.&#160;This&#160;is&#160;useful&#160;when you want&#160;to&#160;use&#160;<br/>more&#160;than&#160;one&#160;possible&#160;match.<br/>
There&#160;quite&#160;a&#160;few&#160;more&#160;that&#160;are&#160;rather&#160;obscure.&#160;A&#160;list&#160;appears&#160;in&#160;the&#160;bash&#160;man&#160;page&#160;un-<br/>der “READLINE”.<br/>
<b>Programmable&#160;Completion</b><br/>
Recent&#160;versions&#160;of&#160;&#160;bash&#160;&#160;have&#160;a&#160;facility&#160;called&#160;&#160;<i>programmable&#160;completion</i>.&#160;Pro-<br/>grammable&#160;completion&#160;allows&#160;you&#160;(or&#160;more&#160;likely,&#160;your&#160;distribution&#160;provider)&#160;to<br/>add&#160;additional&#160;completion&#160;rules.&#160;Usually&#160;this&#160;is&#160;done&#160;to&#160;add&#160;support&#160;for&#160;specific<br/>applications.&#160;For&#160;example,&#160;it&#160;is&#160;possible&#160;to&#160;add&#160;completions&#160;for&#160;the&#160;option&#160;list&#160;of&#160;a<br/>command&#160;or&#160;match&#160;particular&#160;file&#160;types&#160;that&#160;an&#160;application&#160;supports.&#160;Ubuntu&#160;has&#160;a<br/>fairly&#160;large&#160;set&#160;defined&#160;by&#160;default.&#160;Programmable&#160;completion&#160;is&#160;implemented&#160;by<br/>shell&#160;functions,&#160;a&#160;kind&#160;of&#160;mini&#160;shell&#160;script&#160;that&#160;we&#160;will&#160;cover&#160;in&#160;later&#160;chapters.&#160;If<br/>you are&#160;curious,&#160;try the&#160;following:<br/><b>set | less</b><br/>
and see&#160;if&#160;you can find them. Not&#160;all&#160;distributions&#160;include&#160;them&#160;by default.<br/>
<b>Using&#160;History<br/></b>As&#160;we&#160;discovered&#160;in&#160;Chapter&#160;1,&#160;bash&#160;maintains&#160;a&#160;history&#160;of&#160;commands&#160;that&#160;have&#160;been<br/>entered.&#160;&#160;&#160;This&#160;&#160;&#160;list&#160;&#160;&#160;of&#160;&#160;&#160;commands&#160;&#160;&#160;is&#160;&#160;&#160;kept&#160;&#160;&#160;in&#160;&#160;&#160;our&#160;&#160;&#160;home&#160;&#160;&#160;directory&#160;&#160;&#160;in&#160;&#160;&#160;a&#160;&#160;&#160;file&#160;&#160;&#160;called<br/>
85<br/>
<hr/>
<a name=110></a>8 –&#160;Advanced&#160;Keyboard&#160;Tricks<br/>
.bash_history.&#160;The&#160;history&#160;facility&#160;is&#160;a&#160;useful&#160;resource&#160;for&#160;reducing&#160;the&#160;amount&#160;of<br/>typing we&#160;have&#160;to do, especially&#160;when combined&#160;with command line&#160;editing.<br/>
Searching&#160;History<br/>At&#160;any time, we&#160;can&#160;view&#160;the&#160;contents&#160;of the&#160;history&#160;list&#160;by doing the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>history | less</b><br/>
By&#160;default,&#160;bash&#160;stores&#160;the&#160;last&#160;500&#160;commands&#160;we&#160;have&#160;entered,&#160;though&#160;most&#160;modern<br/>distributions&#160;set&#160;this&#160;value&#160;to&#160;1000.&#160;We&#160;will&#160;see&#160;how&#160;to&#160;adjust&#160;this&#160;value&#160;in&#160;Chapter&#160;11.<br/>Let's&#160;say&#160;we&#160;want&#160;to&#160;find&#160;the&#160;commands&#160;we&#160;used&#160;to&#160;list&#160;/usr/bin.&#160;This&#160;is&#160;one&#160;way&#160;we<br/>could do this:<br/>
[me@linuxbox ~]$&#160;<b>history | grep /usr/bin</b><br/>
And&#160;let's&#160;say&#160;that&#160;among&#160;our&#160;results&#160;we&#160;got&#160;a&#160;line&#160;containing&#160;an&#160;interesting&#160;command&#160;like<br/>this:<br/>&#160; &#160;88 &#160;ls -l /usr/bin &gt; ls-output.txt<br/>The&#160;88&#160;is&#160;the&#160;line&#160;number&#160;of&#160;the&#160;command&#160;in&#160;the&#160;history&#160;list.&#160;We&#160;could&#160;use&#160;this&#160;immedi-<br/>ately&#160;using&#160;another&#160;type&#160;of&#160;expansion&#160;called&#160;&#160;<i>history&#160;&#160;expansion</i>.&#160;To&#160;use&#160;our&#160;discovered<br/>line,&#160;we&#160;could do this:<br/>
[me@linuxbox ~]$&#160;<b>!88</b><br/>
bash&#160;&#160;will&#160;expand&#160;&#160;!88&#160;&#160;into&#160;the&#160;contents&#160;of&#160;the&#160;88th&#160;line&#160;in&#160;the&#160;history&#160;list.&#160;There&#160;are<br/>other forms&#160;of history&#160;expansion that&#160;we&#160;will&#160;cover in&#160;the&#160;next&#160;section.<br/>
bash&#160;also&#160;provides&#160;the&#160;ability&#160;to&#160;search&#160;the&#160;history&#160;list&#160;incrementally.&#160;This&#160;means&#160;we&#160;can<br/>tell&#160;bash&#160;to&#160;search&#160;the&#160;history&#160;list&#160;as&#160;we&#160;enter&#160;characters,&#160;with&#160;each&#160;additional&#160;character<br/>further&#160;refining&#160;our&#160;search.&#160;To&#160;start&#160;incremental&#160;search&#160;press&#160;&#160;Ctrl-r&#160;&#160;followed&#160;by&#160;the<br/>text&#160;we&#160;are&#160;looking&#160;for.&#160;When&#160;we&#160;find&#160;it,&#160;we&#160;can&#160;either&#160;press&#160;Enter&#160;to&#160;execute&#160;the&#160;com-<br/>mand&#160;or&#160;press&#160;Ctrl-j&#160;to&#160;copy&#160;the&#160;line&#160;from&#160;the&#160;history&#160;list&#160;to&#160;the&#160;current&#160;command&#160;line.<br/>To&#160;find&#160;the&#160;next&#160;occurrence&#160;of&#160;the&#160;text&#160;(moving&#160;“up”&#160;the&#160;history&#160;list),&#160;press&#160;&#160;Ctrl-r<br/>again.&#160;To quit&#160;searching,&#160;press&#160;either&#160;Ctrl-g&#160;or&#160;Ctrl-c. Here&#160;we&#160;see&#160;it&#160;in action:<br/>
[me@linuxbox ~]$&#160;<br/>
86<br/>
<hr/>
<a name=111></a>Using History<br/>
First&#160;press&#160;Ctrl-r.<br/>
(reverse-i-search)`':&#160;<br/>
The&#160;prompt&#160;changes&#160;to&#160;indicate&#160;that&#160;we&#160;are&#160;performing&#160;a&#160;reverse&#160;incremental&#160;search.&#160;It&#160;is<br/>“reverse”&#160;because&#160;we&#160;are&#160;searching&#160;from&#160;“now”&#160;to&#160;some&#160;time&#160;in&#160;the&#160;past.&#160;Next,&#160;we&#160;start<br/>typing our search&#160;text.&#160;In this&#160;example,&#160;/usr/bin:<br/>
(reverse-i-search)`<b>/usr/bin</b>': ls -l /usr/bin &gt; ls-output.txt<br/>
Immediately,&#160;the&#160;search&#160;returns&#160;our&#160;result.&#160;With&#160;our&#160;result,&#160;we&#160;can&#160;execute&#160;the&#160;command<br/>by&#160;pressing&#160;Enter,&#160;or&#160;we&#160;can&#160;copy&#160;the&#160;command&#160;to&#160;our&#160;current&#160;command&#160;line&#160;for&#160;fur-<br/>ther editing&#160;by pressing&#160;Ctrl-j. Let's&#160;copy it.&#160;Press&#160;Ctrl-j.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt; ls-output.txt</b><br/>
Our&#160;shell&#160;prompt&#160;returns, and our command line&#160;is&#160;loaded&#160;and ready&#160;for action!<br/>The&#160;Table&#160;8-5 lists&#160;some&#160;of the&#160;keystrokes&#160;used to&#160;manipulate&#160;the&#160;history&#160;list.<br/>
<i>Table&#160;8-5: History&#160;Commands</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
Ctrl-p<br/>
Move&#160;to the&#160;previous&#160;history entry.&#160;This&#160;is&#160;the&#160;same&#160;action as&#160;the&#160;up<br/>arrow.<br/>
Ctrl-n<br/>
Move&#160;to the&#160;next&#160;history&#160;entry.&#160;This&#160;is&#160;the&#160;same&#160;action&#160;as&#160;the&#160;down&#160;<br/>arrow.<br/>
Alt-&lt;<br/>
Move&#160;to the&#160;beginning&#160;(top) of the&#160;history&#160;list.<br/>
Alt-&gt;<br/>
Move&#160;to the&#160;end (bottom)&#160;of the&#160;history&#160;list, i.e., the&#160;current&#160;<br/>command&#160;line.<br/>
Ctrl-r<br/>
Reverse&#160;incremental&#160;search.&#160;This&#160;searches&#160;incrementally from&#160;the&#160;<br/>current&#160;command&#160;line&#160;up the&#160;history&#160;list.<br/>
Alt-p<br/>
Reverse&#160;search,&#160;nonincremental.&#160;With&#160;this&#160;key,&#160;type&#160;in&#160;the&#160;search&#160;<br/>string and press&#160;enter&#160;before&#160;the&#160;search is&#160;performed.<br/>
Alt-n<br/>
Forward search,&#160;nonincremental.<br/>
Ctrl-o<br/>
Execute&#160;the&#160;current&#160;item&#160;in the&#160;history list&#160;and advance&#160;to the&#160;next&#160;<br/>
87<br/>
<hr/>
<a name=112></a>8 –&#160;Advanced&#160;Keyboard&#160;Tricks<br/>
one.&#160;This&#160;is&#160;handy if&#160;we&#160;are&#160;trying&#160;to re-execute&#160;a&#160;sequence&#160;of&#160;<br/>commands&#160;in the&#160;history list.<br/>
History&#160;Expansion<br/>The&#160;shell&#160;offers&#160;a&#160;specialized&#160;type&#160;of&#160;expansion&#160;for&#160;items&#160;in&#160;the&#160;history&#160;list&#160;by&#160;using&#160;the&#160;!<br/>character.&#160;We&#160;have&#160;already&#160;seen&#160;how&#160;the&#160;exclamation&#160;point&#160;can&#160;be&#160;followed&#160;by&#160;a&#160;number<br/>to&#160;insert&#160;an&#160;entry&#160;from&#160;the&#160;history&#160;list.&#160;There&#160;are&#160;a&#160;number&#160;of&#160;other&#160;expansion&#160;features,&#160;as<br/>described&#160;in&#160;Table&#160;8-6.<br/>
<i>Table&#160;8-6: History&#160;Expansion&#160;Commands</i><br/>
<b>Sequence</b><br/>
<b>Action</b><br/>
!!<br/>
Repeat&#160;the&#160;last&#160;command. It&#160;is&#160;probably easier&#160;to press&#160;up arrow&#160;and<br/>enter.<br/>
!<i>number</i><br/>
Repeat&#160;history list&#160;item&#160;<i>number</i>.<br/>
!string<br/>
Repeat&#160;last&#160;history&#160;list&#160;item&#160;starting&#160;with string.&#160;<br/>
!?string<br/>
Repeat&#160;last&#160;history&#160;list&#160;item&#160;containing string.<br/>
I&#160;would&#160;caution&#160;against&#160;using&#160;the&#160;!string&#160;and&#160;!?string&#160;forms&#160;unless&#160;you&#160;are&#160;abso-<br/>lutely sure&#160;of the&#160;contents&#160;of the&#160;history list&#160;items.<br/>Many&#160;more&#160;elements&#160;are&#160;available&#160;in&#160;the&#160;history&#160;expansion&#160;mechanism,&#160;but&#160;this&#160;subject&#160;is<br/>already&#160;too&#160;arcane&#160;and&#160;our&#160;heads&#160;may&#160;explode&#160;if&#160;we&#160;continue.&#160;The&#160;HISTORY&#160;EXPAN-<br/>SION&#160;section&#160;of the&#160;bash&#160;man&#160;page&#160;goes&#160;into&#160;all&#160;the&#160;gory details.&#160;Feel&#160;free&#160;to explore!<br/>
<b>script</b><br/>
In&#160;addition&#160;to&#160;the&#160;command&#160;history&#160;feature&#160;in&#160;bash,&#160;most&#160;Linux&#160;distributions&#160;in-<br/>clude&#160;a&#160;program&#160;called&#160;script&#160;that&#160;can&#160;be&#160;used&#160;to&#160;record&#160;an&#160;entire&#160;shell&#160;session<br/>and store&#160;it&#160;in a&#160;file.&#160;The&#160;basic&#160;syntax&#160;of the&#160;command is&#160;as&#160;follows:<br/>script [<i>file</i>]<br/>where&#160;<i>file</i>&#160;is&#160;the&#160;name&#160;of&#160;the&#160;file&#160;used&#160;for&#160;storing&#160;the&#160;recording.&#160;If&#160;no&#160;file&#160;is&#160;speci-<br/>fied,&#160;the&#160;file&#160;&#160;typescript&#160;is&#160;used.&#160;See&#160;the&#160;script&#160;man&#160;page&#160;for&#160;a&#160;complete<br/>list&#160;of the&#160;program’s&#160;options&#160;and features.<br/>
88<br/>
<hr/>
<a name=113></a>Summing&#160;Up<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter&#160;we&#160;covered&#160;&#160;<i>some</i>&#160;&#160;of&#160;the&#160;keyboard&#160;tricks&#160;that&#160;the&#160;shell&#160;provides&#160;to&#160;help<br/>hardcore&#160;typists&#160;reduce&#160;their&#160;workloads.&#160;As&#160;time&#160;goes&#160;by&#160;and&#160;we&#160;become&#160;more&#160;involved<br/>with&#160;the&#160;command&#160;line,&#160;we&#160;can&#160;refer&#160;back&#160;to&#160;this&#160;chapter&#160;to&#160;pick&#160;up&#160;more&#160;of&#160;these&#160;tricks.<br/>For now, consider&#160;them&#160;optional&#160;and potentially helpful.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;Wikipedia&#160;has&#160;a&#160;good article&#160;on computer&#160;terminals:<br/><a href="http://en.wikipedia.org/wiki/Computer_terminal">http://en.wikipedia.org/wiki/Computer_terminal</a><br/>
89<br/>
<hr/>
<a name=114></a>9 – Permissions<br/>
<i><b>9&#160;–&#160;Permissions</b></i><br/>
Operating&#160;systems&#160;in&#160;the&#160;Unix&#160;tradition&#160;differ&#160;from&#160;those&#160;in&#160;the&#160;MS-DOS&#160;tradition&#160;in&#160;that<br/>they are&#160;not&#160;only&#160;<i>multitasking</i>&#160;systems, but&#160;also&#160;<i>multi-user</i>&#160;systems.<br/>What&#160;exactly&#160;does&#160;this&#160;mean?&#160;It&#160;means&#160;that&#160;more&#160;than&#160;one&#160;person&#160;can&#160;be&#160;using&#160;the&#160;com-<br/>puter&#160;at&#160;the&#160;same&#160;time.&#160;While&#160;a&#160;typical&#160;computer&#160;will&#160;likely&#160;have&#160;only&#160;one&#160;keyboard&#160;and<br/>monitor,&#160;it&#160;can&#160;still&#160;be&#160;used&#160;by&#160;more&#160;than&#160;one&#160;user.&#160;For&#160;example,&#160;if&#160;a&#160;computer&#160;is&#160;attached<br/>to&#160;a&#160;network&#160;or&#160;the&#160;Internet,&#160;remote&#160;users&#160;can&#160;log&#160;in&#160;via&#160;ssh&#160;(secure&#160;shell)&#160;and&#160;operate<br/>the&#160;&#160;&#160;computer.&#160;&#160;&#160;In&#160;&#160;&#160;fact,&#160;&#160;&#160;remote&#160;&#160;&#160;users&#160;&#160;&#160;can&#160;&#160;&#160;execute&#160;&#160;&#160;graphical&#160;&#160;&#160;applications&#160;&#160;&#160;and&#160;&#160;&#160;have&#160;&#160;&#160;the<br/>graphical&#160;output&#160;appear&#160;on&#160;a&#160;remote&#160;display.&#160;The&#160;X&#160;Window&#160;System&#160;supports&#160;this&#160;as&#160;part<br/>of its&#160;basic&#160;design.<br/>The&#160;multiuser&#160;capability&#160;of&#160;Linux&#160;is&#160;not&#160;a&#160;recent&#160;&#34;innovation,&#34;&#160;but&#160;rather&#160;a&#160;feature&#160;that&#160;is<br/>deeply&#160;embedded&#160;into the&#160;design of the&#160;operating&#160;system. Considering&#160;the&#160;environment&#160;in<br/>which&#160;Unix&#160;was&#160;created,&#160;this&#160;makes&#160;perfect&#160;sense.&#160;Years&#160;ago,&#160;before&#160;computers&#160;were<br/>&#34;personal,&#34;&#160;they&#160;were&#160;large,&#160;expensive,&#160;and&#160;centralized.&#160;A&#160;typical&#160;university&#160;computer<br/>system,&#160;for&#160;example,&#160;consisted&#160;of&#160;a&#160;large&#160;central&#160;computer&#160;located&#160;in&#160;one&#160;building&#160;and<br/>terminals&#160;&#160;that&#160;were&#160;located&#160;throughout&#160;the&#160;campus,&#160;each&#160;connected&#160;to&#160;the&#160;large&#160;central<br/>computer.&#160;The&#160;computer&#160;would support&#160;many users&#160;at&#160;the&#160;same&#160;time.<br/>To&#160;make&#160;this&#160;practical,&#160;a&#160;method&#160;had&#160;to&#160;be&#160;devised&#160;to&#160;protect&#160;the&#160;users&#160;from&#160;each&#160;other.<br/>After&#160;all,&#160;the&#160;actions&#160;of&#160;one&#160;user&#160;could&#160;not&#160;be&#160;allowed&#160;to&#160;crash&#160;the&#160;computer,&#160;nor&#160;could<br/>one&#160;user interfere&#160;with&#160;the&#160;files&#160;belonging&#160;to another&#160;user.<br/>In&#160;this&#160;chapter&#160;we&#160;will&#160;look&#160;at&#160;this&#160;essential&#160;part&#160;of&#160;system&#160;security&#160;and&#160;introduce&#160;the&#160;fol-<br/>lowing commands:<br/>
●<br/>
id&#160;– Display user identity<br/>
●<br/>
chmod&#160;– Change&#160;a&#160;file's&#160;mode<br/>
●<br/>
umask&#160;– Set&#160;the&#160;default&#160;file&#160;permissions<br/>
●<br/>
su&#160;– Run a&#160;shell&#160;as&#160;another user<br/>
●<br/>
sudo&#160;– Execute&#160;a&#160;command&#160;as&#160;another user&#160;<br/>
●<br/>
chown&#160;– Change&#160;a&#160;file's&#160;owner<br/>
90<br/>
<hr/>
<a name=115></a>9 – Permissions<br/>
●<br/>
chgrp&#160;– Change&#160;a&#160;file's&#160;group ownership<br/>
●<br/>
passwd&#160;– Change&#160;a&#160;user's&#160;password<br/>
<b>Owners,&#160;Group&#160;Members,&#160;and&#160;Everybody&#160;Else<br/></b>When&#160;we&#160;were&#160;exploring&#160;the&#160;system&#160;in&#160;Chapter&#160;3,&#160;we&#160;may&#160;have&#160;encountered&#160;a&#160;problem<br/>when&#160;trying to&#160;examine&#160;a&#160;file&#160;such as&#160;/etc/shadow:<br/>
[me@linuxbox ~]$&#160;<b>file /etc/shadow<br/></b>/etc/shadow: regular file, no read permission<br/>[me@linuxbox ~]$&#160;<b>less /etc/shadow<br/></b>/etc/shadow: Permission denied<br/>
The&#160;reason&#160;for&#160;this&#160;error&#160;message&#160;is&#160;that,&#160;as&#160;regular&#160;users,&#160;we&#160;do&#160;not&#160;have&#160;permission&#160;to<br/>read this&#160;file.<br/>In&#160;the&#160;Unix&#160;security&#160;model,&#160;a&#160;user&#160;may&#160;<i>own</i>&#160;files&#160;and&#160;directories.&#160;When&#160;a&#160;user&#160;owns&#160;a&#160;file<br/>or&#160;directory,&#160;the&#160;user&#160;has&#160;control&#160;over&#160;its&#160;access.&#160;Users&#160;can,&#160;in&#160;turn,&#160;belong&#160;to&#160;a&#160;&#160;<i>group<br/></i>consisting&#160;of&#160;one&#160;or&#160;more&#160;users&#160;who&#160;are&#160;given&#160;access&#160;to&#160;files&#160;and&#160;directories&#160;by&#160;their<br/>owners.&#160;In&#160;addition&#160;to&#160;granting&#160;access&#160;to&#160;a&#160;group,&#160;an&#160;owner&#160;may&#160;also&#160;grant&#160;some&#160;set&#160;of<br/>access&#160;rights&#160;to&#160;everybody, which&#160;in Unix terms&#160;is&#160;referred to&#160;as&#160;the&#160;<i>world</i>.&#160;To find out&#160;in-<br/>formation about&#160;your&#160;identity, use&#160;the&#160;id&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>id<br/></b>uid=500(me) gid=500(me) groups=500(me)<br/>
Let's&#160;look&#160;at&#160;the&#160;output.&#160;When&#160;user&#160;&#160;accounts&#160;&#160;are&#160;created,&#160;users&#160;are&#160;assigned&#160;a&#160;number<br/>called&#160;a&#160;<i>user&#160;ID</i>&#160;(<i>uid</i>)&#160;which&#160;is&#160;then,&#160;for&#160;the&#160;sake&#160;of&#160;the&#160;humans,&#160;mapped&#160;to&#160;a&#160;username.<br/>The&#160;user&#160;is&#160;assigned&#160;a&#160;<i>primary&#160;group&#160;ID</i>&#160;(<i>gid</i>)&#160;and&#160;may&#160;belong&#160;to&#160;additional&#160;groups.&#160;The<br/>above&#160;example&#160;is&#160;from&#160;a&#160;Fedora&#160;system.&#160;On&#160;other&#160;systems,&#160;such&#160;as&#160;Ubuntu,&#160;the&#160;output<br/>may look&#160;a&#160;little&#160;different:<br/>
[me@linuxbox ~]$&#160;<b>id<br/></b>uid=1000(me) gid=1000(me)&#160;<br/>groups=4(adm),20(dialout),24(cdrom),25(floppy),29(audio),30(dip),44(v<br/>ideo),46(plugdev),108(lpadmin),114(admin),1000(me)<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;uid&#160;and gid numbers&#160;are&#160;different.&#160;This&#160;is&#160;simply&#160;because&#160;Fedora&#160;starts<br/>its&#160;numbering&#160;of&#160;regular&#160;user&#160;accounts&#160;at&#160;500,&#160;while&#160;Ubuntu&#160;starts&#160;at&#160;1000.&#160;We&#160;can&#160;also<br/>
91<br/>
<hr/>
<a name=116></a>9 – Permissions<br/>
see&#160;that&#160;the&#160;Ubuntu&#160;user&#160;belongs&#160;to&#160;a&#160;lot&#160;more&#160;groups.&#160;This&#160;has&#160;to&#160;do&#160;with&#160;the&#160;way<br/>Ubuntu&#160;manages&#160;privileges&#160;for system&#160;devices&#160;and services.<br/>So&#160;where&#160;does&#160;this&#160;information&#160;come&#160;from?&#160;Like&#160;so&#160;many&#160;things&#160;in&#160;Linux,&#160;it&#160;comes&#160;from<br/>a&#160;couple&#160;of&#160;text&#160;files.&#160;User&#160;accounts&#160;are&#160;defined&#160;in&#160;the&#160;/etc/passwd&#160;file&#160;and&#160;groups<br/>are&#160;defined&#160;in&#160;the&#160;/etc/group&#160;file.&#160;When&#160;user&#160;accounts&#160;and&#160;groups&#160;are&#160;created,&#160;these<br/>files&#160;are&#160;modified&#160;along&#160;with&#160;/etc/shadow&#160;which&#160;holds&#160;information&#160;about&#160;the&#160;user's<br/>password.&#160;For&#160;each&#160;user&#160;account,&#160;the&#160;/etc/passwd&#160;file&#160;defines&#160;the&#160;user&#160;(login)&#160;name,<br/>uid,&#160;gid,&#160;account's&#160;real&#160;name,&#160;home&#160;directory,&#160;and&#160;login&#160;shell.&#160;If&#160;we&#160;examine&#160;the&#160;contents<br/>of&#160;/etc/passwd&#160;and&#160;/etc/group,&#160;we&#160;notice&#160;that&#160;besides&#160;the&#160;regular&#160;user&#160;accounts,<br/>there&#160;are&#160;accounts&#160;for the&#160;superuser&#160;(uid&#160;0) and various&#160;other&#160;system&#160;users.<br/>In&#160;the&#160;next&#160;chapter,&#160;when&#160;we&#160;cover&#160;processes,&#160;we&#160;will&#160;see&#160;that&#160;some&#160;of&#160;these&#160;other<br/>“users”&#160;are, in&#160;fact,&#160;quite&#160;busy.<br/>While&#160;many&#160;Unix-like&#160;systems&#160;assign&#160;regular&#160;users&#160;to&#160;a&#160;common&#160;group&#160;such&#160;as&#160;“users”,<br/>modern&#160;Linux&#160;practice&#160;is&#160;to&#160;create&#160;a&#160;unique,&#160;single-member&#160;group&#160;with&#160;the&#160;same&#160;name&#160;as<br/>the&#160;user.&#160;This&#160;makes&#160;certain&#160;types&#160;of permission&#160;assignment&#160;easier.<br/>
<b>Reading,&#160;Writing,&#160;and&#160;Executing<br/></b>Access&#160;rights&#160;to&#160;files&#160;and&#160;directories&#160;are&#160;defined&#160;in&#160;terms&#160;of&#160;read&#160;access,&#160;write&#160;access, and<br/>execution&#160;access.&#160;If we&#160;look&#160;at&#160;the&#160;output&#160;of the&#160;ls&#160;command,&#160;we&#160;can&#160;get&#160;some&#160;clue&#160;as&#160;to<br/>how&#160;this&#160;is&#160;implemented:<br/>
[me@linuxbox ~]$&#160;<b>&gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw-rw-r-- 1 me &#160; &#160;me &#160; 0 2016-03-06 14:52 foo.txt<br/>
The&#160;first&#160;10&#160;characters&#160;of&#160;the&#160;listing&#160;are&#160;the&#160;<i>file&#160;attributes</i>.&#160;The&#160;first&#160;of&#160;these&#160;characters&#160;is<br/>the&#160;<i>file&#160;type</i>.&#160;Table&#160;9-1&#160;describes&#160;the&#160;file&#160;types&#160;we&#160;are&#160;most&#160;likely&#160;to&#160;see&#160;(there&#160;are&#160;other,<br/>less&#160;common&#160;types&#160;too):<br/>
<i>Table&#160;9-1: File&#160;Types</i><br/>
<b>Attribute</b><br/>
<b>File&#160;Type</b><br/>
-<br/>
A&#160;regular file.<br/>
d<br/>
A&#160;directory.<br/>
l<br/>
A&#160;symbolic&#160;link.&#160;Notice&#160;that&#160;with symbolic&#160;links, the&#160;remaining file&#160;<br/>attributes&#160;are&#160;always&#160;“rwxrwxrwx”&#160;and are&#160;dummy values.&#160;The&#160;real<br/>file&#160;attributes&#160;are&#160;those&#160;of the&#160;file&#160;the&#160;symbolic&#160;link points&#160;to.<br/>
92<br/>
<hr/>
<a name=117></a>Reading,&#160;Writing, and&#160;Executing<br/>
c<br/>
A&#160;<i>character&#160;special&#160;file</i>.&#160;This&#160;file&#160;type&#160;refers&#160;to a&#160;device&#160;that&#160;<br/>handles&#160;data&#160;as&#160;a&#160;stream&#160;of bytes, such as&#160;a&#160;terminal&#160;or&#160;<br/>/dev/null.<br/>
b<br/>
A&#160;<i>block&#160;special&#160;file</i>.&#160;This&#160;file&#160;type&#160;refers&#160;to a&#160;device&#160;that&#160;handles&#160;<br/>data&#160;in blocks, such&#160;as&#160;a&#160;hard drive&#160;or DVD&#160;drive.<br/>
The&#160;remaining&#160;nine&#160;characters&#160;of the&#160;file&#160;attributes, called the&#160;<i>file&#160;mode,</i>&#160;represent&#160;the&#160;<br/>read, write,&#160;and execute&#160;permissions&#160;for the&#160;file's&#160;owner,&#160;the&#160;file's&#160;group owner, and&#160;<br/>everybody else.<br/>
<b>Owner</b><br/>
<b>Group</b><br/>
<b>World</b><br/>
rwx<br/>
rwx<br/>
rwx<br/>
Table&#160;9-2&#160;describes&#160;the&#160;effect&#160;the&#160;r,&#160;w,&#160;and&#160;x&#160;mode&#160;attributes&#160;have&#160;on&#160;files&#160;and&#160;directo-<br/>ries:<br/>
<i>Table&#160;9-2: Permission&#160;Attributes</i><br/>
<b>Attribute</b><br/>
<b>Files</b><br/>
<b>Directories</b><br/>
r<br/>
Allows&#160;a&#160;file&#160;to be&#160;opened&#160;and&#160;<br/>
Allows&#160;a&#160;directory's&#160;contents&#160;to&#160;<br/>
read.&#160;<br/>
be&#160;listed&#160;if the&#160;execute&#160;attribute&#160;<br/>is&#160;also set.<br/>
w<br/>
Allows&#160;a&#160;file&#160;to be&#160;written to or&#160;<br/>
Allows&#160;files&#160;within&#160;a&#160;directory&#160;<br/>
truncated, however this&#160;attribute<br/>
to be&#160;created,&#160;deleted, and&#160;<br/>
does&#160;not&#160;allow&#160;files&#160;to&#160;be&#160;<br/>
renamed&#160;if the&#160;execute&#160;attribute&#160;<br/>
renamed&#160;or deleted.&#160;The&#160;ability&#160;<br/>
is&#160;also set.<br/>
to delete&#160;or rename&#160;files&#160;is&#160;<br/>determined&#160;by directory&#160;<br/>attributes.<br/>
x<br/>
Allows&#160;a&#160;file&#160;to be&#160;treated&#160;as&#160;a&#160;<br/>
Allows&#160;a&#160;directory&#160;to be&#160;<br/>
program&#160;and&#160;executed.&#160;Program<br/>
entered,&#160;e.g., cd&#160;<i>directory</i>.<br/>
files&#160;written in&#160;scripting&#160;<br/>languages&#160;must&#160;also be&#160;set&#160;as&#160;<br/>readable&#160;to be&#160;executed.<br/>
Table&#160;9-3 provides&#160;some&#160;examples&#160;of file&#160;attribute&#160;settings:<br/>
93<br/>
<hr/>
<a name=118></a>9 – Permissions<br/>
<i>Table&#160;9-3: Permission&#160;Attribute&#160;Examples</i><br/>
<b>File&#160;Attributes</b><br/>
<b>Meaning</b><br/>
-rwx------<br/>
A&#160;regular&#160;file&#160;that&#160;is&#160;readable,&#160;writable,&#160;and executable&#160;by the&#160;<br/>file's&#160;owner. No one&#160;else&#160;has&#160;any access.<br/>
-rw-------<br/>
A&#160;regular&#160;file&#160;that&#160;is&#160;readable&#160;and writable&#160;by the&#160;file's&#160;owner.&#160;<br/>No one&#160;else&#160;has&#160;any access.<br/>
-rw-r--r--<br/>
A&#160;regular&#160;file&#160;that&#160;is&#160;readable&#160;and writable&#160;by the&#160;file's&#160;owner.&#160;<br/>Members&#160;of the&#160;file's&#160;owner&#160;group may read&#160;the&#160;file.&#160;The&#160;file&#160;is<br/>world-readable.<br/>
-rwxr-xr-x<br/>
A&#160;regular&#160;file&#160;that&#160;is&#160;readable,&#160;writable,&#160;and executable&#160;by the&#160;<br/>file's&#160;owner.&#160;The&#160;file&#160;may be&#160;read&#160;and executed by everybody&#160;<br/>else.&#160;<br/>
-rw-rw----<br/>
A&#160;regular&#160;file&#160;that&#160;is&#160;readable&#160;and writable&#160;by the&#160;file's&#160;owner&#160;<br/>and members&#160;of the&#160;file's&#160;group owner&#160;only.<br/>
lrwxrwxrwx<br/>
A&#160;symbolic&#160;link.&#160;All&#160;symbolic&#160;links&#160;have&#160;“dummy”&#160;<br/>permissions.&#160;The&#160;real&#160;permissions&#160;are&#160;kept&#160;with the&#160;actual&#160;file&#160;<br/>pointed&#160;to by the&#160;symbolic&#160;link.<br/>
drwxrwx---<br/>
A&#160;directory.&#160;The&#160;owner and&#160;the&#160;members&#160;of the&#160;owner&#160;group&#160;<br/>may enter the&#160;directory&#160;and create,&#160;rename&#160;and remove&#160;files&#160;<br/>within the&#160;directory.<br/>
drwxr-x---<br/>
A&#160;directory.&#160;The&#160;owner may enter&#160;the&#160;directory&#160;and create,&#160;<br/>rename,&#160;and delete&#160;files&#160;within&#160;the&#160;directory.&#160;Members&#160;of the&#160;<br/>owner&#160;group may enter the&#160;directory&#160;but&#160;cannot&#160;create, delete,&#160;<br/>or rename&#160;files.<br/>
chmod&#160;–&#160;Change&#160;File&#160;Mode<br/>To&#160;change&#160;the&#160;mode&#160;(permissions)&#160;of&#160;a&#160;file&#160;or&#160;directory,&#160;the&#160;chmod&#160;command&#160;is&#160;used.&#160;Be<br/>aware&#160;that&#160;only&#160;the&#160;file’s&#160;owner&#160;or&#160;the&#160;superuser&#160;can&#160;change&#160;the&#160;mode&#160;of&#160;a&#160;file&#160;or&#160;direc-<br/>tory.&#160;chmod&#160;supports&#160;two&#160;distinct&#160;ways&#160;of&#160;specifying&#160;mode&#160;changes:&#160;octal&#160;number&#160;repre-<br/>sentation,&#160;or symbolic&#160;representation.&#160;We&#160;will&#160;cover octal&#160;number representation&#160;first.<br/>
94<br/>
<hr/>
<a name=119></a>Reading,&#160;Writing, and&#160;Executing<br/>
<b>What&#160;the&#160;Heck&#160;is&#160;Octal?</b><br/>
<i>Octal</i>&#160;(base&#160;8),&#160;and&#160;its&#160;cousin,&#160;<i>hexadecimal</i>&#160;(base&#160;16)&#160;are&#160;number&#160;systems&#160;often<br/>used&#160;to&#160;express&#160;numbers&#160;on&#160;computers.&#160;We&#160;humans,&#160;owing&#160;to&#160;the&#160;fact&#160;that&#160;we&#160;(or<br/>at&#160;least&#160;most&#160;of&#160;us)&#160;were&#160;born&#160;with&#160;10&#160;fingers,&#160;count&#160;using&#160;a&#160;base&#160;10&#160;number&#160;sys-<br/>tem.&#160;Computers,&#160;on&#160;the&#160;other&#160;hand,&#160;were&#160;born&#160;with&#160;only&#160;one&#160;finger&#160;and&#160;thus&#160;do<br/>all&#160;their&#160;counting&#160;in&#160;<i>binary</i>&#160;(base&#160;2).&#160;Their&#160;number&#160;system&#160;has&#160;only&#160;two&#160;numerals,<br/>0 and 1. So, in binary,&#160;counting&#160;looks&#160;like&#160;this:<br/>0, 1, 10, 11, 100, 101, 110, 111, 1000, 1001, 1010, 1011...<br/>In octal,&#160;counting&#160;is&#160;done&#160;with the&#160;numerals&#160;zero through&#160;seven, like&#160;so:<br/>0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12, 13, 14, 15, 16, 17, 20, 21...<br/>Hexadecimal&#160;counting&#160;uses&#160;the&#160;numerals&#160;zero&#160;through&#160;nine&#160;plus&#160;the&#160;letters&#160;“A”<br/>through “F”:<br/>0, 1, 2, 3, 4, 5, 6, 7, 8, 9,&#160;A, B, C, D, E, F, 10, 11, 12, 13...<br/>While&#160;we&#160;can&#160;see&#160;the&#160;sense&#160;in&#160;binary&#160;(since&#160;computers&#160;have&#160;only&#160;one&#160;finger),<br/>what&#160;are&#160;octal&#160;and&#160;hexadecimal&#160;good&#160;for?&#160;The&#160;answer&#160;has&#160;to&#160;do&#160;with&#160;human&#160;con-<br/>venience.&#160;Many&#160;times,&#160;small&#160;portions&#160;of&#160;data&#160;are&#160;represented&#160;on&#160;computers&#160;as&#160;<i>bit<br/>patterns</i>.&#160;Take&#160;for&#160;example&#160;an&#160;RGB&#160;color.&#160;On&#160;most&#160;computer&#160;displays,&#160;each&#160;pixel<br/>is&#160;composed&#160;of&#160;three&#160;color&#160;components:&#160;eight&#160;bits&#160;of&#160;red,&#160;eight&#160;bits&#160;of&#160;green,&#160;and<br/>eight&#160;bits&#160;of blue.&#160;A&#160;lovely&#160;medium&#160;blue&#160;would&#160;be&#160;a&#160;24 digit&#160;number:<br/>010000110110111111001101<br/>How&#160;would&#160;you&#160;like&#160;to&#160;read&#160;and&#160;write&#160;those&#160;kinds&#160;of&#160;numbers&#160;all&#160;day?&#160;I&#160;didn't<br/>think&#160;so.&#160;Here's&#160;where&#160;another&#160;number&#160;system&#160;would&#160;help.&#160;Each&#160;digit&#160;in&#160;a&#160;hexa-<br/>decimal&#160;number&#160;represents&#160;four&#160;digits&#160;in&#160;binary.&#160;In&#160;octal,&#160;each&#160;digit&#160;represents<br/>three&#160;binary&#160;digits.&#160;So&#160;our&#160;24&#160;digit&#160;medium&#160;blue&#160;could&#160;be&#160;condensed&#160;to&#160;a&#160;six-digit<br/>hexadecimal&#160;number:<br/>436FCD<br/>Since&#160;the&#160;digits&#160;in&#160;the&#160;hexadecimal&#160;number&#160;“line&#160;up”&#160;with&#160;the&#160;bits&#160;in&#160;the&#160;binary<br/>number,&#160;we&#160;can&#160;see&#160;that&#160;the&#160;red&#160;component&#160;of&#160;our&#160;color&#160;is&#160;43,&#160;the&#160;green&#160;6F,&#160;and<br/>the&#160;blue&#160;CD.<br/>These&#160;days,&#160;hexadecimal&#160;notation&#160;(often&#160;spoken&#160;as&#160;“hex”)&#160;is&#160;more&#160;common&#160;than<br/>octal,&#160;but&#160;as&#160;we&#160;will&#160;soon&#160;see,&#160;octal's&#160;ability&#160;to&#160;express&#160;three&#160;bits&#160;of&#160;binary&#160;will&#160;be<br/>very useful...&#160;<br/>
With&#160;octal&#160;notation,&#160;we&#160;use&#160;octal&#160;numbers&#160;to&#160;set&#160;the&#160;pattern&#160;of&#160;desired&#160;permissions.&#160;Since<br/>each&#160;&#160;digit&#160;&#160;in&#160;an&#160;octal&#160;number&#160;&#160;represents&#160;three&#160;&#160;binary&#160;&#160;digits,&#160;this&#160;maps&#160;&#160;nicely&#160;&#160;to&#160;the<br/>
95<br/>
<hr/>
<a name=120></a>9 – Permissions<br/>
scheme&#160;used to&#160;store&#160;the&#160;file&#160;mode.&#160;Table&#160;9-4 shows&#160;what&#160;we&#160;mean.<br/>
<i>Table&#160;9-4: File&#160;Modes&#160;in&#160;Binary&#160;and Octal</i><br/>
<b>Octal</b><br/>
<b>Binary</b><br/>
<b>File&#160;Mode</b><br/>
0<br/>
000<br/>
---<br/>
1<br/>
001<br/>
--x<br/>
2<br/>
010<br/>
-w-<br/>
3<br/>
011<br/>
-wx<br/>
4<br/>
100<br/>
r--<br/>
5<br/>
101<br/>
r-x<br/>
6<br/>
110<br/>
rw-<br/>
7<br/>
111<br/>
rwx<br/>
By&#160;using&#160;three&#160;octal&#160;digits,&#160;we&#160;can&#160;set&#160;the&#160;file&#160;mode&#160;for&#160;the&#160;owner,&#160;group&#160;owner,&#160;and<br/>world.<br/>
[me@linuxbox ~]$&#160;<b>&gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw-rw-r-- 1 me &#160; &#160;me &#160; 0 2016-03-06 14:52 foo.txt<br/>[me@linuxbox ~]$&#160;<b>chmod 600 foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw------- 1 me &#160; &#160;me &#160; 0 2016-03-06 14:52 foo.txt<br/>
By&#160;passing&#160;the&#160;argument&#160;“600”,&#160;we&#160;were&#160;able&#160;to&#160;set&#160;the&#160;permissions&#160;of&#160;the&#160;owner&#160;to&#160;read<br/>and&#160;write&#160;while&#160;removing&#160;all&#160;permissions&#160;from&#160;the&#160;group&#160;owner&#160;and&#160;world.&#160;Though&#160;re-<br/>membering&#160;the&#160;octal&#160;to&#160;binary&#160;mapping&#160;may&#160;seem&#160;inconvenient,&#160;we&#160;will&#160;usually&#160;have<br/>only to use&#160;a&#160;few&#160;common ones:&#160;7 (rwx), 6 (rw-), 5 (r-x), 4 (r--), and 0 (---).<br/>
chmod&#160;also&#160;supports&#160;a&#160;symbolic&#160;notation&#160;for&#160;specifying&#160;file&#160;modes.&#160;Symbolic&#160;notation&#160;is<br/>divided&#160;into three&#160;parts.<br/>
•<br/>
Who the&#160;change&#160;will&#160;affect<br/>
•<br/>
Which&#160;operation&#160;will&#160;be&#160;performed<br/>
•<br/>
What&#160;permission will&#160;be&#160;set.<br/>
To&#160;specify&#160;who&#160;is&#160;affected,&#160;a&#160;combination&#160;of&#160;the&#160;characters&#160;“u”,&#160;“g”,&#160;“o”,&#160;and&#160;“a”&#160;is&#160;used<br/>as&#160;shown in&#160;Table&#160;9-5.<br/>
96<br/>
<hr/>
<a name=121></a>Reading,&#160;Writing, and&#160;Executing<br/>
<i>Table&#160;9-5:&#160;chmod&#160;Symbolic&#160;Notation</i><br/>
<b>Symbol</b><br/>
<b>Meaning</b><br/>
u<br/>
Short&#160;for “user”&#160;but&#160;means&#160;the&#160;file&#160;or directory&#160;owner.<br/>
g<br/>
Group owner.<br/>
o<br/>
Short&#160;for “others”&#160;but&#160;means&#160;world.<br/>
a<br/>
Short&#160;for “all.”&#160;This&#160;is&#160;the&#160;combination&#160;of “u”, “g”,&#160;and “o”.<br/>
If&#160;no&#160;character&#160;is&#160;specified,&#160;“all”&#160;will&#160;be&#160;assumed.&#160;The&#160;operation&#160;may&#160;be&#160;a&#160;“+”&#160;indicating<br/>that&#160;a&#160;permission&#160;is&#160;to&#160;be&#160;added,&#160;a&#160;“-”&#160;indicating&#160;that&#160;a&#160;permission&#160;is&#160;to&#160;be&#160;taken&#160;away,&#160;or<br/>a&#160;“=”&#160;indicating&#160;that&#160;only&#160;the&#160;specified&#160;permissions&#160;are&#160;to&#160;be&#160;applied&#160;and&#160;that&#160;all&#160;others<br/>are&#160;to&#160;be&#160;removed.<br/>Permissions&#160;are&#160;specified&#160;with&#160;the&#160;“r”,&#160;“w”,&#160;and&#160;“x”&#160;characters.&#160;Table&#160;9-6&#160;provides&#160;some<br/>examples&#160;of symbolic&#160;notation:<br/>
<i>Table&#160;9-6:&#160;chmod&#160;Symbolic&#160;Notation Examples</i><br/>
<b>Notation</b><br/>
<b>Meaning</b><br/>
u+x<br/>
Add execute&#160;permission for the&#160;owner.<br/>
u-x<br/>
Remove&#160;execute&#160;permission&#160;from&#160;the&#160;owner.<br/>
+x<br/>
Add execute&#160;permission for the&#160;owner, group, and world.&#160;This&#160;is&#160;<br/>equivalent&#160;to&#160;a+x.<br/>
o-rw<br/>
Remove&#160;the&#160;read&#160;and write&#160;permissions&#160;from&#160;anyone&#160;besides&#160;the&#160;<br/>owner&#160;and group owner.<br/>
go=rw<br/>
Set&#160;the&#160;group owner&#160;and anyone&#160;besides&#160;the&#160;owner to have&#160;read and<br/>write&#160;permission. If either the&#160;group owner&#160;or the&#160;world previously&#160;<br/>had execute&#160;permission, it&#160;is&#160;removed.<br/>
u+x,go=rx<br/>
Add execute&#160;permission for the&#160;owner and set&#160;the&#160;permissions&#160;for&#160;<br/>the&#160;group and&#160;others&#160;to read&#160;and execute. Multiple&#160;specifications&#160;<br/>may be&#160;separated&#160;by commas.<br/>
Some&#160;people&#160;prefer&#160;to&#160;use&#160;octal&#160;notation,&#160;and&#160;some&#160;folks&#160;really&#160;like&#160;the&#160;symbolic.&#160;Sym-<br/>bolic&#160;notation&#160;does&#160;offer&#160;the&#160;advantage&#160;of allowing&#160;us&#160;to&#160;set&#160;a&#160;single&#160;attribute&#160;without&#160;dis-<br/>turbing any&#160;of the&#160;others.<br/>Take&#160;a&#160;look&#160;at&#160;the&#160;chmod&#160;man&#160;page&#160;for&#160;more&#160;details&#160;and&#160;a&#160;list&#160;of&#160;options.&#160;A&#160;word&#160;of&#160;cau-<br/>tion&#160;regarding&#160;the&#160;“--recursive”&#160;option:&#160;it&#160;acts&#160;on&#160;both&#160;files&#160;and&#160;directories,&#160;so&#160;it's&#160;not&#160;as<br/>
97<br/>
<hr/>
<a name=122></a><img src="linux-command-line-122_1.jpg"/><br/>
9 – Permissions<br/>
useful&#160;as&#160;we&#160;would&#160;hope&#160;since&#160;we&#160;rarely&#160;want&#160;files&#160;and&#160;directories&#160;to&#160;have&#160;the&#160;same&#160;per-<br/>missions.<br/>
Setting&#160;File&#160;Mode&#160;with&#160;the&#160;GUI<br/>Now&#160;that&#160;we&#160;have&#160;seen&#160;how&#160;the&#160;permissions&#160;on&#160;files&#160;and&#160;directories&#160;are&#160;set,&#160;we&#160;can&#160;better<br/>understand&#160;the&#160;permission&#160;dialogs&#160;in&#160;the&#160;GUI.&#160;In&#160;both&#160;Files&#160;(GNOME)&#160;and&#160;Dolphin<br/>(KDE),&#160;right-clicking&#160;a&#160;file&#160;or&#160;directory&#160;icon&#160;will&#160;expose&#160;a&#160;properties&#160;dialog.&#160;Here&#160;is&#160;an<br/>example&#160;from&#160;GNOME:<br/>
<i>Figure&#160;2: GNOME&#160;file&#160;<br/>permissions&#160;dialog</i><br/>
Here&#160;we&#160;can see&#160;the&#160;settings&#160;for the&#160;owner, group, and&#160;world.<br/>
umask&#160;–&#160;Set&#160;Default&#160;Permissions<br/>The&#160;umask&#160;command&#160;controls&#160;the&#160;default&#160;permissions&#160;given&#160;to&#160;a&#160;file&#160;when&#160;it&#160;is&#160;created.<br/>It&#160;uses&#160;octal&#160;notation&#160;to&#160;express&#160;a&#160;&#160;<i>mask</i>&#160;&#160;of&#160;bits&#160;to&#160;be&#160;removed&#160;from&#160;a&#160;file's&#160;mode&#160;at-<br/>tributes. Let's&#160;take&#160;a&#160;look.<br/>
98<br/>
<hr/>
<a name=123></a>Reading,&#160;Writing, and&#160;Executing<br/>
[me@linuxbox ~]$&#160;<b>rm -f foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>umask<br/></b>0002<br/>[me@linuxbox ~]$&#160;<b>&gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw-rw-r-- 1 me &#160; &#160;me &#160; 0 2018-03-06 14:53 foo.txt<br/>
We&#160;first&#160;removed&#160;any&#160;old&#160;copy&#160;of&#160;foo.txt&#160;to&#160;make&#160;sure&#160;we&#160;were&#160;starting&#160;fresh.&#160;Next,<br/>we&#160;ran&#160;the&#160;umask&#160;command&#160;without&#160;an&#160;argument&#160;to&#160;see&#160;the&#160;current&#160;value.&#160;It&#160;responded<br/>with&#160;the&#160;value&#160;0002&#160;(the&#160;value&#160;0022&#160;is&#160;another&#160;common&#160;default&#160;value),&#160;which&#160;is&#160;the&#160;oc-<br/>tal&#160;representation&#160;of&#160;our&#160;mask.&#160;We&#160;next&#160;create&#160;a&#160;new&#160;instance&#160;of&#160;the&#160;file&#160;foo.txt&#160;and<br/>observe&#160;its&#160;permissions.<br/>We&#160;can&#160;see&#160;that&#160;both&#160;the&#160;owner&#160;and&#160;group&#160;get&#160;read&#160;and&#160;write&#160;permission,&#160;while&#160;everyone<br/>else&#160;only&#160;gets&#160;read&#160;permission.&#160;The&#160;reason&#160;that&#160;world&#160;does&#160;not&#160;have&#160;write&#160;permission&#160;is<br/>because&#160;of the&#160;value&#160;of the&#160;mask. Let's&#160;repeat&#160;our example, this&#160;time&#160;setting&#160;the&#160;mask our-<br/>selves.<br/>
[me@linuxbox ~]$&#160;<b>rm foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>umask 0000<br/></b>[me@linuxbox ~]$&#160;<b>&gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw-rw-rw- 1 me &#160; &#160;me &#160; 0 2018-03-06 14:58 foo.txt<br/>
When&#160;we&#160;set&#160;the&#160;mask&#160;to&#160;&#160;0000&#160;(effectively&#160;turning&#160;it&#160;off),&#160;we&#160;see&#160;that&#160;the&#160;file&#160;is&#160;now<br/>world&#160;writable.&#160;To&#160;understand&#160;how&#160;this&#160;works,&#160;we&#160;have&#160;to&#160;look&#160;at&#160;octal&#160;numbers&#160;again.&#160;If<br/>we&#160;take&#160;the&#160;mask,&#160;expand&#160;it&#160;into&#160;binary,&#160;and&#160;then&#160;compare&#160;it&#160;to&#160;the&#160;attributes&#160;we&#160;can&#160;see<br/>what&#160;happens.<br/>
<b>Original&#160;file&#160;mode</b><br/>
--- rw- rw- rw-<br/>
<b>Mask</b><br/>
000 000 000 010<br/>
<b>Result</b><br/>
--- rw- rw- r--<br/>
Ignore&#160;for&#160;the&#160;moment&#160;the&#160;leading&#160;zeros&#160;(we'll&#160;get&#160;to&#160;those&#160;in&#160;a&#160;minute)&#160;and&#160;observe&#160;that<br/>where&#160;the&#160;1&#160;appears&#160;in&#160;our&#160;mask,&#160;an&#160;attribute&#160;was&#160;removed — in&#160;this&#160;case,&#160;the&#160;world&#160;write<br/>permission.&#160;That's&#160;what&#160;the&#160;mask&#160;does.&#160;Everywhere&#160;a&#160;1&#160;appears&#160;in&#160;the&#160;binary&#160;value&#160;of&#160;the<br/>mask, an attribute&#160;is&#160;unset. If we&#160;look&#160;at&#160;a&#160;mask value&#160;of&#160;0022, we&#160;can see&#160;what&#160;it&#160;does.<br/>
99<br/>
<hr/>
<a name=124></a>9 – Permissions<br/>
<b>Original&#160;file&#160;mode</b><br/>
--- rw- rw- rw-<br/>
<b>Mask</b><br/>
000 000 010 010<br/>
<b>Result</b><br/>
--- rw- r-- r--<br/>
Again,&#160;where&#160;a&#160;1&#160;appears&#160;in&#160;the&#160;binary&#160;value,&#160;the&#160;corresponding&#160;attribute&#160;is&#160;unset.&#160;Play<br/>with&#160;some&#160;values&#160;(try&#160;some&#160;sevens)&#160;to&#160;get&#160;used&#160;to&#160;how&#160;this&#160;works.&#160;When&#160;you're&#160;done,&#160;re-<br/>member&#160;to clean up.<br/>
[me@linuxbox ~]$&#160;<b>rm foo.txt; umask 0002</b><br/>
Most&#160;of&#160;the&#160;time&#160;we&#160;won't&#160;have&#160;to&#160;change&#160;the&#160;mask;&#160;the&#160;default&#160;provided&#160;by&#160;the&#160;distribu-<br/>tion will&#160;be&#160;fine.&#160;In some&#160;high-security situations, however,&#160;we&#160;will&#160;want&#160;to&#160;control&#160;it.<br/>
<b>Some&#160;Special&#160;Permissions</b><br/>
Though&#160;we&#160;usually&#160;see&#160;an&#160;octal&#160;permission&#160;mask&#160;expressed&#160;as&#160;a&#160;three-digit&#160;num-<br/>ber, it&#160;is&#160;more&#160;technically&#160;correct&#160;to express&#160;it&#160;in four digits.&#160;Why?&#160;Because,&#160;in ad-<br/>dition&#160;to&#160;read,&#160;write,&#160;and&#160;execute&#160;permission,&#160;there&#160;are&#160;some&#160;other,&#160;less&#160;used,&#160;per-<br/>mission settings.<br/>The&#160;first&#160;of these&#160;is&#160;the&#160;<i>setuid&#160;bit</i>&#160;(octal&#160;4000).&#160;When&#160;applied&#160;to an&#160;executable&#160;file,<br/>it&#160;sets&#160;the&#160;<i>effective&#160;user&#160;ID</i>&#160;from&#160;that&#160;of&#160;the&#160;real&#160;user&#160;(the&#160;user&#160;actually&#160;running&#160;the<br/>program)&#160;to&#160;that&#160;of&#160;the&#160;program's&#160;owner.&#160;Most&#160;often&#160;this&#160;is&#160;given&#160;to&#160;a&#160;few&#160;pro-<br/>grams&#160;owned&#160;by&#160;the&#160;superuser.&#160;When&#160;an&#160;ordinary&#160;user&#160;runs&#160;a&#160;program&#160;that&#160;is&#160;“<i>se-<br/>tuid&#160;root</i>”&#160;,&#160;the&#160;program&#160;runs&#160;with&#160;the&#160;effective&#160;privileges&#160;of&#160;the&#160;superuser.&#160;This<br/>allows&#160;the&#160;program&#160;to&#160;access&#160;files&#160;and&#160;directories&#160;that&#160;an ordinary&#160;user&#160;would&#160;nor-<br/>mally&#160;be&#160;prohibited&#160;from&#160;accessing.&#160;Clearly,&#160;because&#160;this&#160;raises&#160;security&#160;concerns,<br/>the&#160;number&#160;of setuid&#160;programs&#160;must&#160;be&#160;held&#160;to an&#160;absolute&#160;minimum.<br/>The&#160;second&#160;less-used&#160;setting&#160;is&#160;the&#160;<i>setgid&#160;bit</i>&#160;(octal&#160;2000),&#160;which,&#160;like&#160;the&#160;setuid<br/>bit,&#160;changes&#160;the&#160;<i>effective&#160;group&#160;ID</i>&#160;from&#160;the&#160;<i>real&#160;group&#160;ID</i>&#160;of&#160;the&#160;real&#160;user&#160;to&#160;that<br/>of&#160;the&#160;file&#160;owner.&#160;If&#160;the&#160;setgid&#160;bit&#160;is&#160;set&#160;on&#160;a&#160;directory,&#160;newly&#160;created&#160;files&#160;in&#160;the<br/>directory&#160;will&#160;be&#160;given the&#160;group ownership of the&#160;directory&#160;rather&#160;the&#160;group own-<br/>ership&#160;of&#160;the&#160;file's&#160;creator.&#160;This&#160;is&#160;useful&#160;in&#160;a&#160;shared&#160;directory&#160;when&#160;members&#160;of&#160;a<br/>common&#160;group&#160;need&#160;access&#160;to&#160;all&#160;the&#160;files&#160;in&#160;the&#160;directory,&#160;regardless&#160;of&#160;the&#160;file<br/>owner's&#160;primary&#160;group.<br/>The&#160;third&#160;is&#160;called&#160;the&#160;&#160;<i>sticky&#160;bit</i>&#160;&#160;(octal&#160;1000).&#160;This&#160;is&#160;a&#160;holdover&#160;from&#160;ancient<br/>Unix,&#160;where&#160;it&#160;was&#160;possible&#160;to&#160;mark&#160;an&#160;executable&#160;file&#160;as&#160;“not&#160;swappable.”&#160;On<br/>
100<br/>
<hr/>
<a name=125></a>Reading,&#160;Writing, and&#160;Executing<br/>
files,&#160;Linux&#160;ignores&#160;the&#160;sticky&#160;bit,&#160;but&#160;if&#160;applied&#160;to&#160;a&#160;directory,&#160;it&#160;prevents&#160;users<br/>from&#160;deleting&#160;or renaming&#160;files&#160;unless&#160;the&#160;user is&#160;either&#160;the&#160;owner of the&#160;directory,<br/>the&#160;owner&#160;of&#160;the&#160;file,&#160;or&#160;the&#160;superuser.&#160;This&#160;is&#160;often&#160;used&#160;to&#160;control&#160;access&#160;to&#160;a<br/>shared&#160;directory, such as&#160;/tmp.&#160;<br/>Here&#160;are&#160;some&#160;examples&#160;of&#160;using&#160;chmod&#160;with&#160;symbolic&#160;notation&#160;to&#160;set&#160;these&#160;spe-<br/>cial&#160;permissions. Here’s&#160;an&#160;example&#160;of assigning setuid&#160;to a&#160;program:<br/>chmod u+s&#160;<i>program<br/></i>Next, here’s&#160;and example&#160;of assigning setgid to a&#160;directory:<br/>chmod g+s&#160;<i>dir<br/></i>Finally,&#160;here’s&#160;an&#160;example&#160;of assigning the&#160;sticky&#160;bit&#160;to&#160;a&#160;directory:<br/>chmod +t&#160;<i>dir<br/></i>When&#160;viewing&#160;the&#160;output&#160;from&#160;&#160;ls,&#160;you&#160;can&#160;determine&#160;the&#160;special&#160;permissions.<br/>Here&#160;are&#160;some&#160;examples. First, an example&#160;of a&#160;program&#160;that&#160;is&#160;setuid:<br/>-rw<b>s</b>r-xr-x<br/>Here’s&#160;an example&#160;of a&#160;directory that&#160;has&#160;the&#160;setgid attribute:<br/>drwxrw<b>s</b>r-x<br/>Here’s&#160;an example&#160;of a&#160;directory with the&#160;sticky&#160;bit&#160;set:<br/>drwxrwxrw<b>t</b><br/>
<b>Changing&#160;Identities<br/></b>At&#160;various&#160;times,&#160;we&#160;may&#160;find&#160;it&#160;necessary&#160;to&#160;take&#160;on&#160;the&#160;identity&#160;of&#160;another&#160;user.&#160;Often<br/>we&#160;want&#160;to&#160;gain&#160;superuser&#160;privileges&#160;to&#160;carry&#160;out&#160;some&#160;administrative&#160;task,&#160;but&#160;it&#160;is&#160;also<br/>possible&#160;to&#160;“become”&#160;another&#160;regular&#160;user&#160;for&#160;such&#160;things&#160;as&#160;testing&#160;an&#160;account.&#160;There&#160;are<br/>three&#160;ways&#160;to&#160;take&#160;on an&#160;alternate&#160;identity.<br/>
1.&#160;Log out&#160;and&#160;log back&#160;in as&#160;the&#160;alternate&#160;user.<br/>2.&#160;Use&#160;the&#160;su&#160;command.<br/>3.&#160;Use&#160;the&#160;sudo&#160;command.<br/>
We&#160;will&#160;skip&#160;the&#160;first&#160;technique&#160;since&#160;we&#160;know&#160;how&#160;to&#160;do&#160;it&#160;and&#160;it&#160;lacks&#160;the&#160;convenience<br/>of&#160;the&#160;other&#160;two.&#160;From&#160;within&#160;our&#160;own&#160;shell&#160;session,&#160;the&#160;su&#160;command&#160;allows&#160;us&#160;to&#160;as-<br/>sume&#160;the&#160;identity&#160;of&#160;another&#160;user&#160;and&#160;either&#160;start&#160;a&#160;new&#160;shell&#160;session&#160;with&#160;that&#160;user's&#160;ID,<br/>or&#160;to&#160;issue&#160;a&#160;single&#160;command&#160;as&#160;that&#160;user.&#160;The&#160;sudo&#160;command&#160;allows&#160;an&#160;administrator&#160;to<br/>set&#160;up&#160;a&#160;configuration&#160;file&#160;called&#160;&#160;/etc/sudoers&#160;&#160;and&#160;define&#160;specific&#160;commands&#160;that<br/>
101<br/>
<hr/>
<a name=126></a>9 – Permissions<br/>
particular&#160;users&#160;are&#160;permitted&#160;to&#160;execute&#160;under&#160;an&#160;assumed&#160;identity.&#160;The&#160;choice&#160;of&#160;which<br/>command&#160;to&#160;use&#160;is&#160;largely&#160;determined&#160;by&#160;which&#160;Linux&#160;distribution&#160;you&#160;use.&#160;Your&#160;distri-<br/>bution&#160;probably&#160;includes&#160;both&#160;commands,&#160;but&#160;its&#160;configuration&#160;will&#160;favor&#160;either&#160;one&#160;or<br/>the&#160;other.&#160;We'll&#160;start&#160;with&#160;su.<br/>
su&#160;–&#160;Run&#160;a&#160;Shell&#160;with&#160;Substitute&#160;User&#160;and&#160;Group&#160;IDs<br/>The&#160;su&#160;command&#160;is&#160;used&#160;to&#160;start&#160;a&#160;shell&#160;as&#160;another&#160;user.&#160;The&#160;command&#160;syntax&#160;looks&#160;like<br/>this:<br/>
<b>su [-[l]] [<i>user</i></b><b>]</b><br/>
If&#160;the&#160;“-l”&#160;option&#160;is&#160;included,&#160;the&#160;resulting&#160;shell&#160;session&#160;is&#160;a&#160;<i>login&#160;shell</i>&#160;for&#160;the&#160;specified<br/>user.&#160;This&#160;means&#160;the&#160;user's&#160;environment&#160;is&#160;loaded&#160;and&#160;the&#160;working directory&#160;is&#160;changed&#160;to<br/>the&#160;user's&#160;home&#160;directory.&#160;This&#160;is&#160;usually&#160;what&#160;we&#160;want.&#160;If&#160;the&#160;user&#160;is&#160;not&#160;specified,&#160;the<br/>superuser&#160;is&#160;assumed.&#160;Notice&#160;that&#160;(strangely)&#160;the&#160;-l&#160;may&#160;be&#160;abbreviated&#160;as&#160;-,&#160;which&#160;is<br/>how&#160;it&#160;is&#160;most&#160;often used.&#160;To start&#160;a&#160;shell&#160;for the&#160;superuser,&#160;we&#160;would&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>su -<br/></b>Password:<br/>[root@linuxbox ~]#<br/>
After&#160;entering&#160;the&#160;command,&#160;we&#160;are&#160;prompted&#160;for&#160;the&#160;superuser's&#160;password.&#160;If&#160;it&#160;is&#160;suc-<br/>cessfully&#160;entered,&#160;a&#160;new&#160;shell&#160;prompt&#160;appears&#160;indicating&#160;that&#160;this&#160;shell&#160;has&#160;superuser&#160;priv-<br/>ileges&#160;(the&#160;trailing&#160;#&#160;rather&#160;than&#160;a&#160;$),&#160;and&#160;the&#160;current&#160;working&#160;directory&#160;is&#160;now&#160;the&#160;home<br/>directory&#160;for&#160;the&#160;superuser&#160;(normally&#160;/root).&#160;Once&#160;in&#160;the&#160;new&#160;shell,&#160;we&#160;can&#160;carry&#160;out<br/>commands&#160;as&#160;the&#160;superuser.&#160;When&#160;finished, enter&#160;exit&#160;to&#160;return to&#160;the&#160;previous&#160;shell.<br/>
[root@linuxbox ~]#&#160;<b>exit<br/></b>[me@linuxbox ~]$<br/>
It&#160;is&#160;also possible&#160;to execute&#160;a&#160;single&#160;command rather than&#160;starting&#160;a&#160;new&#160;interactive&#160;com-<br/>mand by using&#160;su&#160;this&#160;way.<br/>
su -c '<i>command</i>'<br/>
Using&#160;this&#160;form,&#160;a&#160;single&#160;command&#160;line&#160;is&#160;passed&#160;to&#160;the&#160;new&#160;shell&#160;for&#160;execution.&#160;It&#160;is&#160;im-<br/>
102<br/>
<hr/>
<a name=127></a>Changing&#160;Identities<br/>
portant&#160;to&#160;enclose&#160;the&#160;command&#160;in&#160;quotes,&#160;as&#160;we&#160;do&#160;not&#160;want&#160;expansion&#160;to&#160;occur&#160;in&#160;our<br/>shell, but&#160;rather&#160;in the&#160;new&#160;shell.<br/>
[me@linuxbox ~]$&#160;<b>su -c 'ls -l /root/*'<br/></b>Password:<br/>-rw------- 1 root root &#160; &#160; 754 2007-08-11 03:19 /root/anaconda-ks.cfg<br/>
/root/Mail:<br/>total 0<br/>[me@linuxbox ~]$<br/>
sudo&#160;–&#160;Execute&#160;a&#160;Command&#160;as&#160;Another&#160;User<br/>The&#160;sudo&#160;command&#160;is&#160;like&#160;su&#160;in&#160;many&#160;ways&#160;but&#160;has&#160;some&#160;important&#160;additional&#160;capabili-<br/>ties.&#160;The&#160;administrator&#160;can&#160;configure&#160;&#160;sudo&#160;&#160;to&#160;allow&#160;an&#160;ordinary&#160;user&#160;to&#160;execute&#160;com-<br/>mands&#160;as&#160;a&#160;different&#160;user&#160;(usually&#160;the&#160;superuser)&#160;in&#160;a&#160;controlled&#160;way.&#160;In&#160;particular,&#160;a&#160;user<br/>may&#160;be&#160;restricted&#160;to&#160;one&#160;or&#160;more&#160;specific&#160;commands&#160;and&#160;no&#160;others.&#160;Another&#160;important<br/>difference&#160;is&#160;that&#160;the&#160;use&#160;of&#160;sudo&#160;does&#160;not&#160;require&#160;access&#160;to&#160;the&#160;superuser's&#160;password.&#160;To<br/>authenticating&#160;using&#160;sudo,&#160;requires&#160;the&#160;user’s&#160;own&#160;password.&#160;Let's&#160;say,&#160;for&#160;example,&#160;that<br/>sudo&#160;&#160;has&#160;&#160;&#160;been&#160;&#160;&#160;configured&#160;&#160;&#160;to&#160;&#160;&#160;allow&#160;&#160;&#160;us&#160;&#160;&#160;to&#160;&#160;&#160;run&#160;&#160;&#160;a&#160;&#160;&#160;fictitious&#160;&#160;&#160;backup&#160;&#160;&#160;program&#160;&#160;&#160;called<br/>“backup_script”,&#160;which&#160;requires&#160;superuser&#160;privileges.&#160;With&#160;sudo&#160;it&#160;would&#160;be&#160;done&#160;like<br/>this:<br/>
[me@linuxbox ~]$&#160;<b>sudo backup_script<br/></b>Password:<br/>System Backup Starting...<br/>
After&#160;entering&#160;the&#160;command,&#160;we&#160;are&#160;prompted&#160;for&#160;our&#160;password&#160;(not&#160;the&#160;superuser's)&#160;and<br/>once&#160;the&#160;authentication&#160;is&#160;complete,&#160;the&#160;specified&#160;command&#160;is&#160;carried&#160;out.&#160;One&#160;important<br/>difference&#160;between&#160;su&#160;and&#160;sudo&#160;is&#160;that&#160;sudo&#160;does&#160;not&#160;start&#160;a&#160;new&#160;shell,&#160;nor&#160;does&#160;it&#160;load<br/>another&#160;user's&#160;environment.&#160;This&#160;means&#160;that&#160;commands&#160;do&#160;not&#160;need&#160;to&#160;be&#160;quoted&#160;any&#160;dif-<br/>ferently&#160;than&#160;they&#160;would&#160;be&#160;without&#160;using&#160;sudo.&#160;Note&#160;that&#160;this&#160;behavior&#160;can&#160;be&#160;overrid-<br/>den&#160;by specifying&#160;various&#160;options.&#160;Note,&#160;too,&#160;that&#160;sudo&#160;can&#160;be&#160;used to&#160;start&#160;an&#160;interactive<br/>superuser&#160;session&#160;(much&#160;like&#160;su&#160;-)&#160;by&#160;using&#160;the&#160;-i&#160;option.&#160;See&#160;the&#160;sudo&#160;man&#160;page&#160;for<br/>details.<br/>To see&#160;what&#160;privileges&#160;are&#160;granted&#160;by&#160;sudo, use&#160;the&#160;-l&#160;option&#160;to list&#160;them:<br/>
[me@linuxbox ~]$&#160;<b>sudo -l</b><br/>
103<br/>
<hr/>
<a name=128></a>9 – Permissions<br/>
User me may run the following commands on this host:<br/>&#160; &#160; (ALL) ALL<br/>
<b>Ubuntu&#160;and&#160;sudo</b><br/>
One&#160;of&#160;the&#160;recurrent&#160;problems&#160;for&#160;regular&#160;users&#160;is&#160;how&#160;to&#160;perform&#160;certain&#160;tasks<br/>that&#160;require&#160;superuser&#160;privileges.&#160;These&#160;tasks&#160;include&#160;installing&#160;and&#160;updating&#160;soft-<br/>ware,&#160;editing&#160;system&#160;configuration&#160;files,&#160;and&#160;accessing&#160;devices.&#160;In&#160;the&#160;Windows<br/>world,&#160;this&#160;is&#160;often&#160;done&#160;by&#160;giving&#160;users&#160;administrative&#160;privileges.&#160;This&#160;allows<br/>users&#160;to&#160;perform&#160;these&#160;tasks.&#160;However,&#160;it&#160;also&#160;enables&#160;programs&#160;executed&#160;by&#160;the<br/>user&#160;to&#160;have&#160;the&#160;same&#160;abilities.&#160;This&#160;is&#160;desirable&#160;in&#160;most&#160;cases,&#160;but&#160;it&#160;also&#160;permits<br/><i>malware</i>&#160;(malicious&#160;software)&#160;such as&#160;viruses&#160;to have&#160;free&#160;rein&#160;of the&#160;computer.<br/>In&#160;the&#160;Unix&#160;world,&#160;there&#160;has&#160;always&#160;been&#160;a&#160;larger&#160;division&#160;between&#160;regular&#160;users<br/>and&#160;administrators,&#160;owing&#160;to&#160;the&#160;multiuser&#160;heritage&#160;of&#160;Unix.&#160;The&#160;approach&#160;taken<br/>in&#160;Unix&#160;is&#160;to&#160;grant&#160;superuser&#160;privileges&#160;only&#160;when&#160;needed.&#160;To&#160;do&#160;this,&#160;the&#160;su&#160;and<br/>sudo&#160;commands&#160;are&#160;commonly used.<br/>Up&#160;until&#160;a&#160;few&#160;of&#160;years&#160;ago,&#160;most&#160;Linux&#160;distributions&#160;relied&#160;on&#160;su&#160;for&#160;this&#160;pur-<br/>pose.&#160;su&#160;didn't&#160;require&#160;the&#160;configuration&#160;that&#160;sudo&#160;required,&#160;and&#160;having&#160;a&#160;root<br/>account&#160;is&#160;traditional&#160;in&#160;Unix.&#160;This&#160;introduced&#160;a&#160;problem.&#160;Users&#160;were&#160;tempted&#160;to<br/>operate&#160;as&#160;root&#160;unnecessarily.&#160;In&#160;fact,&#160;some&#160;users&#160;operated&#160;their&#160;systems&#160;as&#160;the<br/>root&#160;user&#160;exclusively,&#160;since&#160;it&#160;does&#160;away&#160;with&#160;all&#160;those&#160;annoying&#160;“permission&#160;de-<br/>nied”&#160;messages.&#160;This&#160;is&#160;how&#160;you reduce&#160;the&#160;security&#160;of a&#160;Linux&#160;system&#160;to that&#160;of a<br/>Windows&#160;system. Not&#160;a&#160;good idea.<br/>When&#160;&#160;Ubuntu&#160;&#160;was&#160;&#160;&#160;introduced,&#160;&#160;&#160;its&#160;&#160;&#160;creators&#160;&#160;&#160;took&#160;&#160;&#160;a&#160;&#160;&#160;different&#160;&#160;&#160;tack.&#160;&#160;&#160;By&#160;&#160;&#160;default,<br/>Ubuntu&#160;disables&#160;logins&#160;to&#160;the&#160;root&#160;account&#160;(by&#160;failing&#160;to&#160;set&#160;a&#160;password&#160;for&#160;the&#160;ac-<br/>count)&#160;and&#160;instead&#160;uses&#160;sudo&#160;to&#160;grant&#160;superuser&#160;privileges.&#160;The&#160;initial&#160;user&#160;ac-<br/>count&#160;is&#160;granted&#160;full&#160;access&#160;to&#160;superuser&#160;privileges&#160;via&#160;sudo&#160;and&#160;may&#160;grant&#160;simi-<br/>lar powers&#160;to subsequent&#160;user accounts.<br/>
chown&#160;–&#160;Change&#160;File&#160;Owner&#160;and&#160;Group<br/>The&#160;chown&#160;command&#160;is&#160;used&#160;to&#160;change&#160;the&#160;owner&#160;and&#160;group&#160;owner&#160;of&#160;a&#160;file&#160;or&#160;directory.<br/>Superuser&#160;privileges&#160;are&#160;required&#160;to&#160;use&#160;this&#160;command.&#160;The&#160;syntax&#160;of&#160;chown&#160;looks&#160;like<br/>this:<br/>
104<br/>
<hr/>
<a name=129></a>Changing&#160;Identities<br/>
<b>chown [owner][:[group]] file...</b><br/>
chown&#160;can&#160;change&#160;the&#160;file&#160;owner&#160;and/or&#160;the&#160;file&#160;group&#160;owner&#160;depending&#160;on&#160;the&#160;first&#160;ar-<br/>gument&#160;of the&#160;command.&#160;Table&#160;9-7 provides&#160;some&#160;examples.<br/>
<i>Table&#160;9-7:&#160;chown&#160;Argument&#160;Examples</i><br/>
<b>Argument</b><br/>
<b>Results</b><br/>
bob<br/>
Changes&#160;the&#160;ownership of the&#160;file&#160;from&#160;its&#160;current&#160;owner to&#160;user&#160;<br/>bob.<br/>
bob:users<br/>
Changes&#160;the&#160;ownership of the&#160;file&#160;from&#160;its&#160;current&#160;owner to&#160;user&#160;<br/>bob&#160;and changes&#160;the&#160;file&#160;group owner to group&#160;users.<br/>
:admins<br/>
Changes&#160;the&#160;group owner to&#160;the&#160;group&#160;admins.&#160;The&#160;file&#160;owner&#160;is&#160;<br/>unchanged.<br/>
bob:<br/>
Changes&#160;the&#160;file&#160;owner from&#160;the&#160;current&#160;owner to user&#160;bob&#160;and&#160;<br/>changes&#160;the&#160;group owner&#160;to the&#160;login group of user&#160;bob.<br/>
Let's&#160;say&#160;we&#160;have&#160;two&#160;users;&#160;janet,&#160;who&#160;has&#160;access&#160;to&#160;superuser&#160;privileges&#160;and&#160;tony,<br/>who&#160;does&#160;not.&#160;User&#160;janet&#160;wants&#160;to&#160;copy&#160;a&#160;file&#160;from&#160;her&#160;home&#160;directory&#160;to&#160;the&#160;home&#160;di-<br/>rectory&#160;of&#160;user&#160;tony.&#160;Since&#160;user&#160;janet&#160;wants&#160;tony&#160;to&#160;be&#160;able&#160;to&#160;edit&#160;the&#160;file,&#160;janet<br/>changes&#160;the&#160;ownership&#160;of the&#160;copied file&#160;from&#160;janet&#160;to&#160;tony.<br/>
[janet@linuxbox ~]$&#160;<b>sudo cp myfile.txt ~tony<br/></b>Password:<br/>[janet@linuxbox ~]$&#160;<b>sudo ls -l ~tony/myfile.txt<br/></b>&#160;-rw-r--r-- 1 root &#160;root &#160;root 2018-03-20 14:30 /home/tony/myfile.txt<br/>[janet@linuxbox ~]$&#160;<b>sudo chown tony: ~tony/myfile.txt<br/></b>[janet@linuxbox ~]$&#160;<b>sudo ls -l ~tony/myfile.txt<br/></b>&#160;-rw-r--r-- 1 tony &#160;tony &#160;tony 2018-03-20 14:30 /home/tony/myfile.txt<br/>
Here&#160;we&#160;see&#160;user&#160;janet&#160;copy&#160;the&#160;file&#160;from&#160;her&#160;directory&#160;to&#160;the&#160;home&#160;directory&#160;of&#160;user<br/>tony.&#160;Next,&#160;&#160;janet&#160;&#160;changes&#160;the&#160;ownership&#160;of&#160;the&#160;file&#160;from&#160;&#160;root&#160;&#160;(a&#160;result&#160;of&#160;using<br/>sudo)&#160;to&#160;tony.&#160;Using&#160;the&#160;trailing&#160;colon&#160;in&#160;the&#160;first&#160;argument,&#160;janet&#160;also&#160;changed&#160;the<br/>group&#160;ownership&#160;of&#160;the&#160;file&#160;to&#160;the&#160;login&#160;group&#160;of&#160;&#160;tony,&#160;which&#160;happens&#160;to&#160;be&#160;group<br/>tony.<br/>Notice&#160;that&#160;after&#160;the&#160;first&#160;use&#160;of&#160;sudo,&#160;janet&#160;was&#160;not&#160;prompted&#160;for&#160;her&#160;password.&#160;This<br/>is&#160;because&#160;&#160;sudo,&#160;in&#160;most&#160;configurations,&#160;“trusts”&#160;us&#160;for&#160;several&#160;minutes&#160;until&#160;its&#160;timer<br/>
105<br/>
<hr/>
<a name=130></a><img src="linux-command-line-130_1.jpg"/><br/>
9 – Permissions<br/>
runs&#160;out.<br/>
chgrp&#160;–&#160;Change&#160;Group&#160;Ownership<br/>In&#160;older&#160;versions&#160;of&#160;Unix,&#160;the&#160;chown&#160;command&#160;only&#160;changed&#160;file&#160;ownership,&#160;not&#160;group<br/>ownership.&#160;For&#160;that&#160;purpose,&#160;a&#160;separate&#160;command,&#160;chgrp&#160;was&#160;used.&#160;It&#160;works&#160;much&#160;the<br/>same&#160;way as&#160;chown, except&#160;for being&#160;more&#160;limited.<br/>
<b>Exercising&#160;Our&#160;Privileges<br/></b>Now&#160;that&#160;we&#160;have&#160;learned&#160;how&#160;this&#160;permissions&#160;thing&#160;works,&#160;it's&#160;time&#160;to&#160;show&#160;it&#160;off.&#160;We<br/>are&#160;going&#160;to&#160;demonstrate&#160;the&#160;solution&#160;to&#160;a&#160;common&#160;problem — setting&#160;up&#160;a&#160;shared&#160;direc-<br/>tory.&#160;Let's&#160;imagine&#160;that&#160;we&#160;have&#160;two&#160;users&#160;named&#160;“bill”&#160;and&#160;“karen.”&#160;They&#160;both&#160;have&#160;mu-<br/>sic&#160;collections&#160;and&#160;want&#160;to&#160;set&#160;up&#160;a&#160;shared&#160;directory,&#160;where&#160;they&#160;will&#160;each&#160;store&#160;their&#160;mu-<br/>sic&#160;files&#160;as&#160;Ogg&#160;Vorbis&#160;or&#160;MP3. User&#160;bill&#160;has&#160;access&#160;to superuser&#160;privileges&#160;via&#160;sudo.&#160;<br/>The&#160;first&#160;thing&#160;that&#160;needs&#160;to&#160;happen&#160;is&#160;a&#160;group&#160;needs&#160;to&#160;be&#160;created&#160;that&#160;will&#160;have&#160;both<br/>bill&#160;and&#160;karen&#160;as&#160;members.&#160;Using&#160;the&#160;graphical&#160;user&#160;management&#160;tool,&#160;bill&#160;creates<br/>a&#160;group called&#160;music&#160;and&#160;adds&#160;users&#160;bill&#160;and&#160;karen&#160;to it:<br/>
<i>Figure&#160;3: Creating a new&#160;group with&#160;GNOME</i><br/>
Next,&#160;bill&#160;creates&#160;the&#160;directory for the&#160;music&#160;files.<br/>
106<br/>
<hr/>
<a name=131></a>Exercising Our Privileges<br/>
[bill@linuxbox ~]$&#160;<b>sudo mkdir /usr/local/share/Music<br/></b>Password:<br/>
Since&#160;bill&#160;is&#160;manipulating&#160;files&#160;outside&#160;his&#160;home&#160;directory,&#160;superuser&#160;privileges&#160;are&#160;re-<br/>quired.&#160;After the&#160;directory&#160;is&#160;created, it&#160;has&#160;the&#160;following&#160;ownerships&#160;and permissions:<br/>
[bill@linuxbox ~]$&#160;<b>ls -ld /usr/local/share/Music<br/></b>drwxr-xr-x 2 root root 4096 2018-03-21 18:05 /usr/local/share/Music<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;directory&#160;is&#160;owned&#160;by&#160;root&#160;and&#160;has&#160;permission&#160;mode&#160;755.&#160;To&#160;make<br/>this&#160;directory&#160;sharable,&#160;bill&#160;needs&#160;to&#160;change&#160;the&#160;group&#160;ownership&#160;and&#160;the&#160;group permis-<br/>sions&#160;to&#160;allow&#160;writing.<br/>
[bill@linuxbox ~]$&#160;<b>sudo&#160;chown :music /usr/local/share/Music<br/></b>[bill@linuxbox ~]$&#160;<b>sudo&#160;chmod 775 /usr/local/share/Music<br/></b>[bill@linuxbox ~]$&#160;<b>ls -ld /usr/local/share/Music<br/></b>drwxrwxr-x 2 root music 4096 2018-03-21 18:05 /usr/local/share/Music<br/>
What&#160;&#160;&#160;does&#160;&#160;&#160;this&#160;&#160;&#160;all&#160;&#160;&#160;mean?&#160;&#160;&#160;It&#160;&#160;&#160;means&#160;&#160;&#160;that&#160;&#160;&#160;we&#160;&#160;&#160;now&#160;&#160;&#160;have&#160;&#160;&#160;a&#160;&#160;&#160;directory,&#160;&#160;/usr/local/<br/>share/Music&#160;that&#160;is&#160;owned&#160;by&#160;root&#160;and&#160;allows&#160;read&#160;and&#160;write&#160;access&#160;to&#160;group&#160;mu-<br/>sic.&#160;Group&#160;music&#160;has&#160;members&#160;bill&#160;and&#160;karen;&#160;thus,&#160;bill&#160;and&#160;karen&#160;can&#160;create<br/>files&#160;in&#160;directory&#160;/usr/local/share/Music.&#160;Other&#160;users&#160;can&#160;list&#160;the&#160;contents&#160;of&#160;the<br/>directory&#160;but&#160;cannot&#160;create&#160;files&#160;there.<br/>But&#160;we&#160;still&#160;have&#160;a&#160;problem.&#160;With&#160;the&#160;current&#160;permissions,&#160;files&#160;and&#160;directories&#160;created<br/>within&#160;the&#160;&#160;Music&#160;&#160;directory&#160;will&#160;have&#160;the&#160;normal&#160;permissions&#160;of&#160;the&#160;users&#160;&#160;bill&#160;&#160;and<br/>karen.<br/>
[bill@linuxbox ~]$&#160;<b>&gt; /usr/local/share/Music/test_file<br/></b>[bill@linuxbox ~]$&#160;<b>ls -l /usr/local/share/Music<br/></b>-rw-r--r-- 1 bill &#160; bill &#160; 0 2018-03-24 20:03 test_file<br/>
Actually&#160;there&#160;are&#160;two&#160;problems.&#160;First,&#160;the&#160;default&#160;umask&#160;on&#160;this&#160;system&#160;is&#160;0022,&#160;which<br/>prevents&#160;group&#160;members&#160;from&#160;writing&#160;files&#160;belonging&#160;to&#160;other&#160;members&#160;of&#160;the&#160;group.<br/>This&#160;would&#160;not&#160;be&#160;a&#160;problem&#160;if&#160;the&#160;shared&#160;directory&#160;contained&#160;only&#160;files,&#160;but&#160;since&#160;this&#160;di-<br/>rectory&#160;will&#160;store&#160;music,&#160;and&#160;music&#160;is&#160;usually&#160;organized&#160;in&#160;a&#160;hierarchy&#160;of&#160;artists&#160;and&#160;al-<br/>bums,&#160;members&#160;of&#160;the&#160;group&#160;will&#160;need&#160;the&#160;ability&#160;to&#160;create&#160;files&#160;and&#160;directories&#160;inside&#160;di-<br/>rectories&#160;created&#160;by&#160;other&#160;members.&#160;We&#160;need&#160;to&#160;change&#160;the&#160;&#160;umask&#160;used&#160;by&#160;bill&#160;and<br/>
107<br/>
<hr/>
<a name=132></a>9 – Permissions<br/>
karen&#160;to 0002 instead.<br/>Second, each&#160;file&#160;and directory created by one&#160;member&#160;will&#160;be&#160;set&#160;to the&#160;primary&#160;group of<br/>the&#160;user&#160;rather&#160;than&#160;the&#160;group&#160;music.&#160;This&#160;can&#160;be&#160;fixed&#160;by&#160;setting&#160;the&#160;setgid&#160;bit&#160;on&#160;the<br/>directory.<br/>
[bill@linuxbox ~]$&#160;<b>sudo chmod g+s /usr/local/share/Music<br/></b>[bill@linuxbox ~]$&#160;<b>ls -ld /usr/local/share/Music<br/></b>drwxrwsr-x 2 root music 4096 2018-03-24 20:03 /usr/local/share/Music<br/>
Now&#160;we&#160;test&#160;to&#160;see&#160;whether&#160;the&#160;new&#160;permissions&#160;fix&#160;the&#160;problem.&#160;bill&#160;sets&#160;his&#160;umask<br/>to 0002, removes&#160;the&#160;previous&#160;test&#160;file,&#160;and creates&#160;a&#160;new&#160;test&#160;file&#160;and directory:<br/>
[bill@linuxbox ~]$&#160;<b>umask 0002<br/></b>[bill@linuxbox ~]$&#160;<b>rm /usr/local/share/Music/test_file<br/></b>[bill@linuxbox ~]$&#160;<b>&gt; /usr/local/share/Music/test_file<br/></b>[bill@linuxbox ~]$&#160;<b>mkdir /usr/local/share/Music/test_dir<br/></b>[bill@linuxbox ~]$&#160;<b>ls -l /usr/local/share/Music<br/></b>drwxrwsr-x 2 bill &#160; music 4096 2018-03-24 20:24 test_dir<br/>-rw-rw-r-- 1 bill &#160; music &#160; &#160;0 2018-03-24 20:22 test_file<br/>[bill@linuxbox ~]$&#160;<br/>
Both&#160;files&#160;and&#160;directories&#160;are&#160;now&#160;created&#160;with&#160;the&#160;correct&#160;permissions&#160;to&#160;allow&#160;all&#160;mem-<br/>bers&#160;of the&#160;group&#160;music&#160;to&#160;create&#160;files&#160;and directories&#160;inside&#160;the&#160;Music&#160;directory.<br/>The&#160;one&#160;remaining&#160;issue&#160;is&#160;umask.&#160;The&#160;necessary&#160;setting&#160;only&#160;lasts&#160;until&#160;the&#160;end&#160;of&#160;ses-<br/>sion&#160;and&#160;must&#160;be&#160;reset.&#160;In&#160;Chapter&#160;11,&#160;we'll&#160;look&#160;at&#160;making&#160;the&#160;change&#160;to&#160;umask&#160;perma-<br/>nent.<br/>
<b>Changing&#160;Your&#160;Password<br/></b>The&#160;last&#160;topic&#160;we'll&#160;cover&#160;in&#160;this&#160;chapter&#160;is&#160;setting&#160;passwords&#160;for&#160;yourself&#160;(and&#160;for&#160;other<br/>users&#160;&#160;&#160;if&#160;&#160;&#160;you&#160;&#160;&#160;have&#160;&#160;&#160;access&#160;&#160;&#160;to&#160;&#160;&#160;superuser&#160;&#160;&#160;privileges).&#160;&#160;To&#160;&#160;&#160;set&#160;&#160;&#160;or&#160;&#160;&#160;change&#160;&#160;&#160;a&#160;&#160;&#160;password,&#160;&#160;&#160;the<br/>passwd&#160;command&#160;is&#160;used.&#160;The&#160;command syntax&#160;looks&#160;like&#160;this:<br/>
<b>passwd [<i>user</i></b><b>]</b><br/>
To&#160;change&#160;your&#160;password,&#160;just&#160;enter&#160;the&#160;&#160;passwd&#160;command.&#160;You&#160;will&#160;be&#160;prompted&#160;for<br/>your old password and&#160;your new&#160;password.<br/>
108<br/>
<hr/>
<a name=133></a>Changing&#160;Your Password<br/>
[me@linuxbox ~]$&#160;<b>passwd<br/></b>(current) UNIX password:<br/>New UNIX password:<br/>
The&#160;passwd&#160;command&#160;will&#160;try&#160;to&#160;enforce&#160;use&#160;of&#160;“strong”&#160;passwords.&#160;This&#160;means&#160;it&#160;will<br/>refuse&#160;to&#160;accept&#160;passwords&#160;that&#160;are&#160;too&#160;short,&#160;are&#160;too&#160;similar&#160;to&#160;previous&#160;passwords,&#160;are<br/>dictionary words, or are&#160;too easily guessed.<br/>
[me@linuxbox ~]$&#160;<b>passwd<br/></b>(current) UNIX password:<br/>New UNIX password:<br/>BAD PASSWORD: is too similar to the old one<br/>New UNIX password:<br/>BAD PASSWORD: it is WAY too short<br/>New UNIX password:<br/>BAD PASSWORD: it is based on a dictionary word<br/>
If&#160;you&#160;have&#160;&#160;superuser&#160;&#160;privileges,&#160;you&#160;can&#160;specify&#160;a&#160;username&#160;as&#160;an&#160;argument&#160;to&#160;the<br/>passwd&#160;command&#160;to&#160;set&#160;the&#160;password&#160;for&#160;another&#160;user.&#160;Other&#160;options&#160;are&#160;available&#160;to<br/>the&#160;superuser&#160;to&#160;allow&#160;account&#160;locking,&#160;password&#160;expiration,&#160;and&#160;so&#160;on.&#160;See&#160;the&#160;passwd<br/>man page&#160;for details.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter&#160;we&#160;saw&#160;how&#160;Unix-like&#160;systems&#160;such&#160;as&#160;Linux&#160;manage&#160;user&#160;permissions&#160;to<br/>allow&#160;the&#160;read,&#160;write,&#160;and&#160;execution&#160;access&#160;to&#160;files&#160;and&#160;directories.&#160;The&#160;basic&#160;ideas&#160;of&#160;this<br/>system&#160;of&#160;permissions&#160;date&#160;back&#160;to&#160;the&#160;early&#160;days&#160;of&#160;Unix&#160;and&#160;have&#160;stood&#160;up&#160;pretty&#160;well<br/>to&#160;the&#160;test&#160;of&#160;time.&#160;But&#160;the&#160;native&#160;permissions&#160;mechanism&#160;in&#160;Unix-like&#160;systems&#160;lacks&#160;the<br/>fine&#160;granularity&#160;of more&#160;modern systems.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
Wikipedia&#160;has&#160;a&#160;good article&#160;on malware:<br/><a href="http://en.wikipedia.org/wiki/Malware">http://en.wikipedia.org/wiki/Malware</a><br/>
There&#160;are&#160;number&#160;of&#160;command&#160;line&#160;programs&#160;used&#160;to&#160;create&#160;and&#160;maintain&#160;users&#160;and<br/>groups. For more&#160;information, see&#160;the&#160;man&#160;pages&#160;for the&#160;following commands:<br/>
●<br/>
adduser<br/>
●<br/>
useradd<br/>
●<br/>
groupadd<br/>
109<br/>
<hr/>
<a name=134></a>10 – Processes<br/>
<i><b>10&#160;–&#160;Processes</b></i><br/>
Modern&#160;operating&#160;systems&#160;are&#160;usually&#160;&#160;<i>multitasking</i>,&#160;meaning&#160;they&#160;create&#160;the&#160;illusion&#160;of<br/>doing&#160;more&#160;than&#160;one&#160;thing&#160;at&#160;once&#160;by&#160;rapidly&#160;switching&#160;from&#160;one&#160;executing&#160;program&#160;to<br/>another.&#160;The&#160;Linux&#160;kernel&#160;manages&#160;this&#160;through&#160;the&#160;use&#160;of&#160;<i>processes</i>.&#160;Processes&#160;are&#160;how<br/>Linux organizes&#160;the&#160;different&#160;programs&#160;waiting&#160;for their&#160;turn at&#160;the&#160;CPU.<br/>Sometimes&#160;a&#160;computer&#160;will&#160;become&#160;sluggish&#160;or&#160;an&#160;application&#160;will&#160;stop&#160;responding.&#160;In<br/>this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;some&#160;of&#160;the&#160;tools&#160;available&#160;at&#160;the&#160;command&#160;line&#160;that&#160;let&#160;us<br/>examine&#160;what&#160;programs&#160;are&#160;doing&#160;and how&#160;to&#160;terminate&#160;processes&#160;that&#160;are&#160;misbehaving.&#160;<br/>This&#160;chapter will&#160;introduce&#160;the&#160;following commands:<br/>
●<br/>
ps&#160;– Report&#160;a&#160;snapshot&#160;of current&#160;processes<br/>
●<br/>
top&#160;– Display tasks<br/>
●<br/>
jobs&#160;– List&#160;active&#160;jobs<br/>
●<br/>
bg&#160;– Place&#160;a&#160;job in&#160;the&#160;background<br/>
●<br/>
fg&#160;– Place&#160;a&#160;job in&#160;the&#160;foreground<br/>
●<br/>
kill&#160;– Send a&#160;signal&#160;to a&#160;process<br/>
●<br/>
killall&#160;– Kill&#160;processes&#160;by name<br/>
●<br/>
shutdown&#160;– Shutdown or reboot&#160;the&#160;system<br/>
<b>How&#160;a&#160;Process&#160;Works<br/></b>When&#160;a&#160;system&#160;starts&#160;up,&#160;the&#160;kernel&#160;initiates&#160;a&#160;few&#160;of&#160;its&#160;own&#160;activities&#160;as&#160;processes&#160;and<br/>launches&#160;a&#160;program&#160;called&#160;init.&#160;init,&#160;in&#160;turn,&#160;runs&#160;a&#160;series&#160;of&#160;shell&#160;scripts&#160;(located&#160;in<br/>/etc)&#160;called&#160;<i>init&#160;scripts</i>,&#160;which&#160;start&#160;all&#160;the&#160;system&#160;services.&#160;Many&#160;of&#160;these&#160;services&#160;are<br/>implemented&#160;as&#160;<i>daemon&#160;programs</i>,&#160;programs&#160;that&#160;just&#160;sit&#160;in&#160;the&#160;background&#160;and&#160;do&#160;their<br/>thing&#160;without&#160;having&#160;any&#160;user&#160;interface.&#160;So,&#160;even&#160;if&#160;we&#160;are&#160;not&#160;logged&#160;in,&#160;the&#160;system&#160;is&#160;at<br/>least&#160;a&#160;little&#160;busy performing routine&#160;stuff.<br/>The&#160;fact&#160;that&#160;a&#160;program&#160;can&#160;launch&#160;other&#160;programs&#160;is&#160;expressed&#160;in&#160;the&#160;process&#160;scheme&#160;as<br/>a&#160;<i>parent&#160;process</i>&#160;producing&#160;a&#160;<i>child&#160;process</i>.<br/>
110<br/>
<hr/>
<a name=135></a>How&#160;a&#160;Process&#160;Works<br/>
The&#160;kernel&#160;maintains&#160;information&#160;about&#160;each&#160;process&#160;to&#160;help&#160;keep&#160;things&#160;organized.&#160;For<br/>example,&#160;each&#160;process&#160;is&#160;assigned&#160;a&#160;number&#160;called&#160;a&#160;<i>process&#160;ID</i>&#160;(<i>PID</i>).&#160;PIDs&#160;are&#160;assigned<br/>in&#160;ascending&#160;order,&#160;with&#160;init&#160;always&#160;getting&#160;PID&#160;1.&#160;The&#160;kernel&#160;also&#160;keeps&#160;track&#160;of&#160;the<br/>memory&#160;&#160;assigned&#160;to&#160;each&#160;process,&#160;as&#160;well&#160;as&#160;the&#160;processes'&#160;readiness&#160;to&#160;resume&#160;execu-<br/>tion. Like&#160;files, processes&#160;also have&#160;owners&#160;and user IDs,&#160;effective&#160;user IDs, etc.<br/>
<b>Viewing&#160;Processes<br/></b>The&#160;most&#160;commonly&#160;used&#160;command&#160;to&#160;view&#160;processes&#160;(there&#160;are&#160;several)&#160;is&#160;ps.&#160;The&#160;ps<br/>program&#160;has&#160;a&#160;lot&#160;of options,&#160;but&#160;in its&#160;simplest&#160;form&#160;it&#160;is&#160;used like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ps<br/></b>&#160; PID TTY &#160; &#160; &#160; &#160; &#160;TIME CMD<br/>&#160;5198 pts/1 &#160; &#160;00:00:00 bash<br/>10129 pts/1 &#160; &#160;00:00:00 ps<br/>
The&#160;result&#160;in&#160;this&#160;example&#160;lists&#160;two&#160;processes, process&#160;5198&#160;and&#160;process&#160;10129,&#160;which&#160;are<br/>bash&#160;and&#160;ps&#160;respectively.&#160;As&#160;we&#160;can&#160;see, by&#160;default,&#160;ps&#160;doesn't&#160;show&#160;us&#160;very&#160;much,&#160;just<br/>the&#160;processes&#160;associated&#160;with&#160;the&#160;current&#160;terminal&#160;session.&#160;To&#160;see&#160;more,&#160;we&#160;need&#160;to&#160;add<br/>some&#160;options,&#160;but&#160;before&#160;we&#160;do&#160;that,&#160;let's&#160;look&#160;at&#160;the&#160;other&#160;fields&#160;produced&#160;by&#160;ps.&#160;TTY&#160;is<br/>short&#160;for&#160;“teletype,”&#160;and&#160;refers&#160;to&#160;the&#160;<i>controlling&#160;terminal</i>&#160;for&#160;the&#160;process.&#160;Unix&#160;is&#160;show-<br/>ing&#160;its&#160;age&#160;here.&#160;The&#160;TIME&#160;field&#160;is&#160;the&#160;amount&#160;of&#160;CPU&#160;time&#160;consumed&#160;by&#160;the&#160;process.&#160;As<br/>we&#160;can see, neither&#160;process&#160;makes&#160;the&#160;computer&#160;work very&#160;hard.<br/>If we&#160;add an option,&#160;we&#160;can get&#160;a&#160;bigger&#160;picture&#160;of what&#160;the&#160;system&#160;is&#160;doing.<br/>
[me@linuxbox ~]$&#160;<b>ps x<br/></b>&#160; PID TTY &#160; &#160; &#160;STAT &#160; TIME COMMAND<br/>&#160;2799 ? &#160; &#160; &#160; &#160;Ssl &#160; &#160;0:00 /usr/libexec/bonobo-activation-server –ac<br/>&#160;2820 ? &#160; &#160; &#160; &#160;Sl &#160; &#160; 0:01 /usr/libexec/evolution-data-server-1.10 --<br/>15647 ? &#160; &#160; &#160; &#160;Ss &#160; &#160; 0:00 /bin/sh /usr/bin/startkde<br/>15751 ? &#160; &#160; &#160; &#160;Ss &#160; &#160; 0:00 /usr/bin/ssh-agent /usr/bin/dbus-launch --<br/>15754 ? &#160; &#160; &#160; &#160;S &#160; &#160; &#160;0:00 /usr/bin/dbus-launch --exit-with-session<br/>15755 ? &#160; &#160; &#160; &#160;Ss &#160; &#160; 0:01 /bin/dbus-daemon --fork --print-pid 4 –pr<br/>15774 ? &#160; &#160; &#160; &#160;Ss &#160; &#160; 0:02 /usr/bin/gpg-agent -s –daemon<br/>15793 ? &#160; &#160; &#160; &#160;S &#160; &#160; &#160;0:00 start_kdeinit --new-startup +kcminit_start<br/>15794 ? &#160; &#160; &#160; &#160;Ss &#160; &#160; 0:00 kdeinit Running...<br/>15797 ? &#160; &#160; &#160; &#160;S &#160; &#160; &#160;0:00 dcopserver –nosid<br/>and many more...<br/>
Adding&#160;the&#160;“x”&#160;option&#160;(note&#160;that&#160;there&#160;is&#160;no&#160;leading&#160;dash)&#160;tells&#160;ps&#160;to&#160;show&#160;all&#160;of&#160;our&#160;pro-<br/>
111<br/>
<hr/>
<a name=136></a>10 – Processes<br/>
cesses&#160;regardless&#160;of what&#160;terminal&#160;(if any)&#160;they are&#160;controlled by.&#160;The&#160;presence&#160;of a&#160;“?”&#160;in<br/>the&#160;TTY&#160;column&#160;indicates&#160;no&#160;controlling&#160;terminal.&#160;Using&#160;this&#160;option,&#160;we&#160;see&#160;a&#160;list&#160;of&#160;ev-<br/>ery process&#160;that&#160;we&#160;own.<br/>Since&#160;the&#160;system&#160;is&#160;running&#160;a&#160;lot&#160;of&#160;processes,&#160;ps&#160;produces&#160;a&#160;long&#160;list.&#160;It&#160;is&#160;often&#160;helpful<br/>to&#160;pipe&#160;the&#160;output&#160;from&#160;ps&#160;into&#160;less&#160;for&#160;easier&#160;viewing.&#160;Some&#160;option&#160;combinations&#160;also<br/>produce&#160;long&#160;lines&#160;of&#160;output,&#160;so&#160;maximizing&#160;the&#160;terminal&#160;emulator&#160;window&#160;may&#160;be&#160;a<br/>good idea,&#160;too.<br/>A&#160;new&#160;column&#160;titled&#160;STAT&#160;has&#160;been&#160;added to&#160;the&#160;output.&#160;STAT&#160;is&#160;short&#160;for “state”&#160;and re-<br/>veals&#160;the&#160;current&#160;status&#160;of the&#160;process, as&#160;shown in&#160;Table&#160;10-1.<br/>
<i>Table&#160;10-1: Process&#160;States</i><br/>
<b>State</b><br/>
<b>Meaning</b><br/>
R<br/>
Running.&#160;This&#160;means&#160;that&#160;the&#160;process&#160;is&#160;running or ready&#160;to run.<br/>
S<br/>
Sleeping.&#160;The&#160;process&#160;is&#160;not&#160;running;&#160;rather,&#160;it&#160;is&#160;waiting&#160;for an&#160;<br/>event,&#160;such&#160;as&#160;a&#160;keystroke&#160;or network packet.<br/>
D<br/>
Uninterruptible&#160;sleep.&#160;The&#160;process&#160;is&#160;waiting for I/O&#160;such as&#160;a&#160;disk&#160;<br/>drive.<br/>
T<br/>
Stopped.&#160;The&#160;process&#160;has&#160;been&#160;instructed&#160;to stop. More&#160;on this&#160;later&#160;<br/>in the&#160;chapter.<br/>
Z<br/>
A&#160;defunct&#160;or “zombie”&#160;process.&#160;This&#160;is&#160;a&#160;child process&#160;that&#160;has&#160;<br/>terminated&#160;but&#160;has&#160;not&#160;been&#160;cleaned up by its&#160;parent.<br/>
&lt;<br/>
A&#160;high-priority process. It's&#160;possible&#160;to grant&#160;more&#160;importance&#160;to a&#160;<br/>process, giving it&#160;more&#160;time&#160;on the&#160;CPU.&#160;This&#160;property&#160;of a&#160;process&#160;<br/>is&#160;called&#160;<i>niceness</i>.&#160;A&#160;process&#160;with high&#160;priority&#160;is&#160;said to be&#160;less&#160;<i>nice<br/></i>because&#160;it's&#160;taking more&#160;of the&#160;CPU's&#160;time, which&#160;leaves&#160;less&#160;for&#160;<br/>everybody else.<br/>
N<br/>
A&#160;low-priority&#160;process.&#160;A&#160;process&#160;with low&#160;priority (a&#160;“nice”&#160;<br/>process) will&#160;get&#160;processor time&#160;only after other&#160;processes&#160;with&#160;<br/>higher priority have&#160;been serviced.<br/>
The&#160;process&#160;state&#160;may&#160;be&#160;followed&#160;by&#160;other&#160;characters.&#160;These&#160;indicate&#160;various&#160;exotic<br/>process&#160;characteristics. See&#160;the&#160;ps&#160;man page&#160;for more&#160;detail.<br/>Another&#160;popular&#160;set&#160;of&#160;options&#160;is&#160;“aux”&#160;(without&#160;a&#160;leading&#160;dash).&#160;This&#160;gives&#160;us&#160;even&#160;more<br/>information.<br/>
112<br/>
<hr/>
<a name=137></a>Viewing&#160;Processes<br/>
[me@linuxbox ~]$&#160;<b>ps aux<br/></b>USER &#160; &#160;PID %CPU %MEM &#160; &#160;VSZ &#160; RSS TTY &#160; &#160; &#160;STAT START &#160; TIME COMMAND<br/>root &#160; &#160; &#160;1 &#160;0.0 &#160;0.0 &#160; 2136 &#160; 644 ? &#160; &#160; &#160; &#160;Ss &#160; Mar05 &#160; 0:31 init<br/>root &#160; &#160; &#160;2 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:00 [kt]<br/>root &#160; &#160; &#160;3 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:00 [mi]<br/>root &#160; &#160; &#160;4 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:00 [ks]<br/>root &#160; &#160; &#160;5 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:06 [wa]<br/>root &#160; &#160; &#160;6 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:36 [ev]<br/>root &#160; &#160; &#160;7 &#160;0.0 &#160;0.0 &#160; &#160; &#160;0 &#160; &#160; 0 ? &#160; &#160; &#160; &#160;S&lt; &#160; Mar05 &#160; 0:00 [kh]<br/>and many more...<br/>
This&#160;set&#160;of&#160;options&#160;displays&#160;the&#160;processes&#160;belonging&#160;to&#160;every&#160;user.&#160;Using&#160;the&#160;options<br/>without&#160;the&#160;leading&#160;dash&#160;invokes&#160;the&#160;command&#160;with&#160;“BSD&#160;style”&#160;behavior.&#160;The&#160;Linux<br/>version&#160;of&#160;&#160;ps&#160;&#160;can&#160;emulate&#160;the&#160;behavior&#160;of&#160;the&#160;&#160;ps&#160;&#160;program&#160;found&#160;in&#160;several&#160;different<br/>Unix&#160;implementations.&#160;With&#160;these&#160;options,&#160;we&#160;get&#160;the&#160;additional&#160;columns&#160;shown&#160;in&#160;Table<br/>10-2.<br/>
<i>Table&#160;10-2: BSD&#160;Style&#160;ps&#160;Column Headers</i><br/>
<b>Header</b><br/>
<b>Meaning</b><br/>
USER<br/>
User ID.&#160;This&#160;is&#160;the&#160;owner&#160;of the&#160;process.<br/>
%CPU<br/>
CPU&#160;usage&#160;in&#160;percent.<br/>
%MEM<br/>
Memory&#160;usage&#160;in&#160;percent.<br/>
VSZ<br/>
Virtual&#160;memory size.<br/>
RSS<br/>
Resident&#160;set&#160;size.&#160;This&#160;is&#160;the&#160;amount&#160;of physical&#160;memory&#160;(RAM)&#160;<br/>the&#160;process&#160;is&#160;using in&#160;kilobytes.<br/>
START<br/>
Time&#160;when&#160;the&#160;process&#160;started.&#160;For values&#160;over 24 hours, a&#160;date&#160;is&#160;<br/>used.<br/>
Viewing&#160;Processes&#160;Dynamically&#160;with&#160;top<br/>While&#160;the&#160;ps&#160;command&#160;can&#160;reveal&#160;a&#160;lot&#160;about&#160;what&#160;the&#160;machine&#160;is&#160;doing,&#160;it&#160;provides&#160;only<br/>a&#160;snapshot&#160;of&#160;the&#160;machine's&#160;state&#160;at&#160;the&#160;moment&#160;the&#160;ps&#160;command&#160;is&#160;executed.&#160;To&#160;see&#160;a<br/>more&#160;dynamic&#160;view&#160;of the&#160;machine's&#160;activity, we&#160;use&#160;the&#160;top&#160;command:<br/>
[me@linuxbox ~]$&#160;<b>top</b><br/>
113<br/>
<hr/>
<a name=138></a>10 – Processes<br/>
The&#160;top&#160;program&#160;displays&#160;a&#160;continuously&#160;updating&#160;(by&#160;default,&#160;every&#160;three&#160;seconds)&#160;dis-<br/>play&#160;of&#160;the&#160;system&#160;processes&#160;listed&#160;in&#160;order&#160;of&#160;process&#160;activity.&#160;The&#160;name&#160;<i>top</i>&#160;comes&#160;from<br/>the&#160;fact&#160;that&#160;the&#160;top&#160;program&#160;is&#160;used&#160;to&#160;see&#160;the&#160;“top”&#160;processes&#160;on&#160;the&#160;system.&#160;The&#160;top<br/>display&#160;consists&#160;of&#160;two&#160;parts:&#160;a&#160;system&#160;summary&#160;at&#160;the&#160;top&#160;of&#160;the&#160;display,&#160;followed&#160;by&#160;a<br/>table&#160;of processes&#160;sorted&#160;by CPU&#160;activity:<br/>
top - 14:59:20 up &#160;6:30, &#160;2 users, &#160;load average: 0.07, 0.02, 0.00<br/>Tasks: 109 total, &#160; 1 running, 106 sleeping, &#160; 0 stopped, &#160; 2 zombie<br/>Cpu(s): &#160;0.7%us, &#160;1.0%sy, &#160;0.0%ni, 98.3%id, &#160;0.0%wa, &#160;0.0%hi, &#160;0.0%si<br/>Mem: &#160; &#160;319496k total, &#160; 314860k used, &#160; &#160; 4636k free, &#160; &#160;19392k buff<br/>Swap: &#160; 875500k total, &#160; 149128k used, &#160; 726372k free, &#160; 114676k cach<br/>
&#160; PID USER &#160; &#160; &#160;PR &#160;NI &#160;VIRT &#160;RES &#160;SHR S %CPU %MEM &#160; &#160;TIME+ &#160;COMMAND<br/>&#160;6244 me &#160; &#160; &#160; &#160;39 &#160;19 31752 3124 2188 S &#160;6.3 &#160;1.0 &#160;16:24.42 trackerd<br/>11071 me &#160; &#160; &#160; &#160;20 &#160; 0 &#160;2304 1092 &#160;840 R &#160;1.3 &#160;0.3 &#160; 0:00.14 top<br/>&#160;6180 me &#160; &#160; &#160; &#160;20 &#160; 0 &#160;2700 1100 &#160;772 S &#160;0.7 &#160;0.3 &#160; 0:03.66 dbus-dae<br/>&#160;6321 me &#160; &#160; &#160; &#160;20 &#160; 0 20944 7248 6560 S &#160;0.7 &#160;2.3 &#160; 2:51.38 multiloa<br/>&#160;4955 root &#160; &#160; &#160;20 &#160; 0 &#160;104m 9668 5776 S &#160;0.3 &#160;3.0 &#160; 2:19.39 Xorg<br/>&#160; &#160; 1 root &#160; &#160; &#160;20 &#160; 0 &#160;2976 &#160;528 &#160;476 S &#160;0.0 &#160;0.2 &#160; 0:03.14 init<br/>&#160; &#160; 2 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.00 kthreadd<br/>&#160; &#160; 3 root &#160; &#160; &#160;RT &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.00 migratio<br/>&#160; &#160; 4 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.72 ksoftirq<br/>&#160; &#160; 5 root &#160; &#160; &#160;RT &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.04 watchdog<br/>&#160; &#160; 6 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.42 events/0<br/>&#160; &#160; 7 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.06 khelper<br/>&#160; &#160;41 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:01.08 kblockd/<br/>&#160; &#160;67 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:00.00 kseriod<br/>&#160; 114 root &#160; &#160; &#160;20 &#160; 0 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:01.62 pdflush<br/>&#160; 116 root &#160; &#160; &#160;15 &#160;-5 &#160; &#160; 0 &#160; &#160;0 &#160; &#160;0 S &#160;0.0 &#160;0.0 &#160; 0:02.44 kswapd0<br/>
The&#160;system&#160;summary contains&#160;a&#160;lot&#160;of good stuff. Here's&#160;a&#160;rundown:<br/>
<i>Table&#160;10-3:&#160;top&#160;Information&#160;Fields</i><br/>
<b>Row</b><br/>
<b>Field</b><br/>
<b>Meaning</b><br/>
1<br/>
top<br/>
The&#160;name&#160;of the&#160;program.<br/>
14:59:20<br/>
The&#160;current&#160;time&#160;of day.<br/>
up 6:30<br/>
This&#160;is&#160;called&#160;<i>uptime</i>. It&#160;is&#160;the&#160;amount&#160;of time&#160;<br/>since&#160;the&#160;machine&#160;was&#160;last&#160;booted. In this&#160;<br/>example, the&#160;system&#160;has&#160;been up for six-and-a-<br/>half hours.<br/>
114<br/>
<hr/>
<a name=139></a>Viewing&#160;Processes<br/>
2 users<br/>
There&#160;are&#160;two users&#160;logged in.<br/>
load average:<br/>
<i>Load average</i>&#160;refers&#160;to the&#160;number of processes<br/>that&#160;are&#160;waiting to run, that&#160;is, the&#160;number&#160;of&#160;<br/>processes&#160;that&#160;are&#160;in a&#160;runnable&#160;state&#160;and are&#160;<br/>sharing the&#160;CPU.&#160;Three&#160;values&#160;are&#160;shown, each<br/>for a&#160;different&#160;period&#160;of time.&#160;The&#160;first&#160;is&#160;the&#160;<br/>average&#160;for the&#160;last&#160;60 seconds, the&#160;next&#160;the&#160;<br/>previous&#160;5 minutes, and finally the&#160;previous&#160;15<br/>minutes.&#160;Values&#160;less&#160;than&#160;1.0 indicate&#160;that&#160;the&#160;<br/>machine&#160;is&#160;not&#160;busy.<br/>
2<br/>
Tasks:<br/>
This&#160;summarizes&#160;the&#160;number of processes&#160;and&#160;<br/>their&#160;various&#160;process&#160;states.<br/>
3<br/>
Cpu(s):<br/>
This&#160;row&#160;describes&#160;the&#160;character of the&#160;<br/>activities&#160;that&#160;the&#160;CPU&#160;is&#160;performing.<br/>
0.7%us<br/>
0.7 percent&#160;of the&#160;CPU&#160;is&#160;being used for&#160;<i>user&#160;<br/>processes</i>.&#160;This&#160;means&#160;processes&#160;outside&#160;the&#160;<br/>kernel.<br/>
1.0%sy<br/>
1.0 percent&#160;of the&#160;CPU&#160;is&#160;being used for&#160;<br/><i>system</i>&#160;(kernel)&#160;processes.<br/>
0.0%ni<br/>
0.0 percent&#160;of the&#160;CPU&#160;is&#160;being used by “nice”&#160;<br/>(low-priority)&#160;processes.<br/>
98.3%id<br/>
98.3 percent&#160;of the&#160;CPU&#160;is&#160;idle.<br/>
0.0%wa<br/>
0.0 percent&#160;of the&#160;CPU&#160;is&#160;waiting&#160;for I/O.<br/>
4<br/>
Mem:<br/>
This&#160;shows&#160;how&#160;physical&#160;RAM&#160;is&#160;being&#160;used.<br/>
5<br/>
Swap:<br/>
This&#160;shows&#160;how&#160;swap space&#160;(virtual&#160;memory)&#160;<br/>is&#160;being used.<br/>
The&#160;top&#160;program&#160;accepts&#160;a&#160;number&#160;of keyboard commands.&#160;The&#160;two most&#160;interesting are<br/>h, which displays&#160;the&#160;program's&#160;help screen,&#160;and&#160;q, which quits&#160;top.<br/>Both&#160;major&#160;desktop&#160;environments&#160;provide&#160;graphical&#160;applications&#160;that&#160;display&#160;information<br/>similar&#160;to&#160;top&#160;(in&#160;much&#160;the&#160;same&#160;way&#160;that&#160;Task Manager&#160;in&#160;Windows&#160;works), but&#160;top&#160;is<br/>better&#160;than&#160;the&#160;graphical&#160;versions&#160;because&#160;it&#160;is&#160;faster&#160;and&#160;it&#160;consumes&#160;far&#160;fewer&#160;system&#160;re-<br/>sources.&#160;After&#160;all,&#160;our&#160;system&#160;monitor&#160;program&#160;shouldn't&#160;be&#160;the&#160;source&#160;of&#160;the&#160;system<br/>slowdown that&#160;we&#160;are&#160;trying to track.<br/>
115<br/>
<hr/>
<a name=140></a><img src="linux-command-line-140_1.png"/><br/>
10 – Processes<br/>
<b>Controlling&#160;Processes<br/></b>Now&#160;that&#160;we&#160;can&#160;see&#160;and&#160;monitor&#160;processes,&#160;let's&#160;gain&#160;some&#160;control&#160;over&#160;them.&#160;For&#160;our<br/>experiments,&#160;we're&#160;going&#160;to&#160;use&#160;a&#160;little&#160;program&#160;called&#160;&#160;xlogo&#160;&#160;as&#160;our&#160;guinea&#160;pig.&#160;The<br/>xlogo&#160;program&#160;is&#160;a&#160;sample&#160;program&#160;supplied&#160;with&#160;the&#160;X&#160;Window&#160;System&#160;(the&#160;underly-<br/>ing&#160;engine&#160;that&#160;makes&#160;the&#160;graphics&#160;on&#160;our&#160;display&#160;go),&#160;which&#160;simply&#160;displays&#160;a&#160;re-sizable<br/>window&#160;containing&#160;the&#160;X&#160;logo.&#160;First,&#160;we'll&#160;get&#160;to&#160;know&#160;our test&#160;subject.<br/>
[me@linuxbox ~]$&#160;<b>xlogo</b><br/>
After&#160;entering&#160;the&#160;command,&#160;a&#160;small&#160;window&#160;containing&#160;the&#160;logo&#160;should&#160;appear&#160;some-<br/>where&#160;on&#160;the&#160;screen.&#160;On&#160;some&#160;systems,&#160;xlogo&#160;may&#160;print&#160;a&#160;warning&#160;message,&#160;but&#160;it&#160;may<br/>be&#160;safely&#160;ignored.<br/>
<b>Tip:</b>&#160;If&#160;your&#160;system&#160;does&#160;not&#160;include&#160;the&#160;xlogo&#160;program,&#160;try&#160;using&#160;gedit&#160;or<br/>kwrite&#160;instead.<br/>
We&#160;can&#160;verify&#160;that&#160;xlogo&#160;is&#160;running&#160;by&#160;resizing&#160;its&#160;window.&#160;If&#160;the&#160;logo&#160;is&#160;redrawn&#160;in&#160;the<br/>new&#160;size, the&#160;program&#160;is&#160;running.<br/>Notice&#160;how&#160;our&#160;shell&#160;prompt&#160;has&#160;not&#160;returned?&#160;This&#160;is&#160;because&#160;the&#160;shell&#160;is&#160;waiting&#160;for&#160;the<br/>program&#160;to&#160;finish,&#160;just&#160;like&#160;all&#160;the&#160;other&#160;programs&#160;we&#160;have&#160;used&#160;so&#160;far.&#160;If&#160;we&#160;close&#160;the<br/>xlogo&#160;window, the&#160;prompt&#160;returns.<br/>
<i>Figure&#160;4: The&#160;xlogo&#160;program</i><br/>
Interrupting&#160;a&#160;Process<br/>Let's&#160;observe&#160;what&#160;happens&#160;when&#160;we&#160;run&#160;xlogo&#160;again.&#160;First,&#160;enter&#160;the&#160;xlogo&#160;command<br/>
116<br/>
<hr/>
<a name=141></a>Controlling&#160;Processes<br/>
and&#160;verify&#160;that&#160;the&#160;program&#160;is&#160;running.&#160;Next,&#160;return&#160;to&#160;the&#160;terminal&#160;window&#160;and&#160;press<br/>Ctrl-c.<br/>
[me@linuxbox ~]$&#160;<b>xlogo<br/></b>[me@linuxbox ~]$<br/>
In&#160;a&#160;terminal,&#160;pressing&#160;Ctrl-c,&#160;<i>interrupts</i>&#160;a&#160;program.&#160;This&#160;means&#160;we&#160;are&#160;politely&#160;asking<br/>the&#160;program&#160;to&#160;terminate.&#160;After&#160;we&#160;pressed&#160;Ctrl-c,&#160;the&#160;xlogo&#160;window&#160;closed&#160;and&#160;the<br/>shell&#160;prompt&#160;returned.<br/>Many (but&#160;not&#160;all) command-line&#160;programs&#160;can be&#160;interrupted&#160;by using this&#160;technique.&#160;<br/>
Putting&#160;a&#160;Process&#160;in&#160;the&#160;Background<br/>Let's&#160;say&#160;we&#160;wanted&#160;to&#160;get&#160;the&#160;shell&#160;prompt&#160;back&#160;without&#160;terminating&#160;the&#160;&#160;xlogo&#160;&#160;pro-<br/>gram.&#160;We&#160;can&#160;do&#160;this&#160;by&#160;placing&#160;the&#160;program&#160;in&#160;the&#160;<i>background</i>.&#160;Think&#160;of&#160;the&#160;terminal&#160;as<br/>having&#160;a&#160;<i>foreground</i>&#160;(with&#160;stuff&#160;visible&#160;on&#160;the&#160;surface&#160;like&#160;the&#160;shell&#160;prompt)&#160;and&#160;a&#160;back-<br/>ground&#160;(with&#160;stuff&#160;hidden&#160;behind&#160;the&#160;surface).&#160;To&#160;launch&#160;a&#160;program&#160;so&#160;that&#160;it&#160;is&#160;immedi-<br/>ately&#160;placed&#160;in&#160;the&#160;background,&#160;we&#160;follow&#160;the&#160;command&#160;with&#160;an&#160;ampersand&#160;(&amp;)&#160;charac-<br/>ter.<br/>
[me@linuxbox ~]$&#160;<b>xlogo &amp;<br/></b>[1] 28236<br/>[me@linuxbox ~]$<br/>
After&#160;entering&#160;the&#160;command,&#160;the&#160;xlogo&#160;window&#160;appeared&#160;and&#160;the&#160;shell&#160;prompt&#160;returned,<br/>but&#160;some&#160;funny&#160;numbers&#160;were&#160;printed&#160;too.&#160;This&#160;message&#160;is&#160;part&#160;of&#160;a&#160;shell&#160;feature&#160;called<br/><i>job&#160;control</i>.&#160;With&#160;this&#160;message,&#160;the&#160;shell&#160;is&#160;telling&#160;us&#160;that&#160;we&#160;have&#160;started&#160;job&#160;number&#160;1<br/>([1]) and that&#160;it&#160;has&#160;PID&#160;28236. If we&#160;run&#160;ps, we&#160;can see&#160;our process.<br/>
[me@linuxbox ~]$&#160;<b>ps<br/></b>&#160;PID TTY &#160; &#160; &#160; &#160; &#160;TIME CMD<br/>10603 pts/1 &#160; &#160;00:00:00 bash<br/>28236 pts/1 &#160; &#160;00:00:00 xlogo<br/>28239 pts/1 &#160; &#160;00:00:00 ps<br/>
The&#160;shell's&#160;job&#160;control&#160;facility&#160;also&#160;gives&#160;us&#160;a&#160;way&#160;to&#160;list&#160;the&#160;jobs&#160;that&#160;have&#160;been&#160;launched<br/>from&#160;our terminal.&#160;Using&#160;the&#160;jobs&#160;command, we&#160;can&#160;see&#160;this&#160;list:<br/>
117<br/>
<hr/>
<a name=142></a>10 – Processes<br/>
[me@linuxbox ~]$&#160;<b>jobs<br/></b>[1]+ &#160;Running &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; xlogo &amp;<br/>
The&#160;results&#160;show&#160;that&#160;we&#160;have&#160;one&#160;job,&#160;numbered&#160;1,&#160;that&#160;it&#160;is&#160;running,&#160;and&#160;that&#160;the&#160;com-<br/>mand was&#160;xlogo &amp;.<br/>
Returning&#160;a&#160;Process&#160;to&#160;the&#160;Foreground<br/>A&#160;process&#160;in&#160;the&#160;background&#160;is&#160;immune&#160;from&#160;terminal&#160;keyboard&#160;input,&#160;including&#160;any&#160;at-<br/>tempt&#160;to&#160;interrupt&#160;it&#160;with&#160;&#160;Ctrl-c.&#160;To&#160;return&#160;a&#160;process&#160;to&#160;the&#160;foreground,&#160;use&#160;the&#160;&#160;fg<br/>command&#160;in this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>jobs<br/></b>[1]+ &#160;Running &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; xlogo &amp;<br/>[me@linuxbox ~]$&#160;<b>fg %1<br/></b>xlogo<br/>
The&#160;fg&#160;command&#160;followed&#160;by&#160;a&#160;percent&#160;sign&#160;and&#160;the&#160;job&#160;number&#160;(called&#160;a&#160;<i>jobspec</i>)&#160;does<br/>the&#160;trick.&#160;If&#160;we&#160;only&#160;have&#160;one&#160;background&#160;job,&#160;the&#160;jobspec&#160;is&#160;optional.&#160;To&#160;terminate&#160;xl-<br/>ogo, press&#160;Ctrl-c.<br/>
Stopping&#160;(Pausing)&#160;a&#160;Process<br/>Sometimes&#160;we'll&#160;want&#160;to&#160;stop&#160;a&#160;process&#160;without&#160;terminating&#160;it.&#160;This&#160;is&#160;often&#160;done&#160;to&#160;allow<br/>a&#160;foreground&#160;process&#160;to&#160;be&#160;moved&#160;to&#160;the&#160;background.&#160;To&#160;stop&#160;a&#160;foreground&#160;process&#160;and<br/>place&#160;it&#160;in&#160;the&#160;background,&#160;press&#160;Ctrl-z.&#160;Let's&#160;try&#160;it.&#160;At&#160;the&#160;command&#160;prompt,&#160;type&#160;xl-<br/>ogo, press&#160;the&#160;Enter&#160;key, and then press&#160;Ctrl-z:<br/>
[me@linuxbox ~]$&#160;<b>xlogo<br/></b>[1]+ &#160;Stopped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; xlogo<br/>[me@linuxbox ~]$<br/>
After&#160;stopping&#160;xlogo,&#160;we&#160;can&#160;verify&#160;that&#160;the&#160;program&#160;has&#160;stopped&#160;by&#160;attempting&#160;to&#160;re-<br/>size&#160;the&#160;xlogo&#160;window.&#160;We&#160;will&#160;see&#160;that&#160;it&#160;appears&#160;quite&#160;dead.&#160;We&#160;can&#160;either&#160;continue<br/>the&#160;program's&#160;execution&#160;in&#160;the&#160;foreground,&#160;using&#160;the&#160;&#160;fg&#160;command,&#160;or&#160;resume&#160;the&#160;pro-<br/>gram's&#160;execution in the&#160;background with&#160;the&#160;bg&#160;command:<br/>
[me@linuxbox ~]$&#160;<b>bg %1</b><br/>
118<br/>
<hr/>
<a name=143></a>Controlling&#160;Processes<br/>
[1]+ xlogo &amp;<br/>[me@linuxbox ~]$<br/>
As&#160;with the&#160;fg&#160;command, the&#160;jobspec&#160;is&#160;optional&#160;if there&#160;is&#160;only one&#160;job.<br/>Moving&#160;a&#160;process&#160;from&#160;the&#160;foreground&#160;to&#160;the&#160;background&#160;is&#160;handy&#160;if&#160;we&#160;launch&#160;a&#160;graphi-<br/>cal&#160;program&#160;from&#160;the&#160;command&#160;line,&#160;but&#160;forget&#160;to&#160;place&#160;it&#160;in&#160;the&#160;background&#160;by&#160;append-<br/>ing the&#160;trailing&#160;&amp;.<br/>Why&#160;would&#160;we&#160;want&#160;to&#160;launch&#160;a&#160;graphical&#160;program&#160;from&#160;the&#160;command&#160;line?&#160;There&#160;are<br/>two reasons.<br/>
•<br/>
The&#160;program&#160;we&#160;want&#160;to&#160;run&#160;might&#160;not&#160;be&#160;listed&#160;on&#160;the&#160;window&#160;manager's&#160;menus<br/>(such&#160;as&#160;xlogo).<br/>
•<br/>
By&#160;launching&#160;a&#160;program&#160;from&#160;the&#160;command&#160;line,&#160;we&#160;might&#160;be&#160;able&#160;to&#160;see&#160;error<br/>messages&#160;that&#160;would&#160;otherwise&#160;be&#160;invisible&#160;if&#160;the&#160;program&#160;were&#160;launched&#160;graphi-<br/>cally. Sometimes, a&#160;program&#160;will&#160;fail&#160;to start&#160;up when&#160;launched&#160;from&#160;the&#160;graphical<br/>menu.&#160;By&#160;launching&#160;it&#160;from&#160;the&#160;command&#160;line&#160;instead,&#160;we&#160;may&#160;see&#160;an&#160;error&#160;mes-<br/>sage&#160;that&#160;will&#160;reveal&#160;the&#160;problem.&#160;Also,&#160;some&#160;graphical&#160;programs&#160;have&#160;interesting<br/>and useful&#160;command line&#160;options.&#160;<br/>
<b>Signals<br/></b>The&#160;&#160;kill&#160;&#160;command&#160;&#160;is&#160;used&#160;to&#160;“kill”&#160;processes.&#160;This&#160;allows&#160;us&#160;to&#160;terminate&#160;programs<br/>that&#160;need killing&#160;(that&#160;is, some&#160;kind of pausing or termination). Here's&#160;an example:<br/>
[me@linuxbox ~]$ xlogo &amp;<br/>[1] 28401<br/>[me@linuxbox ~]$ kill 28401<br/>[1]+ &#160;Terminated &#160; &#160; &#160; &#160; &#160; &#160; &#160;xlogo<br/>
We&#160;first&#160;launch&#160;xlogo&#160;in&#160;the&#160;background.&#160;The&#160;shell&#160;prints&#160;the&#160;jobspec&#160;and&#160;the&#160;PID&#160;of&#160;the<br/>background&#160;process. Next,&#160;we&#160;use&#160;the&#160;kill&#160;command&#160;and&#160;specify&#160;the&#160;PID&#160;of the&#160;process<br/>we&#160;want&#160;to&#160;terminate.&#160;We&#160;could&#160;have&#160;also&#160;specified&#160;the&#160;process&#160;using&#160;a&#160;jobspec&#160;(for&#160;ex-<br/>ample,&#160;%1) instead&#160;of a&#160;PID.<br/>While&#160;this&#160;is&#160;all&#160;very&#160;straightforward,&#160;there&#160;is&#160;more&#160;to&#160;it&#160;than&#160;that.&#160;The&#160;kill&#160;command<br/>doesn't&#160;exactly&#160;“kill”&#160;processes:&#160;rather&#160;it&#160;sends&#160;them&#160;<i>signals</i>.&#160;Signals&#160;are&#160;one&#160;of&#160;several<br/>ways&#160;that&#160;the&#160;operating&#160;system&#160;communicates&#160;with&#160;programs.&#160;We&#160;have&#160;already&#160;seen&#160;sig-<br/>nals&#160;in&#160;action&#160;with&#160;the&#160;use&#160;of&#160;Ctrl-c&#160;and&#160;Ctrl-z.&#160;When&#160;the&#160;terminal&#160;receives&#160;one&#160;of<br/>these&#160;keystrokes, it&#160;sends&#160;a&#160;signal&#160;to the&#160;program&#160;in the&#160;foreground.&#160;In&#160;the&#160;case&#160;of&#160;Ctrl-<br/>c,&#160;a&#160;signal&#160;called&#160;INT&#160;(interrupt)&#160;is&#160;sent;&#160;with&#160;Ctrl-z,&#160;a&#160;signal&#160;called&#160;TSTP&#160;(terminal<br/>
119<br/>
<hr/>
<a name=144></a>10 – Processes<br/>
stop)&#160;is&#160;sent.&#160;Programs,&#160;in&#160;turn,&#160;“listen”&#160;for&#160;signals&#160;and&#160;may&#160;act&#160;upon&#160;them&#160;as&#160;they&#160;are&#160;re-<br/>ceived.&#160;The&#160;fact&#160;that&#160;a&#160;program&#160;can&#160;listen&#160;and&#160;act&#160;upon&#160;signals&#160;allows&#160;a&#160;program&#160;to&#160;do<br/>things&#160;such as&#160;save&#160;work in progress&#160;when&#160;it&#160;is&#160;sent&#160;a&#160;termination&#160;signal.<br/>
Sending&#160;Signals&#160;to&#160;Processes&#160;with&#160;kill<br/>The&#160;kill&#160;command&#160;is&#160;used&#160;to&#160;send&#160;signals&#160;to&#160;programs.&#160;Its&#160;most&#160;common&#160;syntax&#160;looks<br/>like&#160;this:<br/>
<b>kill [-<i>signal</i></b><b>] PID...</b><br/>
If&#160;no&#160;signal&#160;is&#160;specified&#160;on&#160;the&#160;command&#160;line,&#160;then&#160;the&#160;TERM&#160;(terminate)&#160;signal&#160;is&#160;sent&#160;by<br/>default.&#160;The&#160;kill&#160;command is&#160;most&#160;often used to&#160;send the&#160;following&#160;signals:<br/>
<i>Table&#160;10-4: Common Signals</i><br/>
<b>Number</b><br/>
<b>Name</b><br/>
<b>Meaning</b><br/>
1<br/>
HUP<br/>
Hangup.&#160;This&#160;is&#160;a&#160;vestige&#160;of the&#160;good old days&#160;<br/>when&#160;terminals&#160;were&#160;attached to remote&#160;<br/>computers&#160;with phone&#160;lines&#160;and modems.&#160;The&#160;<br/>signal&#160;is&#160;used to&#160;indicate&#160;to&#160;programs&#160;that&#160;the&#160;<br/>controlling terminal&#160;has&#160;“hung up.”&#160;The&#160;effect&#160;of&#160;<br/>this&#160;signal&#160;can be&#160;demonstrated&#160;by closing a&#160;<br/>terminal&#160;session.&#160;The&#160;foreground program&#160;<br/>running on the&#160;terminal&#160;will&#160;be&#160;sent&#160;the&#160;signal&#160;and<br/>will&#160;terminate.<br/>
This&#160;signal&#160;is&#160;also used by many&#160;daemon&#160;<br/>programs&#160;to&#160;cause&#160;a&#160;reinitialization.&#160;This&#160;means&#160;<br/>that&#160;when&#160;a&#160;daemon&#160;is&#160;sent&#160;this&#160;signal,&#160;it&#160;will&#160;<br/>restart&#160;and reread&#160;its&#160;configuration file.&#160;The&#160;<br/>Apache&#160;web server&#160;is&#160;an&#160;example&#160;of a&#160;daemon&#160;<br/>that&#160;uses&#160;the&#160;HUP&#160;signal&#160;in&#160;this&#160;way.<br/>
2<br/>
INT<br/>
Interrupt.&#160;This&#160;performs&#160;the&#160;same&#160;function as&#160;a&#160;<br/>Ctrl-c&#160;sent&#160;from&#160;the&#160;terminal.&#160;It&#160;will&#160;usually&#160;<br/>terminate&#160;a&#160;program.<br/>
9<br/>
KILL<br/>
Kill.&#160;This&#160;signal&#160;is&#160;special.&#160;Whereas&#160;programs&#160;<br/>may choose&#160;to handle&#160;signals&#160;sent&#160;to&#160;them&#160;in&#160;<br/>different&#160;ways, including&#160;ignoring them&#160;all&#160;<br/>together, the&#160;KILL&#160;signal&#160;is&#160;never&#160;actually&#160;sent&#160;to<br/>
120<br/>
<hr/>
<a name=145></a>Signals<br/>
the&#160;target&#160;program.&#160;Rather,&#160;the&#160;kernel&#160;<br/>immediately&#160;terminates&#160;the&#160;process.&#160;When a&#160;<br/>process&#160;is&#160;terminated&#160;in this&#160;manner, it&#160;is&#160;given&#160;no<br/>opportunity&#160;to “clean up”&#160;after&#160;itself or save&#160;its&#160;<br/>work. For this&#160;reason, the&#160;KILL&#160;signal&#160;should be&#160;<br/>used&#160;only as&#160;a&#160;last&#160;resort&#160;when other&#160;termination&#160;<br/>signals&#160;fail.<br/>
15<br/>
TERM<br/>
Terminate.&#160;This&#160;is&#160;the&#160;default&#160;signal&#160;sent&#160;by the&#160;<br/>kill&#160;command.&#160;If a&#160;program&#160;is&#160;still&#160;“alive”&#160;<br/>enough to receive&#160;signals, it&#160;will&#160;terminate.<br/>
18<br/>
CONT<br/>
Continue.&#160;This&#160;will&#160;restore&#160;a&#160;process&#160;after&#160;a&#160;STOP<br/>or&#160;TSTP&#160;signal.&#160;This&#160;signal&#160;is&#160;sent&#160;by the&#160;bg&#160;and&#160;<br/>fg&#160;commands.<br/>
19<br/>
STOP<br/>
Stop.&#160;This&#160;signal&#160;causes&#160;a&#160;process&#160;to pause&#160;<br/>without&#160;terminating.&#160;Like&#160;the&#160;KILL&#160;signal,&#160;it&#160;is&#160;<br/>not&#160;sent&#160;to&#160;the&#160;target&#160;process, and thus&#160;it&#160;cannot&#160;be<br/>ignored.<br/>
20<br/>
TSTP<br/>
Terminal&#160;stop.&#160;This&#160;is&#160;the&#160;signal&#160;sent&#160;by the&#160;<br/>terminal&#160;when&#160;Ctrl-z&#160;is&#160;pressed.&#160;Unlike&#160;the&#160;<br/>STOP&#160;signal, the&#160;TSTP&#160;signal&#160;is&#160;received&#160;by the&#160;<br/>program, but&#160;the&#160;program&#160;may choose&#160;to ignore&#160;it.<br/>
&#160;<br/>Let's&#160;try out&#160;the&#160;kill&#160;command:<br/>
[me@linuxbox ~]$&#160;<b>xlogo &amp;<br/></b>[1] 13546<br/>[me@linuxbox ~]$&#160;<b>kill -1 13546<br/></b>[1]+ &#160;Hangup &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;xlogo<br/>
In&#160;this&#160;example,&#160;we&#160;start&#160;the&#160;xlogo&#160;program&#160;in&#160;the&#160;background&#160;and&#160;then&#160;send&#160;it&#160;a&#160;HUP<br/>signal&#160;with&#160;kill.&#160;The&#160;xlogo&#160;program&#160;terminates,&#160;and&#160;the&#160;shell&#160;indicates&#160;that&#160;the&#160;back-<br/>ground&#160;process&#160;has&#160;received&#160;a&#160;hangup&#160;signal.&#160;We&#160;may&#160;need&#160;to&#160;press&#160;the&#160;&#160;Enter&#160;&#160;key&#160;a<br/>couple&#160;of&#160;times&#160;before&#160;the&#160;message&#160;appears.&#160;Note&#160;that&#160;signals&#160;may&#160;be&#160;specified&#160;either&#160;by<br/>number or by name, including the&#160;name&#160;prefixed&#160;with the&#160;letters&#160;SIG.<br/>
[me@linuxbox ~]$&#160;<b>xlogo &amp;</b><br/>
121<br/>
<hr/>
<a name=146></a>10 – Processes<br/>
[1] 13601<br/>[me@linuxbox ~]$&#160;<b>kill -INT 13601<br/></b>[1]+ &#160;Interrupt &#160; &#160; &#160; &#160; &#160; &#160; &#160; xlogo<br/>[me@linuxbox ~]$&#160;<b>xlogo &amp;<br/></b>[1] 13608<br/>[me@linuxbox ~]$&#160;<b>kill -SIGINT 13608<br/></b>[1]+ &#160;Interrupt &#160; &#160; &#160; &#160; &#160; &#160; &#160; xlogo<br/>
Repeat&#160;the&#160;example&#160;above&#160;and&#160;try&#160;the&#160;other&#160;signals.&#160;Remember,&#160;we&#160;can&#160;also&#160;use&#160;jobspecs<br/>in place&#160;of PIDs.<br/>Processes,&#160;like&#160;files,&#160;have&#160;owners,&#160;and&#160;you&#160;must&#160;be&#160;the&#160;owner&#160;of&#160;a&#160;process&#160;(or&#160;the&#160;supe-<br/>ruser)&#160;to send it&#160;signals&#160;with&#160;kill.<br/>In&#160;addition&#160;to&#160;the&#160;list&#160;of&#160;signals&#160;above,&#160;which&#160;are&#160;most&#160;often&#160;used&#160;with&#160;kill,&#160;there&#160;are<br/>other signals&#160;frequently&#160;used&#160;by the&#160;system&#160;as&#160;listed in&#160;Table&#160;10-5.<br/>
<i>Table&#160;10-5: Other&#160;Common Signals</i><br/>
<b>Number</b><br/>
<b>Name</b><br/>
<b>Meaning</b><br/>
3<br/>
QUIT<br/>
Quit.<br/>
11<br/>
SEGV<br/>
Segmentation&#160;violation.&#160;This&#160;signal&#160;is&#160;sent&#160;if&#160;a&#160;<br/>program&#160;makes&#160;illegal&#160;use&#160;of memory,&#160;that&#160;is, if it<br/>tried&#160;to write&#160;somewhere&#160;it&#160;was&#160;not&#160;allowed to&#160;<br/>write.<br/>
28<br/>
WINCH<br/>
Window&#160;change.&#160;This&#160;is&#160;the&#160;signal&#160;sent&#160;by the&#160;<br/>system&#160;when a&#160;window&#160;changes&#160;size.&#160;Some&#160;<br/>programs&#160;, such as&#160;top&#160;and&#160;less&#160;will&#160;respond to<br/>this&#160;signal&#160;by redrawing themselves&#160;to&#160;fit&#160;the&#160;new&#160;<br/>window&#160;dimensions.<br/>
For the&#160;curious, a&#160;complete&#160;list&#160;of signals&#160;can&#160;be&#160;displayed&#160;with the&#160;following command:<br/>
[me@linuxbox ~]$ kill -l<br/>
Sending&#160;Signals&#160;to&#160;Multiple&#160;Processes&#160;with&#160;killall<br/>It's&#160;also&#160;possible&#160;to&#160;send&#160;signals&#160;to&#160;multiple&#160;processes&#160;matching&#160;a&#160;specified&#160;program&#160;or<br/>username&#160;by using&#160;the&#160;killall&#160;command. Here&#160;is&#160;the&#160;syntax:<br/>
122<br/>
<hr/>
<a name=147></a>Signals<br/>
<b>killall [-u&#160;<i>user</i></b><b>] [-<i>signal</i></b><b>]&#160;<i>name</i></b><b>...</b><br/>
To&#160;demonstrate,&#160;we&#160;will&#160;start&#160;a&#160;couple&#160;of&#160;instances&#160;of&#160;the&#160;xlogo&#160;program&#160;and&#160;then&#160;ter-<br/>minate&#160;them.<br/>
[me@linuxbox ~]$&#160;<b>xlogo &amp;<br/></b>[1] 18801<br/>[me@linuxbox ~]$&#160;<b>xlogo &amp;<br/></b>[2] 18802<br/>[me@linuxbox ~]$&#160;<b>killall xlogo<br/></b>[1]- &#160;Terminated &#160; &#160; &#160; &#160; &#160; &#160; &#160;xlogo<br/>[2]+ &#160;Terminated &#160; &#160; &#160; &#160; &#160; &#160; &#160;xlogo<br/>
Remember,&#160;as&#160;with&#160;kill,&#160;we&#160;must&#160;have&#160;superuser&#160;privileges&#160;to&#160;send&#160;signals&#160;to&#160;processes<br/>that&#160;do not&#160;belong&#160;to us.<br/>
<b>Shutting&#160;Down&#160;the&#160;System<br/></b>The&#160;process&#160;of&#160;shutting&#160;down&#160;the&#160;system&#160;involves&#160;the&#160;orderly&#160;termination&#160;of&#160;all&#160;the&#160;pro-<br/>cesses&#160;on&#160;the&#160;system,&#160;as&#160;well&#160;as&#160;performing&#160;some&#160;vital&#160;housekeeping&#160;chores&#160;(such&#160;as<br/>syncing&#160;all&#160;of&#160;the&#160;mounted&#160;file&#160;systems)&#160;before&#160;the&#160;system&#160;powers&#160;off.&#160;There&#160;are&#160;four<br/>commands&#160;that&#160;can&#160;perform&#160;this&#160;function.&#160;They&#160;are&#160;&#160;halt,&#160;&#160;poweroff,&#160;&#160;reboot,&#160;and<br/>shutdown.&#160;The&#160;first&#160;three&#160;are&#160;pretty&#160;self-explanatory and&#160;are&#160;generally&#160;used&#160;without&#160;any<br/>command&#160;line&#160;options. Here’s&#160;an&#160;example:<br/>
[me@linuxbox ~]$&#160;<b>sudo reboot</b><br/>
The&#160;shutdown&#160;command&#160;is&#160;a&#160;bit&#160;more&#160;interesting.&#160;With&#160;it,&#160;we&#160;can&#160;specify&#160;which&#160;of&#160;the<br/>actions&#160;to&#160;perform&#160;(halt,&#160;power&#160;down,&#160;or&#160;reboot)&#160;and&#160;provide&#160;a&#160;time&#160;delay&#160;to&#160;the&#160;shut-<br/>down event. Most&#160;often&#160;it&#160;is&#160;used like&#160;this&#160;to&#160;halt&#160;the&#160;system:<br/>
[me@linuxbox ~]$&#160;<b>sudo shutdown -h now</b><br/>
or like&#160;this&#160;to reboot&#160;the&#160;system:<br/>
[me@linuxbox ~]$&#160;<b>sudo shutdown -r now</b><br/>
123<br/>
<hr/>
<a name=148></a>10 – Processes<br/>
The&#160;delay&#160;can&#160;be&#160;specified&#160;in a&#160;variety&#160;of ways. See&#160;the&#160;shutdown&#160;man&#160;page&#160;for details.<br/>Once&#160;the&#160;&#160;shutdown&#160;&#160;command&#160;is&#160;executed,&#160;a&#160;message&#160;is&#160;“broadcast”&#160;to&#160;all&#160;logged-in<br/>users&#160;warning&#160;them&#160;of the&#160;impending event.<br/>
<b>More&#160;Process-Related&#160;Commands<br/></b>Since&#160;monitoring&#160;processes&#160;is&#160;an&#160;important&#160;system&#160;administration&#160;task,&#160;there&#160;are&#160;a&#160;lot&#160;of<br/>commands&#160;for it.&#160;Table&#160;10-6 lists&#160;some&#160;to&#160;play with:<br/>
<i>Table&#160;10-6: Other&#160;Process&#160;Related Commands</i><br/>
<b>Command</b><br/>
<b>Description</b><br/>
pstree<br/>
Outputs&#160;a&#160;process&#160;list&#160;arranged in&#160;a&#160;tree-like&#160;pattern&#160;showing the&#160;<br/>parent-child&#160;relationships&#160;between processes.<br/>
vmstat<br/>
Outputs&#160;a&#160;snapshot&#160;of system&#160;resource&#160;usage&#160;including, memory,&#160;<br/>swap, and&#160;disk I/O.&#160;To see&#160;a&#160;continuous&#160;display, follow&#160;the&#160;<br/>command&#160;with a&#160;time&#160;delay&#160;(in seconds) for updates. Here’s&#160;an&#160;<br/>example:&#160;vmstat 5.&#160;Terminate&#160;the&#160;output&#160;with&#160;Ctrl-c.<br/>
xload<br/>
A&#160;graphical&#160;program&#160;that&#160;draws&#160;a&#160;graph showing system&#160;load over&#160;<br/>time.<br/>
tload<br/>
Similar to the&#160;xload&#160;program&#160;but&#160;draws&#160;the&#160;graph&#160;in the&#160;terminal.&#160;<br/>Terminate&#160;the&#160;output&#160;with&#160;Ctrl-c.<br/>
<b>Summing&#160;Up<br/></b>Most&#160;modern&#160;systems&#160;feature&#160;a&#160;mechanism&#160;for&#160;managing&#160;multiple&#160;processes.&#160;Linux&#160;pro-<br/>vides&#160;a&#160;rich&#160;set&#160;of&#160;tools&#160;for&#160;this&#160;purpose.&#160;Given&#160;that&#160;Linux&#160;is&#160;the&#160;world's&#160;most&#160;deployed<br/>server&#160;operating&#160;system,&#160;this&#160;makes&#160;a&#160;lot&#160;of&#160;sense.&#160;However,&#160;unlike&#160;some&#160;other&#160;systems,<br/>Linux&#160;relies&#160;primarily&#160;on&#160;command&#160;line&#160;tools&#160;for&#160;process&#160;management.&#160;Though&#160;there&#160;are<br/>graphical&#160;process&#160;tools&#160;for Linux, the&#160;command&#160;line&#160;tools&#160;are&#160;greatly&#160;preferred because&#160;of<br/>their&#160;speed&#160;and&#160;light&#160;footprint.&#160;While&#160;the&#160;GUI&#160;tools&#160;may&#160;look&#160;pretty,&#160;they&#160;often&#160;create&#160;a<br/>lot&#160;of system&#160;load themselves, which&#160;somewhat&#160;defeats&#160;the&#160;purpose.<br/>
124<br/>
<hr/>
<a name=149></a><hr/>
<a name=150></a>10 – Processes<br/>
126<br/>
<hr/>
<a name=151></a>Part&#160;2 – Configuration&#160;and the&#160;Environment<br/>
Part&#160;2&#160;–&#160;Configuration&#160;and&#160;the<br/>
Environment<br/>
127<br/>
<hr/>
<a name=152></a>11 –&#160;The&#160;Environment<br/>
<i><b>11&#160;–&#160;The&#160;Environment</b></i><br/>
As&#160;we&#160;discussed&#160;earlier,&#160;the&#160;shell&#160;maintains&#160;a&#160;body&#160;of&#160;information&#160;during&#160;our&#160;shell&#160;ses-<br/>sion&#160;called&#160;the&#160;&#160;<i>environment</i>.&#160;Programs&#160;use&#160;data&#160;stored&#160;in&#160;the&#160;environment&#160;to&#160;determine<br/>facts&#160;about&#160;the&#160;system's&#160;configuration.&#160;While&#160;most&#160;programs&#160;use&#160;&#160;<i>configuration&#160;files</i>&#160;&#160;to<br/>store&#160;program&#160;settings,&#160;some&#160;programs&#160;also&#160;look&#160;for&#160;values&#160;stored&#160;in&#160;the&#160;environment&#160;to<br/>adjust&#160;their&#160;behavior.&#160;Knowing&#160;this,&#160;we&#160;can&#160;use&#160;the&#160;environment&#160;to&#160;customize&#160;our&#160;shell<br/>experience.<br/>In this&#160;chapter, we&#160;will&#160;work with the&#160;following commands:<br/>
●<br/>
printenv&#160;– Print&#160;part&#160;or all&#160;of the&#160;environment<br/>
●<br/>
set&#160;– Set&#160;shell&#160;options<br/>
●<br/>
export&#160;– Export&#160;environment&#160;to subsequently&#160;executed programs<br/>
●<br/>
alias&#160;– Create&#160;an alias&#160;for a&#160;command<br/>
<b>What&#160;is&#160;Stored&#160;in&#160;the&#160;Environment?<br/></b>The&#160;shell&#160;stores&#160;two&#160;basic&#160;types&#160;of&#160;data&#160;in&#160;the&#160;environment;&#160;though,&#160;with&#160;&#160;bash,&#160;&#160;the<br/>types&#160;are&#160;largely&#160;indistinguishable.&#160;They&#160;are&#160;<i>environment&#160;variables</i>&#160;and&#160;&#160;<i>shell&#160;variables</i>.<br/>Shell&#160;variables&#160;are&#160;bits&#160;of&#160;data&#160;placed&#160;there&#160;by&#160;bash,&#160;and&#160;environment&#160;variables&#160;are&#160;ev-<br/>erything&#160;else.&#160;In&#160;addition&#160;to&#160;variables,&#160;the&#160;shell&#160;stores&#160;some&#160;programmatic&#160;data,&#160;namely<br/><i>aliases</i>&#160;and&#160;<i>shell&#160;functions</i>.&#160;We&#160;covered&#160;aliases&#160;in&#160;Chapter&#160;5,&#160;“Working&#160;with&#160;Commands.”<br/>and we&#160;will&#160;cover shell&#160;functions&#160;(which&#160;are&#160;related to&#160;shell&#160;scripting) &#160;in&#160;Part&#160;4.<br/>
Examining&#160;The&#160;Environment<br/>To&#160;see&#160;what&#160;is&#160;stored&#160;in&#160;the&#160;environment,&#160;we&#160;can&#160;use&#160;either&#160;the&#160;set&#160;builtin&#160;in&#160;bash&#160;or<br/>the&#160;printenv&#160;program.&#160;The&#160;set&#160;command&#160;will&#160;show&#160;both&#160;the&#160;shell&#160;and&#160;environment<br/>variables,&#160;while&#160;&#160;printenv&#160;&#160;will&#160;only&#160;display&#160;the&#160;latter.&#160;Since&#160;the&#160;list&#160;of&#160;environment<br/>contents&#160;will&#160;be&#160;fairly long,&#160;it&#160;is&#160;best&#160;to pipe&#160;the&#160;output&#160;of either command into&#160;less.<br/>
[me@linuxbox ~]$&#160;<b>printenv | less</b><br/>
128<br/>
<hr/>
<a name=153></a>What&#160;is&#160;Stored in&#160;the&#160;Environment?<br/>
Doing&#160;so, we&#160;should get&#160;that&#160;looks&#160;like&#160;this:<br/>
USER=me<br/>PAGER=less&#160;<br/>LSCOLORS=Gxfxcxdxbxegedabagacad&#160;<br/>XDG_CONFIG_DIRS=/etc/xdg/xdg-ubuntu:/usr/share/upstart/xdg:/etc/xdg&#160;<br/>PATH=/home/me/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/<br/>sbin:/bin:/usr/games:/usr/local/games&#160;<br/>DESKTOP_SESSION=ubuntu&#160;<br/>QT_IM_MODULE=ibus&#160;<br/>QT_QPA_PLATFORMTHEME=appmenu-qt5&#160;<br/>JOB=dbus&#160;<br/>PWD=/home/me<br/><a href="mailto:XMODIFIERS%3D@im">XMODIFIERS=@im</a>=ibus&#160;<br/>GNOME_KEYRING_PID=1850&#160;<br/>LANG=en_US.UTF-8&#160;<br/>GDM_LANG=en_US&#160;<br/>MANDATORY_PATH=/usr/share/gconf/ubuntu.mandatory.path<br/>&#160;MASTER_HOST=linuxbox<br/>IM_CONFIG_PHASE=1&#160;<br/>COMPIZ_CONFIG_PROFILE=ubuntu&#160;<br/>GDMSESSION=ubuntu&#160;<br/>SESSIONTYPE=gnome-session&#160;<br/>XDG_SEAT=seat0&#160;<br/>HOME=/home/me&#160;<br/>SHLVL=2&#160;<br/>LANGUAGE=en_US&#160;<br/>GNOME_DESKTOP_SESSION_ID=this-is-deprecated&#160;<br/>LESS=-R&#160;<br/>LOGNAME=me&#160;<br/>COMPIZ_BIN_PATH=/usr/bin/&#160;<br/>LC_CTYPE=en_US.UTF-8&#160;<br/>XDG_DATA_DIRS=/usr/share/ubuntu:/usr/share/gnome:/usr/local/share/:/<br/>usr/share/&#160;<br/>QT4_IM_MODULE=xim&#160;<br/>DBUS_SESSION_BUS_ADDRESS=unix:abstract=/tmp/dbus-IwaesmWaT0&#160;<br/>LESSOPEN=| /usr/bin/lesspipe %s&#160;<br/>INSTANCE=<br/>
What&#160;we&#160;see&#160;is&#160;a&#160;list&#160;of&#160;environment&#160;variables&#160;and&#160;their&#160;values.&#160;For&#160;example,&#160;we&#160;see&#160;a<br/>variable&#160;called&#160;USER,&#160;which&#160;contains&#160;the&#160;value&#160;me.&#160;The&#160;printenv&#160;command&#160;can&#160;also<br/>list&#160;the&#160;value&#160;of a&#160;specific&#160;variable.<br/>
129<br/>
<hr/>
<a name=154></a>11 –&#160;The&#160;Environment<br/>
[me@linuxbox ~]$&#160;<b>printenv USER<br/></b>me<br/>
The&#160;set&#160;command,&#160;when&#160;used&#160;without&#160;options&#160;or&#160;arguments,&#160;will&#160;display&#160;both&#160;the&#160;shell<br/>and&#160;environment&#160;variables,&#160;as&#160;well&#160;as&#160;any&#160;defined&#160;shell&#160;functions.&#160;Unlike&#160;printenv,&#160;its<br/>output&#160;is&#160;courteously sorted&#160;in alphabetical&#160;order.<br/>
[me@linuxbox ~]$&#160;<b>set | less</b><br/>
It&#160;is&#160;also possible&#160;to view&#160;the&#160;contents&#160;of a&#160;variable&#160;using the&#160;echo&#160;command, like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>echo $HOME<br/></b>/home/me<br/>
One&#160;element&#160;of&#160;the&#160;environment&#160;that&#160;neither&#160;set&#160;nor&#160;printenv&#160;displays&#160;is&#160;aliases.&#160;To<br/>see&#160;them,&#160;enter&#160;the&#160;alias&#160;command&#160;without&#160;arguments.<br/>
[me@linuxbox ~]$&#160;<b>alias<br/></b>alias l.='ls -d .* --color=tty'<br/>alias ll='ls -l --color=tty'<br/>alias ls='ls --color=tty'<br/>alias vi='vim'<br/>alias which='alias | /usr/bin/which --tty-only --read-alias --show-<br/>dot --show-tilde'<br/>
Some&#160;Interesting&#160;Variables<br/>The&#160;environment&#160;contains&#160;quite&#160;a&#160;few&#160;variables,&#160;and&#160;though&#160;the&#160;environment&#160;will&#160;differ<br/>from&#160;the&#160;one&#160;presented&#160;here,&#160;we&#160;will&#160;likely&#160;see&#160;the&#160;variables&#160;listed&#160;in&#160;Table&#160;11-1&#160;in&#160;our<br/>environment.<br/>
<i>Table&#160;11-1: Environment&#160;Variables</i><br/>
<b>Variable</b><br/>
<b>Contents</b><br/>
DISPLAY<br/>
The&#160;name&#160;of the&#160;display if&#160;we&#160;are&#160;running a&#160;graphical&#160;environment.&#160;<br/>Usually this&#160;is&#160;“:0”, meaning the&#160;first&#160;display&#160;generated by the&#160;X&#160;<br/>server.<br/>
130<br/>
<hr/>
<a name=155></a>What&#160;is&#160;Stored in&#160;the&#160;Environment?<br/>
EDITOR<br/>
The&#160;name&#160;of the&#160;program&#160;to&#160;be&#160;used for text&#160;editing.<br/>
SHELL<br/>
The&#160;name&#160;of the&#160;user’s&#160;default&#160;shell&#160;program.<br/>
HOME<br/>
The&#160;pathname&#160;of your&#160;home&#160;directory.<br/>
LANG<br/>
Defines&#160;the&#160;character set&#160;and&#160;collation&#160;order&#160;of your language.<br/>
OLDPWD<br/>
The&#160;previous&#160;working&#160;directory.<br/>
PAGER<br/>
The&#160;name&#160;of the&#160;program&#160;to&#160;be&#160;used for paging output.&#160;This&#160;is&#160;often<br/>set&#160;to&#160;/usr/bin/less.<br/>
PATH<br/>
A&#160;colon-separated list&#160;of directories&#160;that&#160;are&#160;searched&#160;when we&#160;enter<br/>the&#160;name&#160;of a&#160;executable&#160;program.<br/>
PS1<br/>
This&#160;stands&#160;for “prompt&#160;string 1.”&#160;This&#160;defines&#160;the&#160;contents&#160;of the<br/>shell&#160;prompt.&#160;As&#160;we&#160;will&#160;later&#160;see,&#160;this&#160;can&#160;be&#160;extensively&#160;<br/>customized.<br/>
PWD<br/>
The&#160;current&#160;working directory.<br/>
TERM<br/>
The&#160;name&#160;of your terminal&#160;type.&#160;Unix-like&#160;systems&#160;support&#160;many&#160;<br/>terminal&#160;protocols;&#160;this&#160;variable&#160;sets&#160;the&#160;protocol&#160;to be&#160;used with&#160;<br/>your terminal&#160;emulator.&#160;<br/>
TZ<br/>
Specifies&#160;your time&#160;zone. Most&#160;Unix-like&#160;systems&#160;maintain&#160;the&#160;<br/>computer’s&#160;internal&#160;clock&#160;in&#160;<i>Coordinated Universal&#160;Time</i>&#160;(UTC)&#160;<br/>and then&#160;display the&#160;local&#160;time&#160;by applying an offset&#160;specified&#160;by&#160;<br/>this&#160;variable.<br/>
USER<br/>
Your username.<br/>
Don't&#160;worry if some&#160;of these&#160;values&#160;are&#160;missing.&#160;They&#160;vary by distribution.<br/>
<b>How&#160;Is&#160;The&#160;Environment&#160;Established?<br/></b>When&#160;we&#160;log&#160;on&#160;to&#160;the&#160;system,&#160;the&#160;bash&#160;program&#160;starts,&#160;and&#160;reads&#160;a&#160;series&#160;of&#160;configura-<br/>tion&#160;scripts&#160;called&#160;<i>startup&#160;files</i>,&#160;which&#160;define&#160;the&#160;default&#160;environment&#160;shared&#160;by&#160;all&#160;users.<br/>This&#160;is&#160;followed&#160;by more&#160;startup&#160;files&#160;in&#160;our home&#160;directory&#160;that&#160;define&#160;our personal&#160;envi-<br/>ronment.&#160;The&#160;exact&#160;sequence&#160;depends&#160;on the&#160;type&#160;of&#160;shell&#160;session&#160;being&#160;started.&#160;There&#160;are<br/>two kinds.<br/>
•<br/>
<b>A&#160;login&#160;shell&#160;session</b>&#160;A&#160;login&#160;shell&#160;session&#160;is&#160;one&#160;in&#160;which&#160;we&#160;are&#160;prompted&#160;for<br/>our username&#160;and password.&#160;This&#160;happens&#160;when we&#160;start&#160;a&#160;virtual&#160;console&#160;session,<br/>for example.<br/>
•<br/>
<b>A&#160;non-login&#160;shell&#160;session</b>&#160;&#160;A&#160;non-login&#160;shell&#160;session&#160;typically&#160;occurs&#160;when&#160;we<br/>
131<br/>
<hr/>
<a name=156></a>11 –&#160;The&#160;Environment<br/>
launch&#160;a&#160;terminal&#160;session in&#160;the&#160;GUI.<br/>
Login shells&#160;read one&#160;or more&#160;startup&#160;files&#160;as&#160;shown in&#160;Table&#160;11-2.<br/>
<i>Table&#160;11-2: Startup&#160;Files&#160;for&#160;Login&#160;Shell&#160;Sessions</i><br/>
<b>File</b><br/>
<b>Contents</b><br/>
/etc/profile<br/>
A&#160;global&#160;configuration script&#160;that&#160;applies&#160;to all&#160;users.<br/>
~/.bash_profile<br/>
A&#160;user's&#160;personal&#160;startup file.&#160;This&#160;can&#160;be&#160;used to extend&#160;<br/>or override&#160;settings&#160;in&#160;the&#160;global&#160;configuration&#160;script.<br/>
~/.bash_login<br/>
If&#160;~/.bash_profile&#160;is&#160;not&#160;found,&#160;bash&#160;attempts&#160;to<br/>read this&#160;script.<br/>
~/.profile<br/>
If neither&#160;~/.bash_profile&#160;nor&#160;~/.bash_login<br/>is&#160;found,&#160;bash&#160;attempts&#160;to&#160;read this&#160;file.&#160;This&#160;is&#160;the&#160;<br/>default&#160;in Debian-based distributions, such as&#160;Ubuntu.<br/>
Non-login shell&#160;sessions&#160;read the&#160;startup&#160;files&#160;listed in&#160;Table&#160;11-3.<br/>
<i>Table&#160;11-3: Startup&#160;Files&#160;for&#160;Non-Login&#160;Shell&#160;Sessions</i><br/>
<b>File</b><br/>
<b>Contents</b><br/>
/etc/bash.bashrc<br/>
A&#160;global&#160;configuration script&#160;that&#160;applies&#160;to all&#160;users.<br/>
~/.bashrc<br/>
A&#160;user's&#160;personal&#160;startup file.&#160;It&#160;can&#160;be&#160;used to extend or&#160;<br/>override&#160;settings&#160;in&#160;the&#160;global&#160;configuration&#160;script.<br/>
In&#160;addition&#160;to&#160;reading&#160;the&#160;startup&#160;files&#160;in&#160;Table&#160;11-3,&#160;non-login&#160;shells&#160;inherit&#160;the&#160;environ-<br/>ment&#160;from&#160;their&#160;parent&#160;process, usually a&#160;login shell.<br/>Take&#160;a&#160;look&#160;and&#160;see&#160;which&#160;of&#160;these&#160;startup&#160;files&#160;are&#160;installed.&#160;Remember — since&#160;most&#160;of<br/>the&#160;filenames&#160;listed&#160;above&#160;start&#160;with&#160;a&#160;period&#160;(meaning&#160;that&#160;they&#160;are&#160;hidden),&#160;we&#160;will<br/>need to&#160;use&#160;the&#160;“-a”&#160;option&#160;when using&#160;ls.<br/>The&#160;~/.bashrc&#160;file&#160;is&#160;probably&#160;the&#160;most&#160;important&#160;startup&#160;file&#160;from&#160;the&#160;ordinary&#160;user’s<br/>point&#160;of&#160;view,&#160;since&#160;it&#160;is&#160;almost&#160;always&#160;read.&#160;Non-login&#160;shells&#160;read&#160;it&#160;by&#160;default&#160;and&#160;most<br/>startup&#160;files&#160;for&#160;login&#160;shells&#160;are&#160;written&#160;in&#160;such&#160;a&#160;way&#160;as&#160;to&#160;read&#160;the&#160;~/.bashrc&#160;file&#160;as<br/>well.<br/>
What's&#160;in&#160;a&#160;Startup&#160;File?<br/>If&#160;we&#160;take&#160;a&#160;look&#160;inside&#160;a&#160;typical&#160;.bash_profile&#160;(taken&#160;from&#160;a&#160;CentOS&#160;6&#160;system),&#160;it<br/>
132<br/>
<hr/>
<a name=157></a>How&#160;Is&#160;The&#160;Environment&#160;Established?<br/>
looks&#160;something&#160;like&#160;this:<br/>
# .bash_profile<br/>
# Get the aliases and functions<br/>if [ -f ~/.bashrc ]; then<br/>&#160; &#160; &#160; &#160; . ~/.bashrc<br/>fi<br/>
# User specific environment and startup programs<br/>
PATH=$PATH:$HOME/bin<br/>export PATH<br/>
Lines&#160;that&#160;begin&#160;with&#160;a&#160;“#”&#160;are&#160;<i>comments</i>&#160;and&#160;are&#160;not&#160;read&#160;by&#160;the&#160;shell.&#160;These&#160;are&#160;there<br/>for&#160;human&#160;readability.&#160;The&#160;first&#160;interesting&#160;thing&#160;occurs&#160;on&#160;the&#160;fourth&#160;line,&#160;with&#160;the&#160;fol-<br/>lowing code:<br/>
if [ -f ~/.bashrc ]; then<br/>&#160; &#160; &#160; &#160; . ~/.bashrc<br/>fi<br/>
This&#160;is&#160;called&#160;an&#160;<i>if&#160;compound&#160;command</i>,&#160;which&#160;we&#160;will&#160;cover&#160;fully&#160;when&#160;we&#160;get&#160;to&#160;shell<br/>scripting&#160;in Part&#160;4, but&#160;for now, here&#160;is&#160;a&#160;translation:<br/>
If the file &#34;~/.bashrc&#34; exists, then<br/>
read the &#34;~/.bashrc&#34; file.<br/>
We&#160;can&#160;see&#160;that&#160;this&#160;bit&#160;of&#160;code&#160;is&#160;how&#160;a&#160;login&#160;shell&#160;gets&#160;the&#160;contents&#160;of&#160;.bashrc.&#160;The<br/>next&#160;thing in our startup&#160;file&#160;has&#160;to do with the&#160;PATH&#160;variable.<br/>Ever&#160;wonder&#160;how&#160;the&#160;shell&#160;knows&#160;where&#160;to&#160;find&#160;commands&#160;when&#160;we&#160;enter&#160;them&#160;on&#160;the<br/>command&#160;line?&#160;For&#160;example,&#160;when&#160;we&#160;enter&#160;ls,&#160;the&#160;shell&#160;does&#160;not&#160;search&#160;the&#160;entire&#160;com-<br/>puter&#160;to&#160;find&#160;/bin/ls&#160;(the&#160;full&#160;pathname&#160;of&#160;the&#160;ls&#160;command);&#160;rather,&#160;it&#160;searches&#160;a&#160;list<br/>of directories&#160;that&#160;are&#160;contained in the&#160;PATH&#160;variable.<br/>The&#160;PATH&#160;variable&#160;is&#160;often&#160;(but&#160;not&#160;always,&#160;depending&#160;on&#160;the&#160;distribution)&#160;set&#160;by&#160;the&#160;/<br/>etc/profile&#160;startup file&#160;with&#160;this&#160;code:<br/>
133<br/>
<hr/>
<a name=158></a>11 –&#160;The&#160;Environment<br/>
PATH=$PATH:$HOME/bin<br/>
PATH&#160;is&#160;modified&#160;to&#160;add&#160;the&#160;directory&#160;$HOME/bin&#160;to&#160;the&#160;end&#160;of&#160;the&#160;list.&#160;This&#160;is&#160;an&#160;ex-<br/>ample&#160;of&#160;parameter&#160;expansion,&#160;which&#160;we&#160;touched&#160;on&#160;in&#160;Chapter&#160;7.&#160;“Seeing&#160;the&#160;World&#160;As<br/>tthe&#160;Shell&#160;Sees&#160;It.”&#160;To demonstrate&#160;how&#160;this&#160;works, try&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;This is some &#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>This is some<br/>[me@linuxbox ~]$&#160;<b>foo=$foo&#34;text.&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>This is some text.<br/>
Using this&#160;technique, we&#160;can&#160;append text&#160;to the&#160;end of a&#160;variable's&#160;contents.<br/>By&#160;adding&#160;the&#160;string&#160;$HOME/bin&#160;to&#160;the&#160;end&#160;of&#160;the&#160;PATH&#160;variable's&#160;contents,&#160;the&#160;direc-<br/>tory&#160;$HOME/bin&#160;is&#160;added&#160;to&#160;the&#160;list&#160;of&#160;directories&#160;searched&#160;when&#160;a&#160;command&#160;is&#160;entered.<br/>This&#160;means&#160;that&#160;when&#160;we&#160;want&#160;to&#160;create&#160;a&#160;directory&#160;within&#160;our&#160;home&#160;directory&#160;for&#160;storing<br/>our&#160;own&#160;private&#160;programs,&#160;the&#160;shell&#160;is&#160;ready&#160;to&#160;accommodate&#160;us.&#160;All&#160;we&#160;have&#160;to&#160;do&#160;is&#160;call<br/>it&#160;bin, and&#160;we’re&#160;ready to&#160;go.<br/>
<b>Note</b>:&#160;Many distributions&#160;provide&#160;this&#160;PATH&#160;setting&#160;by default.&#160;Debian based&#160;dis-<br/>tributions,&#160;such&#160;as&#160;Ubuntu,&#160;test&#160;for&#160;the&#160;existence&#160;of&#160;the&#160;~/bin&#160;directory&#160;at&#160;login<br/>and&#160;dynamically&#160;add it&#160;to the&#160;PATH&#160;variable&#160;if the&#160;directory&#160;is&#160;found.<br/>
Lastly,&#160;we&#160;have:<br/>
export PATH<br/>
The&#160;export&#160;command&#160;tells&#160;the&#160;shell&#160;to&#160;make&#160;the&#160;contents&#160;of&#160;PATH&#160;available&#160;to&#160;child<br/>processes&#160;of this&#160;shell.<br/>
<b>Modifying&#160;the&#160;Environment<br/></b>Since&#160;we&#160;know&#160;where&#160;the&#160;startup&#160;files&#160;are&#160;and&#160;what&#160;they&#160;contain,&#160;we&#160;can&#160;modify&#160;them&#160;to<br/>customize&#160;our environment.<br/>
134<br/>
<hr/>
<a name=159></a>Modifying the&#160;Environment<br/>
Which&#160;Files&#160;Should&#160;We&#160;Modify?<br/>As&#160;a&#160;general&#160;rule,&#160;to&#160;add&#160;directories&#160;to&#160;your&#160;PATH&#160;or&#160;define&#160;additional&#160;environment&#160;vari-<br/>ables,&#160;place&#160;those&#160;changes&#160;in&#160;&#160;.bash_profile&#160;&#160;(or&#160;the&#160;equivalent,&#160;according&#160;to&#160;your<br/>distribution;&#160;&#160;&#160;for&#160;&#160;&#160;example,&#160;&#160;&#160;Ubuntu&#160;&#160;&#160;uses&#160;&#160;.profile).&#160;&#160;&#160;For&#160;&#160;&#160;everything&#160;&#160;&#160;else,&#160;&#160;&#160;place&#160;&#160;&#160;the<br/>changes&#160;in&#160;.bashrc.&#160;<br/>
<b>Note:</b>&#160;Unless&#160;you&#160;are&#160;the&#160;system&#160;administrator&#160;and&#160;need&#160;to&#160;change&#160;the&#160;defaults<br/>for&#160;all&#160;users&#160;of&#160;the&#160;system,&#160;restrict&#160;your&#160;modifications&#160;to&#160;the&#160;files&#160;in&#160;your&#160;home<br/>directory.&#160;It&#160;is&#160;certainly&#160;possible&#160;to&#160;change&#160;the&#160;files&#160;in&#160;/etc&#160;such&#160;as&#160;profile,<br/>and&#160;in many cases&#160;it&#160;would be&#160;sensible&#160;to do so, but&#160;for now, let's&#160;play&#160;it&#160;safe.<br/>
Text&#160;Editors<br/>To&#160;edit&#160;(i.e.,&#160;modify)&#160;the&#160;shell's&#160;startup&#160;files,&#160;as&#160;well&#160;as&#160;most&#160;of&#160;the&#160;other&#160;configuration<br/>files&#160;on&#160;the&#160;system,&#160;we&#160;use&#160;a&#160;program&#160;called&#160;a&#160;<i>text&#160;editor</i>.&#160;A&#160;text&#160;editor&#160;is&#160;a&#160;program&#160;that<br/>is,&#160;in&#160;some&#160;ways,&#160;like&#160;a&#160;word&#160;processor&#160;in&#160;that&#160;it&#160;allows&#160;us&#160;to&#160;edit&#160;the&#160;words&#160;on&#160;the&#160;screen<br/>with&#160;a&#160;moving&#160;cursor.&#160;It&#160;differs&#160;from&#160;a&#160;word&#160;processor&#160;by&#160;only&#160;supporting&#160;pure&#160;text&#160;and<br/>often&#160;contains&#160;features&#160;designed&#160;for&#160;writing&#160;programs.&#160;Text&#160;editors&#160;are&#160;the&#160;central&#160;tool<br/>used&#160;by&#160;software&#160;developers&#160;to&#160;write&#160;code&#160;and&#160;by&#160;system&#160;administrators&#160;to&#160;manage&#160;the<br/>configuration files&#160;that&#160;control&#160;the&#160;system.<br/>A&#160;lot&#160;of&#160;different&#160;text&#160;editors&#160;are&#160;available&#160;for&#160;Linux;&#160;most&#160;systems&#160;have&#160;several&#160;installed.<br/>Why&#160;so&#160;many&#160;different&#160;ones?&#160;Because&#160;programmers&#160;like&#160;writing&#160;them&#160;and&#160;since&#160;pro-<br/>grammers&#160;use&#160;them&#160;extensively,&#160;they&#160;write&#160;editors&#160;to&#160;express&#160;their&#160;own&#160;desires&#160;as&#160;to&#160;how<br/>they should work.<br/>Text&#160;editors&#160;fall&#160;into&#160;two&#160;basic&#160;categories:&#160;graphical&#160;and&#160;text&#160;based.&#160;GNOME&#160;and&#160;KDE<br/>both include&#160;some&#160;popular graphical&#160;editors. GNOME&#160;ships&#160;with an editor called&#160;gedit,<br/>which&#160;is&#160;usually&#160;called&#160;“Text&#160;Editor”&#160;in&#160;the&#160;GNOME&#160;menu.&#160;KDE&#160;usually&#160;ships&#160;with<br/>three,&#160;which&#160;are&#160;(in&#160;order of increasing complexity)&#160;kedit,&#160;kwrite, and&#160;kate.<br/>There&#160;are&#160;many&#160;text-based&#160;editors.&#160;The&#160;popular&#160;ones&#160;we'll&#160;encounter&#160;are&#160;nano,&#160;vi,&#160;and<br/>emacs.&#160;The&#160;nano&#160;editor&#160;is&#160;a&#160;simple,&#160;easy-to-use&#160;editor&#160;designed&#160;as&#160;a&#160;replacement&#160;for<br/>the&#160;pico&#160;editor&#160;supplied&#160;with&#160;the&#160;PINE&#160;email&#160;suite.&#160;The&#160;vi&#160;editor&#160;(which&#160;on&#160;most&#160;Linux<br/>systems&#160;replaced&#160;by&#160;a&#160;program&#160;named&#160;vim,&#160;which&#160;is&#160;short&#160;for&#160;“vi&#160;improved”)&#160;is&#160;the&#160;tra-<br/>ditional&#160;editor&#160;for&#160;Unix-like&#160;systems.&#160;It&#160;will&#160;be&#160;the&#160;subject&#160;of&#160;our&#160;next&#160;chapter.&#160;The<br/>emacs&#160;&#160;editor&#160;was&#160;originally&#160;written&#160;by&#160;&#160;Richard&#160;Stallman.&#160;It&#160;is&#160;a&#160;gigantic,&#160;all-purpose,<br/>does-everything&#160;programming environment.&#160;While&#160;readily&#160;available,&#160;it&#160;is&#160;seldom&#160;installed<br/>on most&#160;Linux&#160;systems&#160;by default.<br/>
135<br/>
<hr/>
<a name=160></a>11 –&#160;The&#160;Environment<br/>
Using&#160;a&#160;Text&#160;Editor<br/>Text&#160;editors&#160;can&#160;be&#160;invoked&#160;from&#160;the&#160;command&#160;line&#160;by&#160;typing&#160;the&#160;name&#160;of&#160;the&#160;editor&#160;fol-<br/>lowed&#160;by&#160;the&#160;name&#160;of&#160;the&#160;file&#160;we&#160;want&#160;to&#160;edit.&#160;If&#160;the&#160;file&#160;does&#160;not&#160;already&#160;exist,&#160;the&#160;editor<br/>will&#160;assume&#160;that&#160;we&#160;want&#160;to create&#160;a&#160;new&#160;file. Here&#160;is&#160;an example&#160;using&#160;gedit:<br/>
[me@linuxbox ~]$&#160;<b>gedit some_file</b><br/>
This&#160;command&#160;will&#160;start&#160;the&#160;gedit&#160;text&#160;editor&#160;and&#160;load&#160;the&#160;file&#160;named&#160;“some_file”,&#160;if&#160;it<br/>exists.<br/>Graphical&#160;text&#160;editors&#160;are&#160;pretty&#160;self-explanatory,&#160;so&#160;we&#160;won't&#160;cover&#160;them&#160;here.&#160;Instead,<br/>we&#160;will&#160;concentrate&#160;on&#160;our&#160;first&#160;text-based&#160;text&#160;editor,&#160;nano.&#160;Let's&#160;fire&#160;up&#160;nano&#160;and&#160;edit<br/>the&#160;.bashrc&#160;file.&#160;But&#160;before&#160;we&#160;do&#160;that,&#160;let's&#160;practice&#160;some&#160;“safe&#160;computing.”&#160;When-<br/>ever&#160;we&#160;edit&#160;an&#160;important&#160;configuration&#160;file,&#160;it&#160;is&#160;always&#160;a&#160;good&#160;idea&#160;to&#160;create&#160;a&#160;backup<br/>copy&#160;of&#160;the&#160;file&#160;first.&#160;This&#160;protects&#160;us&#160;in&#160;case&#160;we&#160;mess&#160;up&#160;the&#160;file&#160;while&#160;editing.&#160;To&#160;create<br/>a&#160;backup&#160;of the&#160;.bashrc&#160;file, do this:<br/>
[me@linuxbox ~]$ cp .bashrc .bashrc.bak<br/>
It&#160;doesn't&#160;matter&#160;what&#160;we&#160;call&#160;the&#160;backup&#160;file;&#160;just&#160;pick&#160;an&#160;understandable&#160;name.&#160;The&#160;ex-<br/>tensions&#160;“.bak”,&#160;“.sav”,&#160;“.old”,&#160;and&#160;“.orig”&#160;are&#160;all&#160;popular&#160;ways&#160;of&#160;indicating&#160;a&#160;backup<br/>file.&#160;Oh, and&#160;remember that&#160;cp&#160;will&#160;<i>overwrite&#160;existing files</i>&#160;silently.<br/>Now&#160;that&#160;we&#160;have&#160;a&#160;backup file, we'll&#160;start&#160;the&#160;editor.<br/>
[me@linuxbox ~]$&#160;<b>nano .bashrc</b><br/>
Once&#160;nano&#160;starts, we’ll&#160;get&#160;a&#160;screen&#160;like&#160;this:<br/>
&#160; GNU nano 2.0.3 &#160; &#160; &#160; &#160; &#160; File: .bashrc<br/>
# .bashrc<br/>
# Source global definitions<br/>if [ -f /etc/bashrc ]; then<br/>&#160; &#160; &#160; &#160; . /etc/bashrc<br/>fi<br/>
136<br/>
<hr/>
<a name=161></a>Modifying the&#160;Environment<br/>
# User specific aliases and functions<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; [ Read 8 lines ]<br/>^G&#160;Get Help^O&#160;WriteOut^R&#160;Read Fil^Y&#160;Prev Pag^K&#160;Cut Text^C&#160;Cur Pos<br/>^X&#160;Exit &#160; &#160;^J&#160;Justify&#160;^W&#160;Where Is^V&#160;Next Pag^U&#160;UnCut Te^T&#160;To Spell<br/>
<b>Note:</b>&#160;If&#160;your&#160;system&#160;does&#160;not&#160;have&#160;nano&#160;installed,&#160;you&#160;may&#160;use&#160;a&#160;graphical&#160;edi-<br/>tor&#160;instead.<br/>
The&#160;screen&#160;consists&#160;of&#160;a&#160;header&#160;at&#160;the&#160;top,&#160;the&#160;text&#160;of&#160;the&#160;file&#160;being&#160;edited&#160;in&#160;the&#160;middle,<br/>and a&#160;menu&#160;of commands&#160;at&#160;the&#160;bottom.&#160;Since&#160;nano&#160;was&#160;designed to&#160;replace&#160;the&#160;text&#160;edi-<br/>tor supplied&#160;with an email&#160;client, it&#160;is&#160;rather&#160;short&#160;on editing features.<br/>The&#160;first&#160;command&#160;we&#160;should&#160;learn&#160;in&#160;any&#160;text&#160;editor&#160;is&#160;how&#160;to&#160;exit&#160;the&#160;program.&#160;In&#160;the<br/>case&#160;of&#160;nano,&#160;we&#160;press&#160;Ctrl-x&#160;to&#160;exit.&#160;This&#160;is&#160;indicated&#160;in&#160;the&#160;menu&#160;at&#160;the&#160;bottom&#160;of<br/>the&#160;screen.&#160;The&#160;notation&#160;^X&#160;means&#160;Ctrl-x.&#160;This&#160;is&#160;a&#160;common&#160;notation&#160;for&#160;control&#160;char-<br/>acters&#160;used by many programs.<br/>The&#160;second&#160;command&#160;we&#160;need&#160;to&#160;know&#160;is&#160;how&#160;to&#160;save&#160;our&#160;work.&#160;With&#160;nano&#160;it's&#160;Ctrl-<br/>o.&#160;With&#160;this&#160;knowledge,&#160;we're&#160;ready&#160;to&#160;do&#160;some&#160;editing.&#160;Using&#160;the&#160;down&#160;arrow&#160;key&#160;and/<br/>or&#160;the&#160;PageDown&#160;key,&#160;move&#160;the&#160;cursor&#160;to&#160;the&#160;end&#160;of&#160;the&#160;file,&#160;and&#160;then&#160;add&#160;the&#160;following<br/>lines&#160;to&#160;the&#160;.bashrc&#160;file:<br/>
<b>umask 0002<br/>export HISTCONTROL=ignoredups<br/>export HISTSIZE=1000<br/>alias l.='ls -d .* --color=auto'<br/>alias ll='ls -l --color=auto'</b><br/>
<b>Note:</b>&#160;Your&#160;distribution&#160;may&#160;already&#160;include&#160;some&#160;of&#160;these,&#160;but&#160;duplicates&#160;won't<br/>
137<br/>
<hr/>
<a name=162></a>11 –&#160;The&#160;Environment<br/>
hurt&#160;anything.<br/>
Table&#160;11-4 details&#160;the&#160;meaning of our additions:<br/>
<i>Table&#160;11-4:&#160;Additions&#160;to Our&#160;.bashrc</i><br/>
<b>Line</b><br/>
<b>Meaning</b><br/>
umask 0002<br/>
Sets&#160;the&#160;umask&#160;to&#160;solve&#160;the&#160;<br/>problem&#160;with the&#160;shared&#160;<br/>directories&#160;we&#160;discussed in&#160;<br/>Chapter&#160;9, “Permissions.”<br/>
export HISTCONTROL=ignoredups<br/>
Causes&#160;the&#160;shell's&#160;history&#160;<br/>recording&#160;feature&#160;to ignore&#160;a&#160;<br/>command&#160;if the&#160;same&#160;command&#160;<br/>was&#160;just&#160;recorded.<br/>
export HISTSIZE=1000<br/>
Increases&#160;the&#160;size&#160;of the&#160;command<br/>history from&#160;the&#160;usual&#160;default&#160;of&#160;<br/>500 lines&#160;to&#160;1,000 lines.<br/>
alias l.='ls -d .* --color=auto'<br/>
Creates&#160;a&#160;new&#160;command&#160;called&#160;<br/>l., which displays&#160;all&#160;directory&#160;<br/>entries&#160;that&#160;begin with a&#160;dot.<br/>
alias ll='ls -l --color=auto'<br/>
Creates&#160;a&#160;new&#160;command&#160;called&#160;<br/>ll, which displays&#160;a&#160;long-format&#160;<br/>directory&#160;listing.<br/>
As&#160;we&#160;can&#160;see,&#160;many&#160;of&#160;our&#160;additions&#160;are&#160;not&#160;intuitively&#160;obvious,&#160;so&#160;it&#160;would&#160;be&#160;a&#160;good<br/>idea&#160;to&#160;add&#160;some&#160;comments&#160;to&#160;our&#160;.bashrc&#160;file&#160;to&#160;help&#160;explain&#160;things&#160;to&#160;the&#160;humans.<br/>Using the&#160;editor, change&#160;our additions&#160;to look like&#160;this:<br/>
138<br/>
<hr/>
<a name=163></a>Modifying the&#160;Environment<br/>
<b># Change umask to make directory sharing easier<br/></b>umask 0002<br/>
<b># Ignore duplicates in command history and increase<br/># history size to 1000 lines<br/></b>export HISTCONTROL=ignoredups<br/>export HISTSIZE=1000<br/>
<b># Add some helpful aliases<br/></b>alias l.='ls -d .* --color=auto'<br/>alias ll='ls -l --color=auto'<br/>
Ah,&#160;&#160;&#160;much&#160;&#160;&#160;better!&#160;&#160;With&#160;&#160;&#160;our&#160;&#160;&#160;changes&#160;&#160;&#160;complete,&#160;&#160;&#160;press&#160;&#160;Ctrl-o&#160;&#160;to&#160;&#160;&#160;save&#160;&#160;&#160;our&#160;&#160;&#160;modified<br/>.bashrc&#160;file,&#160;and press&#160;Ctrl-x&#160;to exit&#160;nano.&#160;<br/>
<b>Why&#160;Comments&#160;Are&#160;Important</b><br/>
Whenever&#160;you&#160;modify&#160;configuration&#160;files&#160;it's&#160;a&#160;good&#160;idea&#160;to&#160;add&#160;some&#160;comments<br/>to&#160;document&#160;your&#160;changes.&#160;Sure,&#160;you'll&#160;probably&#160;remember&#160;what&#160;you&#160;changed&#160;to-<br/>morrow,&#160;but&#160;what&#160;about&#160;six&#160;months&#160;from&#160;now?&#160;Do&#160;yourself&#160;a&#160;favor&#160;and&#160;add&#160;some<br/>comments.&#160;While&#160;you're&#160;at&#160;it,&#160;it’s&#160;not&#160;a&#160;bad&#160;idea&#160;to&#160;keep&#160;a&#160;log&#160;of&#160;what&#160;changes<br/>you make.<br/>Shell&#160;scripts&#160;and&#160;bash&#160;startup&#160;files&#160;use&#160;a&#160;“#”&#160;symbol&#160;to&#160;begin&#160;a&#160;comment.&#160;Other<br/>configuration&#160;files&#160;may&#160;use&#160;other&#160;symbols.&#160;Most&#160;configuration&#160;files&#160;will&#160;have<br/>comments. Use&#160;them&#160;as&#160;a&#160;guide.<br/>You&#160;will&#160;often&#160;see&#160;lines&#160;in&#160;configuration&#160;files&#160;that&#160;are&#160;<i>commented&#160;out</i>&#160;to&#160;prevent<br/>them&#160;from&#160;being&#160;used&#160;by&#160;the&#160;affected&#160;program.&#160;This&#160;is&#160;done&#160;to&#160;give&#160;the&#160;reader<br/>suggestions&#160;for&#160;possible&#160;configuration&#160;choices&#160;or&#160;examples&#160;of&#160;correct&#160;configura-<br/>tion syntax.&#160;For example,&#160;the&#160;.bashrc&#160;file&#160;of Ubuntu 18.04 contains&#160;these&#160;lines:<br/># some more ls aliases<br/>#alias ll='ls -l'<br/>#alias la='ls -A'<br/>#alias l='ls -CF'<br/>The&#160;last&#160;three&#160;lines&#160;are&#160;valid&#160;alias&#160;definitions&#160;that&#160;have&#160;been&#160;commented&#160;out.&#160;If<br/>you&#160;remove&#160;the&#160;leading&#160;“#”&#160;symbols&#160;from&#160;these&#160;three&#160;lines,&#160;a&#160;technique&#160;called&#160;<i>un-<br/>commenting</i>,&#160;you&#160;will&#160;activate&#160;the&#160;aliases.&#160;Conversely,&#160;if&#160;you&#160;add&#160;a&#160;“#”&#160;symbol&#160;to<br/>
139<br/>
<hr/>
<a name=164></a>11 –&#160;The&#160;Environment<br/>
the&#160;beginning&#160;of&#160;a&#160;line,&#160;you&#160;can&#160;deactivate&#160;a&#160;configuration&#160;line&#160;while&#160;preserving<br/>the&#160;information&#160;it&#160;contains.<br/>
Activating&#160;Our&#160;Changes<br/>The&#160;changes&#160;we&#160;have&#160;made&#160;to our&#160;.bashrc&#160;will&#160;not&#160;take&#160;effect&#160;until&#160;we&#160;close&#160;our termi-<br/>nal&#160;session and start&#160;a&#160;new&#160;one&#160;because&#160;the&#160;.bashrc&#160;file&#160;is&#160;only&#160;read at&#160;the&#160;beginning of<br/>a&#160;session.&#160;However,&#160;we&#160;can&#160;force&#160;bash&#160;to&#160;reread&#160;the&#160;modified&#160;.bashrc&#160;file&#160;with&#160;the<br/>following command:<br/>
[me@linuxbox ~]$&#160;<b>source ~/.bashrc</b><br/>
After&#160;doing&#160;this,&#160;we&#160;should&#160;be&#160;able&#160;to&#160;see&#160;the&#160;effect&#160;of&#160;our&#160;changes.&#160;Try&#160;one&#160;of&#160;the&#160;new<br/>aliases.<br/>
[me@linuxbox ~]$&#160;<b>ll</b><br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;learned&#160;an&#160;essential&#160;skill — editing&#160;configuration&#160;files&#160;with&#160;a&#160;text&#160;edi-<br/>tor.&#160;Moving&#160;forward,&#160;as&#160;we&#160;read&#160;man&#160;pages&#160;for&#160;commands,&#160;take&#160;note&#160;of&#160;the&#160;environment<br/>variables&#160;that&#160;commands&#160;support.&#160;There&#160;may&#160;be&#160;a&#160;gem&#160;or&#160;two.&#160;In&#160;later&#160;chapters,&#160;we&#160;will<br/>learn&#160;about&#160;shell&#160;functions,&#160;a&#160;powerful&#160;feature&#160;that&#160;you&#160;can&#160;also&#160;include&#160;in&#160;the&#160;&#160;bash<br/>startup files&#160;to add&#160;to your arsenal&#160;of custom&#160;commands.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;INVOCATION&#160;section&#160;of&#160;the&#160;bash&#160;man&#160;page&#160;covers&#160;the&#160;bash&#160;startup&#160;files<br/>in gory detail.<br/>
140<br/>
<hr/>
<a name=165></a>12 –&#160;A&#160;Gentle&#160;Introduction&#160;to vi<br/>
<i><b>12&#160;–&#160;A&#160;Gentle&#160;Introduction&#160;to&#160;vi</b></i><br/>
There&#160;is&#160;an&#160;old&#160;joke&#160;about&#160;a&#160;visitor&#160;to&#160;New&#160;York&#160;City&#160;asking&#160;a&#160;passerby&#160;for&#160;directions&#160;to<br/>the&#160;city's&#160;famous&#160;classical&#160;music&#160;venue:<br/>Visitor:&#160;Excuse&#160;me, how&#160;do I get&#160;to Carnegie&#160;Hall?<br/>Passerby:&#160;Practice, practice,&#160;practice!<br/>Learning&#160;the&#160;Linux&#160;command&#160;line,&#160;like&#160;becoming&#160;an&#160;accomplished&#160;pianist,&#160;is&#160;not&#160;some-<br/>thing&#160;that&#160;we&#160;pick&#160;up&#160;in&#160;an&#160;afternoon.&#160;It&#160;takes&#160;years&#160;of&#160;practice.&#160;In&#160;this&#160;chapter,&#160;we&#160;will<br/>introduce&#160;the&#160;&#160;vi&#160;&#160;(pronounced&#160;“vee&#160;eye”)&#160;text&#160;editor,&#160;one&#160;of&#160;the&#160;core&#160;programs&#160;in&#160;the<br/>Unix&#160;tradition.&#160;vi&#160;is&#160;somewhat&#160;notorious&#160;for&#160;its&#160;difficult&#160;user&#160;interface,&#160;but&#160;when&#160;we&#160;see<br/>a&#160;master&#160;sit&#160;down&#160;at&#160;the&#160;keyboard&#160;and&#160;begin&#160;to&#160;“play,”&#160;we&#160;will&#160;indeed&#160;be&#160;witness&#160;to&#160;some<br/>great&#160;art.&#160;We&#160;won't&#160;become&#160;masters&#160;in&#160;this&#160;chapter,&#160;but&#160;when&#160;we&#160;are&#160;done,&#160;we&#160;will&#160;know<br/>how&#160;to&#160;play “chopsticks”&#160;in&#160;vi.<br/>
<b>Why&#160;We&#160;Should&#160;Learn&#160;vi<br/></b>In&#160;this&#160;modern&#160;age&#160;of&#160;graphical&#160;editors&#160;and&#160;easy-to-use&#160;text-based&#160;editors&#160;such&#160;as&#160;nano,<br/>why should we&#160;learn&#160;vi?&#160;There&#160;are&#160;three&#160;good reasons.<br/>
●<br/>
vi&#160;is&#160;almost&#160;always&#160;available.&#160;This&#160;can&#160;be&#160;a&#160;lifesaver&#160;if&#160;we&#160;have&#160;a&#160;system&#160;with&#160;no<br/>graphical&#160;interface,&#160;such&#160;as&#160;a&#160;remote&#160;server&#160;or&#160;a&#160;local&#160;system&#160;with&#160;a&#160;broken&#160;X<br/>configuration.&#160;nano,&#160;while&#160;increasingly&#160;popular,&#160;is&#160;still&#160;not&#160;universal.&#160;POSIX,&#160;a<br/>standard for program&#160;compatibility&#160;on Unix&#160;systems,&#160;requires&#160;that&#160;vi&#160;be&#160;present.<br/>
●<br/>
vi&#160;is&#160;lightweight&#160;and&#160;fast.&#160;For&#160;many&#160;tasks,&#160;it's&#160;easier&#160;to&#160;bring&#160;up&#160;vi&#160;than&#160;it&#160;is&#160;to<br/>find&#160;the&#160;graphical&#160;text&#160;editor&#160;in&#160;the&#160;menus&#160;and&#160;wait&#160;for&#160;its&#160;multiple&#160;megabytes&#160;to<br/>load.&#160;In&#160;addition,&#160;&#160;vi&#160;is&#160;designed&#160;for&#160;typing&#160;speed.&#160;As&#160;we&#160;will&#160;see,&#160;a&#160;skilled&#160;vi<br/>user&#160;never has&#160;to lift&#160;his&#160;or her&#160;fingers&#160;from&#160;the&#160;keyboard while&#160;editing.<br/>
●<br/>
We&#160;don't&#160;want&#160;other Linux and Unix users&#160;to think&#160;we&#160;are&#160;cowards.<br/>
Okay,&#160;maybe&#160;two good reasons.<br/>
141<br/>
<hr/>
<a name=166></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
<b>A&#160;Little&#160;Background&#160;<br/></b>The&#160;first&#160;version&#160;of&#160;&#160;vi&#160;&#160;was&#160;written&#160;in&#160;1976&#160;by&#160;Bill&#160;&#160;Joy,&#160;a&#160;University&#160;of&#160;California&#160;at<br/>Berkley&#160;student&#160;who&#160;later&#160;went&#160;on&#160;to&#160;co-found&#160;Sun&#160;Microsystems.&#160;vi&#160;derives&#160;its&#160;name<br/>from&#160;the&#160;word&#160;“visual,”&#160;because&#160;it&#160;was&#160;intended&#160;to&#160;allow&#160;editing&#160;on&#160;a&#160;video&#160;terminal&#160;with<br/>a&#160;moving&#160;cursor.&#160;Previous&#160;to&#160;<i>visual&#160;editors</i>,&#160;there&#160;were&#160;<i>line&#160;editors</i>&#160;that&#160;operated&#160;on&#160;a&#160;sin-<br/>gle&#160;line&#160;of text&#160;at&#160;a&#160;time.&#160;To specify&#160;a&#160;change,&#160;we&#160;tell&#160;a&#160;line&#160;editor&#160;to go to a&#160;particular line<br/>and&#160;describe&#160;what&#160;change&#160;to&#160;make,&#160;such&#160;as&#160;adding&#160;or&#160;deleting&#160;text.&#160;With&#160;the&#160;advent&#160;of<br/>video&#160;terminals&#160;(rather&#160;than&#160;printer-based&#160;terminals&#160;like&#160;teletypes),&#160;visual&#160;editing&#160;became<br/>possible.&#160;vi&#160;actually&#160;incorporates&#160;a&#160;powerful&#160;line&#160;editor&#160;called&#160;ex,&#160;and&#160;we&#160;can&#160;use&#160;line<br/>editing commands&#160;while&#160;using&#160;vi.<br/>Most&#160;Linux&#160;distributions&#160;don't&#160;include&#160;real&#160;&#160;vi;&#160;rather,&#160;they&#160;ship&#160;with&#160;an&#160;enhanced&#160;re-<br/>placement&#160;called&#160;&#160;vim&#160;&#160;(which&#160;is&#160;short&#160;for&#160;“vi&#160;improved”)&#160;written&#160;by&#160;Bram&#160;&#160;Moolenaar.<br/>vim&#160;is&#160;a&#160;substantial&#160;improvement&#160;over&#160;traditional&#160;Unix&#160;vi&#160;and&#160;is&#160;usually&#160;symbolically<br/>linked&#160;(or&#160;aliased)&#160;to&#160;the&#160;name&#160;vi&#160;on&#160;Linux&#160;systems.&#160;In&#160;the&#160;discussions&#160;that&#160;follow,&#160;we<br/>will&#160;assume&#160;that&#160;we&#160;have&#160;a&#160;program&#160;called&#160;vi&#160;that&#160;is&#160;really&#160;vim.<br/>
<b>Starting&#160;and&#160;Stopping&#160;vi<br/></b>To start&#160;vi, we&#160;simply&#160;enter&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>vi</b><br/>
A&#160;screen like&#160;this&#160;should appear:<br/>
~<br/>~<br/>~ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; VIM - Vi Improved<br/>~<br/>~ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;version 8.0.707<br/>~ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; by Bram Moolenaar et al.<br/>~ &#160; &#160; &#160; &#160; &#160; &#160;Vim is open source and freely distributable<br/>~<br/>~ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Sponsor Vim development!<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:help sponsor&lt;Enter&gt; &#160; &#160;for information<br/>~<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:q&lt;Enter&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; to exit<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:help&lt;Enter&gt; &#160;or &#160;&lt;F1&gt; &#160;for on-line help<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:help version8&lt;Enter&gt; &#160; for version info<br/>~<br/>
142<br/>
<hr/>
<a name=167></a>Starting and&#160;Stopping vi<br/>
~ &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Running in Vi compatible mode<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:set nocp&lt;Enter&gt; &#160; &#160; &#160; &#160;for Vim defaults<br/>~ &#160; &#160; &#160; &#160; &#160;type &#160;:help cp-default&lt;Enter&gt; for info on this<br/>~<br/>~<br/>~<br/>
Just&#160;as&#160;we&#160;did&#160;with&#160;nano&#160;earlier,&#160;the&#160;first&#160;thing&#160;to&#160;learn&#160;is&#160;how&#160;to&#160;exit.&#160;To&#160;exit,&#160;we&#160;enter<br/>the&#160;following command (note&#160;that&#160;the&#160;colon&#160;character is&#160;part&#160;of the&#160;command):<br/>
<b>:q</b><br/>
The&#160;shell&#160;prompt&#160;should&#160;return.&#160;If,&#160;for&#160;some&#160;reason,&#160;vi&#160;will&#160;not&#160;quit&#160;(usually&#160;because&#160;we<br/>made&#160;a&#160;change&#160;to&#160;a&#160;file&#160;that&#160;has&#160;not&#160;yet&#160;been&#160;saved),&#160;we&#160;can&#160;tell&#160;vi&#160;that&#160;we&#160;really&#160;mean&#160;it<br/>by adding an&#160;exclamation&#160;point&#160;to the&#160;command.<br/>
<b>:q!</b><br/>
<b>Tip:</b>&#160;&#160;If&#160;you&#160;get&#160;“lost”&#160;in&#160;&#160;vi,&#160;try&#160;pressing&#160;the&#160;Esc&#160;key&#160;twice&#160;to&#160;find&#160;your&#160;way<br/>again.<br/>
<b>Compatibility&#160;Mode</b><br/>
In&#160;the&#160;example&#160;startup&#160;screen&#160;above,&#160;we&#160;see&#160;the&#160;text&#160;“Running&#160;in&#160;Vi&#160;compatible<br/>mode.”&#160;This&#160;means&#160;that&#160;vim&#160;will&#160;run&#160;in&#160;a&#160;mode&#160;that&#160;is&#160;closer&#160;to&#160;the&#160;normal&#160;be-<br/>havior&#160;of&#160;vi&#160;rather&#160;than&#160;the&#160;enhanced&#160;behavior&#160;of&#160;vim.&#160;For&#160;the&#160;purposes&#160;of&#160;this<br/>chapter,&#160;we&#160;will&#160;want&#160;to&#160;run&#160;vim&#160;with&#160;its&#160;enhanced&#160;behavior.&#160;To&#160;do&#160;this,&#160;you&#160;have<br/>a&#160;few&#160;options.&#160;Try&#160;running&#160;&#160;vim&#160;&#160;instead&#160;of&#160;&#160;vi.&#160;If&#160;that&#160;works,&#160;consider&#160;adding<br/>alias&#160;vi='vim'&#160;to&#160;your&#160;.bashrc&#160;file.&#160;Alternatively,&#160;use&#160;this&#160;command&#160;to<br/>add a&#160;line&#160;to&#160;your&#160;vim&#160;configuration file:<br/>echo &#34;set nocp&#34; &gt;&gt; ~/.vimrc<br/>Different&#160;Linux&#160;distributions&#160;package&#160;vim&#160;in&#160;different&#160;ways.&#160;Some&#160;distributions<br/>install&#160;a&#160;minimal&#160;version&#160;of&#160;&#160;vim&#160;&#160;by&#160;default&#160;that&#160;supports&#160;only&#160;a&#160;limited&#160;set&#160;of<br/>
143<br/>
<hr/>
<a name=168></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
vim&#160;features.&#160;While&#160;performing&#160;the&#160;lessons&#160;that&#160;follow,&#160;you&#160;may&#160;encounter&#160;miss-<br/>ing features. If this&#160;is&#160;the&#160;case, install&#160;the&#160;full&#160;version of&#160;vim.<br/>
<b>Editing&#160;Modes<br/></b>Let's&#160;start&#160;vi&#160;again,&#160;this&#160;time&#160;passing&#160;to&#160;it&#160;the&#160;name&#160;of&#160;a&#160;nonexistent&#160;file.&#160;This&#160;is&#160;how&#160;we<br/>can create&#160;a&#160;new&#160;file&#160;with&#160;vi:<br/>
[me@linuxbox ~]$&#160;<b>rm -f foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>vi foo.txt</b><br/>
If all&#160;goes&#160;well, we&#160;should get&#160;a&#160;screen like&#160;this:<br/>
~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>~<br/>&#34;foo.txt&#34; [New File]&#160;<br/>
The&#160;leading&#160;tilde&#160;characters&#160;(~)&#160;indicate&#160;that&#160;no&#160;text&#160;exists&#160;on&#160;that&#160;line.&#160;This&#160;shows&#160;that<br/>we&#160;have&#160;an empty file.&#160;<b>Do not type&#160;anything yet!</b><br/>
144<br/>
<hr/>
<a name=169></a>Editing&#160;Modes<br/>
The&#160;second&#160;most&#160;important&#160;thing&#160;to&#160;learn&#160;about&#160;vi&#160;(after&#160;learning&#160;how&#160;to&#160;exit)&#160;is&#160;that&#160;vi<br/>is&#160;a&#160;<i>modal&#160;editor</i>.&#160;When&#160;vi&#160;starts,&#160;it&#160;begins&#160;in&#160;<i>command&#160;mode</i>.&#160;In&#160;this&#160;mode,&#160;almost&#160;ev-<br/>ery&#160;key&#160;is&#160;a&#160;command,&#160;so&#160;if&#160;we&#160;were&#160;to&#160;start&#160;typing,&#160;&#160;vi&#160;would&#160;basically&#160;go&#160;crazy&#160;and<br/>make&#160;a&#160;big mess.<br/>
Entering&#160;Insert&#160;Mode<br/>To&#160;add&#160;some&#160;text&#160;to&#160;our&#160;file,&#160;we&#160;must&#160;first&#160;enter&#160;<i>insert&#160;mode</i>.&#160;To&#160;do&#160;this,&#160;we&#160;press&#160;the&#160;i<br/>key.&#160;Afterward,&#160;we&#160;should&#160;see&#160;the&#160;following&#160;at&#160;the&#160;bottom&#160;of&#160;the&#160;screen&#160;if&#160;vim&#160;is&#160;running<br/>in its&#160;usual&#160;enhanced&#160;mode&#160;(this&#160;will&#160;not&#160;appear in&#160;vi&#160;compatible&#160;mode):<br/>
<b>-- INSERT --</b><br/>
Now&#160;we&#160;can&#160;enter some&#160;text.&#160;Try this:<br/>
<b>The quick brown fox jumped over the lazy dog.</b><br/>
To exit&#160;insert&#160;mode&#160;and return&#160;to command mode,&#160;press&#160;the&#160;Esc&#160;key.<br/>
Saving&#160;Our&#160;Work<br/>To&#160;save&#160;the&#160;change&#160;we&#160;just&#160;made&#160;to&#160;our&#160;file,&#160;we&#160;must&#160;enter&#160;an&#160;<i>ex&#160;command</i>&#160;while&#160;in&#160;com-<br/>mand&#160;mode.&#160;This&#160;is&#160;easily&#160;done&#160;by&#160;pressing&#160;the&#160;:&#160;key.&#160;After&#160;doing&#160;this,&#160;a&#160;colon&#160;character<br/>should&#160;appear&#160;at&#160;the&#160;bottom&#160;of the&#160;screen.<br/>
:<br/>
To write&#160;our modified&#160;file, we&#160;follow&#160;the&#160;colon&#160;with a&#160;w&#160;and&#160;then press&#160;Enter.<br/>
:<b>w</b><br/>
The&#160;file&#160;will&#160;be&#160;written to the&#160;hard drive,&#160;and we&#160;should get&#160;a&#160;confirmation&#160;message&#160;at&#160;the<br/>bottom&#160;of the&#160;screen,&#160;like&#160;this:<br/>
&#34;foo.txt&#34; [New] 1L, 46C written<br/>
145<br/>
<hr/>
<a name=170></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
<b>Tip:</b>&#160;If&#160;you&#160;read&#160;the&#160;vim&#160;documentation,&#160;you&#160;will&#160;notice&#160;that&#160;(confusingly)&#160;com-<br/>mand&#160;mode&#160;is&#160;called&#160;<i>normal&#160;mode</i>&#160;and&#160;ex&#160;commands&#160;are&#160;called&#160;<i>command&#160;mode</i>.<br/>Beware.<br/>
<b>Moving&#160;the&#160;Cursor&#160;Around<br/></b>While&#160;in&#160;command&#160;mode,&#160;&#160;vi&#160;offers&#160;a&#160;large&#160;number&#160;of&#160;movement&#160;commands,&#160;some&#160;of<br/>which it&#160;shares&#160;with&#160;less.&#160;Table&#160;12-1 lists&#160;a&#160;subset.<br/>
<i>Table&#160;12-1: Cursor&#160;Movement&#160;Keys</i><br/>
<b>Key</b><br/>
<b>Moves&#160;The&#160;Cursor</b><br/>
l&#160;or right&#160;arrow<br/>
Right&#160;one&#160;character.<br/>
h&#160;or left&#160;arrow<br/>
Left&#160;one&#160;character.<br/>
j&#160;or down arrow<br/>
Down one&#160;line.<br/>
k&#160;or up arrow<br/>
Up one&#160;line.<br/>
0&#160;(zero)<br/>
To the&#160;beginning of the&#160;current&#160;line.<br/>
^<br/>
To the&#160;first&#160;non-whitespace&#160;character on the&#160;current&#160;<br/>line.<br/>
$<br/>
To the&#160;end&#160;of the&#160;current&#160;line.<br/>
w<br/>
To the&#160;beginning of the&#160;next&#160;word or punctuation&#160;<br/>character.<br/>
W<br/>
To the&#160;beginning of the&#160;next&#160;word, ignoring&#160;<br/>punctuation characters.<br/>
b<br/>
To the&#160;beginning of the&#160;previous&#160;word or punctuation&#160;<br/>character.<br/>
B<br/>
To the&#160;beginning of the&#160;previous&#160;word, ignoring&#160;<br/>punctuation characters.<br/>
Ctrl-f&#160;or&#160;Page Down<br/>
Down one&#160;page.<br/>
Ctrl-b&#160;or&#160;Page Up<br/>
Up one&#160;page.<br/>
<i>number</i>G<br/>
To line&#160;<i>number</i>. For example,&#160;1G&#160;moves&#160;to the&#160;first&#160;<br/>line&#160;of the&#160;file.<br/>
G<br/>
To the&#160;last&#160;line&#160;of the&#160;file.<br/>
146<br/>
<hr/>
<a name=171></a>Moving&#160;the&#160;Cursor&#160;Around<br/>
Why&#160;are&#160;the&#160;&#160;h,&#160;&#160;j,&#160;&#160;k,&#160;and&#160;&#160;l&#160;&#160;keys&#160;used&#160;for&#160;cursor&#160;movement?&#160;When&#160;&#160;vi&#160;&#160;was&#160;originally<br/>written,&#160;not&#160;all&#160;video&#160;terminals&#160;had&#160;arrow&#160;keys,&#160;and&#160;skilled&#160;typists&#160;could&#160;use&#160;regular&#160;key-<br/>board keys&#160;to move&#160;the&#160;cursor without&#160;ever&#160;having to lift&#160;their fingers&#160;from&#160;the&#160;keyboard.<br/>Many&#160;commands&#160;in&#160;vi&#160;can&#160;be&#160;prefixed&#160;with&#160;a&#160;number,&#160;as&#160;with&#160;the&#160;“G”&#160;command&#160;listed<br/>above.&#160;By&#160;prefixing&#160;a&#160;command&#160;with&#160;a&#160;number,&#160;we&#160;may&#160;specify&#160;the&#160;number&#160;of&#160;times&#160;a<br/>command&#160;is&#160;to&#160;be&#160;carried&#160;out.&#160;For&#160;example,&#160;the&#160;command&#160;“5j”&#160;causes&#160;&#160;vi&#160;to&#160;move&#160;the<br/>cursor down five&#160;lines.<br/>
<b>Basic&#160;Editing<br/></b>Most&#160;editing&#160;consists&#160;of&#160;a&#160;few&#160;basic&#160;operations&#160;such&#160;as&#160;inserting&#160;text,&#160;deleting&#160;text,&#160;and<br/>moving&#160;text&#160;around&#160;by&#160;cutting&#160;and&#160;pasting.&#160;vi,&#160;of&#160;course,&#160;supports&#160;all&#160;of&#160;these&#160;operations<br/>in&#160;its&#160;own&#160;unique&#160;way.&#160;vi&#160;also&#160;provides&#160;a&#160;limited&#160;form&#160;of&#160;undo.&#160;If&#160;we&#160;press&#160;the&#160;“u”&#160;key<br/>while&#160;in&#160;command&#160;mode,&#160;vi&#160;will&#160;undo&#160;the&#160;last&#160;change&#160;that&#160;you&#160;made.&#160;This&#160;will&#160;come&#160;in<br/>handy as&#160;we&#160;try some&#160;of the&#160;basic&#160;editing&#160;commands.<br/>
Appending&#160;Text<br/>vi&#160;has&#160;several&#160;different&#160;ways&#160;of&#160;entering&#160;insert&#160;mode.&#160;We&#160;have&#160;already&#160;used&#160;the&#160;i&#160;com-<br/>mand to&#160;insert&#160;text.<br/>Let's&#160;go back to&#160;our&#160;foo.txt&#160;file&#160;for a&#160;moment.<br/>
The quick brown fox jumped over the lazy dog.<br/>
If&#160;we&#160;wanted&#160;to&#160;add&#160;some&#160;text&#160;to&#160;the&#160;end&#160;of&#160;this&#160;sentence,&#160;we&#160;would&#160;discover&#160;that&#160;the&#160;i<br/>command&#160;will&#160;not&#160;do&#160;it,&#160;since&#160;we&#160;can't&#160;move&#160;the&#160;cursor&#160;beyond&#160;the&#160;end&#160;of&#160;the&#160;line.&#160;vi<br/>provides&#160;a&#160;command&#160;to&#160;append&#160;text,&#160;the&#160;sensibly&#160;named&#160;a&#160;command.&#160;If&#160;we&#160;move&#160;the&#160;cur-<br/>sor&#160;to&#160;the&#160;end&#160;of&#160;the&#160;line&#160;and&#160;type&#160;a,&#160;the&#160;cursor&#160;will&#160;move&#160;past&#160;the&#160;end&#160;of&#160;the&#160;line&#160;and&#160;vi<br/>will&#160;enter insert&#160;mode.&#160;This&#160;will&#160;allow&#160;us&#160;to add some&#160;more&#160;text.<br/>
The quick brown fox jumped over the lazy dog.<b>&#160;It was cool.</b><br/>
Remember to&#160;press&#160;the&#160;Esc&#160;key to exit&#160;insert&#160;mode.<br/>Since&#160;we&#160;will&#160;almost&#160;always&#160;want&#160;to&#160;append&#160;text&#160;to&#160;the&#160;end&#160;of&#160;a&#160;line,&#160;vi&#160;offers&#160;a&#160;shortcut<br/>to&#160;move&#160;to&#160;the&#160;end&#160;of&#160;the&#160;current&#160;line&#160;and&#160;start&#160;appending.&#160;It's&#160;the&#160;A&#160;command.&#160;Let's&#160;try&#160;it<br/>and add some&#160;more&#160;lines&#160;to our file.<br/>
147<br/>
<hr/>
<a name=172></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
First,&#160;we'll&#160;move&#160;the&#160;cursor&#160;to&#160;the&#160;beginning&#160;of&#160;the&#160;line&#160;using&#160;the&#160;“0”&#160;(zero)&#160;command.<br/>Now&#160;we&#160;type&#160;A&#160;and add the&#160;following&#160;lines&#160;of text:<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/><b>Line 2<br/>Line 3<br/>Line 4<br/>Line 5</b><br/>
Again, press&#160;the&#160;Esc&#160;key&#160;to exit&#160;insert&#160;mode.<br/>As&#160;we&#160;can&#160;see,&#160;the&#160;“A”&#160;command&#160;is&#160;more&#160;useful&#160;as&#160;it&#160;moves&#160;the&#160;cursor&#160;to&#160;the&#160;end&#160;of&#160;the<br/>line&#160;before&#160;starting insert&#160;mode.<br/>
Opening&#160;a&#160;Line<br/>Another&#160;way&#160;we&#160;can&#160;insert&#160;text&#160;is&#160;by&#160;“opening”&#160;a&#160;line.&#160;This&#160;inserts&#160;a&#160;blank&#160;line&#160;between<br/>two&#160;existing&#160;lines&#160;and&#160;enters&#160;insert&#160;mode.&#160;This&#160;has&#160;two&#160;variants&#160;as&#160;described&#160;in&#160;Table&#160;12-<br/>2.<br/>
<i>Table&#160;12-2: Line&#160;Opening&#160;Keys</i><br/>
<b>Command</b><br/>
<b>Opens</b><br/>
o<br/>
The&#160;line&#160;below&#160;the&#160;current&#160;line<br/>
O<br/>
The&#160;line&#160;above&#160;the&#160;current&#160;line<br/>
We&#160;can demonstrate&#160;this&#160;as&#160;follows:&#160;place&#160;the&#160;cursor on “Line&#160;3”&#160;then&#160;type&#160;o.<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>
Line 4<br/>Line 5<br/>
A&#160;new&#160;line&#160;was&#160;opened&#160;below&#160;the&#160;third&#160;line&#160;and&#160;we&#160;entered&#160;insert&#160;mode.&#160;Exit&#160;insert&#160;mode<br/>by pressing&#160;the&#160;Esc&#160;key.&#160;Press&#160;the&#160;u&#160;key to undo our change.<br/>Press&#160;the&#160;O&#160;key to open&#160;the&#160;line&#160;above&#160;the&#160;cursor:<br/>
148<br/>
<hr/>
<a name=173></a>Basic&#160;Editing<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>
Line 3<br/>Line 4<br/>Line 5<br/>
Exit&#160;insert&#160;mode&#160;by pressing the&#160;Esc&#160;key&#160;and undo our change&#160;by pressing&#160;u.<br/>
Deleting&#160;Text<br/>As&#160;we&#160;might&#160;expect,&#160;vi&#160;offers&#160;a&#160;variety&#160;of&#160;ways&#160;to&#160;delete&#160;text,&#160;all&#160;of&#160;which&#160;contain&#160;one<br/>of&#160;two&#160;keystrokes.&#160;First,&#160;the&#160;x&#160;command&#160;will&#160;delete&#160;a&#160;character&#160;at&#160;the&#160;cursor&#160;location.&#160;x<br/>may&#160;be&#160;preceded&#160;by&#160;a&#160;number&#160;specifying&#160;how&#160;many&#160;characters&#160;are&#160;to&#160;be&#160;deleted.&#160;The&#160;d<br/>command&#160;is&#160;more&#160;general&#160;purpose.&#160;Like&#160;x,&#160;it&#160;may&#160;be&#160;preceded&#160;by&#160;a&#160;number&#160;specifying<br/>the&#160;number&#160;of&#160;times&#160;the&#160;deletion&#160;is&#160;to&#160;be&#160;performed.&#160;In&#160;addition,&#160;d&#160;is&#160;always&#160;followed&#160;by<br/>a&#160;movement&#160;command&#160;that&#160;controls&#160;the&#160;size&#160;of the&#160;deletion.&#160;Table&#160;12-3 provides&#160;some&#160;ex-<br/>amples:&#160;<br/>
<i>Table&#160;12-3: Text&#160;Deletion Commands</i><br/>
<b>Command</b><br/>
<b>Deletes</b><br/>
x<br/>
The&#160;current&#160;character<br/>
3x<br/>
The&#160;current&#160;character&#160;and the&#160;next&#160;two characters<br/>
dd<br/>
The&#160;current&#160;line<br/>
5dd<br/>
The&#160;current&#160;line&#160;and the&#160;next&#160;four lines<br/>
dW<br/>
From&#160;the&#160;current&#160;cursor position&#160;to the&#160;beginning&#160;of&#160;<br/>the&#160;next&#160;word<br/>
d$<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;end of the&#160;<br/>current&#160;line<br/>
d0<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;beginning&#160;of&#160;<br/>the&#160;line<br/>
d^<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;first&#160;non-<br/>whitespace&#160;character in&#160;the&#160;line<br/>
dG<br/>
From&#160;the&#160;current&#160;line&#160;to&#160;the&#160;end of the&#160;file<br/>
d20G<br/>
From&#160;the&#160;current&#160;line&#160;to&#160;the&#160;twentieth&#160;line&#160;of the&#160;file<br/>
149<br/>
<hr/>
<a name=174></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
Place&#160;the&#160;cursor&#160;on&#160;the&#160;word&#160;It&#160;on&#160;the&#160;first&#160;line&#160;of&#160;our&#160;text.&#160;Press&#160;the&#160;x&#160;key&#160;repeatedly<br/>until&#160;the&#160;rest&#160;of&#160;the&#160;sentence&#160;is&#160;deleted.&#160;Next,&#160;press&#160;the&#160;u&#160;key&#160;repeatedly&#160;until&#160;the&#160;deletion<br/>is&#160;undone.<br/>
<b>Note:</b>&#160;Real&#160;vi&#160;supports&#160;only&#160;a&#160;single&#160;level&#160;of&#160;undo.&#160;vim&#160;supports&#160;multiple&#160;lev-<br/>els.<br/>
Let's&#160;try&#160;the&#160;deletion&#160;again,&#160;this&#160;time&#160;using&#160;the&#160;d&#160;command.&#160;Again,&#160;move&#160;the&#160;cursor&#160;to&#160;the<br/>word&#160;It&#160;and&#160;type&#160;dW&#160;to&#160;delete&#160;the&#160;word.<br/>
The quick brown fox jumped over the lazy dog. was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/>
Type&#160;d$&#160;to delete&#160;from&#160;the&#160;cursor position to the&#160;end of the&#160;line.<br/>
The quick brown fox jumped over the lazy dog.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/>
Press&#160;dG&#160;to&#160;delete&#160;from&#160;the&#160;current&#160;line&#160;to the&#160;end of the&#160;file.<br/>
~<br/>~<br/>~<br/>~<br/>~<br/>
Press&#160;u&#160;three&#160;times&#160;to undo the&#160;deletion.<br/>
Cutting,&#160;Copying,&#160;and&#160;Pasting&#160;Text<br/>The&#160;d&#160;command&#160;not&#160;only&#160;deletes&#160;text,&#160;it&#160;also&#160;“cuts”&#160;text.&#160;Each&#160;time&#160;we&#160;use&#160;the&#160;d&#160;com-<br/>mand,&#160;the&#160;deletion&#160;is&#160;copied&#160;into&#160;a&#160;paste&#160;buffer&#160;(think&#160;clipboard)&#160;that&#160;we&#160;can&#160;later&#160;recall<br/>
150<br/>
<hr/>
<a name=175></a>Basic&#160;Editing<br/>
with the&#160;p&#160;command to&#160;paste&#160;the&#160;contents&#160;of the&#160;buffer after the&#160;cursor or with the&#160;P&#160;com-<br/>mand to&#160;paste&#160;the&#160;contents&#160;before&#160;the&#160;cursor.<br/>The&#160;y&#160;command&#160;is&#160;used&#160;to&#160;“yank”&#160;(copy)&#160;text&#160;in&#160;much&#160;the&#160;same&#160;way&#160;the&#160;d&#160;command&#160;is<br/>used&#160;to&#160;cut&#160;text.&#160;Table&#160;12-4&#160;provides&#160;some&#160;examples&#160;of&#160;combining&#160;the&#160;y&#160;command&#160;with<br/>various&#160;movement&#160;commands:<br/>
<i>Table&#160;12-&#160;4: Yanking&#160;Commands</i><br/>
<b>Command</b><br/>
<b>Copies</b><br/>
yy<br/>
The&#160;current&#160;line<br/>
5yy<br/>
The&#160;current&#160;line&#160;and the&#160;next&#160;four lines<br/>
yW<br/>
From&#160;the&#160;current&#160;cursor position&#160;to the&#160;beginning&#160;of&#160;<br/>the&#160;next&#160;word<br/>
y$<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;end of the&#160;<br/>current&#160;line<br/>
y0<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;beginning&#160;of&#160;<br/>the&#160;line<br/>
y^<br/>
From&#160;the&#160;current&#160;cursor location&#160;to the&#160;first&#160;non-<br/>whitespace&#160;character in&#160;the&#160;line<br/>
yG<br/>
From&#160;the&#160;current&#160;line&#160;to&#160;the&#160;end of the&#160;file<br/>
y20G<br/>
From&#160;the&#160;current&#160;line&#160;to&#160;the&#160;twentieth&#160;line&#160;of the&#160;file<br/>
Let's&#160;try&#160;some&#160;copy-and-paste.&#160;Place&#160;the&#160;cursor&#160;on&#160;the&#160;first&#160;line&#160;of&#160;the&#160;text&#160;and&#160;type&#160;yy&#160;to<br/>copy&#160;the&#160;current&#160;line.&#160;Next,&#160;move&#160;the&#160;cursor&#160;to&#160;the&#160;last&#160;line&#160;(G)&#160;and&#160;type&#160;p&#160;to&#160;paste&#160;the<br/>line&#160;below&#160;the&#160;current&#160;line.<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/><b>The quick brown fox jumped over the lazy dog. It was cool.</b><br/>
Just&#160;as&#160;before,&#160;the&#160;u&#160;command&#160;will&#160;undo&#160;our&#160;change.&#160;With&#160;the&#160;cursor&#160;still&#160;positioned&#160;on<br/>the&#160;last&#160;line&#160;of the&#160;file, type&#160;P&#160;to paste&#160;the&#160;text&#160;above&#160;the&#160;current&#160;line.<br/>
151<br/>
<hr/>
<a name=176></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/><b>The quick brown fox jumped over the lazy dog. It was cool.<br/></b>Line 5<br/>
Try&#160;some&#160;of&#160;the&#160;other&#160;&#160;y&#160;commands&#160;in&#160;the&#160;Table&#160;12-4&#160;and&#160;get&#160;to&#160;know&#160;the&#160;behavior&#160;of<br/>both the&#160;p&#160;and&#160;P&#160;commands.&#160;When you are&#160;done, return&#160;the&#160;file&#160;to&#160;its&#160;original&#160;state.<br/>
Joining&#160;Lines<br/>vi&#160;is&#160;rather&#160;strict&#160;about&#160;its&#160;idea&#160;of&#160;a&#160;line.&#160;Normally,&#160;it&#160;is&#160;not&#160;possible&#160;to&#160;move&#160;the&#160;cursor<br/>to&#160;the&#160;end&#160;of&#160;a&#160;line&#160;and&#160;delete&#160;the&#160;end-of-line&#160;character&#160;to&#160;join&#160;one&#160;line&#160;with&#160;the&#160;one&#160;be-<br/>low&#160;it.&#160;Because&#160;of&#160;this,&#160;vi&#160;provides&#160;a&#160;specific&#160;command,&#160;J&#160;(not&#160;to&#160;be&#160;confused&#160;with&#160;j,<br/>which is&#160;for cursor movement), to&#160;join lines&#160;together.<br/>If we&#160;place&#160;the&#160;cursor on&#160;Line 3&#160;and&#160;type&#160;the&#160;J&#160;command,&#160;here's&#160;what&#160;happens:<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/><b>Line 3 Line 4<br/></b>Line 5<br/>
<b>Search-and-Replace<br/></b>vi&#160;has&#160;the&#160;ability&#160;to&#160;move&#160;the&#160;cursor&#160;to&#160;locations&#160;based&#160;on&#160;searches.&#160;It&#160;can&#160;do&#160;this&#160;either<br/>on&#160;a&#160;single&#160;line&#160;or&#160;over&#160;an&#160;entire&#160;file.&#160;It&#160;can&#160;also&#160;perform&#160;text&#160;replacements&#160;with&#160;or&#160;with-<br/>out&#160;confirmation&#160;from&#160;the&#160;user.<br/>
Searching&#160;Within&#160;a&#160;Line<br/>The&#160;f&#160;command&#160;searches&#160;a&#160;line&#160;and&#160;moves&#160;the&#160;cursor&#160;to&#160;the&#160;next&#160;instance&#160;of&#160;a&#160;specified<br/>character.&#160;For&#160;example,&#160;the&#160;command&#160;fa&#160;would&#160;move&#160;the&#160;cursor&#160;to&#160;the&#160;next&#160;occurrence<br/>of&#160;the&#160;character&#160;&#160;a&#160;within&#160;the&#160;current&#160;line.&#160;After&#160;performing&#160;a&#160;character&#160;search&#160;within&#160;a<br/>line,&#160;the&#160;search&#160;may be&#160;repeated&#160;by typing&#160;a&#160;semicolon.<br/>
Searching&#160;the&#160;Entire&#160;File<br/>To&#160;move&#160;the&#160;cursor&#160;to&#160;the&#160;next&#160;occurrence&#160;of&#160;a&#160;word&#160;or&#160;phrase,&#160;the&#160;/&#160;command&#160;is&#160;used.<br/>
152<br/>
<hr/>
<a name=177></a>Search-and-Replace<br/>
This&#160;works&#160;the&#160;same&#160;way&#160;as&#160;we&#160;learned&#160;earlier&#160;in&#160;the&#160;less&#160;program.&#160;When&#160;you&#160;type&#160;the<br/>/&#160;command,&#160;a&#160;/&#160;will&#160;appear&#160;at&#160;the&#160;bottom&#160;of&#160;the&#160;screen.&#160;Next,&#160;type&#160;the&#160;word&#160;or&#160;phrase&#160;to<br/>be&#160;searched&#160;for,&#160;followed&#160;by&#160;the&#160;Enter&#160;key.&#160;The&#160;cursor&#160;will&#160;move&#160;to&#160;the&#160;next&#160;location<br/>containing&#160;the&#160;search&#160;string.&#160;A&#160;search&#160;may&#160;be&#160;repeated&#160;using&#160;the&#160;previous&#160;search&#160;string<br/>with the&#160;n&#160;command.&#160;Here's&#160;an&#160;example:<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/>
Place&#160;the&#160;cursor on the&#160;first&#160;line&#160;of the&#160;file.&#160;Type&#160;followed by the&#160;Enter&#160;key.<br/>
&#160;<b>/Line</b><br/>
The&#160;cursor will&#160;move&#160;to line&#160;2. Next,&#160;type&#160;n&#160;and&#160;the&#160;cursor&#160;will&#160;move&#160;to&#160;line&#160;3.&#160;Repeating<br/>the&#160;n&#160;command&#160;will&#160;move&#160;the&#160;cursor&#160;down&#160;the&#160;file&#160;until&#160;it&#160;runs&#160;out&#160;of&#160;matches.&#160;While&#160;we<br/>have&#160;so&#160;far&#160;used&#160;only&#160;words&#160;and&#160;phrases&#160;for&#160;our&#160;search&#160;patterns,&#160;&#160;vi&#160;allows&#160;the&#160;use&#160;of<br/><i>regular&#160;expressions</i>,&#160;a&#160;powerful&#160;method&#160;of&#160;expressing&#160;complex&#160;text&#160;patterns.&#160;We&#160;will<br/>cover regular expressions&#160;fully&#160;in chapter 19, “Regular Expressions.”<br/>
Global&#160;Search-and-Replace<br/>vi&#160;uses&#160;an&#160;ex&#160;command&#160;to&#160;perform&#160;search-and-replace&#160;operations&#160;(called&#160;<i>substitution</i>&#160;in<br/>vi)&#160;over&#160;a&#160;range&#160;of&#160;lines&#160;or&#160;the&#160;entire&#160;file.&#160;To&#160;change&#160;the&#160;word&#160;Line&#160;to&#160;line&#160;for&#160;the&#160;en-<br/>tire&#160;file,&#160;we&#160;would&#160;enter the&#160;following&#160;command:<br/>
<b>:%s/Line/line/g</b><br/>
Let's&#160;break&#160;down&#160;this&#160;command&#160;into&#160;separate&#160;items&#160;and&#160;see&#160;what&#160;each&#160;one&#160;does&#160;(see&#160;Ta-<br/>ble&#160;12-5).<br/>
<i>Table&#160;12-&#160;5:An&#160;Example&#160;of&#160;Global&#160;Search-and-Replace&#160;Syntax</i><br/>
<b>Item</b><br/>
<b>Meaning</b><br/>
:<br/>
The&#160;colon character starts&#160;an&#160;ex command.<br/>
%<br/>
This&#160;specifies&#160;the&#160;range&#160;of lines&#160;for the&#160;operation.&#160;%&#160;is&#160;a&#160;<br/>
153<br/>
<hr/>
<a name=178></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
shortcut&#160;meaning from&#160;the&#160;first&#160;line&#160;to&#160;the&#160;last&#160;line.&#160;Alternately,<br/>the&#160;range&#160;could&#160;have&#160;been&#160;specified&#160;1,5&#160;(since&#160;our file&#160;is&#160;five&#160;<br/>lines&#160;long) or&#160;1,$, which&#160;means&#160;“from&#160;line&#160;1 to the&#160;last&#160;line&#160;in<br/>the&#160;file.”&#160;If the&#160;range&#160;of lines&#160;is&#160;omitted, the&#160;operation is&#160;<br/>performed only on the&#160;current&#160;line.<br/>
s<br/>
This&#160;specifies&#160;the&#160;operation. In this&#160;case,&#160;it’s&#160;substitution&#160;<br/>(search-and-replace).<br/>
/Line/line/<br/>
This&#160;specifies&#160;the&#160;search pattern&#160;and the&#160;replacement&#160;text.<br/>
g<br/>
This&#160;means&#160;“global”&#160;in the&#160;sense&#160;that&#160;the&#160;search-and-replace&#160;is<br/>performed on every&#160;instance&#160;of the&#160;search&#160;string in the&#160;line.&#160;If&#160;<br/>omitted,&#160;only the&#160;first&#160;instance&#160;of the&#160;search string&#160;on each line<br/>is&#160;replaced.<br/>
After executing our search-and-replace&#160;command,&#160;our file&#160;looks&#160;like&#160;this:<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>line 2<br/>line 3<br/>line 4<br/>line 5<br/>
We&#160;can&#160;also&#160;specify&#160;a&#160;substitution&#160;command&#160;with&#160;user&#160;confirmation.&#160;This&#160;is&#160;done&#160;by<br/>adding a&#160;c&#160;to the&#160;end of the&#160;command.&#160;Here’s&#160;an example:<br/>
<b>:%s/line/Line/gc</b><br/>
This&#160;command&#160;will&#160;change&#160;our&#160;file&#160;back&#160;to&#160;its&#160;previous&#160;form;&#160;however,&#160;before&#160;each&#160;sub-<br/>stitution,&#160;vi&#160;stops&#160;and asks&#160;us&#160;to&#160;confirm&#160;the&#160;substitution with&#160;this&#160;message:<br/>
replace with Line (y/n/a/q/l/^E/^Y)?<br/>
Each&#160;of&#160;the&#160;characters&#160;within&#160;the&#160;parentheses&#160;is&#160;a&#160;possible&#160;choice,&#160;&#160;as&#160;described&#160;in&#160;Table<br/>12-6.<br/>
<i>Table&#160;12-6: Replace&#160;Confirmation Keys</i><br/>
<b>Key</b><br/>
<b>Action</b><br/>
154<br/>
<hr/>
<a name=179></a>Search-and-Replace<br/>
y<br/>
Perform&#160;the&#160;substitution.<br/>
n<br/>
Skip this&#160;instance&#160;of the&#160;pattern.<br/>
a<br/>
Perform&#160;the&#160;substitution on this&#160;and all&#160;subsequent&#160;instances&#160;<br/>of the&#160;pattern.<br/>
q&#160;or&#160;Esc<br/>
Quit&#160;substituting.<br/>
l<br/>
Perform&#160;this&#160;substitution&#160;and then&#160;quit.&#160;This&#160;is&#160;hort&#160;for “last.”<br/>
Ctrl-e, Ctrl-y<br/>
Scroll&#160;down and scroll&#160;up, respectively.&#160;This&#160;is&#160;useful&#160;for&#160;<br/>viewing&#160;the&#160;context&#160;of the&#160;proposed substitution.<br/>
&#160;<br/>If you type&#160;y, the&#160;substitution will&#160;be&#160;performed,&#160;n&#160;will&#160;cause&#160;vi&#160;to skip this&#160;instance&#160;and<br/>move&#160;on to&#160;the&#160;next&#160;one.&#160;<br/>
<b>Editing&#160;Multiple&#160;Files<br/></b>It's&#160;often&#160;useful&#160;to&#160;edit&#160;more&#160;than&#160;one&#160;file&#160;at&#160;a&#160;time.&#160;You&#160;might&#160;need&#160;to&#160;make&#160;changes&#160;to<br/>multiple&#160;files&#160;or&#160;you&#160;may&#160;need&#160;to&#160;copy&#160;content&#160;from&#160;one&#160;file&#160;into&#160;another.&#160;With&#160;vi&#160;we<br/>can open&#160;multiple&#160;files&#160;for editing by specifying them&#160;on the&#160;command&#160;line.<br/>
vi&#160;<i>file1 file2 file3...</i><br/>
Let's&#160;exit&#160;our&#160;existing&#160;vi&#160;session&#160;and&#160;create&#160;a&#160;new&#160;file&#160;for&#160;editing.&#160;Type&#160;:wq&#160;to&#160;exit&#160;vi,<br/>saving&#160;our&#160;modified&#160;text.&#160;Next,&#160;we'll&#160;create&#160;an&#160;additional&#160;file&#160;in&#160;our&#160;home&#160;directory&#160;that<br/>we&#160;can play&#160;with.&#160;We'll&#160;create&#160;the&#160;file&#160;by capturing some&#160;output&#160;from&#160;the&#160;ls&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin &gt; ls-output.txt</b><br/>
Let's&#160;edit&#160;our old file&#160;and our new&#160;one&#160;with&#160;vi.<br/>
[me@linuxbox ~]$&#160;<b>vi foo.txt ls-output.txt</b><br/>
vi&#160;will&#160;start, and we&#160;will&#160;see&#160;the&#160;first&#160;file&#160;on the&#160;screen.<br/>
155<br/>
<hr/>
<a name=180></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/>
Switching&#160;Between&#160;Files<br/>To switch&#160;from&#160;one&#160;file&#160;to&#160;the&#160;next,&#160;use&#160;this&#160;ex command:<br/>
<b>:bn</b><br/>
To move&#160;back&#160;to the&#160;previous&#160;file&#160;use&#160;the&#160;following:<br/>
<b>:bp</b><br/>
While&#160;we&#160;can&#160;move&#160;from&#160;one&#160;file&#160;to&#160;another,&#160;vi&#160;enforces&#160;a&#160;policy&#160;that&#160;prevents&#160;us&#160;from<br/>switching&#160;files&#160;if&#160;the&#160;current&#160;file&#160;has&#160;unsaved&#160;changes.&#160;To&#160;force&#160;&#160;vi&#160;to&#160;switch&#160;files&#160;and<br/>abandon your changes, add an exclamation&#160;point&#160;(!) to&#160;the&#160;command.<br/>In&#160;addition&#160;to&#160;the&#160;switching&#160;method&#160;described&#160;above,&#160;&#160;vim&#160;&#160;(and&#160;some&#160;versions&#160;of&#160;&#160;vi)<br/>provides&#160;some&#160;ex&#160;commands&#160;that&#160;make&#160;multiple&#160;files&#160;easier&#160;to&#160;manage.&#160;We&#160;can&#160;view&#160;a<br/>list&#160;of files&#160;being&#160;edited&#160;with the&#160;:buffers&#160;command. Doing so will&#160;display a&#160;list&#160;of the<br/>files&#160;at&#160;the&#160;bottom&#160;of the&#160;display.<br/>
<b>:buffers<br/></b>&#160; 1 %a &#160; &#34;foo.txt&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;line 1<br/>&#160; 2 &#160; &#160; &#160;&#34;ls-output.txt&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;line 0<br/>Press ENTER or type command to continue&#160;<br/>
To&#160;switch&#160;to&#160;another&#160;buffer&#160;(file),&#160;type&#160;:buffer&#160;followed&#160;by&#160;the&#160;number&#160;of&#160;the&#160;buffer<br/>we&#160;want&#160;to&#160;edit.&#160;For&#160;example,&#160;to&#160;switch&#160;from&#160;buffer&#160;1&#160;containing&#160;the&#160;file&#160;foo.txt&#160;to<br/>buffer 2 containing the&#160;file&#160;ls-output.txt&#160;we&#160;would&#160;type&#160;this:<br/>
<b>:buffer 2</b><br/>
Our&#160;screen&#160;now&#160;displays&#160;the&#160;second&#160;file.&#160;Another&#160;way&#160;we&#160;can&#160;change&#160;buffers&#160;is&#160;to&#160;use&#160;the<br/>
156<br/>
<hr/>
<a name=181></a>Editing&#160;Multiple&#160;Files<br/>
:bn&#160;&#160;(short&#160;for&#160;buffer&#160;next)&#160;and&#160;&#160;:bp&#160;&#160;(short&#160;for&#160;buffer&#160;previous)&#160;commands&#160;mentioned<br/>earlier.<br/>
Opening&#160;Additional&#160;Files&#160;for&#160;Editing<br/>It's&#160;also&#160;possible&#160;to add files&#160;to our current&#160;editing session.&#160;The&#160;ex&#160;command&#160;:e&#160;(short&#160;for<br/>“edit”)&#160;followed&#160;by&#160;a&#160;filename&#160;will&#160;open&#160;an&#160;additional&#160;file.&#160;Let's&#160;end&#160;our&#160;current&#160;editing<br/>session and&#160;return to&#160;the&#160;command line.<br/>Start&#160;vi&#160;again with just&#160;one&#160;file.<br/>
[me@linuxbox ~]$&#160;<b>vi foo.txt</b><br/>
To add our second file, enter&#160;the&#160;following:<br/>
<b>:e ls-output.txt</b><br/>
It&#160;should appear&#160;on the&#160;screen.&#160;The&#160;first&#160;file&#160;is&#160;still&#160;present&#160;as&#160;we&#160;can verify.<br/>
<b>:buffers<br/></b>&#160; 1 # &#160; &#160;&#34;foo.txt&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;line 1<br/>&#160; 2 %a &#160; &#34;ls-output.txt&#34; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;line 0<br/>Press ENTER or type command to continue<br/>
Copying&#160;Content&#160;from&#160;One&#160;File&#160;into&#160;Another<br/>Often&#160;while&#160;editing&#160;multiple&#160;files,&#160;we&#160;will&#160;want&#160;to&#160;copy&#160;a&#160;portion&#160;of&#160;one&#160;file&#160;into&#160;another<br/>file&#160;that&#160;we&#160;are&#160;editing.&#160;This&#160;is&#160;easily&#160;done&#160;using&#160;the&#160;usual&#160;yank&#160;and&#160;paste&#160;commands&#160;we<br/>used&#160;earlier.&#160;We&#160;can&#160;demonstrate&#160;as&#160;follows.&#160;First,&#160;using&#160;our&#160;two&#160;files,&#160;switch&#160;to&#160;buffer&#160;1<br/>(foo.txt)&#160;by entering&#160;this:<br/>
<b>:buffer 1</b><br/>
That&#160;should&#160;give&#160;us&#160;this:<br/>
157<br/>
<hr/>
<a name=182></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/>
Next, move&#160;the&#160;cursor to the&#160;first&#160;line, and&#160;type&#160;yy&#160;to&#160;yank (copy) the&#160;line.<br/>Switch to the&#160;second buffer by entering the&#160;following:<br/>
<b>:buffer 2</b><br/>
The&#160;screen&#160;will&#160;now&#160;contain some&#160;file&#160;listings&#160;like&#160;this&#160;(only&#160;a&#160;portion&#160;is&#160;shown here):<br/>
total 343700<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 31316 2017-12-05 08:58 [<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;8240 2017-12-09 13:39 411toppm<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160;111276 2018-01-31 13:36 a2p<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 25368 2016-10-06 20:16 a52dec<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 11532 2017-05-04 17:43 aafire<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;7292 2017-05-04 17:43 aainfo<br/>
Move&#160;the&#160;cursor&#160;to&#160;the&#160;first&#160;line&#160;and&#160;paste&#160;the&#160;line&#160;we&#160;copied&#160;from&#160;the&#160;preceding&#160;file&#160;by<br/>typing the&#160;p&#160;command.<br/>
total 343700<br/><b>The quick brown fox jumped over the lazy dog. It was cool.<br/></b>-rwxr-xr-x 1 root root &#160; &#160; &#160; 31316 2017-12-05 08:58 [<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;8240 2017-12-09 13:39 411toppm<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160;111276 2018-01-31 13:36 a2p<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 25368 2016-10-06 20:16 a52dec<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 11532 2017-05-04 17:43 aafire<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;7292 2017-05-04 17:43 aainfo<br/>
Inserting&#160;an&#160;Entire&#160;File&#160;into&#160;Another<br/>It's&#160;also&#160;possible&#160;to&#160;insert&#160;an&#160;entire&#160;file&#160;into&#160;one&#160;that&#160;we&#160;are&#160;editing.&#160;To&#160;see&#160;this&#160;in&#160;action,<br/>let's&#160;end our&#160;vi&#160;session and start&#160;a&#160;new&#160;one&#160;with just&#160;a&#160;single&#160;file.<br/>
158<br/>
<hr/>
<a name=183></a>Editing&#160;Multiple&#160;Files<br/>
[me@linuxbox ~]$&#160;<b>vi ls-output.txt</b><br/>
We&#160;will&#160;see&#160;our file&#160;listing again.<br/>
total 343700<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 31316 2017-12-05 08:58 [<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;8240 2017-12-09 13:39 411toppm<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160;111276 2018-01-31 13:36 a2p<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 25368 2016-10-06 20:16 a52dec<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 11532 2017-05-04 17:43 aafire<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;7292 2017-05-04 17:43 aainfo<br/>
Move&#160;the&#160;cursor to&#160;the&#160;third&#160;line,&#160;and then&#160;enter the&#160;following&#160;ex command:<br/>
<b>:r foo.txt</b><br/>
The&#160;:r&#160;command&#160;(short&#160;for&#160;“read”)&#160;inserts&#160;the&#160;specified&#160;file&#160;below&#160;the&#160;cursor&#160;position.<br/>Our screen&#160;should now&#160;look like&#160;this:<br/>
total 343700<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 31316 2017-12-05 08:58 [<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;8240 2017-12-09 13:39 411toppm<br/><b>The quick brown fox jumped over the lazy dog. It was cool.<br/>Line 2<br/>Line 3<br/>Line 4<br/>Line 5<br/></b>-rwxr-xr-x 1 root root &#160; &#160; &#160;111276 2018-01-31 13:36 a2p<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 25368 2016-10-06 20:16 a52dec<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; 11532 2017-05-04 17:43 aafire<br/>-rwxr-xr-x 1 root root &#160; &#160; &#160; &#160;7292 2017-05-04 17:43 aainfo<br/>
<b>Saving&#160;Our&#160;Work<br/></b>Like&#160;everything&#160;else&#160;in&#160;vi,&#160;there&#160;are&#160;several&#160;different&#160;ways&#160;to&#160;save&#160;our&#160;edited&#160;files.&#160;We<br/>have&#160;already&#160;covered&#160;the&#160;ex&#160;command&#160;:w,&#160;but&#160;there&#160;are&#160;some&#160;others&#160;we&#160;may&#160;also&#160;find<br/>helpful.<br/>In&#160;command&#160;mode,&#160;typing&#160;&#160;ZZ&#160;&#160;will&#160;save&#160;the&#160;current&#160;file&#160;and&#160;exit&#160;&#160;vi.&#160;Likewise,&#160;the&#160;ex<br/>
159<br/>
<hr/>
<a name=184></a>12 –&#160;A&#160;Gentle&#160;Introduction to&#160;vi<br/>
command&#160;:wq&#160;will&#160;combine&#160;the&#160;:w&#160;and&#160;:q&#160;commands&#160;into&#160;one&#160;that&#160;will&#160;both&#160;save&#160;the<br/>file&#160;and exit.<br/>The&#160;:w&#160;command&#160;may&#160;also&#160;specify&#160;an&#160;optional&#160;filename.&#160;This&#160;acts&#160;like&#160;“Save&#160;As...”&#160;For<br/>example,&#160;if&#160;we&#160;were&#160;editing&#160;&#160;foo.txt&#160;&#160;and&#160;wanted&#160;to&#160;save&#160;an&#160;alternate&#160;version&#160;called<br/>foo1.txt, we&#160;would&#160;enter&#160;the&#160;following:<br/>
<b>:w foo1.txt</b><br/>
<b>Note:</b>&#160;While&#160;this&#160;command&#160;saves&#160;the&#160;file&#160;under&#160;a&#160;new&#160;name,&#160;it&#160;does&#160;not&#160;change<br/>the&#160;name&#160;of the&#160;file&#160;we&#160;are&#160;editing.&#160;As&#160;we&#160;continue&#160;to&#160;edit,&#160;we&#160;will&#160;still&#160;be&#160;editing<br/>foo.txt, not&#160;foo1.txt.<br/>
<b>Summing&#160;Up<br/></b>With&#160;this&#160;basic&#160;set&#160;of&#160;skills,&#160;we&#160;can&#160;now&#160;perform&#160;most&#160;of&#160;the&#160;text&#160;editing&#160;needed&#160;to&#160;main&#160;-<br/>tain&#160;a&#160;typical&#160;Linux&#160;system.&#160;Learning&#160;to&#160;use&#160;vim&#160;on&#160;a&#160;regular&#160;basis&#160;will&#160;pay&#160;off&#160;in&#160;the<br/>long run. Since&#160;vi-style&#160;editors&#160;are&#160;so deeply embedded in&#160;Unix&#160;culture,&#160;we&#160;will&#160;see&#160;many<br/>other&#160;programs&#160;that&#160;have&#160;been&#160;influenced&#160;by&#160;its&#160;design.&#160;less&#160;is&#160;a&#160;good&#160;example&#160;of&#160;this<br/>influence.<br/>
<b>Further&#160;Reading<br/></b>Even&#160;with&#160;all&#160;that&#160;we&#160;have&#160;covered&#160;in&#160;this&#160;chapter,&#160;we&#160;have&#160;barely&#160;scratched&#160;the&#160;surface<br/>of&#160;what&#160;vi&#160;and&#160;vim&#160;can&#160;do.&#160;Here&#160;are&#160;a&#160;couple&#160;of&#160;on-line&#160;resources&#160;you&#160;can&#160;use&#160;to&#160;con-<br/>tinue&#160;your journey towards&#160;vi&#160;mastery:<br/>
●<br/>
<i>Vim, with&#160;Vigor&#160;–&#160;</i>A&#160;follow&#160;up tutorial&#160;to&#160;this&#160;one&#160;on LinuxCommand.org&#160;that&#160;<br/>brings&#160;the&#160;reader up to an&#160;intermediate&#160;level&#160;of skill.&#160;You can&#160;find it&#160;at:<br/><a href="http://linuxcommand.org/lc3_adv_vimvigor.php">http://linuxcommand.org/lc3_adv_vimvigor.php</a><br/>
●<br/>
<i>Learning&#160;The&#160;vi&#160;Editor</i>&#160;–&#160;A&#160;Wikibook&#160;from&#160;Wikipedia&#160;that&#160;offers&#160;a&#160;concise&#160;guide&#160;<br/>to&#160;vi&#160;and&#160;several&#160;of its&#160;work-a-likes&#160;including&#160;vim. It's&#160;available&#160;at:<br/><a href="http://en.wikibooks.org/wiki/Vi">http://en.wikibooks.org/wiki/Vi</a><br/>
●<br/>
<i>The&#160;Vim&#160;Book</i>&#160;-&#160;The&#160;vim&#160;project&#160;has&#160;a&#160;570-page&#160;book that&#160;covers&#160;(almost) all&#160;of&#160;<br/>the&#160;features&#160;in&#160;vim.&#160;You can find it&#160;at:<br/><a href="ftp://ftp.vim.org/pub/vim/doc/book/vimbook-OPL.pdf">ft</a><br/>
<a href="ftp://ftp.vim.org/pub/vim/doc/book/vimbook-OPL.pdf">&#160;&#160;p://ftp.vim.org/pub/vim/doc/book/vimbook-OPL.pdf&#160;.&#160;</a><br/>
●<br/>
A&#160;Wikipedia&#160;article&#160;on Bill&#160;Joy, the&#160;creator&#160;of&#160;vi.:<br/><a href="http://en.wikipedia.org/wiki/Bill_Joy">http://en.wikipedia.org/wiki/Bill_Joy</a><br/>
160<br/>
<hr/>
<a name=185></a>Further&#160;Reading<br/>
●<br/>
A&#160;Wikipedia&#160;article&#160;on Bram&#160;Moolenaar,&#160;the&#160;author&#160;of&#160;vim:<br/><a href="http://en.wikipedia.org/wiki/Bram_Moolenaar">http://en.wikipedia.org/wiki/Bram_Moolenaar</a><br/>
161<br/>
<hr/>
<a name=186></a>13 – Customizing the&#160;Prompt<br/>
<i><b>13&#160;–&#160;Customizing&#160;the&#160;Prompt</b></i><br/>
In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;a&#160;seemingly&#160;trivial&#160;detail — our&#160;shell&#160;prompt.&#160;This&#160;exami-<br/>nation&#160;will&#160;reveal&#160;some&#160;of&#160;the&#160;inner&#160;workings&#160;of&#160;the&#160;shell&#160;and&#160;the&#160;terminal&#160;emulator&#160;pro-<br/>gram.<br/>Like&#160;so&#160;many&#160;things&#160;in&#160;Linux,&#160;the&#160;shell&#160;prompt&#160;is&#160;highly&#160;configurable,&#160;and&#160;while&#160;we&#160;have<br/>pretty&#160;much&#160;taken&#160;it&#160;for&#160;granted,&#160;the&#160;prompt&#160;is&#160;a&#160;really&#160;useful&#160;device&#160;once&#160;we&#160;learn&#160;how<br/>to control&#160;it.<br/>
<b>Anatomy&#160;of&#160;a&#160;Prompt<br/></b>Our default&#160;prompt&#160;looks&#160;something like&#160;this:<br/>
[me@linuxbox ~]$<br/>
Notice&#160;that&#160;it&#160;contains&#160;our&#160;username,&#160;our&#160;hostname,&#160;and&#160;our&#160;current&#160;working&#160;directory,<br/>but&#160;how&#160;did&#160;it&#160;get&#160;that&#160;way?&#160;Very&#160;simply,&#160;it&#160;turns&#160;out.&#160;The&#160;prompt&#160;is&#160;defined&#160;by&#160;an&#160;envi-<br/>ronment&#160;variable&#160;named&#160;PS1&#160;(short&#160;for&#160;“prompt&#160;string&#160;1”).&#160;We&#160;can&#160;view&#160;the&#160;contents&#160;of<br/>PS1&#160;with the&#160;echo&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>echo $PS1<br/></b>[\u@\h \W]\$<br/>
<b>Note:</b>&#160;Don't&#160;worry&#160;if&#160;your&#160;results&#160;are&#160;not&#160;the&#160;same&#160;as&#160;the&#160;example&#160;above.&#160;Every<br/>Linux&#160;distribution&#160;defines&#160;the&#160;prompt&#160;string&#160;a&#160;little&#160;differently,&#160;some&#160;quite&#160;exoti-<br/>cally.<br/>
From&#160;the&#160;results,&#160;we&#160;can&#160;see&#160;that&#160;&#160;PS1&#160;&#160;contains&#160;a&#160;few&#160;of&#160;the&#160;characters&#160;we&#160;see&#160;in&#160;our<br/>prompt&#160;such&#160;as&#160;the&#160;brackets,&#160;the&#160;at-sign,&#160;and&#160;the&#160;dollar&#160;sign,&#160;but&#160;the&#160;rest&#160;are&#160;a&#160;mystery.<br/>The&#160;astute&#160;among&#160;us&#160;will&#160;recognize&#160;these&#160;as&#160;&#160;<i>backslash-escaped&#160;special&#160;characters</i>&#160;&#160;like<br/>those&#160;we&#160;saw&#160;in&#160;Chapter&#160;7,&#160;“Seeing&#160;the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It.”&#160;Table&#160;13-1&#160;provides&#160;a<br/>
162<br/>
<hr/>
<a name=187></a>Anatomy of a&#160;Prompt<br/>
partial&#160;list&#160;of the&#160;characters&#160;that&#160;the&#160;bash&#160;treats&#160;specially&#160;in the&#160;prompt&#160;string.<br/>
<i>Table&#160;13-1: Escape&#160;Codes&#160;Used in&#160;Shell&#160;Prompts</i><br/>
<b>Sequence</b><br/>
<b>Value&#160;Displayed</b><br/>
\a<br/>
ASCII&#160;bell.&#160;This&#160;makes&#160;the&#160;computer&#160;beep when it&#160;is&#160;encountered.<br/>
\d<br/>
Current&#160;date&#160;in&#160;day, month,&#160;date&#160;format. For example,&#160;“Mon May&#160;<br/>26.”&#160;<br/>
\h<br/>
Hostname&#160;of the&#160;local&#160;machine&#160;minus&#160;the&#160;trailing&#160;domain&#160;name.<br/>
\H<br/>
Full&#160;hostname.<br/>
\j<br/>
Number of jobs&#160;running in&#160;the&#160;current&#160;shell&#160;session.<br/>
\l<br/>
Name&#160;of the&#160;current&#160;terminal&#160;device.<br/>
\n<br/>
A&#160;newline&#160;character.<br/>
\r<br/>
A&#160;carriage&#160;return.<br/>
\s<br/>
Name&#160;of the&#160;shell&#160;program.<br/>
\t<br/>
Current&#160;time&#160;in 24-hour hours:minutes:seconds&#160;format.<br/>
\T<br/>
Current&#160;time&#160;in 12-hour format.<br/>
\@<br/>
Current&#160;time&#160;in 12-hour&#160;AM/PM&#160;format.<br/>
\A<br/>
Current&#160;time&#160;in 24-hour hours:minutes&#160;format.<br/>
\u<br/>
Username&#160;of the&#160;current&#160;user.<br/>
\v<br/>
Version number&#160;of the&#160;shell.<br/>
\V<br/>
Version and&#160;release&#160;numbers&#160;of the&#160;shell.<br/>
\w<br/>
Name&#160;of the&#160;current&#160;working&#160;directory.<br/>
\W<br/>
Last&#160;part&#160;of the&#160;current&#160;working directory&#160;name.<br/>
\!<br/>
History&#160;number of the&#160;current&#160;command.<br/>
\#<br/>
Number of commands&#160;entered&#160;during this&#160;shell&#160;session.<br/>
\$<br/>
This&#160;displays&#160;a&#160;“$”&#160;character&#160;unless&#160;we&#160;have&#160;superuser privileges.&#160;<br/>In that&#160;case, it&#160;displays&#160;a&#160;“#”&#160;instead.<br/>
\[<br/>
Signals&#160;the&#160;start&#160;of a&#160;series&#160;of one&#160;or more&#160;non-printing&#160;characters.&#160;<br/>This&#160;is&#160;used to embed non-printing&#160;control&#160;characters&#160;that&#160;<br/>manipulate&#160;the&#160;terminal&#160;emulator&#160;in some&#160;way, such as&#160;moving&#160;the&#160;<br/>cursor or changing&#160;text&#160;colors.<br/>
163<br/>
<hr/>
<a name=188></a>13 – Customizing the&#160;Prompt<br/>
\]<br/>
Signals&#160;the&#160;end of a&#160;non-printing character&#160;sequence.<br/>
<b>Trying&#160;Some&#160;Alternative&#160;Prompt&#160;Designs<br/></b>With&#160;this&#160;list&#160;of&#160;special&#160;characters,&#160;we&#160;can&#160;change&#160;the&#160;prompt&#160;to&#160;see&#160;the&#160;effect.&#160;First,&#160;we'll<br/>back&#160;up&#160;the&#160;existing&#160;prompt&#160;string&#160;so&#160;we&#160;can&#160;restore&#160;it&#160;later.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;copy&#160;the<br/>existing&#160;string into&#160;another&#160;shell&#160;variable&#160;that&#160;we&#160;create&#160;ourselves.<br/>
[me@linuxbox ~]$&#160;<b>ps1_old=&#34;$PS1&#34;</b><br/>
We&#160;create&#160;a&#160;new&#160;variable&#160;called&#160;ps1_old&#160;and&#160;assign&#160;the&#160;value&#160;of&#160;PS1&#160;to&#160;it.&#160;We&#160;can&#160;ver-<br/>ify that&#160;the&#160;string has&#160;been copied by using the&#160;echo&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>echo $ps1_old<br/></b>[\u@\h \W]\$<br/>
We&#160;can&#160;restore&#160;the&#160;original&#160;prompt&#160;at&#160;any&#160;time&#160;during&#160;our&#160;terminal&#160;session&#160;by&#160;simply&#160;re-<br/>versing the&#160;process.<br/>
[me@linuxbox ~]$&#160;<b>PS1=&#34;$ps1_old&#34;</b><br/>
Now&#160;that&#160;we&#160;are&#160;ready&#160;to&#160;proceed,&#160;let's&#160;see&#160;what&#160;happens&#160;if&#160;we&#160;have&#160;an&#160;empty&#160;prompt<br/>string.<br/>
[me@linuxbox ~]$&#160;<b>PS1=</b><br/>
If&#160;we&#160;assign&#160;nothing&#160;to&#160;the&#160;prompt&#160;string,&#160;we&#160;get&#160;nothing.&#160;No&#160;prompt&#160;string&#160;at&#160;all!&#160;The<br/>prompt&#160;is&#160;still&#160;there,&#160;but&#160;displays&#160;nothing,&#160;just&#160;as&#160;we&#160;asked&#160;it&#160;to&#160;do.&#160;Since&#160;this&#160;is&#160;kind&#160;of<br/>disconcerting to&#160;look at, we'll&#160;replace&#160;it&#160;with a&#160;minimal&#160;prompt.<br/>
<b>PS1=&#34;\$ &#34;</b><br/>
That's&#160;better.&#160;At&#160;least&#160;now&#160;we&#160;can&#160;see&#160;what&#160;we&#160;are&#160;doing.&#160;Notice&#160;the&#160;trailing&#160;space&#160;within<br/>the&#160;double&#160;quotes.&#160;This&#160;provides&#160;the&#160;space&#160;between&#160;the&#160;dollar&#160;sign&#160;and&#160;the&#160;cursor&#160;when<br/>the&#160;prompt&#160;is&#160;displayed.<br/>Let's&#160;add a&#160;bell&#160;to&#160;our prompt.<br/>
164<br/>
<hr/>
<a name=189></a>Trying&#160;Some&#160;Alternative&#160;Prompt&#160;Designs<br/>
$&#160;<b>PS1=&#34;\[\a\]\$ &#34;</b><br/>
Now&#160;we&#160;should&#160;hear&#160;a&#160;beep&#160;each&#160;time&#160;the&#160;prompt&#160;is&#160;displayed,&#160;though&#160;some&#160;systems&#160;dis-<br/>able&#160;this&#160;“feature.”&#160;This&#160;could&#160;get&#160;annoying,&#160;but&#160;it&#160;might&#160;be&#160;useful&#160;if&#160;we&#160;needed&#160;notifica-<br/>tion&#160;when&#160;an&#160;especially&#160;long-running&#160;command&#160;has&#160;been&#160;executed.&#160;Note&#160;that&#160;we&#160;included<br/>the&#160;\[&#160;and&#160;\]&#160;sequences.&#160;Since&#160;the&#160;ASCII&#160;bell&#160;(\a)&#160;does&#160;not&#160;“print,”&#160;that&#160;is,&#160;it&#160;does&#160;not<br/>move&#160;the&#160;cursor,&#160;we&#160;need&#160;to&#160;tell&#160;&#160;bash&#160;&#160;so&#160;it&#160;can&#160;correctly&#160;determine&#160;the&#160;length&#160;of&#160;the<br/>prompt.<br/>Next,&#160;let's&#160;try&#160;to&#160;make&#160;an&#160;informative&#160;prompt&#160;with&#160;some&#160;hostname&#160;and&#160;time-of-day&#160;infor-<br/>mation.<br/>
$&#160;<b>PS1=&#34;\A \h \$ &#34;<br/></b>17:33 linuxbox $<br/>
Adding&#160;time-of-day&#160;to&#160;our&#160;prompt&#160;will&#160;be&#160;useful&#160;if&#160;we&#160;need&#160;to&#160;keep&#160;track&#160;of&#160;when&#160;we<br/>perform&#160;certain&#160;tasks. Finally,&#160;we'll&#160;make&#160;a&#160;new&#160;prompt&#160;that&#160;is&#160;similar&#160;to our original.<br/>
17:37 linuxbox $&#160;<b>PS1=&#34;&lt;\u@\h \W&gt;\$ &#34;<br/></b>&lt;me@linuxbox ~&gt;$<br/>
Try&#160;the&#160;other&#160;sequences&#160;listed&#160;in&#160;the&#160;table&#160;above&#160;and&#160;see&#160;whether&#160;you&#160;can&#160;come&#160;up&#160;with&#160;a<br/>brilliant&#160;new&#160;prompt.<br/>
<b>Adding&#160;Color<br/></b>Most&#160;terminal&#160;emulator&#160;programs&#160;respond&#160;to&#160;certain&#160;non-printing&#160;character&#160;sequences&#160;to<br/>control&#160;such&#160;things&#160;as&#160;character&#160;attributes&#160;(such&#160;as&#160;color,&#160;bold&#160;text,&#160;and&#160;the&#160;dreaded&#160;blink-<br/>ing&#160;text)&#160;and&#160;cursor&#160;position.&#160;We'll&#160;cover&#160;cursor&#160;position&#160;in&#160;a&#160;little&#160;bit,&#160;but&#160;first&#160;we'll&#160;look<br/>at&#160;color.<br/>
<b>Terminal&#160;Confusion</b><br/>
Back&#160;in&#160;ancient&#160;times,&#160;when&#160;&#160;terminals&#160;&#160;were&#160;hooked&#160;to&#160;remote&#160;computers,&#160;there<br/>were&#160;many&#160;competing&#160;brands&#160;of&#160;terminals&#160;and&#160;they&#160;all&#160;worked&#160;differently.&#160;They<br/>had&#160;different&#160;keyboards,&#160;and&#160;they&#160;all&#160;had&#160;different&#160;ways&#160;of&#160;interpreting&#160;control&#160;in-<br/>formation.&#160;Unix&#160;and&#160;Unix-like&#160;systems&#160;have&#160;two&#160;rather&#160;complex&#160;subsystems&#160;to<br/>
165<br/>
<hr/>
<a name=190></a>13 – Customizing the&#160;Prompt<br/>
deal&#160;with&#160;the&#160;babel&#160;of&#160;terminal&#160;control&#160;(called&#160;termcap&#160;and&#160;terminfo).&#160;If&#160;you<br/>look&#160;in&#160;the&#160;deepest&#160;recesses&#160;of&#160;your&#160;terminal&#160;emulator&#160;settings,&#160;you&#160;may&#160;find&#160;a<br/>setting&#160;for the&#160;type&#160;of terminal&#160;emulation.<br/>In&#160;an&#160;effort&#160;to&#160;make&#160;terminals&#160;speak&#160;some&#160;sort&#160;of&#160;common&#160;language,&#160;the&#160;Ameri-<br/>can&#160;National&#160;Standards&#160;Institute&#160;(ANSI)&#160;developed&#160;a&#160;standard&#160;set&#160;of&#160;character&#160;se-<br/>quences&#160;to&#160;control&#160;video&#160;terminals.&#160;Old-time&#160;DOS&#160;users&#160;will&#160;remember&#160;the&#160;AN-<br/>SI.SYS&#160;file&#160;that&#160;was&#160;used to enable&#160;interpretation&#160;of these&#160;codes.<br/>
Character&#160;color&#160;is&#160;controlled&#160;by&#160;sending&#160;the&#160;terminal&#160;emulator&#160;an&#160;<i>ANSI&#160;escape&#160;code</i>&#160;em-<br/>bedded&#160;in&#160;the&#160;stream&#160;of&#160;characters&#160;to&#160;be&#160;displayed.&#160;The&#160;control&#160;code&#160;does&#160;not&#160;“print&#160;out”<br/>on&#160;the&#160;display;&#160;rather,&#160;it&#160;is&#160;interpreted&#160;by&#160;the&#160;terminal&#160;as&#160;an&#160;instruction.&#160;As&#160;we&#160;saw&#160;in&#160;the<br/>table&#160;above,&#160;the&#160;\[&#160;and&#160;\]&#160;sequences&#160;are&#160;used&#160;to&#160;encapsulate&#160;non-printing&#160;characters.&#160;An<br/>ANSI&#160;escape&#160;code&#160;begins&#160;with&#160;an&#160;octal&#160;033&#160;(the&#160;code&#160;generated&#160;by&#160;the&#160;&#160;Esc&#160;key),&#160;fol-<br/>lowed&#160;by&#160;an&#160;optional&#160;character&#160;attribute,&#160;followed&#160;by&#160;an&#160;instruction.&#160;For&#160;example,&#160;the<br/>code&#160;to&#160;set&#160;the&#160;text&#160;color&#160;to normal&#160;(attribute&#160;=&#160;0), black&#160;text&#160;is&#160;as&#160;follows:<br/>\033[0;30m<br/>Table&#160;13-2&#160;lists&#160;the&#160;available&#160;text&#160;colors.&#160;Notice&#160;that&#160;the&#160;colors&#160;are&#160;divided&#160;into&#160;two<br/>groups,&#160;differentiated&#160;by&#160;the&#160;application&#160;of&#160;the&#160;bold&#160;character&#160;attribute&#160;(1),&#160;which&#160;creates<br/>the&#160;appearance&#160;of “light”&#160;colors.<br/>
<i>Table&#160;13-&#160;2: Escape&#160;Sequences&#160;Used to Set&#160;Text&#160;Colors</i><br/>
<b>Sequence</b><br/>
<b>Text&#160;Color</b><br/>
<b>Sequence</b><br/>
<b>Text&#160;Color</b><br/>
\033[0;30m<br/>
Black<br/>
\033[1;30m<br/>
Dark gray<br/>
\033[0;31m<br/>
Red<br/>
\033[1;31m<br/>
Light&#160;red<br/>
\033[0;32m<br/>
Green<br/>
\033[1;32m<br/>
Light&#160;green<br/>
\033[0;33m<br/>
Brown<br/>
\033[1;33m<br/>
Yellow<br/>
\033[0;34m<br/>
Blue<br/>
\033[1;34m<br/>
Light&#160;blue<br/>
\033[0;35m<br/>
Purple<br/>
\033[1;35m<br/>
Light&#160;purple<br/>
\033[0;36m<br/>
Cyan<br/>
\033[1;36m<br/>
Light&#160;cyan<br/>
\033[0;37m<br/>
Light&#160;gray<br/>
\033[1;37m<br/>
White<br/>
Let's&#160;try to&#160;make&#160;a&#160;red prompt.&#160;We'll&#160;insert&#160;the&#160;escape&#160;code&#160;at&#160;the&#160;beginning.<br/>
166<br/>
<hr/>
<a name=191></a>Adding&#160;Color<br/>
&lt;me@linuxbox ~&gt;$&#160;<b>PS1=&#34;\[\033[0;31m\]&lt;\u@\h \W&gt;\$ &#34;<br/></b>&lt;me@linuxbox ~&gt;$<br/>
That&#160;works,&#160;but&#160;notice&#160;that&#160;all&#160;the&#160;text&#160;that&#160;we&#160;type&#160;after&#160;the&#160;prompt&#160;will&#160;also&#160;display&#160;in<br/>red.&#160;To fix this, we&#160;will&#160;add another escape&#160;code&#160;to&#160;the&#160;end of the&#160;prompt&#160;that&#160;tells&#160;the&#160;ter-<br/>minal&#160;emulator&#160;to return to&#160;the&#160;previous&#160;color.<br/>
&lt;me@linuxbox ~&gt;$&#160;<b>PS1=&#34;\[\033[0;31m\]&lt;\u@\h \W&gt;\$\[\033[0m\] &#34;<br/></b>&lt;me@linuxbox ~&gt;$<br/>
That's&#160;better!<br/>It's&#160;also&#160;possible&#160;to&#160;set&#160;the&#160;text&#160;background&#160;color&#160;using&#160;the&#160;codes&#160;listed&#160;Table&#160;13-3.&#160;The<br/>background colors&#160;do not&#160;support&#160;the&#160;bold&#160;attribute.<br/>
<i>Table&#160;13-3: Escape&#160;Sequences&#160;Used to Set&#160;Background Color</i><br/>
<b>Sequence</b><br/>
<b>Background&#160;Color</b><br/>
<b>Sequence</b><br/>
<b>Background&#160;Color</b><br/>
\033[0;40m<br/>
Black<br/>
\033[0;44m<br/>
Blue<br/>
\033[0;41m<br/>
Red<br/>
\033[0;45m<br/>
Purple<br/>
\033[0;42m<br/>
Green<br/>
\033[0;46m<br/>
Cyan<br/>
\033[0;43m<br/>
Brown<br/>
\033[0;47m<br/>
Light&#160;gray<br/>
We&#160;can&#160;create&#160;a&#160;prompt&#160;with&#160;a&#160;red&#160;background&#160;by&#160;applying&#160;a&#160;simple&#160;change&#160;to&#160;the&#160;first<br/>escape&#160;code.<br/>
&lt;me@linuxbox ~&gt;$&#160;<b>PS1=&#34;\[\033[0;41m\]&lt;\u@\h \W&gt;\$\[\033[0m\] &#34;<br/></b>&lt;me@linuxbox ~&gt;$<br/>
Try the&#160;color codes&#160;and see&#160;what&#160;you can create!<br/>
<b>Note:</b>&#160;Besides&#160;the&#160;normal&#160;(0)&#160;and&#160;bold&#160;(1)&#160;character&#160;attributes,&#160;text&#160;may&#160;be&#160;given<br/>underscore&#160;(4),&#160;blinking&#160;(5),&#160;and&#160;inverse&#160;(7)&#160;attributes.&#160;In&#160;the&#160;interests&#160;of&#160;good<br/>taste, many&#160;terminal&#160;emulators&#160;refuse&#160;to honor the&#160;blinking&#160;attribute,&#160;however.<br/>
167<br/>
<hr/>
<a name=192></a>13 – Customizing the&#160;Prompt<br/>
<b>Moving&#160;the&#160;Cursor<br/></b>Escape&#160;codes&#160;can&#160;be&#160;used&#160;to&#160;position&#160;the&#160;cursor.&#160;This&#160;is&#160;commonly&#160;used&#160;to&#160;provide&#160;a<br/>clock&#160;or some&#160;other kind&#160;of information at&#160;a&#160;different&#160;location&#160;on the&#160;screen,&#160;such&#160;as&#160;in an<br/>upper&#160;corner&#160;each&#160;time&#160;the&#160;prompt&#160;is&#160;drawn.&#160;Table&#160;13-4&#160;lists&#160;the&#160;escape&#160;codes&#160;that&#160;posi-<br/>tion the&#160;cursor.<br/>
<i>Table&#160;13-4: Cursor&#160;Movement&#160;Escape&#160;Sequences</i><br/>
<b>Escape&#160;Code</b><br/>
<b>Action</b><br/>
\033[<i>l</i>;<i>c</i>H<br/>
Move&#160;the&#160;cursor to&#160;line&#160;<i>l</i>&#160;and column&#160;<i>c</i><br/>
\033[<i>n</i>A<br/>
Move&#160;the&#160;cursor up&#160;<i>n</i>&#160;lines<br/>
\033[<i>n</i>B<br/>
Move&#160;the&#160;cursor down&#160;<i>n</i>&#160;lines<br/>
\033[<i>n</i>C<br/>
Move&#160;the&#160;cursor forward&#160;<i>n</i>&#160;characters<br/>
\033[<i>n</i>D<br/>
Move&#160;the&#160;cursor backward&#160;<i>n</i>&#160;characters<br/>
\033[2J<br/>
Clear&#160;the&#160;screen&#160;and move&#160;the&#160;cursor to the&#160;upper-left&#160;corner (line&#160;<br/>0, column&#160;0)<br/>
\033[K<br/>
Clear&#160;from&#160;the&#160;cursor position to the&#160;end of the&#160;current&#160;line<br/>
\033[s<br/>
Store&#160;the&#160;current&#160;cursor position<br/>
\033[u<br/>
Recall&#160;the&#160;stored cursor position<br/>
Using&#160;the&#160;codes&#160;in&#160;Table&#160;13-4,&#160;we'll&#160;construct&#160;a&#160;prompt&#160;that&#160;draws&#160;a&#160;red&#160;bar&#160;at&#160;the&#160;top&#160;of<br/>the&#160;screen&#160;containing&#160;a&#160;clock&#160;(rendered&#160;in&#160;yellow&#160;text)&#160;each&#160;time&#160;the&#160;prompt&#160;is&#160;displayed.<br/>The&#160;code&#160;for the&#160;prompt&#160;is&#160;this&#160;formidable-looking&#160;string:<br/>
<b>PS1=&#34;\[\033[s\033[0;0H\033[0;41m\033[K\033[1;33m\t\033[0m\033[u\]<br/>&lt;\u@\h \W&gt;\$ &#34;</b><br/>
Table&#160;13-5 outlines&#160;what&#160;each part&#160;of the&#160;string does.<br/>
<i>Table&#160;13-5: Breakdown of&#160;Complex&#160;Prompt&#160;String</i><br/>
<b>Sequence</b><br/>
<b>Action</b><br/>
\[<br/>
Begin a&#160;non-printing&#160;character sequence.&#160;The&#160;purpose&#160;of this&#160;is&#160;<br/>to allow&#160;bash&#160;to properly&#160;calculate&#160;the&#160;size&#160;of the&#160;visible&#160;<br/>prompt.&#160;Without&#160;an accurate&#160;calculation,&#160;command line&#160;editing&#160;<br/>features&#160;cannot&#160;position the&#160;cursor correctly.<br/>
168<br/>
<hr/>
<a name=193></a>Moving&#160;the&#160;Cursor<br/>
\033[s<br/>
Store&#160;the&#160;cursor position.&#160;This&#160;is&#160;needed to&#160;return to the&#160;prompt&#160;<br/>location after the&#160;bar and clock have&#160;been drawn at&#160;the&#160;top of&#160;<br/>the&#160;screen.&#160;<i>Be&#160;aware&#160;that&#160;some&#160;terminal&#160;emulators&#160;do not&#160;<br/>recognize&#160;this&#160;code.</i><br/>
\033[0;0H<br/>
Move&#160;the&#160;cursor to&#160;the&#160;upper-left&#160;corner,&#160;which&#160;is&#160;line&#160;0,&#160;<br/>column&#160;0.<br/>
\033[0;41m<br/>
Set&#160;the&#160;background color&#160;to red.<br/>
\033[K<br/>
Clear&#160;from&#160;the&#160;current&#160;cursor location&#160;(the&#160;top-left&#160;corner) to&#160;<br/>the&#160;end&#160;of the&#160;line. Since&#160;the&#160;background&#160;color is&#160;now&#160;red, the&#160;<br/>line&#160;is&#160;cleared to that&#160;color, creating our bar. Note&#160;that&#160;clearing&#160;<br/>to the&#160;end of the&#160;line&#160;does&#160;not&#160;change&#160;the&#160;cursor position,&#160;which<br/>remains&#160;in the&#160;upper-left&#160;corner.<br/>
\033[1;33m<br/>
Set&#160;the&#160;text&#160;color to&#160;yellow.<br/>
\t<br/>
Display the&#160;current&#160;time.&#160;While&#160;this&#160;is&#160;a&#160;“printing”&#160;element,&#160;we&#160;<br/>still&#160;include&#160;it&#160;in the&#160;non-printing&#160;portion of the&#160;prompt&#160;since&#160;<br/>we&#160;don't&#160;want&#160;bash&#160;to include&#160;the&#160;clock&#160;when&#160;calculating&#160;the&#160;<br/>true&#160;size&#160;of the&#160;displayed prompt.<br/>
\033[0m<br/>
Turn off color.&#160;This&#160;affects&#160;both&#160;the&#160;text&#160;and the&#160;background.<br/>
\033[u<br/>
Restore&#160;the&#160;cursor position saved&#160;earlier.<br/>
\]<br/>
End the&#160;non-printing&#160;characters&#160;sequence.<br/>
&lt;\u@\h \W&gt;\$<br/>
Prompt&#160;string.<br/>
<b>Saving&#160;the&#160;Prompt<br/></b>Obviously,&#160;we&#160;don't&#160;want&#160;to&#160;be&#160;typing&#160;that&#160;monster&#160;all&#160;the&#160;time,&#160;so&#160;we'll&#160;want&#160;to&#160;store&#160;our<br/>prompt&#160;someplace.&#160;We&#160;can&#160;make&#160;the&#160;prompt&#160;permanent&#160;by&#160;adding&#160;it&#160;to&#160;our&#160;&#160;.bashrc<br/>file.&#160;To do so, add these&#160;two lines&#160;to&#160;the&#160;file:<br/>
<b>PS1=&#34;\[\033[s\033[0;0H\033[0;41m\033[K\033[1;33m\t\033[0m\033[u\]<br/>&lt;\u@\h \W&gt;\$ &#34;</b><br/>
<b>export PS1</b><br/>
<b>Summing&#160;Up<br/></b>Believe&#160;it&#160;or&#160;not,&#160;there&#160;is&#160;much&#160;more&#160;that&#160;can&#160;be&#160;done&#160;with&#160;prompts&#160;involving&#160;shell&#160;func-<br/>
169<br/>
<hr/>
<a name=194></a>13 – Customizing the&#160;Prompt<br/>
tions&#160;and&#160;scripts&#160;that&#160;we&#160;haven't&#160;covered&#160;here,&#160;but&#160;this&#160;is&#160;a&#160;good&#160;start.&#160;Not&#160;everyone&#160;will<br/>care&#160;enough to change&#160;the&#160;prompt, since&#160;the&#160;default&#160;prompt&#160;is&#160;usually&#160;satisfactory.&#160;But&#160;for<br/>those&#160;of&#160;us&#160;who&#160;like&#160;to&#160;tinker,&#160;the&#160;shell&#160;provides&#160;the&#160;opportunity&#160;for&#160;many&#160;hours&#160;of&#160;casual<br/>fun.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Prompt&#160;HOWTO</i>&#160;from&#160;the<a href="http://tldp.org/">&#160;Linux&#160;Documentation&#160;Project</a>&#160;provides&#160;a&#160;<br/>pretty&#160;complete&#160;discussion of what&#160;the&#160;shell&#160;prompt&#160;can&#160;be&#160;made&#160;to do. It&#160;is&#160;avail-<br/>able&#160;at:<br/><a href="http://tldp.org/HOWTO/Bash-Prompt-HOWTO/">http://tldp.org/HOWTO/Bash-Prompt-HOWTO/</a><br/>
●<br/>
Wikipedia&#160;has&#160;a&#160;good article&#160;on the&#160;ANSI Escape&#160;Codes:<br/><a href="http://en.wikipedia.org/wiki/ANSI_escape_code">http://en.wikipedia.org/wiki/ANSI_escape_code</a><br/>
170<br/>
<hr/>
<a name=195></a>Part&#160;3 – Common&#160;Tasks&#160;and Essential&#160;Tools<br/>
Part&#160;3&#160;–&#160;Common&#160;Tasks&#160;and&#160;Essential<br/>
Tools<br/>
171<br/>
<hr/>
<a name=196></a>14 – Package&#160;Management<br/>
<i><b>14&#160;–&#160;Package&#160;Management</b></i><br/>
If&#160;we&#160;spend&#160;any&#160;time&#160;in&#160;the&#160;Linux&#160;community,&#160;we&#160;hear&#160;many&#160;opinions&#160;as&#160;to&#160;which&#160;of&#160;the<br/>many&#160;Linux&#160;distributions&#160;is&#160;“best.”&#160;Often,&#160;these&#160;discussions&#160;get&#160;really&#160;silly,&#160;focusing&#160;on<br/>such&#160;things&#160;as&#160;the&#160;prettiness&#160;of&#160;the&#160;desktop&#160;background&#160;(some&#160;people&#160;won't&#160;use&#160;Ubuntu<br/>because&#160;of its&#160;default&#160;color&#160;scheme!) and&#160;other trivial&#160;matters.<br/>The&#160;most&#160;important&#160;determinant&#160;of&#160;distribution&#160;quality&#160;is&#160;the&#160;<i>packaging&#160;system</i>&#160;and&#160;the<br/>vitality&#160;of&#160;the&#160;distribution's&#160;support&#160;community.&#160;As&#160;we&#160;spend&#160;more&#160;time&#160;with&#160;Linux,&#160;we<br/>see&#160;that&#160;its&#160;software&#160;landscape&#160;is&#160;extremely&#160;dynamic.&#160;Things&#160;are&#160;constantly&#160;changing.<br/>Most&#160;of&#160;the&#160;top-tier&#160;Linux&#160;distributions&#160;release&#160;new&#160;versions&#160;every&#160;six&#160;months&#160;and&#160;many<br/>individual&#160;program&#160;updates&#160;every&#160;day.&#160;To&#160;keep&#160;up&#160;with&#160;this&#160;blizzard&#160;of&#160;software,&#160;we&#160;need<br/>good tools&#160;for&#160;<i>package&#160;management</i>.<br/>Package&#160;management&#160;is&#160;a&#160;method&#160;of&#160;installing&#160;and&#160;maintaining&#160;software&#160;on&#160;the&#160;system.<br/>Today,&#160;most&#160;people&#160;can&#160;satisfy&#160;all&#160;of&#160;their&#160;software&#160;needs&#160;by&#160;installing&#160;&#160;<i>packages</i>&#160;&#160;from<br/>their&#160;Linux&#160;distributor.&#160;This&#160;contrasts&#160;with&#160;the&#160;early&#160;days&#160;of&#160;Linux,&#160;when&#160;one&#160;had&#160;to<br/>download&#160;and&#160;compile&#160;<i>source&#160;code</i>&#160;to&#160;install&#160;software.&#160;There&#160;isn’t&#160;anything&#160;wrong&#160;with<br/>compiling&#160;source&#160;code;&#160;in&#160;fact,&#160;having&#160;access&#160;to&#160;&#160;source&#160;code&#160;&#160;is&#160;the&#160;great&#160;wonder&#160;of<br/>Linux.&#160;It&#160;gives&#160;us&#160;(and&#160;everybody&#160;else)&#160;the&#160;ability&#160;to&#160;examine&#160;and&#160;improve&#160;the&#160;system.<br/>It's&#160;just&#160;that&#160;having a&#160;precompiled package&#160;is&#160;faster&#160;and easier&#160;to deal&#160;with.<br/>In this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;some&#160;of&#160;the&#160;command&#160;line&#160;tools&#160;used&#160;for&#160;package&#160;manage-<br/>ment.&#160;While&#160;all&#160;the&#160;major&#160;distributions&#160;provide&#160;powerful&#160;and&#160;sophisticated&#160;graphical&#160;pro-<br/>grams&#160;for&#160;maintaining&#160;the&#160;system,&#160;it&#160;is&#160;important&#160;to&#160;learn&#160;about&#160;the&#160;command&#160;line&#160;pro-<br/>grams, too.&#160;They&#160;can perform&#160;many tasks&#160;that&#160;are&#160;difficult&#160;(or impossible) to do with&#160;their<br/>graphical&#160;counterparts.<br/>
<b>Packaging&#160;Systems<br/></b>Different&#160;distributions&#160;use&#160;different&#160;packaging&#160;systems,&#160;and&#160;as&#160;a&#160;general&#160;rule,&#160;a&#160;package<br/>intended&#160;for&#160;one&#160;distribution&#160;is&#160;not&#160;compatible&#160;with&#160;another&#160;distribution.&#160;Most&#160;distribu-<br/>tions&#160;fall&#160;into&#160;one&#160;of&#160;two&#160;camps&#160;of&#160;packaging&#160;technologies:&#160;the&#160;Debian&#160;.deb&#160;camp&#160;and&#160;the<br/>Red&#160;Hat&#160;.rpm&#160;&#160;camp.&#160;There&#160;are&#160;some&#160;important&#160;exceptions&#160;such&#160;as&#160;&#160;Gentoo,&#160;&#160;Slackware,<br/>and&#160;Arch, but&#160;most&#160;others&#160;use&#160;one&#160;of these&#160;two basic&#160;systems&#160;as&#160;shown in&#160;Table&#160;14-1.<br/>
172<br/>
<hr/>
<a name=197></a>Packaging Systems<br/>
<i>Table&#160;14-1: Major&#160;Packaging System&#160;Families</i><br/>
<b>Packaging&#160;System</b><br/>
<b>Distributions&#160;(Partial&#160;Listing)</b><br/>
Debian Style&#160;(.deb)<br/>
Debian,&#160;Ubuntu,&#160;Linux&#160;Mint,&#160;Raspbian<br/>
Red Hat&#160;Style&#160;(.rpm)<br/>
Fedora,&#160;CentOS,&#160;Red&#160;Hat&#160;Enterprise&#160;Linux,&#160;OpenSUSE<br/>
<b>How&#160;a&#160;Package&#160;System&#160;Works<br/></b>The&#160;method&#160;of&#160;software&#160;distribution&#160;found&#160;in&#160;the&#160;proprietary&#160;software&#160;industry&#160;usually<br/>entails&#160;buying&#160;a&#160;piece&#160;of&#160;installation&#160;media&#160;such&#160;as&#160;an&#160;“install&#160;disk”&#160;or&#160;visiting&#160;a&#160;vendor's<br/>web&#160;site&#160;and&#160;downloading&#160;a&#160;product&#160;and&#160;then&#160;running&#160;an&#160;“installation&#160;wizard”&#160;to&#160;install&#160;a<br/>new&#160;application&#160;on the&#160;system.<br/>Linux&#160;doesn't&#160;work&#160;that&#160;way.&#160;Virtually&#160;all&#160;software&#160;for&#160;a&#160;Linux&#160;system&#160;will&#160;be&#160;found&#160;on<br/>the&#160;Internet.&#160;Most&#160;of it&#160;will&#160;be&#160;provided&#160;by&#160;the&#160;distribution&#160;vendor&#160;in the&#160;form&#160;of&#160;<i>package<br/>files</i>,&#160;and&#160;the&#160;rest&#160;will&#160;be&#160;available&#160;in&#160;&#160;source&#160;code&#160;&#160;form&#160;that&#160;can&#160;be&#160;installed&#160;manually.<br/>We'll&#160;talk&#160;about&#160;how&#160;to install&#160;software&#160;by compiling source&#160;code&#160;in chapter&#160;23, “Compil-<br/>ing Programs.”<br/>
Package&#160;Files<br/>The&#160;basic&#160;unit&#160;of&#160;software&#160;in&#160;a&#160;packaging&#160;system&#160;is&#160;the&#160;<i>package&#160;file</i>.&#160;A&#160;package&#160;file&#160;is&#160;a<br/>compressed collection of files&#160;that&#160;comprise&#160;the&#160;software&#160;package.&#160;A&#160;package&#160;may consist<br/>of&#160;numerous&#160;programs&#160;and&#160;data&#160;files&#160;that&#160;support&#160;the&#160;programs.&#160;In&#160;addition&#160;to&#160;the&#160;files&#160;to<br/>be&#160;installed,&#160;the&#160;package&#160;file&#160;also&#160;includes&#160;metadata&#160;about&#160;the&#160;package,&#160;such&#160;as&#160;a&#160;text&#160;de-<br/>scription&#160;of&#160;the&#160;package&#160;and&#160;its&#160;contents.&#160;Additionally,&#160;many&#160;packages&#160;contain&#160;pre-&#160;and<br/>post-installation&#160;scripts&#160;that&#160;perform&#160;configuration&#160;tasks&#160;before&#160;and&#160;after&#160;the&#160;package&#160;in-<br/>stallation.<br/>Package&#160;files&#160;are&#160;created&#160;by&#160;a&#160;person&#160;known&#160;as&#160;a&#160;<i>package&#160;maintainer</i>,&#160;often&#160;(but&#160;not&#160;al-<br/>ways)&#160;an&#160;employee&#160;of&#160;the&#160;distribution&#160;vendor.&#160;The&#160;package&#160;maintainer&#160;gets&#160;the&#160;software<br/>in&#160;source&#160;code&#160;form&#160;from&#160;the&#160;<i>upstream&#160;provider</i>&#160;(the&#160;author&#160;of&#160;the&#160;program),&#160;compiles&#160;it,<br/>and&#160;creates&#160;the&#160;package&#160;metadata&#160;and&#160;any&#160;necessary&#160;installation&#160;scripts.&#160;Often,&#160;the&#160;pack-<br/>age&#160;maintainer&#160;will&#160;apply&#160;modifications&#160;to&#160;the&#160;original&#160;source&#160;code&#160;to&#160;improve&#160;the&#160;pro-<br/>gram's&#160;integration with&#160;the&#160;other&#160;parts&#160;of the&#160;Linux distribution.<br/>
Repositories<br/>While&#160;some&#160;software&#160;projects&#160;choose&#160;to&#160;perform&#160;their&#160;own&#160;packaging&#160;and&#160;distribution,<br/>most&#160;packages&#160;today&#160;are&#160;created&#160;by&#160;the&#160;distribution&#160;vendors&#160;and&#160;interested&#160;third&#160;parties.<br/>Packages&#160;are&#160;made&#160;available&#160;to&#160;the&#160;users&#160;of&#160;a&#160;distribution&#160;in&#160;central&#160;repositories&#160;that&#160;may<br/>contain&#160;many&#160;thousands&#160;of&#160;packages,&#160;each&#160;specially&#160;built&#160;and&#160;maintained&#160;for&#160;the&#160;distribu-<br/>tion.<br/>
173<br/>
<hr/>
<a name=198></a>14 – Package&#160;Management<br/>
A&#160;distribution&#160;may&#160;maintain&#160;several&#160;different&#160;repositories&#160;for&#160;different&#160;stages&#160;of&#160;the&#160;soft-<br/>ware&#160;development&#160;life&#160;cycle.&#160;For&#160;example,&#160;there&#160;will&#160;usually&#160;be&#160;a&#160;“testing”&#160;repository<br/>that&#160;contains&#160;packages&#160;that&#160;have&#160;just&#160;been&#160;built&#160;and&#160;are&#160;intended&#160;for&#160;use&#160;by&#160;brave&#160;souls<br/>who&#160;are&#160;looking&#160;for&#160;bugs&#160;before&#160;the&#160;packages&#160;are&#160;released&#160;for&#160;general&#160;distribution.&#160;A&#160;dis-<br/>tribution&#160;will&#160;often&#160;have&#160;a&#160;“development”&#160;repository&#160;where&#160;work-in-progress&#160;packages<br/>destined&#160;for inclusion&#160;in the&#160;distribution's&#160;next&#160;major&#160;release&#160;are&#160;kept.<br/>A&#160;distribution&#160;may&#160;also&#160;have&#160;related&#160;third-party&#160;repositories.&#160;These&#160;are&#160;often&#160;needed&#160;to<br/>supply&#160;software&#160;that,&#160;for&#160;legal&#160;reasons&#160;such&#160;as&#160;patents&#160;or&#160;DRM&#160;anti-circumvention&#160;issues,<br/>cannot&#160;be&#160;included&#160;with&#160;the&#160;distribution.&#160;Perhaps&#160;the&#160;best&#160;known&#160;case&#160;is&#160;that&#160;of&#160;encrypted<br/>DVD&#160;support,&#160;which&#160;is&#160;not&#160;legal&#160;in&#160;the&#160;United&#160;States.&#160;The&#160;third-party&#160;repositories&#160;operate<br/>in&#160;countries&#160;where&#160;software&#160;patents&#160;and&#160;anti-circumvention&#160;laws&#160;do&#160;not&#160;apply.&#160;These<br/>repositories&#160;are&#160;usually&#160;wholly&#160;independent&#160;of&#160;the&#160;distribution&#160;they&#160;support,&#160;and&#160;to&#160;use<br/>them,&#160;one&#160;must&#160;know&#160;about&#160;them&#160;and&#160;manually include&#160;them&#160;in&#160;the&#160;configuration&#160;files&#160;for<br/>the&#160;package&#160;management&#160;system.<br/>
Dependencies<br/>Programs&#160;are&#160;seldom&#160;“standalone”;&#160;rather&#160;they&#160;rely&#160;on&#160;the&#160;presence&#160;of&#160;other&#160;software<br/>components&#160;to&#160;get&#160;their&#160;work&#160;done.&#160;Common&#160;activities,&#160;such&#160;as&#160;input/output&#160;for&#160;example,<br/>are&#160;handled&#160;by&#160;routines&#160;shared&#160;by&#160;many&#160;programs.&#160;These&#160;routines&#160;are&#160;stored&#160;in&#160;what&#160;are<br/>called&#160;<i>shared&#160;libraries</i>,&#160;which&#160;provide&#160;essential&#160;services&#160;to&#160;more&#160;than&#160;one&#160;program.&#160;If&#160;a<br/>package&#160;requires&#160;a&#160;shared&#160;resource&#160;such&#160;as&#160;a&#160;shared&#160;library,&#160;it&#160;is&#160;said&#160;to&#160;have&#160;a&#160;<i>depen-<br/>dency</i>.&#160;Modern&#160;package&#160;management&#160;systems&#160;all&#160;provide&#160;some&#160;method&#160;of&#160;&#160;<i>dependency<br/>resolution</i>&#160;to&#160;ensure&#160;that&#160;when&#160;a&#160;package&#160;is&#160;installed,&#160;all&#160;of&#160;its&#160;dependencies&#160;are&#160;installed,<br/>too.&#160;<br/>
High&#160;and&#160;Low-level&#160;Package&#160;Tools<br/>Package&#160;management&#160;systems&#160;usually consist&#160;of two types&#160;of tools.<br/>
•<br/>
Low-level&#160;tools&#160;which&#160;handle&#160;tasks&#160;such as&#160;installing&#160;and removing&#160;package&#160;files<br/>
•<br/>
High-level&#160;tools&#160;that&#160;perform&#160;metadata&#160;searching&#160;and dependency&#160;resolution<br/>
In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;the&#160;tools&#160;supplied&#160;with&#160;Debian-style&#160;systems&#160;(such&#160;as<br/>Ubuntu&#160;and&#160;many&#160;others)&#160;and&#160;those&#160;used&#160;by&#160;Red&#160;Hat&#160;products.&#160;While&#160;all&#160;Red&#160;Hat-style<br/>distributions&#160;rely&#160;on&#160;the&#160;same&#160;low-level&#160;program&#160;(rpm),&#160;they&#160;use&#160;different&#160;high-level<br/>tools.&#160;For&#160;our&#160;discussion,&#160;we&#160;will&#160;cover&#160;the&#160;high-level&#160;program&#160;&#160;yum,&#160;used&#160;by&#160;Red&#160;Hat<br/>Enterprise&#160;Linux,&#160;and&#160;CentOS.&#160;Other&#160;Red&#160;Hat-style&#160;distributions&#160;provide&#160;high-level&#160;tools<br/>with comparable&#160;features&#160;(see&#160;Table&#160;14-2).<br/>
<i>Table&#160;14-&#160;2: Packaging System&#160;Tools</i><br/>
<b>Distributions</b><br/>
<b>Low-Level&#160;Tools</b><br/>
<b>High-Level&#160;Tools</b><br/>
174<br/>
<hr/>
<a name=199></a>How&#160;a&#160;Package&#160;System&#160;Works<br/>
Debian style<br/>
dpkg<br/>
apt,&#160;apt-get,<br/>aptitude<br/>
Fedora, Red Hat&#160;<br/>
rpm<br/>
yum, dnf<br/>
Enterprise&#160;Linux,&#160;CentOS<br/>
<b>Common&#160;Package&#160;Management&#160;Tasks<br/></b>Many&#160;operations&#160;can&#160;be&#160;performed&#160;with&#160;the&#160;command&#160;line&#160;package&#160;management&#160;tools.<br/>We&#160;will&#160;look&#160;at&#160;the&#160;most&#160;common.&#160;Be&#160;aware&#160;that&#160;the&#160;low-level&#160;tools&#160;also&#160;support&#160;the&#160;cre-<br/>ation&#160;of package&#160;files, an&#160;activity outside&#160;the&#160;scope&#160;of this&#160;book.<br/>In the&#160;discussion below,&#160;the&#160;term&#160;<i>package_name</i>&#160;refers&#160;to&#160;the&#160;actual&#160;name&#160;of a&#160;package<br/>rather&#160;than&#160;the&#160;term&#160;&#160;<i>package_file</i>,&#160;which&#160;is&#160;the&#160;name&#160;of&#160;the&#160;file&#160;that&#160;contains&#160;the<br/>package.<br/>
Finding&#160;a&#160;Package&#160;in&#160;a&#160;Repository<br/>Using&#160;the&#160;high-level&#160;tools&#160;to&#160;search&#160;repository&#160;metadata,&#160;a&#160;package&#160;can&#160;be&#160;located&#160;based<br/>on its&#160;name&#160;or description (see&#160;Table&#160;14-3).<br/>
<i>Table&#160;14-3: Package&#160;Search Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
apt-get update<br/>apt-cache search&#160;<i>search_string</i><br/>
Red Hat<br/>
yum search&#160;<i>search_string</i><br/>
For&#160;example,&#160;to&#160;search&#160;a&#160;yum&#160;repository&#160;for&#160;the&#160;emacs&#160;text&#160;editor,&#160;we&#160;can&#160;use&#160;this&#160;com-<br/>mand:<br/>
yum search emacs<br/>
Installing&#160;a&#160;Package&#160;from&#160;a&#160;Repository<br/>High-level&#160;tools&#160;permit&#160;a&#160;package&#160;to&#160;be&#160;downloaded&#160;from&#160;a&#160;repository&#160;and&#160;installed&#160;with<br/>full&#160;dependency resolution (see&#160;Table&#160;14-4).<br/>
<i>Table&#160;14-4: Package&#160;Installation&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
175<br/>
<hr/>
<a name=200></a>14 – Package&#160;Management<br/>
Debian<br/>
apt-get update<br/>apt-get install&#160;<i>package_name</i><br/>
Red Hat<br/>
yum install&#160;<i>package_name</i><br/>
For&#160;example,&#160;to&#160;install&#160;the&#160;emacs&#160;text&#160;editor&#160;from&#160;an&#160;apt&#160;repository&#160;on&#160;a&#160;Debian&#160;system,<br/>we&#160;can use&#160;this&#160;command:<br/>
apt-get update; apt-get install emacs<br/>
Installing&#160;a&#160;Package&#160;from&#160;a&#160;Package&#160;File<br/>If&#160;a&#160;package&#160;file&#160;has&#160;been&#160;downloaded&#160;from&#160;a&#160;source&#160;other&#160;than&#160;a&#160;repository,&#160;it&#160;can&#160;be&#160;in-<br/>stalled&#160;directly&#160;(though&#160;without&#160;dependency&#160;resolution)&#160;using&#160;a&#160;low-level&#160;tool&#160;(see&#160;Table<br/>14-5).<br/>
<i>Table&#160;14-5: Low-Level&#160;Package&#160;Installation Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
dpkg -i&#160;<i>package_file</i><br/>
Red Hat<br/>
rpm -i&#160;<i>package_file</i><br/>
For&#160;example,&#160;if&#160;the&#160;&#160;emacs-22.1-7.fc7-i386.rpm&#160;&#160;package&#160;file&#160;had&#160;been&#160;down-<br/>loaded&#160;from&#160;a&#160;non-repository&#160;site, it&#160;would be&#160;installed&#160;this&#160;way:<br/>
rpm -i emacs-22.1-7.fc7-i386.rpm&#160;<br/>
<b>Note:</b>&#160;Because&#160;this&#160;technique&#160;uses&#160;the&#160;low-level&#160;rpm&#160;program&#160;to&#160;perform&#160;the&#160;in-<br/>stallation,&#160;no dependency&#160;resolution&#160;is&#160;performed.&#160;If&#160;rpm&#160;discovers&#160;a&#160;missing&#160;de-<br/>pendency,&#160;rpm&#160;will&#160;exit&#160;with an error.<br/>
Removing&#160;a&#160;Package<br/>Packages&#160;can&#160;be&#160;uninstalled&#160;using&#160;either&#160;the&#160;high-level&#160;or&#160;low-level&#160;tools.&#160;The&#160;high-level<br/>tools&#160;are&#160;shown in&#160;Table&#160;14-6.<br/>
176<br/>
<hr/>
<a name=201></a>Common&#160;Package&#160;Management&#160;Tasks<br/>
<i>Table&#160;14-6: Package&#160;Removal&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
apt-get remove&#160;<i>package_name</i><br/>
Red Hat<br/>
yum erase&#160;<i>package_name</i><br/>
For&#160;example,&#160;to&#160;uninstall&#160;the&#160;emacs&#160;package&#160;from&#160;a&#160;Debian-style&#160;system,&#160;we&#160;can&#160;use&#160;this<br/>command:<br/>
apt-get remove emacs<br/>
Updating&#160;Packages&#160;from&#160;a&#160;Repository<br/>The&#160;most&#160;common&#160;package&#160;management&#160;task&#160;is&#160;keeping&#160;the&#160;system&#160;up-to-date&#160;with&#160;the<br/>latest&#160;versions&#160;of&#160;packages.&#160;The&#160;high-level&#160;tools&#160;can&#160;perform&#160;this&#160;vital&#160;task&#160;in&#160;a&#160;single<br/>step (see&#160;Table&#160;14-7).<br/>
<i>Table&#160;14-7: Package&#160;Update&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
apt-get update; apt-get&#160;upgrade<br/>
Red Hat<br/>
yum&#160;update<br/>
For&#160;example,&#160;to&#160;apply&#160;all&#160;available&#160;updates&#160;to&#160;the&#160;installed&#160;packages&#160;on&#160;a&#160;Debian-style<br/>system, we&#160;can use&#160;this&#160;command:<br/>
apt-get update; apt-get upgrade<br/>
Upgrading&#160;a&#160;Package&#160;from&#160;a&#160;Package&#160;File<br/>If&#160;an&#160;updated&#160;version&#160;of&#160;a&#160;package&#160;has&#160;been&#160;downloaded&#160;from&#160;a&#160;non-repository&#160;source,&#160;it<br/>can be&#160;installed, replacing the&#160;previous&#160;version&#160;(see&#160;Table&#160;14-8).<br/>
<i>Table&#160;14-8: Low-Level&#160;Package&#160;Upgrade&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
177<br/>
<hr/>
<a name=202></a>14 – Package&#160;Management<br/>
Debian<br/>
dpkg -i&#160;<i>package_file</i><br/>
Red Hat<br/>
rpm -U&#160;<i>package_file</i><br/>
For&#160;example,&#160;to&#160;update&#160;an&#160;existing&#160;installation&#160;of&#160;emacs&#160;to&#160;the&#160;version&#160;contained&#160;in&#160;the<br/>package&#160;file&#160;emacs-22.1-7.fc7-i386.rpm&#160;on&#160;a&#160;Red&#160;Hat&#160;system,&#160;we&#160;can&#160;use&#160;this<br/>command:<br/>
rpm -U emacs-22.1-7.fc7-i386.rpm<br/>
<b>Note:</b>&#160;dpkg&#160;does&#160;not&#160;have&#160;a&#160;specific&#160;option&#160;for&#160;upgrading&#160;a&#160;package&#160;versus&#160;in-<br/>stalling&#160;one&#160;as&#160;rpm&#160;does.<br/>
Listing&#160;Installed&#160;Packages<br/>Table&#160;14-9&#160;lists&#160;the&#160;commands&#160;we&#160;can&#160;use&#160;to&#160;display&#160;a&#160;list&#160;of&#160;all&#160;the&#160;packages&#160;installed&#160;on<br/>the&#160;system.<br/>
<i>Table&#160;14-9: Package&#160;Listing&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
dpkg -l<br/>
Red Hat<br/>
rpm -qa<br/>
Determining&#160;Whether&#160;a&#160;Package&#160;is&#160;Installed<br/>Table&#160;14-10&#160;list&#160;the&#160;&#160;low-level&#160;tools&#160;we&#160;can&#160;use&#160;to&#160;display&#160;whether&#160;a&#160;specified&#160;package&#160;is<br/>installed.<br/>
<i>Table&#160;14-10: Package&#160;Status&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
dpkg -s&#160;<i>package_name</i><br/>
Red Hat<br/>
rpm -q&#160;<i>package_name</i><br/>
For&#160;example,&#160;to&#160;determine&#160;whether&#160;the&#160;emacs&#160;package&#160;is&#160;installed&#160;on&#160;a&#160;Debian&#160;style&#160;sys-<br/>tem,&#160;we&#160;can use&#160;this&#160;command:<br/>
178<br/>
<hr/>
<a name=203></a>Common&#160;Package&#160;Management&#160;Tasks<br/>
dpkg --status emacs<br/>
Displaying&#160;Information&#160;&#160;About&#160;an&#160;Installed&#160;Package<br/>If&#160;the&#160;name&#160;of&#160;an&#160;installed&#160;package&#160;is&#160;known,&#160;we&#160;can&#160;use&#160;the&#160;commands&#160;in&#160;Table&#160;14-11&#160;to<br/>display a&#160;description&#160;of the&#160;package.<br/>
<i>Table&#160;14-11: Package&#160;Information&#160;Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
apt-cache show&#160;<i>package_name</i><br/>
Red Hat<br/>
yum info&#160;<i>package_name</i><br/>
For&#160;example,&#160;to&#160;see&#160;a&#160;description&#160;of&#160;the&#160;emacs&#160;package&#160;on&#160;a&#160;Debian-style&#160;system,&#160;we&#160;can<br/>use&#160;this&#160;command:<br/>
apt-cache show emacs<br/>
Finding&#160;Which&#160;Package&#160;Installed&#160;a&#160;File<br/>To&#160;determine&#160;what&#160;package&#160;is&#160;responsible&#160;for&#160;the&#160;installation&#160;of&#160;a&#160;particular&#160;file,&#160;we&#160;can<br/>use&#160;the&#160;commands&#160;in&#160;Table&#160;14-12.<br/>
<i>Table&#160;14-12: Package&#160;File&#160;Identification Commands</i><br/>
<b>Style</b><br/>
<b>Command(s)</b><br/>
Debian<br/>
dpkg -S&#160;<i>file_name</i><br/>
Red Hat<br/>
rpm -qf&#160;<i>file_name</i><br/>
For&#160;example,&#160;to&#160;see&#160;what&#160;package&#160;installed&#160;the&#160;/usr/bin/vim&#160;file&#160;on&#160;a&#160;Red&#160;Hat&#160;sys-<br/>tem,&#160;we&#160;can use&#160;the&#160;following:<br/>
rpm -qf /usr/bin/vim<br/>
179<br/>
<hr/>
<a name=204></a>14 – Package&#160;Management<br/>
<b>Summing&#160;Up<br/></b>In&#160;the&#160;chapters&#160;that&#160;follow,&#160;we&#160;will&#160;explore&#160;many&#160;different&#160;programs&#160;covering&#160;a&#160;wide<br/>range&#160;of&#160;application&#160;areas.&#160;While&#160;most&#160;of&#160;these&#160;programs&#160;are&#160;commonly&#160;installed&#160;by&#160;de-<br/>fault,&#160;we&#160;may&#160;need&#160;to&#160;install&#160;additional&#160;packages&#160;if&#160;the&#160;necessary&#160;programs&#160;are&#160;not&#160;al-<br/>ready&#160;installed&#160;on&#160;our&#160;system.&#160;With&#160;our&#160;newfound&#160;knowledge&#160;(and&#160;appreciation)&#160;of&#160;pack-<br/>age&#160;management,&#160;we&#160;should&#160;have&#160;no&#160;problem&#160;installing&#160;and&#160;managing&#160;the&#160;programs&#160;we<br/>need.<br/>
<b>The&#160;Linux&#160;Software&#160;Installation&#160;Myth</b><br/>
People&#160;migrating&#160;from&#160;other&#160;platforms&#160;sometimes&#160;fall&#160;victim&#160;to&#160;the&#160;myth&#160;that<br/>software&#160;is&#160;somehow&#160;difficult&#160;to&#160;install&#160;under&#160;Linux&#160;and&#160;that&#160;the&#160;variety&#160;of&#160;pack-<br/>aging&#160;schemes&#160;used&#160;by&#160;different&#160;distributions&#160;is&#160;a&#160;hindrance.&#160;Well,&#160;it&#160;is&#160;a&#160;hin-<br/>drance,&#160;but&#160;only&#160;to&#160;proprietary&#160;software&#160;vendors&#160;that&#160;want&#160;to&#160;distribute&#160;binary-<br/>only versions&#160;of their&#160;secret&#160;software.<br/>The&#160;Linux&#160;software&#160;ecosystem&#160;is&#160;based&#160;on&#160;the&#160;idea&#160;of&#160;open&#160;source&#160;code.&#160;If&#160;a&#160;pro-<br/>gram&#160;developer&#160;releases&#160;source&#160;code&#160;for&#160;a&#160;program,&#160;it&#160;is&#160;likely&#160;that&#160;a&#160;person&#160;asso-<br/>ciated&#160;with&#160;a&#160;distribution&#160;will&#160;package&#160;the&#160;program&#160;and&#160;include&#160;it&#160;in&#160;their&#160;reposi-<br/>tory.&#160;This&#160;method&#160;ensures&#160;that&#160;the&#160;program&#160;is&#160;well&#160;integrated&#160;into&#160;the&#160;distribution,<br/>and&#160;the&#160;user&#160;is&#160;given&#160;the&#160;convenience&#160;of&#160;“one-stop&#160;shopping”&#160;for&#160;software,&#160;rather<br/>than&#160;having&#160;to&#160;search&#160;for&#160;each&#160;program's&#160;website.&#160;Recently,&#160;major&#160;proprietary<br/>platform&#160;vendors&#160;have&#160;begun&#160;building&#160;application&#160;stores&#160;that&#160;mimic&#160;this&#160;idea.<br/>Device&#160;drivers&#160;are&#160;handled&#160;in&#160;much&#160;the&#160;same&#160;way,&#160;except&#160;that&#160;instead&#160;of&#160;being<br/>separate&#160;items&#160;in&#160;a&#160;distribution's&#160;repository,&#160;they&#160;become&#160;part&#160;of&#160;the&#160;Linux&#160;kernel.<br/>Generally&#160;speaking,&#160;there&#160;is&#160;no&#160;such&#160;thing&#160;as&#160;a&#160;“driver&#160;disk”&#160;in&#160;Linux.&#160;Either&#160;the<br/>kernel&#160;supports&#160;a&#160;device&#160;or&#160;it&#160;doesn't,&#160;and&#160;the&#160;Linux&#160;kernel&#160;supports&#160;a&#160;lot&#160;of&#160;de-<br/>vices.&#160;Many&#160;more,&#160;in&#160;fact,&#160;than&#160;Windows&#160;does.&#160;Of&#160;course,&#160;this&#160;is&#160;of&#160;no&#160;consola-<br/>tion&#160;if&#160;the&#160;particular&#160;device&#160;you&#160;need&#160;is&#160;not&#160;supported.&#160;When&#160;that&#160;happens,&#160;you<br/>need&#160;to&#160;look&#160;at&#160;the&#160;cause.&#160;A&#160;lack&#160;of&#160;driver&#160;support&#160;is&#160;usually&#160;caused&#160;by&#160;one&#160;of<br/>three&#160;things:<br/><b>1.&#160;The&#160;device&#160;is&#160;too&#160;new.</b>&#160;&#160;Since&#160;many&#160;hardware&#160;vendors&#160;don't&#160;actively&#160;support<br/>Linux&#160;development,&#160;it&#160;falls&#160;upon&#160;a&#160;member&#160;of&#160;the&#160;Linux&#160;community&#160;to&#160;write&#160;the<br/>kernel&#160;driver code.&#160;This&#160;takes&#160;time.<br/><b>2.&#160;The&#160;device&#160;is&#160;too&#160;exotic.</b>&#160;&#160;Not&#160;all&#160;distributions&#160;include&#160;every&#160;possible&#160;device<br/>driver.&#160;Each&#160;distribution&#160;builds&#160;its&#160;own&#160;kernels,&#160;and&#160;since&#160;kernels&#160;are&#160;very&#160;config-<br/>urable&#160;(which&#160;is&#160;what&#160;makes&#160;it&#160;possible&#160;to&#160;run&#160;Linux&#160;on&#160;everything&#160;from&#160;wrist-<br/>watches&#160;to&#160;mainframes)&#160;they&#160;may&#160;have&#160;overlooked&#160;a&#160;particular&#160;device.&#160;By&#160;locat-<br/>
180<br/>
<hr/>
<a name=205></a>Summing&#160;Up<br/>
ing&#160;and&#160;downloading&#160;the&#160;source&#160;code&#160;for&#160;the&#160;driver,&#160;it&#160;is&#160;possible&#160;for&#160;you&#160;(yes,<br/>you)&#160;to&#160;compile&#160;and&#160;install&#160;the&#160;driver&#160;yourself.&#160;This&#160;process&#160;is&#160;not&#160;overly&#160;difficult,<br/>but&#160;it&#160;is&#160;rather&#160;involved.&#160;We'll&#160;talk about&#160;compiling&#160;software&#160;in a&#160;later&#160;chapter.<br/><b>3.&#160;The&#160;hardware&#160;vendor&#160;is&#160;hiding&#160;something.</b>&#160;&#160;It&#160;has&#160;neither&#160;released&#160;source<br/>code&#160;for&#160;a&#160;Linux&#160;driver,&#160;nor&#160;has&#160;it&#160;released&#160;the&#160;technical&#160;documentation&#160;for&#160;some-<br/>body&#160;to&#160;create&#160;one&#160;for&#160;them.&#160;This&#160;means&#160;the&#160;hardware&#160;vendor&#160;is&#160;trying&#160;to&#160;keep&#160;the<br/>programming&#160;interfaces&#160;to&#160;the&#160;device&#160;a&#160;secret.&#160;Since&#160;we&#160;don't&#160;want&#160;secret&#160;devices<br/>in our computers, it&#160;is&#160;best&#160;that&#160;you avoid such products.&#160;<br/>
<b>Further&#160;Reading<br/></b>Spend&#160;some&#160;time&#160;getting&#160;to&#160;know&#160;the&#160;package&#160;management&#160;system&#160;for&#160;your&#160;distribution.<br/>Each&#160;distribution&#160;provides&#160;documentation&#160;for&#160;its&#160;package&#160;management&#160;tools.&#160;In&#160;addition,<br/>here&#160;are&#160;some&#160;more&#160;generic&#160;sources:<br/>
●<br/>
The&#160;<i>Debian&#160;GNU/Linux&#160;FAQ</i>&#160;chapter on package&#160;management&#160;provides&#160;an over-<br/>view&#160;of package&#160;management&#160;on Debian&#160;systems&#160;:<br/><a href="http://www.debian.org/doc/FAQ/ch-pkgtools.en.html">http://www.debian.org/doc/FAQ/ch-pkgtools.en.html</a><br/>
●<br/>
The&#160;home&#160;page&#160;for the&#160;RPM&#160;project:<br/><a href="http://www.rpm.org/">http://www.rpm.org</a><br/>
●<br/>
The&#160;home&#160;page&#160;for the&#160;YUM&#160;project:<br/><a href="http://yum.baseurl.org/">h&#160;&#160;t&#160;tp://&#160;yum</a><br/>
<a href="http://yum.baseurl.org/">&#160;</a><br/>
<a href="http://yum.baseurl.org/">.baseurl.org&#160;</a><br/>
●<br/>
For a&#160;little&#160;background, the&#160;Wikipedia&#160;has&#160;an&#160;article&#160;on metadata:<br/><a href="http://en.wikipedia.org/wiki/Metadata">http://en.wikipedia.org/wiki/Metadata</a><br/>
181<br/>
<hr/>
<a name=206></a>15 – Storage&#160;Media<br/>
<i><b>15&#160;–&#160;Storage&#160;Media</b></i><br/>
In&#160;previous&#160;chapters&#160;we&#160;looked&#160;at&#160;manipulating&#160;data&#160;at&#160;the&#160;file&#160;level.&#160;In&#160;this&#160;chapter,&#160;we<br/>will&#160;consider&#160;data&#160;at&#160;the&#160;device&#160;level.&#160;Linux&#160;has&#160;amazing&#160;capabilities&#160;for&#160;handling&#160;storage<br/>devices,&#160;whether&#160;physical&#160;storage,&#160;such&#160;as&#160;hard&#160;disks,&#160;network&#160;storage,&#160;or&#160;virtual&#160;storage<br/>devices&#160;such&#160;as&#160;RAID&#160;(Redundant&#160;Array&#160;of&#160;Independent&#160;Disks)&#160;and&#160;LVM&#160;(Logical&#160;Vol-<br/>ume&#160;Manager).<br/>However,&#160;since&#160;this&#160;is&#160;not&#160;a&#160;book&#160;about&#160;system&#160;administration,&#160;we&#160;will&#160;not&#160;try&#160;to&#160;cover<br/>this&#160;entire&#160;topic&#160;in&#160;depth.&#160;What&#160;we&#160;will&#160;try&#160;to&#160;do&#160;is&#160;introduce&#160;some&#160;of&#160;the&#160;concepts&#160;and<br/>key commands&#160;that&#160;are&#160;used to&#160;manage&#160;storage&#160;devices.<br/>To&#160;carry&#160;out&#160;the&#160;exercises&#160;in&#160;this&#160;chapter,&#160;we&#160;will&#160;use&#160;a&#160;USB&#160;flash&#160;drive&#160;and&#160;a&#160;CD-RW<br/>disc&#160;(for systems&#160;equipped&#160;with a&#160;CD-ROM&#160;burner).<br/>We&#160;will&#160;look&#160;at&#160;the&#160;following&#160;commands:<br/>
●<br/>
mount&#160;– Mount&#160;a&#160;file&#160;system<br/>
●<br/>
umount&#160;– Unmount&#160;a&#160;file&#160;system<br/>
●<br/>
fsck&#160;– Check and&#160;repair a&#160;file&#160;system<br/>
●<br/>
fdisk&#160;– Manipulate&#160;disk partition&#160;table<br/>
●<br/>
mkfs&#160;– Create&#160;a&#160;file&#160;system<br/>
●<br/>
dd&#160;– Convert&#160;and&#160;copy a&#160;file<br/>
●<br/>
genisoimage (mkisofs)&#160;– Create&#160;an ISO&#160;9660 image&#160;file<br/>
●<br/>
wodim (cdrecord)&#160;–&#160;Write&#160;data&#160;to optical&#160;storage&#160;media<br/>
●<br/>
md5sum&#160;– Calculate&#160;an MD5 checksum<br/>
<b>Mounting&#160;and&#160;Unmounting&#160;Storage&#160;Devices<br/></b>Recent&#160;advances&#160;in&#160;the&#160;Linux&#160;desktop&#160;have&#160;made&#160;storage&#160;device&#160;management&#160;extremely<br/>easy&#160;for&#160;desktop&#160;users.&#160;For&#160;the&#160;most&#160;part,&#160;we&#160;attach&#160;a&#160;device&#160;to&#160;our&#160;system&#160;and&#160;it&#160;“just<br/>works.”&#160;In&#160;the&#160;old&#160;days&#160;(say,&#160;2004),&#160;this&#160;stuff&#160;had&#160;to&#160;be&#160;done&#160;manually.&#160;On&#160;non-desktop<br/>systems&#160;(i.e.,&#160;servers)&#160;this&#160;is&#160;still&#160;a&#160;largely&#160;manual&#160;procedure&#160;since&#160;servers&#160;often&#160;have&#160;ex-<br/>
182<br/>
<hr/>
<a name=207></a>Mounting and Unmounting Storage&#160;Devices<br/>
treme&#160;storage&#160;needs&#160;and complex configuration&#160;requirements.<br/>The&#160;first&#160;step&#160;in&#160;managing&#160;a&#160;storage&#160;device&#160;is&#160;attaching&#160;the&#160;device&#160;to&#160;the&#160;file&#160;system&#160;tree.<br/>This&#160;process,&#160;called&#160;<i>mounting</i>,&#160;allows&#160;the&#160;device&#160;to&#160;interact&#160;with&#160;the&#160;operating&#160;system.&#160;As<br/>we&#160;recall&#160;from&#160;Chapter&#160;2,&#160;Unix-like&#160;operating&#160;systems,&#160;like&#160;Linux,&#160;maintain&#160;a&#160;single&#160;file<br/>system&#160;tree&#160;with&#160;devices&#160;attached&#160;at&#160;various&#160;points.&#160;This&#160;contrasts&#160;with&#160;other&#160;operating<br/>systems&#160;such&#160;as&#160;MS-DOS&#160;and&#160;Windows&#160;that&#160;maintain&#160;separate&#160;file&#160;system&#160;trees&#160;for&#160;each<br/>device&#160;(for example&#160;C:\,&#160;D:\, etc.).<br/>A&#160;file&#160;named&#160;&#160;/etc/fstab&#160;&#160;(short&#160;for&#160;“file&#160;system&#160;table”)&#160;lists&#160;the&#160;devices&#160;(typically<br/>hard&#160;disk&#160;partitions)&#160;that&#160;are&#160;to&#160;be&#160;mounted&#160;at&#160;boot&#160;time.&#160;Here&#160;is&#160;an&#160;example&#160;&#160;/etc/<br/>fstab&#160;file&#160;from&#160;an early Fedora&#160;system:<br/>
LABEL=/12 &#160; &#160; &#160; &#160; / &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 1<br/>LABEL=/home &#160; &#160; &#160; /home &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 2<br/>LABEL=/boot &#160; &#160; &#160; /boot &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 2<br/>tmpfs &#160; &#160; &#160; &#160; &#160; &#160; /dev/shm &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;tmpfs &#160; defaults &#160; &#160; &#160; &#160;0 0<br/>devpts &#160; &#160; &#160; &#160; &#160; &#160;/dev/pts &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;devpts &#160;gid=5,mode=620 &#160;0 0<br/>sysfs &#160; &#160; &#160; &#160; &#160; &#160; /sys &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;sysfs &#160; defaults &#160; &#160; &#160; &#160;0 0<br/>proc &#160; &#160; &#160; &#160; &#160; &#160; &#160;/proc &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; proc &#160; &#160;defaults &#160; &#160; &#160; &#160;0 0<br/>LABEL=SWAP-sda3 &#160; swap &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;swap &#160; &#160;defaults &#160; &#160; &#160; &#160;0 0<br/>
Most&#160;of&#160;the&#160;file&#160;systems&#160;listed&#160;in&#160;this&#160;example&#160;file&#160;are&#160;virtual&#160;and&#160;not&#160;applicable&#160;to&#160;our<br/>discussion.&#160;For our purposes, the&#160;interesting ones&#160;are&#160;the&#160;first&#160;three:<br/>
LABEL=/12 &#160; &#160; &#160; &#160; / &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 1<br/>LABEL=/home &#160; &#160; &#160; /home &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 2<br/>LABEL=/boot &#160; &#160; &#160; /boot &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ext4 &#160; &#160;defaults &#160; &#160; &#160; &#160;1 2<br/>
These&#160;are&#160;the&#160;hard&#160;disk&#160;partitions.&#160;Each&#160;line&#160;of&#160;the&#160;file&#160;consists&#160;of&#160;six&#160;fields,&#160;as&#160;described<br/>in&#160;Table&#160;15-1.<br/>
<i>Table&#160;15-1:&#160;/etc/fstab&#160;Fields</i><br/>
<b>Field</b><br/>
<b>Contents</b><br/>
<b>Description</b><br/>
1<br/>
Device<br/>
Traditionally, this&#160;field contains&#160;the&#160;actual&#160;name&#160;of a&#160;<br/>device&#160;file&#160;associated&#160;with the&#160;physical&#160;device,&#160;such&#160;as<br/>/dev/sda1&#160;(the&#160;first&#160;partition of the&#160;first&#160;detected&#160;<br/>hard disk). But&#160;with&#160;today's&#160;computers, which&#160;have&#160;<br/>many devices&#160;that&#160;are&#160;hot&#160;pluggable&#160;(like&#160;USB drives),<br/>many modern&#160;Linux&#160;distributions&#160;associate&#160;a&#160;device&#160;<br/>
183<br/>
<hr/>
<a name=208></a>15 – Storage&#160;Media<br/>
with a&#160;text&#160;label&#160;instead.&#160;This&#160;label&#160;(which&#160;is&#160;added to&#160;<br/>the&#160;storage&#160;media&#160;when it&#160;is&#160;formatted) can&#160;be&#160;either a&#160;<br/>simple&#160;text&#160;label&#160;or a&#160;randomly&#160;generated&#160;UUID&#160;<br/>(Universally&#160;Unique&#160;Identifier).&#160;This&#160;label&#160;is&#160;read by&#160;<br/>the&#160;operating&#160;system&#160;when&#160;the&#160;device&#160;is&#160;attached to the<br/>system.&#160;That&#160;way, no matter which&#160;device&#160;file&#160;is&#160;<br/>assigned&#160;to the&#160;actual&#160;physical&#160;device, it&#160;can still&#160;be&#160;<br/>correctly identified.<br/>
&#160;2<br/>
Mount&#160;point<br/>
The&#160;directory&#160;where&#160;the&#160;device&#160;is&#160;attached to the&#160;file&#160;<br/>system&#160;tree.<br/>
3<br/>
File&#160;system&#160;type<br/>
Linux allows&#160;many file&#160;system&#160;types&#160;to be&#160;mounted.&#160;<br/>Most&#160;native&#160;Linux file&#160;systems&#160;are&#160;Fourth&#160;Extended&#160;<br/>File&#160;System&#160;(ext4), but&#160;many&#160;others&#160;are&#160;supported,&#160;<br/>such&#160;as&#160;FAT16 (msdos), FAT32&#160;(vfat), NTFS&#160;<br/>(ntfs), CD-ROM&#160;(iso9660), etc.<br/>
4<br/>
Options<br/>
File&#160;systems&#160;can&#160;be&#160;mounted with various&#160;options. It&#160;is<br/>possible, for example, to&#160;mount&#160;file&#160;systems&#160;as&#160;read-<br/>only or to prevent&#160;any&#160;programs&#160;from&#160;being&#160;executed&#160;<br/>from&#160;them&#160;(a&#160;useful&#160;security feature&#160;for removable&#160;<br/>media).<br/>
5<br/>
Frequency<br/>
A&#160;single&#160;number&#160;that&#160;specifies&#160;if and when a&#160;file&#160;<br/>system&#160;is&#160;to be&#160;backed up with&#160;the&#160;dump&#160;command.<br/>
6<br/>
Order<br/>
A&#160;single&#160;number&#160;that&#160;specifies&#160;in what&#160;order file&#160;<br/>systems&#160;should&#160;be&#160;checked&#160;with the&#160;fsck&#160;command.<br/>
Viewing&#160;a&#160;List&#160;of&#160;Mounted&#160;File&#160;Systems<br/>The&#160;mount&#160;command&#160;is&#160;used&#160;to&#160;mount&#160;file&#160;systems.&#160;Entering&#160;the&#160;command&#160;without&#160;ar-<br/>guments&#160;will&#160;display&#160;a&#160;list&#160;of the&#160;file&#160;systems&#160;currently mounted:<br/>
[me@linuxbox ~]$&#160;<b>mount<br/></b>/dev/sda2 on / type ext4 (rw)<br/>proc on /proc type proc (rw)<br/>sysfs on /sys type sysfs (rw)<br/>devpts on /dev/pts type devpts (rw,gid=5,mode=620)<br/>/dev/sda5 on /home type ext4 (rw)<br/>/dev/sda1 on /boot type ext4 (rw)<br/>
184<br/>
<hr/>
<a name=209></a>Mounting and Unmounting Storage&#160;Devices<br/>
tmpfs on /dev/shm type tmpfs (rw)<br/>none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)<br/>sunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw)<br/>fusectl on /sys/fs/fuse/connections type fusectl (rw)<br/>/dev/sdd1 on /media/disk type vfat (rw,nosuid,nodev,noatime,<br/>uhelper=hal,uid=500,utf8,shortname=lower)<br/>twin4:/musicbox on /misc/musicbox type nfs4 (rw,addr=192.168.1.4)<br/>
The&#160;format&#160;of&#160;the&#160;listing&#160;is&#160;as&#160;follows:&#160;<i>device</i>&#160;on&#160;<i>mount_point&#160;</i>type&#160;<i>file_system_type</i>&#160;(<i>op-<br/>tions</i>).&#160;For&#160;example,&#160;the&#160;first&#160;line&#160;shows&#160;that&#160;device&#160;/dev/sda2&#160;is&#160;mounted&#160;as&#160;the&#160;root<br/>file&#160;system,&#160;is&#160;of&#160;type&#160;ext4,&#160;and&#160;is&#160;both&#160;readable&#160;and&#160;writable&#160;(the&#160;option&#160;“rw”).&#160;This&#160;list-<br/>ing also has&#160;two interesting&#160;entries&#160;at&#160;the&#160;bottom&#160;of the&#160;list.&#160;The&#160;next-to-last&#160;entry&#160;shows&#160;a<br/>2GB SD&#160;memory&#160;card in&#160;a&#160;card reader mounted at&#160;/media/disk, and&#160;the&#160;last&#160;entry is&#160;a<br/>network drive&#160;mounted&#160;at&#160;/misc/musicbox.<br/>For&#160;our&#160;first&#160;experiment,&#160;we&#160;will&#160;work&#160;with&#160;a&#160;CD-ROM.&#160;First,&#160;let's&#160;look&#160;at&#160;a&#160;system&#160;be-<br/>fore&#160;a&#160;CD-ROM&#160;is&#160;inserted:<br/>
[me@linuxbox ~]$&#160;<b>mount<br/></b>/dev/mapper/VolGroup00-LogVol00 on / type ext4 (rw)<br/>proc on /proc type proc (rw)<br/>sysfs on /sys type sysfs (rw)<br/>devpts on /dev/pts type devpts (rw,gid=5,mode=620)<br/>/dev/sda1 on /boot type ext4 (rw)<br/>tmpfs on /dev/shm type tmpfs (rw)<br/>none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)<br/>sunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw)<br/>
This&#160;listing&#160;is&#160;from&#160;a&#160;CentOS&#160;system,&#160;which&#160;is&#160;using&#160;LVM&#160;(Logical&#160;Volume&#160;Manager)&#160;to<br/>create&#160;its&#160;root&#160;file&#160;system.&#160;Like&#160;many&#160;modern&#160;Linux&#160;distributions,&#160;this&#160;system&#160;will&#160;at-<br/>tempt&#160;to&#160;automatically&#160;mount&#160;the&#160;CD-ROM&#160;after&#160;insertion.&#160;After&#160;we&#160;insert&#160;the&#160;disc,&#160;we<br/>see&#160;the&#160;following:&#160;<br/>
[me@linuxbox ~]$&#160;<b>mount<br/></b>/dev/mapper/VolGroup00-LogVol00 on / type ext4 (rw)<br/>proc on /proc type proc (rw)<br/>sysfs on /sys type sysfs (rw)<br/>devpts on /dev/pts type devpts (rw,gid=5,mode=620)<br/>/dev/hda1 on /boot type ext4 (rw)<br/>tmpfs on /dev/shm type tmpfs (rw)<br/>none on /proc/sys/fs/binfmt_misc type binfmt_misc (rw)<br/>
185<br/>
<hr/>
<a name=210></a>15 – Storage&#160;Media<br/>
sunrpc on /var/lib/nfs/rpc_pipefs type rpc_pipefs (rw)<br/>/dev/sdc on /media/live-1.0.10-8 type iso9660 (ro,noexec,nosuid,&#160;<br/>nodev,uid=500)<br/>
After&#160;we&#160;insert&#160;the&#160;disc,&#160;we&#160;see&#160;the&#160;same&#160;listing&#160;as&#160;before&#160;with&#160;one&#160;additional&#160;entry.&#160;At<br/>the&#160;end&#160;of&#160;the&#160;listing&#160;we&#160;see&#160;that&#160;the&#160;CD-ROM&#160;(which&#160;is&#160;device&#160;/dev/sdc&#160;on&#160;this&#160;sys-<br/>tem)&#160;has&#160;been&#160;mounted&#160;on&#160;&#160;/media/live-1.0.10-8,&#160;and&#160;is&#160;type&#160;&#160;iso9660&#160;&#160;(a&#160;CD-<br/>ROM).&#160;For&#160;the&#160;purposes&#160;of&#160;our&#160;experiment,&#160;we're&#160;interested&#160;in&#160;the&#160;name&#160;of&#160;the&#160;device.<br/>When&#160;you&#160;conduct&#160;this&#160;experiment&#160;yourself,&#160;the&#160;device&#160;name&#160;will&#160;most&#160;likely&#160;be&#160;differ-<br/>ent.<br/>
<b>Warning:</b>&#160;In&#160;the&#160;examples&#160;that&#160;follow,&#160;it&#160;is&#160;vitally&#160;important&#160;that&#160;you&#160;pay&#160;close<br/>attention&#160;to&#160;the&#160;actual&#160;device&#160;names&#160;in&#160;use&#160;on&#160;your&#160;system&#160;and&#160;<b>do&#160;not&#160;use&#160;the<br/>names&#160;used&#160;in&#160;this&#160;text!</b><br/>
Also&#160;note&#160;that&#160;audio&#160;CDs&#160;are&#160;not&#160;the&#160;same&#160;as&#160;CD-ROMs.&#160;Audio&#160;CDs&#160;do&#160;not&#160;con-<br/>tain file&#160;systems&#160;and thus&#160;cannot&#160;be&#160;mounted in&#160;the&#160;usual&#160;sense.<br/>
Now&#160;that&#160;we&#160;have&#160;the&#160;device&#160;name&#160;of&#160;the&#160;CD-ROM&#160;drive,&#160;let's&#160;unmount&#160;the&#160;disc&#160;and&#160;re-<br/>mount&#160;it&#160;at&#160;another&#160;location&#160;in&#160;the&#160;file&#160;system&#160;tree.&#160;To&#160;do&#160;this,&#160;we&#160;become&#160;the&#160;superuser<br/>(using&#160;the&#160;command&#160;appropriate&#160;for&#160;our&#160;system)&#160;and&#160;unmount&#160;the&#160;disc&#160;with&#160;the&#160;umount<br/>(notice&#160;the&#160;spelling) command.<br/>
[me@linuxbox ~]$&#160;<b>su -<br/></b>Password:<br/>[root@linuxbox ~]#&#160;<b>umount /dev/sdc</b><br/>
The&#160;next&#160;step&#160;is&#160;to&#160;create&#160;a&#160;new&#160;<i>mount&#160;point</i>&#160;for&#160;the&#160;disk.&#160;A&#160;mount&#160;point&#160;is&#160;simply&#160;a&#160;direc-<br/>tory&#160;somewhere&#160;on&#160;the&#160;file&#160;system&#160;tree.&#160;There’s&#160;nothing&#160;special&#160;about&#160;it.&#160;It&#160;doesn't&#160;even<br/>have&#160;to&#160;be&#160;an&#160;empty&#160;directory,&#160;though&#160;if&#160;you&#160;mount&#160;a&#160;device&#160;on&#160;a&#160;non-empty&#160;directory,<br/>you will&#160;not&#160;be&#160;able&#160;to&#160;see&#160;the&#160;directory's&#160;previous&#160;contents&#160;until&#160;you&#160;unmount&#160;the&#160;device.<br/>For our purposes, we&#160;will&#160;create&#160;a&#160;new&#160;directory.<br/>
[root@linuxbox ~]#&#160;<b>mkdir /mnt/cdrom</b><br/>
Finally,&#160;we&#160;mount&#160;the&#160;CD-ROM&#160;at&#160;the&#160;new&#160;mount&#160;point.&#160;The&#160;-t&#160;option&#160;is&#160;used&#160;to&#160;specify<br/>the&#160;file&#160;system&#160;type.<br/>
186<br/>
<hr/>
<a name=211></a>Mounting and Unmounting Storage&#160;Devices<br/>
[root@linuxbox ~]#&#160;<b>mount -t iso9660 /dev/sdc /mnt/cdrom</b><br/>
Afterward, we&#160;can examine&#160;the&#160;contents&#160;of the&#160;CD-ROM&#160;via&#160;the&#160;new&#160;mount&#160;point.<br/>
[root@linuxbox ~]#&#160;<b>cd /mnt/cdrom<br/></b>[root@linuxbox cdrom]#&#160;<b>ls</b><br/>
Notice&#160;what&#160;happens&#160;when we&#160;try to&#160;unmount&#160;the&#160;CD-ROM.<br/>
[root@linuxbox cdrom]#&#160;<b>umount&#160;/dev/sdc<br/></b>umount: /mnt/cdrom: device is busy<br/>
Why&#160;is&#160;this?&#160;The&#160;reason&#160;is&#160;that&#160;we&#160;cannot&#160;unmount&#160;a&#160;device&#160;if&#160;the&#160;device&#160;is&#160;being&#160;used by<br/>someone&#160;or&#160;some&#160;process.&#160;In&#160;this&#160;case,&#160;we&#160;changed&#160;our&#160;working&#160;directory&#160;to&#160;the&#160;mount<br/>point&#160;for&#160;the&#160;CD-ROM,&#160;which&#160;causes&#160;the&#160;device&#160;to&#160;be&#160;busy.&#160;We&#160;can&#160;easily&#160;remedy&#160;the&#160;is-<br/>sue&#160;by changing&#160;the&#160;working directory to&#160;something&#160;other than&#160;the&#160;mount&#160;point:<br/>
[root@linuxbox cdrom]#&#160;<b>cd<br/></b>[root@linuxbox ~]#&#160;<b>umount /dev/sdc</b><br/>
Now&#160;the&#160;device&#160;unmounts&#160;successfully.<br/>
<b>Why&#160;Unmounting&#160;Is&#160;Important</b><br/>
If&#160;you&#160;look&#160;at&#160;the&#160;output&#160;of&#160;the&#160;free&#160;command,&#160;which&#160;displays&#160;statistics&#160;about<br/>memory&#160;usage,&#160;you&#160;will&#160;see&#160;a&#160;statistic&#160;called&#160;<i>buffers</i>.&#160;Computer&#160;systems&#160;are&#160;de-<br/>signed&#160;to&#160;go&#160;as&#160;fast&#160;as&#160;possible.&#160;One&#160;of&#160;the&#160;impediments&#160;to&#160;system&#160;speed&#160;is&#160;slow<br/>devices.&#160;Printers&#160;are&#160;a&#160;good&#160;example.&#160;Even&#160;the&#160;fastest&#160;printer&#160;is&#160;extremely&#160;slow<br/>by&#160;computer&#160;standards.&#160;A&#160;computer&#160;would&#160;be&#160;very&#160;slow&#160;indeed&#160;if&#160;it&#160;had&#160;to&#160;stop<br/>and&#160;wait&#160;for&#160;a&#160;printer&#160;to&#160;finish&#160;printing&#160;a&#160;page.&#160;In&#160;the&#160;early&#160;days&#160;of&#160;PCs&#160;(before<br/>multi-tasking),&#160;this&#160;was&#160;a&#160;real&#160;problem.&#160;If&#160;you&#160;were&#160;working&#160;on&#160;a&#160;spreadsheet&#160;or<br/>text&#160;document,&#160;the&#160;computer&#160;would&#160;stop&#160;and&#160;become&#160;unavailable&#160;every&#160;time&#160;you<br/>printed.&#160;The&#160;computer&#160;would&#160;send&#160;the&#160;data&#160;to&#160;the&#160;printer&#160;as&#160;fast&#160;as&#160;the&#160;printer<br/>could&#160;accept&#160;it,&#160;but&#160;it&#160;was&#160;very&#160;slow&#160;since&#160;printers&#160;don't&#160;print&#160;very&#160;fast.&#160;This&#160;prob-<br/>lem&#160;was&#160;solved&#160;by&#160;the&#160;advent&#160;of&#160;the&#160;&#160;<i>printer&#160;&#160;buffer</i>,&#160;a&#160;device&#160;containing&#160;some<br/>RAM&#160;memory&#160;that&#160;would&#160;sit&#160;between&#160;the&#160;computer&#160;and&#160;the&#160;printer.&#160;With&#160;the<br/>
187<br/>
<hr/>
<a name=212></a>15 – Storage&#160;Media<br/>
printer&#160;buffer&#160;in&#160;place,&#160;the&#160;computer&#160;would&#160;send&#160;the&#160;printer&#160;output&#160;to&#160;the&#160;buffer,<br/>and&#160;it&#160;would&#160;quickly&#160;be&#160;stored&#160;in&#160;the&#160;fast&#160;RAM&#160;so&#160;the&#160;computer&#160;could&#160;go&#160;back&#160;to<br/>work&#160;without&#160;waiting.&#160;Meanwhile,&#160;the&#160;printer&#160;buffer&#160;would&#160;slowly&#160;<i>spool</i>&#160;the&#160;data<br/>to&#160;the&#160;printer&#160;from&#160;the&#160;buffer's&#160;memory&#160;at&#160;the&#160;speed&#160;at&#160;which&#160;the&#160;printer&#160;could&#160;ac-<br/>cept&#160;it.<br/>This&#160;idea&#160;of&#160;buffering&#160;is&#160;used&#160;extensively&#160;in&#160;computers&#160;to&#160;make&#160;them&#160;faster.&#160;Don't<br/>let&#160;the&#160;need&#160;to&#160;occasionally&#160;read&#160;or&#160;write&#160;data&#160;to&#160;or&#160;from&#160;slow&#160;devices&#160;impede&#160;the<br/>speed&#160;of&#160;the&#160;system.&#160;Operating&#160;systems&#160;store&#160;data&#160;that&#160;has&#160;been&#160;read&#160;from&#160;and&#160;is<br/>to&#160;be&#160;written&#160;to&#160;storage&#160;devices&#160;in&#160;memory&#160;for&#160;as&#160;long&#160;as&#160;possible&#160;before&#160;actually<br/>having&#160;to&#160;interact&#160;with&#160;the&#160;slower&#160;device.&#160;On&#160;a&#160;Linux&#160;system,&#160;for&#160;example,&#160;you<br/>will&#160;notice&#160;that&#160;the&#160;system&#160;seems&#160;to fill&#160;up memory&#160;the&#160;longer&#160;it&#160;is&#160;used.&#160;This&#160;does<br/>not&#160;mean&#160;Linux&#160;is&#160;“using”&#160;all&#160;the&#160;memory;&#160;it&#160;means&#160;that&#160;Linux&#160;is&#160;taking&#160;advan-<br/>tage&#160;of all&#160;the&#160;available&#160;memory to do as&#160;much&#160;buffering as&#160;it&#160;can.<br/>This&#160;buffering&#160;allows&#160;writing&#160;to&#160;storage&#160;devices&#160;to&#160;be&#160;done&#160;very&#160;quickly&#160;because<br/>writing&#160;to&#160;the&#160;physical&#160;device&#160;is&#160;being&#160;deferred&#160;to&#160;a&#160;future&#160;time.&#160;In&#160;the&#160;meantime,<br/>the&#160;data&#160;destined&#160;for the&#160;device&#160;is&#160;piling&#160;up in&#160;memory.&#160;From&#160;time&#160;to&#160;time,&#160;the&#160;op-<br/>erating&#160;system&#160;will&#160;write&#160;this&#160;data&#160;to the&#160;physical&#160;device.<br/>Unmounting&#160;a&#160;device&#160;entails&#160;writing&#160;all&#160;the&#160;remaining&#160;data&#160;to&#160;the&#160;device&#160;so&#160;that&#160;it<br/>can&#160;be&#160;safely&#160;removed.&#160;If&#160;the&#160;device&#160;is&#160;removed&#160;without&#160;unmounting&#160;it&#160;first,&#160;the<br/>possibility&#160;exists&#160;that&#160;not&#160;all&#160;the&#160;data&#160;destined&#160;for&#160;the&#160;device&#160;has&#160;been&#160;transferred.<br/>In&#160;some&#160;cases,&#160;this&#160;data&#160;may&#160;include&#160;vital&#160;directory&#160;updates,&#160;which&#160;will&#160;lead&#160;to<br/><i>file&#160;system&#160;corruption</i>, one&#160;of the&#160;worst&#160;things&#160;that&#160;can&#160;happen on a&#160;computer.&#160;<br/>
Determining&#160;Device&#160;Names<br/>It's&#160;sometimes&#160;difficult&#160;to&#160;determine&#160;the&#160;name&#160;of&#160;a&#160;device.&#160;In&#160;the&#160;old&#160;days,&#160;it&#160;wasn't&#160;very<br/>hard.&#160;A&#160;device&#160;was&#160;always&#160;in&#160;the&#160;same&#160;place&#160;and&#160;it&#160;didn't&#160;change.&#160;Unix-like&#160;systems&#160;like<br/>it&#160;that&#160;way.&#160;When&#160;Unix&#160;was&#160;developed,&#160;“changing&#160;a&#160;disk&#160;drive”&#160;involved&#160;using&#160;a&#160;forklift<br/>to&#160;remove&#160;a&#160;washing&#160;machine-sized&#160;device&#160;from&#160;the&#160;computer&#160;room.&#160;In&#160;recent&#160;years,&#160;the<br/>typical&#160;&#160;&#160;desktop&#160;&#160;&#160;hardware&#160;&#160;&#160;configuration&#160;&#160;&#160;has&#160;&#160;&#160;become&#160;&#160;&#160;quite&#160;&#160;&#160;dynamic,&#160;&#160;&#160;and&#160;&#160;&#160;Linux&#160;&#160;&#160;has<br/>evolved&#160;to become&#160;more&#160;flexible&#160;than&#160;its&#160;ancestors.<br/>In&#160;the&#160;examples&#160;above&#160;we&#160;took&#160;advantage&#160;of&#160;the&#160;modern&#160;Linux&#160;desktop's&#160;ability&#160;to&#160;“au-<br/>tomagically”&#160;mount&#160;the&#160;device&#160;and&#160;then&#160;determine&#160;the&#160;name&#160;after&#160;the&#160;fact.&#160;But&#160;what&#160;if&#160;we<br/>are&#160;managing&#160;a&#160;server&#160;or&#160;some&#160;other&#160;environment&#160;where&#160;this&#160;does&#160;not&#160;occur?&#160;How&#160;can<br/>we&#160;figure&#160;it&#160;out?<br/>First,&#160;let's&#160;look&#160;at&#160;how&#160;the&#160;system&#160;names&#160;devices.&#160;If&#160;we&#160;list&#160;the&#160;contents&#160;of&#160;the&#160;/dev&#160;di-<br/>rectory&#160;(where&#160;all&#160;devices&#160;live), we&#160;can&#160;see&#160;that&#160;there&#160;are&#160;lots&#160;and lots&#160;of devices.<br/>
188<br/>
<hr/>
<a name=213></a>Mounting and Unmounting Storage&#160;Devices<br/>
[me@linuxbox ~]$&#160;<b>ls /dev</b><br/>
The&#160;contents&#160;of&#160;this&#160;listing&#160;reveal&#160;some&#160;patterns&#160;of&#160;device&#160;naming.&#160;Table&#160;15-2&#160;outlines&#160;a<br/>few&#160;of these&#160;patterns.<br/>
<i>Table&#160;15-2: Linux&#160;Storage&#160;Device&#160;Names</i><br/>
<b>Pattern</b><br/>
<b>Device</b><br/>
/dev/fd*<br/>
Floppy disk drives.<br/>
/dev/hd*<br/>
IDE&#160;(PATA) disks&#160;on older systems.&#160;Typical&#160;motherboards&#160;<br/>contain two IDE&#160;connectors&#160;or&#160;<i>channels</i>, each&#160;with a&#160;cable&#160;with&#160;<br/>two attachment&#160;points&#160;for drives.&#160;The&#160;first&#160;drive&#160;on the&#160;cable&#160;is&#160;<br/>called&#160;the&#160;<i>master</i>&#160;device,&#160;and the&#160;second is&#160;called the&#160;<i>slave</i>&#160;<br/>device.&#160;The&#160;device&#160;names&#160;are&#160;ordered such that&#160;/dev/hda&#160;<br/>refers&#160;to&#160;the&#160;master device&#160;on the&#160;first&#160;channel,&#160;/dev/hdb&#160;is&#160;the<br/>slave&#160;device&#160;on the&#160;first&#160;channel;&#160;/dev/hdc&#160;is&#160;the&#160;master&#160;<br/>device&#160;on the&#160;second channel, and so on.&#160;A&#160;trailing digit&#160;indicates<br/>the&#160;partition number on the&#160;device.&#160;For example,&#160;/dev/hda1&#160;<br/>refers&#160;to&#160;the&#160;first&#160;partition on the&#160;first&#160;hard drive&#160;on the&#160;system,&#160;<br/>while&#160;/dev/hda&#160;refers&#160;to the&#160;entire&#160;drive.<br/>
/dev/lp*<br/>
Printers.<br/>
/dev/sd*<br/>
SCSI disks. On modern&#160;Linux systems, the&#160;kernel&#160;treats&#160;all&#160;disk-<br/>like&#160;devices&#160;(including PATA/SATA&#160;hard disks, flash drives, and&#160;<br/>USB mass&#160;storage&#160;devices&#160;such as&#160;portable&#160;music&#160;players&#160;and&#160;<br/>digital&#160;cameras) as&#160;SCSI disks.&#160;The&#160;rest&#160;of the&#160;naming system&#160;is&#160;<br/>similar&#160;to the&#160;older&#160;/dev/hd*&#160;naming scheme&#160;described&#160;above.<br/>
/dev/sr*<br/>
Optical&#160;drives&#160;(CD/DVD&#160;readers&#160;and burners).<br/>
In&#160;addition,&#160;we&#160;often&#160;see&#160;symbolic&#160;links&#160;such&#160;as&#160;/dev/cdrom,&#160;/dev/dvd,&#160;and&#160;/dev/<br/>floppy, which point&#160;to the&#160;actual&#160;device&#160;files, provided as&#160;a&#160;convenience.<br/>If&#160;you&#160;are&#160;working&#160;on&#160;a&#160;system&#160;that&#160;does&#160;not&#160;automatically&#160;mount&#160;removable&#160;devices,<br/>you&#160;can&#160;use&#160;the&#160;following&#160;technique&#160;to&#160;determine&#160;how&#160;the&#160;removable&#160;device&#160;is&#160;named<br/>when&#160;it&#160;is&#160;attached.&#160;First,&#160;start&#160;a&#160;real-time&#160;view&#160;of&#160;the&#160;&#160;/var/log/messages&#160;&#160;or&#160;&#160;/<br/>var/log/syslog&#160;file&#160;(you may require&#160;superuser privileges&#160;for this).<br/>
[me@linuxbox ~]$&#160;<b>sudo tail -f /var/log/messages</b><br/>
189<br/>
<hr/>
<a name=214></a>15 – Storage&#160;Media<br/>
The&#160;last&#160;few&#160;lines&#160;of&#160;the&#160;file&#160;will&#160;be&#160;displayed&#160;and&#160;then&#160;will&#160;pause.&#160;Next,&#160;plug&#160;in&#160;the&#160;re-<br/>movable&#160;device.&#160;In&#160;this&#160;example,&#160;we&#160;will&#160;use&#160;a&#160;16MB&#160;flash&#160;drive.&#160;Almost&#160;immediately,<br/>the&#160;kernel&#160;will&#160;notice&#160;the&#160;device&#160;and probe&#160;it.<br/>
Jul 23 10:07:53 linuxbox kernel: usb 3-2: new full speed USB device&#160;<br/>using uhci_hcd and address 2<br/>Jul 23 10:07:53 linuxbox kernel: usb 3-2: configuration #1 chosen&#160;<br/>from 1 choice<br/>Jul 23 10:07:53 linuxbox kernel: scsi3 : SCSI emulation for USB Mass&#160;<br/>Storage devices<br/>Jul 23 10:07:58 linuxbox kernel: scsi scan: INQUIRY result too short&#160;<br/>(5), using 36<br/>Jul 23 10:07:58 linuxbox kernel: scsi 3:0:0:0: Direct-Access &#160; &#160; Easy<br/>Disk &#160; &#160; &#160; &#160; &#160; &#160; 1.00 PQ: 0 ANSI: 2<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] 31263 512-byte&#160;<br/>hardware sectors (16 MB)<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Write Protect is&#160;<br/>off<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Assuming drive&#160;<br/>cache: write through<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] 31263 512-byte&#160;<br/>hardware sectors (16 MB)<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Write Protect is&#160;<br/>off<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Assuming drive&#160;<br/>cache: write through<br/>Jul 23 10:07:59 linuxbox kernel: &#160;sdb: sdb1<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Attached SCSI&#160;<br/>removable disk<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: Attached scsi generic&#160;<br/>sg3 type 0<br/>
After&#160;the&#160;display&#160;pauses&#160;again,&#160;press&#160;Ctrl-c&#160;to&#160;get&#160;the&#160;prompt&#160;back.&#160;&#160;The&#160;interesting<br/>parts&#160;of&#160;the&#160;output&#160;are&#160;the&#160;repeated&#160;references&#160;to&#160;[sdb],&#160;which&#160;matches&#160;our&#160;expectation<br/>of&#160;a&#160;SCSI&#160;disk&#160;device&#160;name.&#160;&#160;Knowing&#160;this,&#160;these&#160;two&#160;lines&#160;become&#160;particularly&#160;illumi-<br/>nating:<br/>
Jul 23 10:07:59 linuxbox kernel: &#160;sdb: sdb1<br/>Jul 23 10:07:59 linuxbox kernel: sd 3:0:0:0: [sdb] Attached SCSI&#160;<br/>removable disk<br/>
190<br/>
<hr/>
<a name=215></a>Mounting and Unmounting Storage&#160;Devices<br/>
This&#160;tells&#160;us&#160;the&#160;device&#160;name&#160;is&#160;/dev/sdb&#160;for&#160;the&#160;entire&#160;device&#160;and&#160;/dev/sdb1&#160;for<br/>the&#160;first&#160;partition&#160;on&#160;the&#160;device.&#160;&#160;As&#160;we&#160;have&#160;seen,&#160;working&#160;with&#160;Linux&#160;is&#160;full&#160;of&#160;interest-<br/>ing detective&#160;work!<br/>
<b>Tip:</b>&#160;Using&#160;the&#160;tail&#160;-f&#160;/var/log/messages&#160;technique&#160;is&#160;a&#160;great&#160;way&#160;to<br/>watch&#160;what&#160;the&#160;system&#160;is&#160;doing in&#160;near real-time.<br/>
With&#160;our device&#160;name&#160;in hand, we&#160;can&#160;now&#160;mount&#160;the&#160;flash drive.<br/>
[me@linuxbox ~]$&#160;<b>sudo mkdir /mnt/flash<br/></b>[me@linuxbox ~]$&#160;<b>sudo mount /dev/sdb1 /mnt/flash<br/></b>[me@linuxbox ~]$&#160;<b>df<br/></b>Filesystem &#160; &#160; &#160; &#160; &#160; 1K-blocks &#160; &#160; &#160;Used Available Use% Mounted on<br/>/dev/sda2 &#160; &#160; &#160; &#160; &#160; &#160; 15115452 &#160; 5186944 &#160; 9775164 &#160;35% /<br/>/dev/sda5 &#160; &#160; &#160; &#160; &#160; &#160; 59631908 &#160;31777376 &#160;24776480 &#160;57% /home<br/>/dev/sda1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; 147764 &#160; &#160; 17277 &#160; &#160;122858 &#160;13% /boot<br/>tmpfs &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 776808 &#160; &#160; &#160; &#160; 0 &#160; &#160;776808 &#160; 0% /dev/shm<br/>/dev/sdb1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;15560 &#160; &#160; &#160; &#160; 0 &#160; &#160; 15560 &#160; 0% /mnt/flash<br/>
The&#160;device&#160;name&#160;will&#160;remain&#160;the&#160;same&#160;as&#160;long&#160;as&#160;it&#160;remains&#160;physically&#160;attached&#160;to&#160;the<br/>computer&#160;and the&#160;computer&#160;is&#160;not&#160;rebooted.<br/>
<b>Creating&#160;New&#160;File&#160;Systems<br/></b>Let's&#160;say&#160;that&#160;we&#160;want&#160;to&#160;reformat&#160;the&#160;flash&#160;drive&#160;with&#160;a&#160;Linux&#160;native&#160;file&#160;system,&#160;rather<br/>than the&#160;FAT32&#160;system&#160;it&#160;has&#160;now.&#160;This&#160;involves&#160;two steps.<br/>
1.&#160;(optional) Create&#160;a&#160;new&#160;partition&#160;layout&#160;if the&#160;existing&#160;one&#160;is&#160;not&#160;to&#160;our liking.<br/>2.&#160;Create&#160;a&#160;new, empty file&#160;system&#160;on the&#160;drive.<br/>
<b>Warning!</b>&#160;In&#160;the&#160;following&#160;exercise,&#160;we&#160;are&#160;going&#160;to&#160;format&#160;a&#160;flash&#160;drive.&#160;Use&#160;a<br/>drive&#160;that&#160;contains&#160;nothing&#160;you&#160;care&#160;about&#160;because&#160;it&#160;will&#160;be&#160;erased!&#160;Again,<br/><b>make&#160;absolutely&#160;sure&#160;you&#160;are&#160;specifying&#160;the&#160;correct&#160;device&#160;name&#160;for&#160;your<br/>system,&#160;not&#160;the&#160;one&#160;shown&#160;in&#160;the&#160;text.&#160;Failure&#160;to&#160;heed&#160;this&#160;warning&#160;could&#160;re-<br/>sult in&#160;you&#160;formatting (i.e.,&#160;erasing) the&#160;wrong drive!</b><br/>
191<br/>
<hr/>
<a name=216></a>15 – Storage&#160;Media<br/>
Manipulating&#160;Partitions&#160;with&#160;fdisk<br/>fdisk&#160;is&#160;one&#160;of&#160;a&#160;host&#160;of&#160;programs&#160;(both&#160;command&#160;line&#160;and&#160;graphical)&#160;that&#160;allow&#160;us&#160;to<br/>interact&#160;directly&#160;with&#160;disk-like&#160;devices&#160;(such&#160;as&#160;hard&#160;disk&#160;drives&#160;and&#160;flash&#160;drives)&#160;at&#160;a<br/>very&#160;low&#160;level.&#160;With&#160;this&#160;tool&#160;we&#160;can&#160;edit,&#160;delete,&#160;and&#160;create&#160;partitions&#160;on&#160;the&#160;device.&#160;To<br/>work&#160;with&#160;our&#160;flash&#160;drive,&#160;we&#160;must&#160;first&#160;unmount&#160;it&#160;(if&#160;needed)&#160;and&#160;then&#160;invoke&#160;the<br/>fdisk&#160;program&#160;as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>sudo umount /dev/sdb1<br/></b>[me@linuxbox ~]$&#160;<b>sudo fdisk /dev/sdb</b><br/>
Notice&#160;that&#160;we&#160;must&#160;specify the&#160;device&#160;in terms&#160;of the&#160;entire&#160;device,&#160;not&#160;by partition&#160;num-<br/>ber.&#160;After the&#160;program&#160;starts&#160;up, we&#160;will&#160;see&#160;the&#160;following prompt:<br/>
Command (m for help):<br/>
Entering an “m”&#160;will&#160;display the&#160;program&#160;menu.<br/>
Command action&#160;<br/>&#160; &#160;a &#160; toggle a bootable flag&#160;<br/>&#160; &#160;b &#160; edit bsd disklabel&#160;<br/>&#160; &#160;c &#160; toggle the dos compatibility flag&#160;<br/>&#160; &#160;d &#160; delete a partition&#160;<br/>&#160; &#160;l &#160; list known partition types&#160;<br/>&#160; &#160;m &#160; print this menu&#160;<br/>&#160; &#160;n &#160; add a new partition&#160;<br/>&#160; &#160;o &#160; create a new empty DOS partition table&#160;<br/>&#160; &#160;p &#160; print the partition table&#160;<br/>&#160; &#160;q &#160; quit without saving changes&#160;<br/>&#160; &#160;s &#160; create a new empty Sun disklabel&#160;<br/>&#160; &#160;t &#160; change a partition's system id&#160;<br/>&#160; &#160;u &#160; change display/entry units&#160;<br/>&#160; &#160;v &#160; verify the partition table&#160;<br/>&#160; &#160;w &#160; write table to disk and exit&#160;<br/>&#160; &#160;x &#160; extra functionality (experts only)&#160;<br/>
Command (m for help):&#160;<br/>
The&#160;first&#160;thing&#160;we&#160;want&#160;to&#160;do&#160;is&#160;examine&#160;the&#160;existing&#160;partition&#160;layout.&#160;We&#160;do&#160;this&#160;by&#160;en&#160;-<br/>
192<br/>
<hr/>
<a name=217></a>Creating&#160;New&#160;File&#160;Systems<br/>
tering&#160;“p”&#160;to&#160;print&#160;the&#160;partition table&#160;for the&#160;device.<br/>
Command (m for help):&#160;<b>p</b>&#160;<br/>
Disk /dev/sdb: 16 MB, 16006656 bytes&#160;<br/>1 heads, 31 sectors/track, 1008 cylinders&#160;<br/>Units = cylinders of 31 * 512 = 15872 bytes&#160;<br/>
&#160; &#160;Device Boot &#160; &#160; &#160;Start &#160; &#160; &#160; &#160; End &#160; &#160; &#160;Blocks &#160; Id &#160;System&#160;<br/>/dev/sdb1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; 2 &#160; &#160; &#160; &#160;1008 &#160; &#160; &#160; 15608+ &#160; b &#160;W95 FAT32&#160;<br/>
In&#160;this&#160;example,&#160;we&#160;see&#160;a&#160;16&#160;MB&#160;device&#160;with&#160;a&#160;single&#160;partition&#160;(1)&#160;that&#160;uses&#160;1,006&#160;of&#160;the<br/>available&#160;1,008&#160;cylinders&#160;on&#160;the&#160;device.&#160;The&#160;partition&#160;is&#160;identified&#160;as&#160;a&#160;Windows&#160;95<br/>FAT32&#160;partition.&#160;Some&#160;programs&#160;will&#160;use&#160;this&#160;identifier&#160;to&#160;limit&#160;the&#160;kinds&#160;of&#160;operations<br/>that&#160;can&#160;be&#160;done&#160;to&#160;the&#160;disk,&#160;but&#160;most&#160;of&#160;the&#160;time&#160;it&#160;is&#160;not&#160;critical&#160;to&#160;change&#160;it.&#160;However,<br/>in&#160;the&#160;interest&#160;of&#160;this&#160;demonstration,&#160;we&#160;will&#160;change&#160;it&#160;to&#160;indicate&#160;a&#160;Linux&#160;partition.&#160;To&#160;do<br/>this,&#160;we&#160;must&#160;first&#160;find&#160;out&#160;what&#160;ID&#160;is&#160;used&#160;to&#160;identify&#160;a&#160;Linux&#160;partition.&#160;In&#160;the&#160;previous<br/>listing,&#160;we&#160;see&#160;that&#160;the&#160;ID&#160;b&#160;is&#160;used&#160;to&#160;specify&#160;the&#160;existing&#160;partition.&#160;To&#160;see&#160;a&#160;list&#160;of&#160;the<br/>available&#160;partition&#160;types,&#160;we&#160;refer&#160;to&#160;the&#160;program&#160;menu.&#160;There&#160;we&#160;can&#160;see&#160;the&#160;following<br/>choice:<br/>
&#160; &#160;l &#160; list known partition types<br/>
If&#160;we&#160;enter&#160;l&#160;at&#160;the&#160;prompt,&#160;a&#160;large&#160;list&#160;of&#160;possible&#160;types&#160;is&#160;displayed.&#160;Among&#160;them&#160;we<br/>see&#160;b&#160;for our existing&#160;partition type&#160;and&#160;83&#160;for Linux.<br/>Going&#160;back to&#160;the&#160;menu,&#160;we&#160;see&#160;this&#160;choice&#160;to&#160;change&#160;a&#160;partition ID:<br/>
&#160; &#160;t &#160; change a partition's system id<br/>
We&#160;enter&#160;t&#160;at&#160;the&#160;prompt&#160;and enter&#160;the&#160;new&#160;ID:<br/>
Command (m for help):&#160;<b>t&#160;<br/></b>Selected partition 1&#160;<br/>Hex code (type L to list codes):&#160;<b>83</b>&#160;<br/>Changed system type of partition 1 to 83 (Linux)&#160;<br/>
This&#160;completes&#160;all&#160;the&#160;changes&#160;we&#160;need&#160;to&#160;make.&#160;Up&#160;to&#160;this&#160;point,&#160;the&#160;device&#160;has&#160;been&#160;un-<br/>touched&#160;(all&#160;the&#160;changes&#160;have&#160;been&#160;stored&#160;in&#160;memory,&#160;not&#160;on&#160;the&#160;physical&#160;device),&#160;so&#160;we<br/>
193<br/>
<hr/>
<a name=218></a>15 – Storage&#160;Media<br/>
will&#160;write&#160;the&#160;modified&#160;partition&#160;table&#160;to&#160;the&#160;device&#160;and&#160;exit.&#160;To&#160;do&#160;this,&#160;we&#160;enter&#160;w&#160;at&#160;the<br/>prompt.<br/>
Command (m for help):&#160;<b>w</b>&#160;<br/>The partition table has been altered!&#160;<br/>
Calling ioctl() to re-read partition table.&#160;<br/>
WARNING: If you have created or modified any DOS 6.x&#160;<br/>partitions, please see the fdisk manual page for additional&#160;<br/>information.&#160;<br/>Syncing disks.&#160;<br/>[me@linuxbox ~]$<br/>
If&#160;we&#160;had&#160;decided&#160;to&#160;leave&#160;the&#160;device&#160;unaltered,&#160;we&#160;could&#160;have&#160;entered&#160;q&#160;at&#160;the&#160;prompt,<br/>which&#160;would&#160;have&#160;exited&#160;the&#160;program&#160;without&#160;writing&#160;the&#160;changes.&#160;We&#160;can&#160;safely&#160;ignore<br/>the&#160;ominous-sounding&#160;warning message.<br/>
Creating&#160;a&#160;New&#160;File&#160;System&#160;with&#160;mkfs<br/>With&#160;our partition editing&#160;done&#160;(lightweight&#160;though it&#160;might&#160;have&#160;been),&#160;it’s&#160;time&#160;to&#160;create<br/>a&#160;new&#160;file&#160;system&#160;on&#160;our&#160;flash&#160;drive.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;use&#160;mkfs&#160;(short&#160;for&#160;“make&#160;file<br/>system”),&#160;which&#160;can&#160;create&#160;file&#160;systems&#160;in&#160;a&#160;variety&#160;of&#160;formats.&#160;To&#160;create&#160;an&#160;ext4&#160;file&#160;sys-<br/>tem&#160;on&#160;the&#160;device,&#160;we&#160;use&#160;the&#160;-t&#160;option&#160;to&#160;specify&#160;the&#160;ext4”system&#160;type,&#160;followed&#160;by<br/>the&#160;name&#160;of the&#160;device&#160;containing the&#160;partition&#160;we&#160;want&#160;to format.<br/>
[me@linuxbox ~]$&#160;<b>sudo mkfs -t ext4 /dev/sdb1</b>&#160;<br/>mke2fs 2.23.2 (12-Jul-2011)&#160;<br/>Filesystem label=&#160;<br/>OS type: Linux&#160;<br/>Block size=1024 (log=0)&#160;<br/>Fragment size=1024 (log=0)&#160;<br/>3904 inodes, 15608 blocks&#160;<br/>780 blocks (5.00%) reserved for the super user&#160;<br/>First data block=1&#160;<br/>Maximum filesystem blocks=15990784&#160;<br/>2 block groups&#160;<br/>8192 blocks per group, 8192 fragments per group&#160;<br/>1952 inodes per group&#160;<br/>Superblock backups stored on blocks:&#160;<br/>
8193&#160;<br/>
194<br/>
<hr/>
<a name=219></a>Creating&#160;New&#160;File&#160;Systems<br/>
Writing inode tables: done &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br/>Creating journal (1024 blocks): done&#160;<br/>Writing superblocks and filesystem accounting information: done&#160;<br/>
This filesystem will be automatically checked every 34 mounts or&#160;<br/>180 days, whichever comes first. &#160;Use tune2fs -c or -i to override.<br/>[me@linuxbox ~]$<br/>
The&#160;program&#160;will&#160;display&#160;a&#160;lot&#160;of&#160;information&#160;when&#160;ext4&#160;is&#160;the&#160;chosen&#160;file&#160;system&#160;type.<br/>To&#160;reformat&#160;the&#160;device&#160;to&#160;its&#160;original&#160;FAT32&#160;file&#160;system,&#160;specify&#160;vfat&#160;as&#160;the&#160;file&#160;system<br/>type.<br/>
[me@linuxbox ~]$&#160;<b>sudo mkfs -t vfat /dev/sdb1</b><br/>
This&#160;process&#160;of&#160;partitioning&#160;and&#160;formatting&#160;can&#160;be&#160;used&#160;anytime&#160;additional&#160;storage&#160;de-<br/>vices&#160;are&#160;added&#160;to&#160;the&#160;system.&#160;While&#160;we&#160;worked&#160;with&#160;a&#160;tiny&#160;flash&#160;drive,&#160;the&#160;same&#160;process<br/>can&#160;be&#160;applied&#160;to&#160;internal&#160;hard&#160;disks&#160;and&#160;other&#160;removable&#160;storage&#160;devices&#160;like&#160;USB&#160;hard<br/>drives.<br/>
<b>Testing&#160;and&#160;Repairing&#160;File&#160;Systems<br/></b>In&#160;our&#160;earlier&#160;discussion&#160;of&#160;the&#160;/etc/fstab&#160;file,&#160;we&#160;saw&#160;some&#160;mysterious&#160;digits&#160;at&#160;the<br/>end&#160;of&#160;each&#160;line.&#160;Each&#160;time&#160;the&#160;system&#160;boots,&#160;it&#160;routinely&#160;checks&#160;the&#160;integrity&#160;of&#160;the&#160;file<br/>systems&#160;before&#160;mounting&#160;them.&#160;This&#160;is&#160;done&#160;by&#160;the&#160;fsck&#160;program&#160;(short&#160;for&#160;“file&#160;system<br/>check”).&#160;The&#160;last&#160;number&#160;in&#160;each&#160;fstab&#160;entry&#160;specifies&#160;the&#160;order&#160;in&#160;which&#160;the&#160;devices<br/>are&#160;to&#160;be&#160;checked.&#160;In&#160;our&#160;previous&#160;example,&#160;we&#160;see&#160;that&#160;the&#160;root&#160;file&#160;system&#160;is&#160;checked<br/>first,&#160;followed&#160;by&#160;the&#160;home&#160;and&#160;boot&#160;file&#160;systems.&#160;Devices&#160;with&#160;a&#160;zero&#160;as&#160;the&#160;last&#160;digit<br/>are&#160;not&#160;routinely&#160;checked.<br/>In addition to checking the&#160;integrity&#160;of file&#160;systems,&#160;fsck&#160;can&#160;also repair&#160;corrupt&#160;file&#160;sys-<br/>tems&#160;with&#160;varying&#160;degrees&#160;of&#160;success,&#160;depending&#160;on&#160;the&#160;amount&#160;of&#160;damage.&#160;On&#160;Unix-like<br/>file&#160;systems,&#160;recovered&#160;portions&#160;of&#160;files&#160;are&#160;placed&#160;in&#160;the&#160;&#160;lost+found&#160;&#160;directory,&#160;lo-<br/>cated&#160;in the&#160;root&#160;of each&#160;file&#160;system.<br/>To check our flash drive&#160;(which&#160;should&#160;be&#160;unmounted&#160;first), we&#160;could&#160;do the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>sudo fsck /dev/sdb1<br/></b>fsck 1.40.8 (13-Mar-2016)&#160;<br/>e2fsck 1.40.8 (13-Mar-2016)&#160;<br/>
195<br/>
<hr/>
<a name=220></a>15 – Storage&#160;Media<br/>
/dev/sdb1: clean, 11/3904 files, 1661/15608 blocks<br/>
These&#160;days,&#160;file&#160;system&#160;corruption&#160;is&#160;quite&#160;rare&#160;unless&#160;there&#160;is&#160;a&#160;hardware&#160;problem,&#160;such<br/>as&#160;a&#160;failing&#160;disk&#160;drive.&#160;On&#160;most&#160;systems,&#160;file&#160;system&#160;corruption&#160;detected&#160;at&#160;boot&#160;time&#160;will<br/>cause&#160;the&#160;system&#160;to stop and&#160;direct&#160;you to run&#160;fsck&#160;before&#160;continuing.<br/>
<b>What&#160;the&#160;fsck?</b><br/>
In&#160;Unix&#160;culture,&#160;the&#160;word&#160;<i>fsck</i>&#160;is&#160;often&#160;used&#160;in&#160;place&#160;of&#160;a&#160;popular&#160;word&#160;with&#160;which<br/>it&#160;shares&#160;three&#160;letters.&#160;This&#160;is&#160;especially&#160;appropriate,&#160;given&#160;that&#160;you&#160;will&#160;probably<br/>be&#160;uttering&#160;the&#160;aforementioned&#160;word&#160;if&#160;you&#160;find&#160;yourself&#160;in&#160;a&#160;situation&#160;where&#160;you<br/>are&#160;forced&#160;to run&#160;fsck.<br/>
<b>Moving&#160;Data&#160;Directly&#160;to&#160;and&#160;from&#160;Devices<br/></b>While&#160;we&#160;usually&#160;think&#160;of&#160;data&#160;on&#160;our&#160;computers&#160;as&#160;being&#160;organized&#160;into&#160;files,&#160;it&#160;is&#160;also<br/>possible&#160;to think of the&#160;data&#160;in&#160;“raw”&#160;form.&#160;If we&#160;look&#160;at&#160;a&#160;disk drive, for example,&#160;we&#160;see<br/>that&#160;it&#160;consists&#160;of&#160;a&#160;large&#160;number&#160;of&#160;“blocks”&#160;of&#160;data&#160;that&#160;the&#160;operating&#160;system&#160;sees&#160;as&#160;di-<br/>rectories&#160;and&#160;files.&#160;However,&#160;if&#160;we&#160;could&#160;treat&#160;a&#160;disk&#160;drive&#160;as&#160;simply&#160;a&#160;large&#160;collection&#160;of<br/>data&#160;blocks, we&#160;could perform&#160;useful&#160;tasks, such as&#160;cloning&#160;devices.<br/>The&#160;dd&#160;program&#160;performs&#160;this&#160;task.&#160;It&#160;copies&#160;blocks&#160;of&#160;data&#160;from&#160;one&#160;place&#160;to&#160;another.&#160;It<br/>uses&#160;a&#160;unique&#160;syntax (for historical&#160;reasons) and is&#160;usually&#160;used&#160;this&#160;way:<br/>
<b>dd if=<i>input_file</i></b><b>&#160;of=<i>output_file</i></b><b>&#160;[bs=<i>block_size</i></b><b>&#160;[count=<i>blocks</i></b><b>]]</b><br/>
<b>Warning!</b>&#160;&#160;The&#160;&#160;dd&#160;&#160;command&#160;is&#160;very&#160;powerful.&#160;Though&#160;its&#160;name&#160;derives&#160;from<br/>“data&#160;&#160;&#160;definition,”&#160;&#160;&#160;it&#160;&#160;&#160;is&#160;&#160;&#160;sometimes&#160;&#160;&#160;called&#160;&#160;&#160;“destroy&#160;&#160;&#160;disk”&#160;&#160;&#160;because&#160;&#160;&#160;users&#160;&#160;&#160;often<br/>mistype&#160;either&#160;the&#160;&#160;if&#160;&#160;or&#160;&#160;of&#160;&#160;specification.&#160;&#160;<b>Always&#160;double-check&#160;your&#160;input<br/>and&#160;output specifications&#160;before&#160;pressing enter!</b><br/>
Let’s&#160;say&#160;we&#160;had&#160;two&#160;USB&#160;flash&#160;drives&#160;of&#160;the&#160;same&#160;size&#160;and&#160;we&#160;wanted&#160;to&#160;exactly&#160;copy<br/>the&#160;first&#160;drive&#160;to&#160;the&#160;second.&#160;If&#160;we&#160;attached&#160;both&#160;drives&#160;to&#160;the&#160;computer&#160;and&#160;they&#160;are&#160;as&#160;-<br/>signed&#160;to&#160;devices&#160;/dev/sdb&#160;and&#160;/dev/sdc&#160;respectively,&#160;we&#160;could&#160;copy&#160;everything&#160;on<br/>the&#160;first&#160;drive&#160;to&#160;the&#160;second drive&#160;with the&#160;following:<br/>
196<br/>
<hr/>
<a name=221></a>Moving Data&#160;Directly&#160;to and&#160;from&#160;Devices<br/>
<b>dd if=/dev/sdb of=/dev/sdc</b><br/>
Alternately,&#160;if&#160;only&#160;the&#160;first&#160;device&#160;were&#160;attached&#160;to&#160;the&#160;computer,&#160;we&#160;could&#160;copy&#160;its&#160;con-<br/>tents&#160;to&#160;an ordinary&#160;file&#160;for later&#160;restoration&#160;or copying.<br/>
<b>dd if=/dev/sdb of=flash_drive.img</b><br/>
<b>Creating&#160;CD-ROM&#160;Images<br/></b>Writing a&#160;recordable&#160;CD-ROM&#160;(either&#160;a&#160;CD-R or CD-RW) consists&#160;of two steps.<br/>
1.&#160;Constructing&#160;an&#160;<i>iso image&#160;file</i>&#160;that&#160;is&#160;the&#160;exact&#160;file&#160;system&#160;image&#160;of the&#160;CD-ROM<br/>2.&#160;Writing the&#160;image&#160;file&#160;onto the&#160;CD-ROM&#160;media<br/>
Creating&#160;an&#160;Image&#160;Copy&#160;of&#160;a&#160;CD-ROM<br/>If&#160;we&#160;want&#160;to&#160;make&#160;an&#160;ISO&#160;image&#160;of&#160;an&#160;existing&#160;CD-ROM,&#160;we&#160;can&#160;use&#160;dd&#160;to&#160;read&#160;all&#160;the<br/>data&#160;blocks&#160;off&#160;the&#160;CD-ROM&#160;and&#160;copy&#160;them&#160;to&#160;a&#160;local&#160;file.&#160;Say&#160;we&#160;had&#160;an&#160;Ubuntu&#160;CD<br/>and&#160;we&#160;wanted&#160;to&#160;make&#160;an&#160;ISO&#160;file&#160;that&#160;we&#160;could&#160;later&#160;use&#160;to&#160;make&#160;more&#160;copies.&#160;After&#160;in-<br/>serting&#160;the&#160;CD&#160;and&#160;determining&#160;its&#160;device&#160;name&#160;(we’ll&#160;assume&#160;/dev/cdrom),&#160;we&#160;can<br/>make&#160;the&#160;ISO&#160;file&#160;like&#160;so:<br/>
<b>dd if=/dev/cdrom of=ubuntu.iso</b><br/>
This&#160;technique&#160;works&#160;for&#160;data&#160;DVDs&#160;as&#160;well&#160;but&#160;will&#160;not&#160;work&#160;for&#160;audio&#160;CDs,&#160;as&#160;they&#160;do<br/>not&#160;use&#160;a&#160;file&#160;system&#160;for storage.&#160;For audio CDs, look at&#160;the&#160;cdrdao&#160;command.<br/>
Creating&#160;an&#160;Image&#160;From&#160;a&#160;Collection&#160;of&#160;Files<br/>To&#160;&#160;&#160;create&#160;&#160;&#160;an&#160;&#160;&#160;ISO&#160;&#160;&#160;image&#160;&#160;&#160;file&#160;&#160;&#160;containing&#160;&#160;&#160;the&#160;&#160;&#160;contents&#160;&#160;&#160;of&#160;&#160;&#160;a&#160;&#160;&#160;directory,&#160;&#160;&#160;we&#160;&#160;&#160;use&#160;&#160;&#160;the<br/>genisoimage&#160;program.&#160;To&#160;do&#160;this,&#160;we&#160;first&#160;create&#160;a&#160;directory&#160;containing&#160;all&#160;the&#160;files<br/>we&#160;want&#160;to&#160;include&#160;in&#160;the&#160;image,&#160;and&#160;then&#160;execute&#160;the&#160;genisoimage&#160;command&#160;to&#160;cre-<br/>ate&#160;the&#160;image&#160;file.&#160;For&#160;example,&#160;if&#160;we&#160;had&#160;created&#160;a&#160;directory&#160;called&#160;~/cd-rom-files<br/>and&#160;filled&#160;it&#160;with&#160;files&#160;for&#160;our&#160;CD-ROM,&#160;we&#160;could&#160;create&#160;an&#160;image&#160;file&#160;named&#160;&#160;cd-<br/>rom.iso&#160;with the&#160;following command:<br/>
<b>genisoimage -o cd-rom.iso -R -J ~/cd-rom-files</b><br/>
197<br/>
<hr/>
<a name=222></a>15 – Storage&#160;Media<br/>
The&#160;-R&#160;option&#160;adds&#160;metadata&#160;for&#160;the&#160;<i>Rock&#160;Ridge&#160;extensions</i>,&#160;which&#160;allows&#160;the&#160;use&#160;of&#160;long<br/>filenames&#160;and&#160;POSIX-style&#160;file&#160;permissions.&#160;Likewise,&#160;the&#160;-J&#160;option&#160;enables&#160;the&#160;<i>Joliet<br/>extensions</i>,&#160;which permit&#160;long&#160;filenames&#160;for&#160;Windows.<br/>
<b>A&#160;Program&#160;by&#160;Any&#160;Other&#160;Name...</b><br/>
If&#160;you&#160;look&#160;at&#160;online&#160;tutorials&#160;for&#160;creating&#160;and&#160;burning&#160;optical&#160;media&#160;like&#160;CD-<br/>ROMs&#160;and&#160;DVDs,&#160;you&#160;will&#160;frequently&#160;encounter&#160;two&#160;programs&#160;called&#160;mkisofs<br/>and&#160;&#160;cdrecord.&#160;These&#160;programs&#160;were&#160;part&#160;of&#160;a&#160;popular&#160;package&#160;called&#160;&#160;cdr-<br/>tools&#160;authored&#160;by&#160;Jörg&#160;Schilling.&#160;In&#160;the&#160;summer&#160;of&#160;2006,&#160;Mr.&#160;Schilling&#160;made&#160;a<br/>license&#160;change&#160;to&#160;a&#160;portion&#160;of&#160;the&#160;cdrtools&#160;package,&#160;which,&#160;in&#160;the&#160;opinion&#160;of<br/>many&#160;in&#160;the&#160;Linux&#160;community,&#160;created&#160;a&#160;license&#160;incompatibility&#160;with&#160;the&#160;GNU<br/>GPL.&#160;As&#160;a&#160;result,&#160;a&#160;<i>fork</i>&#160;of&#160;the&#160;cdrtools&#160;project&#160;was&#160;started&#160;that&#160;now&#160;includes&#160;re-<br/>placement&#160;&#160;&#160;programs&#160;&#160;&#160;for&#160;&#160;cdrecord&#160;&#160;and&#160;&#160;mkisofs&#160;&#160;named&#160;&#160;wodim&#160;&#160;and<br/>genisoimage, respectively.<br/>
<b>Writing&#160;CD-ROM&#160;Images<br/></b>After&#160;we&#160;have&#160;an&#160;image&#160;file,&#160;we&#160;can&#160;burn&#160;it&#160;onto&#160;our&#160;optical&#160;media.&#160;Most&#160;of&#160;the&#160;com-<br/>mands&#160;we&#160;will&#160;discuss&#160;below&#160;can&#160;be&#160;applied&#160;to&#160;both&#160;recordable&#160;CD-ROM&#160;and&#160;DVD&#160;me-<br/>dia.<br/>
Mounting&#160;an&#160;ISO&#160;Image&#160;Directly<br/>There&#160;is&#160;a&#160;trick&#160;that&#160;we&#160;can&#160;use&#160;to&#160;mount&#160;an&#160;ISO&#160;image&#160;while&#160;it&#160;is&#160;still&#160;on&#160;our&#160;hard&#160;disk<br/>and&#160;treat&#160;it&#160;as&#160;though&#160;it&#160;were&#160;already&#160;on&#160;optical&#160;media.&#160;By&#160;adding&#160;the&#160;“-o&#160;loop”&#160;option&#160;to<br/>mount&#160;(along&#160;with&#160;the&#160;required&#160;“-t&#160;iso9660”&#160;file&#160;system&#160;type),&#160;we&#160;can&#160;mount&#160;the&#160;image<br/>file&#160;as&#160;though it&#160;were&#160;a&#160;device&#160;and attach&#160;it&#160;to&#160;the&#160;file&#160;system&#160;tree.<br/>
<b>mkdir /mnt/iso_image<br/>mount -t iso9660 -o loop image.iso /mnt/iso_image</b><br/>
In&#160;the&#160;example&#160;above,&#160;we&#160;created&#160;a&#160;mount&#160;point&#160;named&#160;&#160;/mnt/iso_image&#160;&#160;and&#160;then<br/>mounted&#160;the&#160;image&#160;file&#160;image.iso&#160;at&#160;that&#160;mount&#160;point.&#160;After&#160;the&#160;image&#160;is&#160;mounted,&#160;it<br/>can&#160;be&#160;treated&#160;just&#160;as&#160;though&#160;it&#160;were&#160;a&#160;real&#160;CD-ROM&#160;or&#160;DVD.&#160;<i>Remember&#160;to&#160;unmount&#160;the<br/>image&#160;when it&#160;is&#160;no longer&#160;needed.</i><br/>
198<br/>
<hr/>
<a name=223></a>Writing&#160;CD-ROM&#160;Images<br/>
Blanking&#160;a&#160;Rewritable&#160;CD-ROM<br/>Rewritable&#160;CD-RW&#160;media&#160;needs&#160;to&#160;be&#160;erased&#160;or&#160;<i>blanked</i>&#160;before&#160;it&#160;can&#160;be&#160;reused.&#160;To&#160;do<br/>this,&#160;we&#160;can&#160;use&#160;wodim,&#160;specifying&#160;the&#160;device&#160;name&#160;for&#160;the&#160;CD&#160;writer&#160;and&#160;the&#160;type&#160;of<br/>blanking&#160;to&#160;be&#160;performed.&#160;The&#160;wodim&#160;program&#160;offers&#160;several&#160;types.&#160;The&#160;most&#160;minimal<br/>(and fastest)&#160;is&#160;the&#160;“fast”&#160;type.<br/>
<b>wodim dev=/dev/cdrw blank=fast</b><br/>
Writing&#160;an&#160;Image<br/>To&#160;write&#160;an&#160;image,&#160;we&#160;again&#160;use&#160;wodim,&#160;specifying&#160;the&#160;name&#160;of&#160;the&#160;optical&#160;media&#160;writer<br/>device&#160;and the&#160;name&#160;of the&#160;image&#160;file.<br/>
<b>wodim dev=/dev/cdrw image.iso</b><br/>
In&#160;addition&#160;to&#160;the&#160;device&#160;name&#160;and&#160;image&#160;file,&#160;&#160;wodim&#160;&#160;supports&#160;a&#160;large&#160;set&#160;of&#160;options.<br/>Two&#160;common&#160;ones&#160;are&#160;“-v”&#160;for&#160;verbose&#160;output,&#160;and&#160;“-dao”,&#160;which&#160;writes&#160;the&#160;disc&#160;in&#160;<i>disc-<br/>at-once</i>&#160;mode.&#160;This&#160;mode&#160;should&#160;be&#160;used&#160;if&#160;you&#160;are&#160;preparing&#160;a&#160;disc&#160;for&#160;commercial&#160;re-<br/>production.&#160;The&#160;default&#160;mode&#160;for&#160;wodim&#160;is&#160;<i>track-at-once</i>,&#160;which&#160;is&#160;useful&#160;for&#160;recording<br/>music&#160;tracks.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter&#160;we&#160;looked&#160;at&#160;the&#160;basic&#160;storage&#160;management&#160;tasks.&#160;There&#160;are,&#160;of&#160;course,<br/>many&#160;more.&#160;Linux&#160;supports&#160;a&#160;vast&#160;array&#160;of&#160;storage&#160;devices&#160;and&#160;file&#160;system&#160;schemes.&#160;It<br/>also offers&#160;many features&#160;for interoperability&#160;with other&#160;systems.<br/>
<b>Further&#160;Reading<br/></b>Take&#160;a&#160;look&#160;at&#160;the&#160;man&#160;pages&#160;of&#160;the&#160;commands&#160;we&#160;have&#160;covered.&#160;Some&#160;of&#160;them&#160;support<br/>huge&#160;numbers&#160;of&#160;options&#160;and&#160;operations.&#160;Also,&#160;look&#160;for&#160;on-line&#160;tutorials&#160;for&#160;adding&#160;hard<br/>drives&#160;to your Linux system&#160;(there&#160;are&#160;many) and working with&#160;optical&#160;media.<br/>
<b>Extra&#160;Credit<br/></b>It’s&#160;often&#160;useful&#160;to&#160;verify&#160;the&#160;integrity&#160;of&#160;an&#160;ISO&#160;image&#160;that&#160;we&#160;have&#160;downloaded.&#160;In&#160;most<br/>cases,&#160;a&#160;distributor&#160;of&#160;an&#160;ISO&#160;image&#160;will&#160;also&#160;supply&#160;a&#160;<i>checksum&#160;file</i>.&#160;A&#160;checksum&#160;is&#160;the<br/>result&#160;of&#160;an&#160;exotic&#160;mathematical&#160;calculation&#160;resulting&#160;in&#160;a&#160;number&#160;that&#160;represents&#160;the&#160;con-<br/>tent&#160;of&#160;the&#160;target&#160;file.&#160;If&#160;the&#160;contents&#160;of&#160;the&#160;file&#160;change&#160;by&#160;even&#160;one&#160;bit,&#160;the&#160;resulting<br/>
199<br/>
<hr/>
<a name=224></a>15 – Storage&#160;Media<br/>
checksum&#160;will&#160;be&#160;much&#160;different.&#160;The&#160;most&#160;common&#160;method&#160;of&#160;checksum&#160;generation<br/>uses&#160;the&#160;&#160;md5sum&#160;program.&#160;When&#160;you&#160;use&#160;md5sum,&#160;it&#160;produces&#160;a&#160;unique&#160;hexadecimal<br/>number.<br/>
<b>md5sum image.iso<br/></b>34e354760f9bb7fbf85c96f6a3f94ece &#160;image.iso<br/>
After&#160;you download&#160;an&#160;image,&#160;you&#160;should&#160;run&#160;md5sum&#160;against&#160;it&#160;and&#160;compare&#160;the&#160;results<br/>with the&#160;md5sum&#160;value&#160;supplied by the&#160;publisher.<br/>In&#160;addition&#160;to&#160;checking&#160;the&#160;integrity&#160;of&#160;a&#160;downloaded&#160;file,&#160;we&#160;can&#160;use&#160;md5sum&#160;to&#160;verify<br/>newly&#160;written&#160;optical&#160;media.&#160;To&#160;do&#160;this,&#160;we&#160;first&#160;calculate&#160;the&#160;checksum&#160;of&#160;the&#160;image&#160;file<br/>and&#160;then&#160;calculate&#160;a&#160;checksum&#160;for&#160;the&#160;media.&#160;The&#160;trick&#160;to&#160;verifying&#160;the&#160;media&#160;is&#160;to&#160;limit<br/>the&#160;calculation&#160;to only the&#160;portion&#160;of the&#160;optical&#160;media&#160;that&#160;contains&#160;the&#160;image.&#160;We&#160;do this<br/>by&#160;determining&#160;the&#160;number&#160;of&#160;2,048-byte&#160;blocks&#160;the&#160;image&#160;contains&#160;(optical&#160;media&#160;is&#160;al-<br/>ways&#160;written&#160;in&#160;2,048-byte&#160;blocks)&#160;and&#160;reading&#160;that&#160;many&#160;blocks&#160;from&#160;the&#160;media.&#160;On<br/>some&#160;types&#160;of&#160;media,&#160;this&#160;is&#160;not&#160;required.&#160;CD-R&#160;and&#160;CD-RW&#160;disks&#160;are&#160;written&#160;in&#160;disc-at-<br/>once&#160;mode&#160;can be&#160;checked&#160;this&#160;way.<br/>
<b>md5sum /dev/cdrom<br/></b>34e354760f9bb7fbf85c96f6a3f94ece &#160;/dev/cdrom<br/>
Many&#160;types&#160;of&#160;media,&#160;such&#160;as&#160;DVDs,&#160;require&#160;a&#160;precise&#160;calculation&#160;of&#160;the&#160;number&#160;of<br/>blocks.&#160;In the&#160;example&#160;below,&#160;we&#160;check&#160;the&#160;integrity&#160;of the&#160;image&#160;file&#160;dvd-image.iso<br/>and the&#160;disc&#160;in the&#160;DVD&#160;reader&#160;/dev/dvd. Can you figure&#160;out&#160;how&#160;this&#160;works?<br/>
<b>md5sum dvd-image.iso; dd if=/dev/dvd bs=2048 count=$(( $(stat -c &#34;%s&#34;<br/>dvd-image.iso) / 2048 )) | md5sum</b><br/>
200<br/>
<hr/>
<a name=225></a>16 – Networking<br/>
<i><b>16&#160;–&#160;Networking</b></i><br/>
When&#160;it&#160;comes&#160;to&#160;networking,&#160;there&#160;is&#160;probably&#160;nothing&#160;that&#160;cannot&#160;be&#160;done&#160;with&#160;Linux.<br/>Linux&#160;is&#160;used&#160;to&#160;build&#160;all&#160;sorts&#160;of&#160;networking&#160;systems&#160;and&#160;appliances,&#160;including&#160;firewalls,<br/>routers, name&#160;servers, network-attached&#160;storage&#160;(NAS) boxes&#160;and on and&#160;on.<br/>Just&#160;as&#160;the&#160;subject&#160;of&#160;networking&#160;is&#160;vast,&#160;so&#160;are&#160;the&#160;number&#160;of&#160;commands&#160;that&#160;can&#160;be&#160;used<br/>to&#160;configure&#160;and&#160;control&#160;it.&#160;We&#160;will&#160;focus&#160;our&#160;attention&#160;on&#160;just&#160;a&#160;few&#160;of&#160;the&#160;most&#160;fre-<br/>quently&#160;used&#160;ones.&#160;The&#160;commands&#160;chosen&#160;for&#160;examination&#160;include&#160;those&#160;used&#160;to&#160;monitor<br/>networks&#160;and&#160;those&#160;used&#160;to&#160;transfer&#160;files.&#160;In&#160;addition,&#160;we&#160;are&#160;going&#160;to&#160;explore&#160;the&#160;ssh<br/>program&#160;that&#160;is&#160;used&#160;to&#160;perform&#160;remote&#160;logins.&#160;This&#160;chapter&#160;will&#160;cover&#160;the&#160;following<br/>commands:<br/>
●<br/>
ping&#160;– Send an ICMP&#160;ECHO_REQUEST&#160;to network hosts<br/>
●<br/>
traceroute&#160;– Print&#160;the&#160;route&#160;packets&#160;trace&#160;to&#160;a&#160;network host<br/>
●<br/>
ip&#160;– Show&#160;/&#160;manipulate&#160;routing, devices, policy&#160;routing&#160;and tunnels<br/>
●<br/>
netstat&#160;&#160;–&#160;Print&#160;network&#160;connections,&#160;routing&#160;tables,&#160;interface&#160;statistics,&#160;mas-<br/>querade&#160;connections,&#160;and multicast&#160;memberships<br/>
●<br/>
ftp&#160;– Internet&#160;file&#160;transfer program<br/>
●<br/>
wget&#160;– Non-interactive&#160;network downloader<br/>
●<br/>
ssh&#160;– OpenSSH&#160;SSH&#160;client&#160;(remote&#160;login program)<br/>
We’re&#160;going&#160;to&#160;assume&#160;a&#160;little&#160;background&#160;in&#160;networking.&#160;In&#160;this,&#160;the&#160;Internet&#160;age,&#160;every-<br/>one&#160;using&#160;a&#160;computer&#160;needs&#160;a&#160;basic&#160;understanding&#160;of&#160;networking&#160;concepts.&#160;To&#160;make&#160;full<br/>use&#160;of this&#160;chapter we&#160;should be&#160;familiar with the&#160;following&#160;terms:<br/>
●<br/>
Internet&#160;protocol&#160;(IP) address<br/>
●<br/>
Host&#160;and&#160;domain&#160;name<br/>
●<br/>
Uniform&#160;resource&#160;identifier (URI)<br/>
Please&#160;see&#160;the&#160;“Further&#160;Reading”&#160;section&#160;below&#160;for&#160;some&#160;useful&#160;articles&#160;regarding&#160;these<br/>terms.<br/>
201<br/>
<hr/>
<a name=226></a>16 – Networking<br/>
<b>Note:</b>&#160;Some&#160;of&#160;the&#160;commands&#160;we&#160;will&#160;cover&#160;may&#160;(depending&#160;on&#160;your&#160;distribu-<br/>tion)&#160;&#160;&#160;require&#160;&#160;&#160;the&#160;&#160;&#160;installation&#160;&#160;&#160;of&#160;&#160;&#160;additional&#160;&#160;&#160;packages&#160;&#160;&#160;from&#160;&#160;&#160;your&#160;&#160;&#160;distribution’s<br/>repositories, and some&#160;may require&#160;superuser privileges&#160;to execute.<br/>
<b>Examining&#160;and&#160;Monitoring&#160;a&#160;Network<br/></b>Even&#160;if&#160;you’re&#160;not&#160;the&#160;system&#160;administrator,&#160;it’s&#160;often&#160;helpful&#160;to&#160;examine&#160;the&#160;performance<br/>and operation of a&#160;network.<br/>
ping<br/>The&#160;most&#160;basic&#160;network command&#160;is&#160;ping.&#160;The&#160;ping&#160;command&#160;sends&#160;a&#160;special&#160;network<br/>packet&#160;called&#160;an&#160;ICMP&#160;ECHO_REQUEST&#160;to&#160;a&#160;specified&#160;host.&#160;Most&#160;network&#160;devices&#160;re-<br/>ceiving&#160;this&#160;packet&#160;will&#160;reply&#160;to it,&#160;allowing&#160;the&#160;network connection&#160;to be&#160;verified.<br/>
<b>Note:</b>&#160;It&#160;is&#160;possible&#160;to&#160;configure&#160;most&#160;network&#160;devices&#160;(including&#160;Linux&#160;hosts)&#160;to<br/>ignore&#160;these&#160;packets.&#160;This&#160;is&#160;usually&#160;done&#160;for&#160;security&#160;reasons,&#160;to&#160;partially&#160;ob-<br/>scure&#160;a&#160;host&#160;from&#160;a&#160;potential&#160;attacker.&#160;It&#160;is&#160;also&#160;common&#160;for&#160;firewalls&#160;to&#160;be&#160;con-<br/>figured&#160;to block&#160;ICMP&#160;traffic.<br/>
For&#160;example,&#160;to&#160;see&#160;whether&#160;we&#160;can&#160;reach&#160;linuxcommand.org&#160;(one&#160;of&#160;our&#160;favorite<br/>sites&#160;;-), we&#160;can&#160;use&#160;ping&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ping linuxcommand.org</b><br/>
Once&#160;started,&#160;ping&#160;continues&#160;to&#160;send&#160;packets&#160;at&#160;a&#160;specified&#160;interval&#160;(default&#160;is&#160;one&#160;sec-<br/>ond) until&#160;it&#160;is&#160;interrupted.<br/>
[me@linuxbox ~]$&#160;<b>ping linuxcommand.org<br/></b>PING linuxcommand.org (66.35.250.210) 56(84) bytes of data.&#160;<br/>64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=1&#160;<br/>ttl=43 time=107 ms&#160;<br/>64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=2&#160;<br/>ttl=43 time=108 ms&#160;<br/>64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=3&#160;<br/>ttl=43 time=106 ms&#160;<br/>64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=4&#160;<br/>ttl=43 time=106 ms&#160;<br/>
202<br/>
<hr/>
<a name=227></a>Examining and&#160;Monitoring a&#160;Network<br/>
64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=5&#160;<br/>ttl=43 time=105 ms&#160;<br/>64 bytes from vhost.sourceforge.net (66.35.250.210): icmp_seq=6&#160;<br/>ttl=43 time=107 ms&#160;<br/>
--- linuxcommand.org ping statistics ---&#160;<br/>6 packets transmitted, 6 received, 0% packet loss, time 6010ms&#160;<br/>rtt min/avg/max/mdev = 105.647/107.052/108.118/0.824 ms<br/>
After&#160;it&#160;is&#160;interrupted&#160;(in&#160;this&#160;case&#160;after&#160;the&#160;sixth&#160;packet)&#160;by&#160;pressing&#160;&#160;Ctrl-c,&#160;&#160;ping<br/>prints&#160;performance&#160;statistics.&#160;A&#160;properly&#160;performing&#160;network will&#160;exhibit&#160;0&#160;percent&#160;packet<br/>loss.&#160;A&#160;successful&#160;“ping”&#160;will&#160;indicate&#160;that&#160;the&#160;elements&#160;of&#160;the&#160;network&#160;(its&#160;interface<br/>cards, cabling, routing,&#160;and gateways) are&#160;in generally&#160;good working&#160;order.&#160;<br/>
traceroute<br/>The&#160;&#160;traceroute&#160;&#160;program&#160;(some&#160;systems&#160;use&#160;the&#160;similar&#160;&#160;tracepath&#160;&#160;program&#160;in-<br/>stead)&#160;lists&#160;all&#160;the&#160;“hops”&#160;network&#160;traffic&#160;takes&#160;to&#160;get&#160;from&#160;the&#160;local&#160;system&#160;to&#160;a&#160;specified<br/>host.&#160;For example,&#160;to see&#160;the&#160;route&#160;taken to&#160;reach&#160;slashdot.org, we&#160;would&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>traceroute slashdot.org</b><br/>
The&#160;output&#160;looks&#160;like&#160;this:<br/>
traceroute to slashdot.org (216.34.181.45), 30 hops max, 40 byte&#160;<br/>packets&#160;<br/>&#160;1 &#160;ipcop.localdomain (192.168.1.1) &#160;1.066 ms &#160;1.366 ms &#160;1.720 ms&#160;<br/>&#160;2 &#160;* * *&#160;<br/>&#160;3 &#160;ge-4-13-ur01.rockville.md.bad.comcast.net (68.87.130.9) &#160;14.622&#160;<br/>ms &#160;14.885 ms &#160;15.169 ms&#160;<br/>&#160;4 &#160;po-30-ur02.rockville.md.bad.comcast.net (68.87.129.154) &#160;17.634&#160;<br/>ms &#160;17.626 ms &#160;17.899 ms&#160;<br/>&#160;5 &#160;po-60-ur03.rockville.md.bad.comcast.net (68.87.129.158) &#160;15.992&#160;<br/>ms &#160;15.983 ms &#160;16.256 ms&#160;<br/>&#160;6 &#160;po-30-ar01.howardcounty.md.bad.comcast.net (68.87.136.5) &#160;22.835&#160;<br/>ms &#160;14.233 ms &#160;14.405 ms&#160;<br/>&#160;7 &#160;po-10-ar02.whitemarsh.md.bad.comcast.net (68.87.129.34) &#160;16.154&#160;<br/>ms &#160;13.600 ms &#160;18.867 ms&#160;<br/>&#160;8 &#160;te-0-3-0-1-cr01.philadelphia.pa.ibone.comcast.net (68.86.90.77) &#160;<br/>21.951 ms &#160;21.073 ms &#160;21.557 ms&#160;<br/>
203<br/>
<hr/>
<a name=228></a>16 – Networking<br/>
&#160;9 &#160;pos-0-8-0-0-cr01.newyork.ny.ibone.comcast.net (68.86.85.10) &#160;<br/>22.917 ms &#160;21.884 ms &#160;22.126 ms&#160;<br/>10 &#160;204.70.144.1 (204.70.144.1) &#160;43.110 ms &#160;21.248 ms &#160;21.264 ms&#160;<br/>11 &#160;cr1-pos-0-7-3-1.newyork.savvis.net (204.70.195.93) &#160;21.857 ms&#160;<br/>cr2-pos-0-0-3-1.newyork.savvis.net (204.70.204.238) &#160;19.556 ms cr1-<br/>pos-0-7-3-1.newyork.savvis.net (204.70.195.93) &#160;19.634 ms&#160;<br/>12 &#160;cr2-pos-0-7-3-0.chicago.savvis.net (204.70.192.109) &#160;41.586 ms &#160;<br/>42.843 ms cr2-tengig-0-0-2-0.chicago.savvis.net (204.70.196.242) &#160;<br/>43.115 ms&#160;<br/>13 &#160;hr2-tengigabitethernet-12-1.elkgrovech3.savvis.net&#160;<br/>(204.70.195.122) &#160;44.215 ms &#160;41.833 ms &#160;45.658 ms&#160;<br/>14 &#160;csr1-ve241.elkgrovech3.savvis.net (216.64.194.42) &#160;46.840 ms &#160;<br/>43.372 ms &#160;47.041 ms&#160;<br/>15 &#160;64.27.160.194 (64.27.160.194) &#160;56.137 ms &#160;55.887 ms &#160;52.810 ms&#160;<br/>16 &#160;slashdot.org (216.34.181.45) &#160;42.727 ms &#160;42.016 ms &#160;41.437 ms<br/>
In&#160;the&#160;output,&#160;we&#160;can&#160;see&#160;that&#160;connecting&#160;from&#160;our&#160;test&#160;system&#160;to&#160;slashdot.org&#160;re-<br/>quires&#160;traversing&#160;16&#160;routers.&#160;For&#160;&#160;routers&#160;&#160;that&#160;provided&#160;identifying&#160;information,&#160;we&#160;see<br/>their&#160;hostnames,&#160;IP&#160;addresses,&#160;and&#160;performance&#160;data,&#160;which&#160;includes&#160;three&#160;samples&#160;of<br/>round-trip&#160;time&#160;from&#160;the&#160;local&#160;system&#160;to&#160;the&#160;router.&#160;For&#160;routers&#160;that&#160;do&#160;not&#160;provide&#160;identi-<br/>fying&#160;information&#160;(because&#160;of&#160;router&#160;configuration,&#160;network&#160;congestion,&#160;firewalls,&#160;etc.),<br/>we&#160;see&#160;asterisks&#160;as&#160;in&#160;the&#160;line&#160;for&#160;hop&#160;number&#160;2.&#160;In&#160;cases&#160;where&#160;routing&#160;information&#160;is<br/>blocked,&#160;we&#160;can&#160;sometimes&#160;overcome&#160;this&#160;by&#160;adding&#160;either&#160;the&#160;-T&#160;or&#160;-I&#160;option&#160;to&#160;the<br/>traceroute&#160;command.<br/>
ip<br/>The&#160;ip&#160;program&#160;is&#160;a&#160;multi-purpose&#160;network&#160;configuration&#160;tool&#160;that&#160;makes&#160;use&#160;of&#160;the&#160;full<br/>range&#160;networking&#160;of&#160;features&#160;available&#160;in&#160;modern&#160;Linux&#160;kernels.&#160;It&#160;replaces&#160;the&#160;earlier<br/>and&#160;now&#160;deprecated&#160;ifconfig&#160;program.&#160;With&#160;ip,&#160;we&#160;can&#160;examine&#160;a&#160;system's&#160;network<br/>interfaces&#160;and routing table.<br/>
[me@linuxbox ~]$&#160;<b>ip a&#160;<br/></b>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN&#160;<br/>group default&#160;<br/>&#160; &#160; link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00&#160;<br/>&#160; &#160; inet 127.0.0.1/8 scope host lo&#160;<br/>&#160; &#160; &#160; &#160;valid_lft forever preferred_lft forever&#160;<br/>&#160; &#160; inet6 ::1/128 scope host&#160;<br/>&#160; &#160; &#160; &#160;valid_lft forever preferred_lft forever&#160;<br/>2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast&#160;<br/>
204<br/>
<hr/>
<a name=229></a>Examining and&#160;Monitoring a&#160;Network<br/>
state UP group default qlen 1000&#160;<br/>&#160; &#160; link/ether ac:22:0b:52:cf:84 brd ff:ff:ff:ff:ff:ff&#160;<br/>&#160; &#160; inet 192.168.1.14/24 brd 192.168.1.255 scope global eth0&#160;<br/>&#160; &#160; &#160; &#160;valid_lft forever preferred_lft forever&#160;<br/>&#160; &#160; inet6 fe80::ae22:bff:fe52:cf84/64 scope link&#160;<br/>&#160; &#160; &#160; &#160;valid_lft forever preferred_lft forever<br/>
In&#160;the&#160;example&#160;above,&#160;we&#160;see&#160;that&#160;our&#160;test&#160;system&#160;has&#160;two&#160;network&#160;interfaces.&#160;The&#160;first,<br/>called&#160;lo,&#160;is&#160;the&#160;<i>loopback&#160;interface</i>,&#160;a&#160;virtual&#160;interface&#160;that&#160;the&#160;system&#160;uses&#160;to&#160;“talk&#160;to&#160;it-<br/>self”&#160;and&#160;the&#160;second, called&#160;eth0, is&#160;the&#160;Ethernet&#160;interface.<br/>When&#160;performing&#160;casual&#160;network&#160;diagnostics,&#160;the&#160;important&#160;things&#160;to&#160;look&#160;for&#160;are&#160;the<br/>presence&#160;of&#160;the&#160;word&#160;UP&#160;in&#160;the&#160;first&#160;line&#160;for&#160;each&#160;interface,&#160;indicating&#160;that&#160;the&#160;network&#160;in-<br/>terface&#160;is&#160;enabled,&#160;and&#160;the&#160;presence&#160;of&#160;a&#160;valid&#160;IP&#160;address&#160;in&#160;the&#160;inet&#160;field&#160;on&#160;the&#160;third<br/>line.&#160;For&#160;systems&#160;using&#160;Dynamic&#160;Host&#160;Configuration&#160;Protocol&#160;(DHCP),&#160;a&#160;valid&#160;IP&#160;address<br/>in this&#160;field will&#160;verify&#160;that&#160;the&#160;DHCP&#160;is&#160;working.<br/>
netstat<br/>The&#160;&#160;netstat&#160;&#160;program&#160;&#160;&#160;is&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;examine&#160;&#160;&#160;various&#160;&#160;&#160;network&#160;&#160;&#160;settings&#160;&#160;&#160;and&#160;&#160;&#160;statistics.<br/>Through&#160;the&#160;use&#160;of&#160;its&#160;many&#160;options,&#160;we&#160;can&#160;look&#160;at&#160;a&#160;variety&#160;of&#160;features&#160;in&#160;our&#160;network<br/>setup. Using the&#160;-ie&#160;option,&#160;we&#160;can examine&#160;the&#160;network&#160;interfaces&#160;in our system.<br/>
[me@linuxbox ~]$&#160;<b>netstat -ie<br/></b>eth0 &#160; &#160;Link encap:Ethernet &#160;HWaddr 00:1d:09:9b:99:67 &#160;<br/>&#160; &#160; &#160; &#160; inet addr:192.168.1.2 Bcast:192.168.1.255 Mask:255.255.255.0&#160;<br/>&#160; &#160; &#160; &#160; inet6 addr: fe80::21d:9ff:fe9b:9967/64 Scope:Link&#160;<br/>&#160; &#160; &#160; &#160; UP BROADCAST RUNNING MULTICAST &#160;MTU:1500 &#160;Metric:1&#160;<br/>&#160; &#160; &#160; &#160; RX packets:238488 errors:0 dropped:0 overruns:0 frame:0&#160;<br/>&#160; &#160; &#160; &#160; TX packets:403217 errors:0 dropped:0 overruns:0 carrier:0&#160;<br/>&#160; &#160; &#160; &#160; collisions:0 txqueuelen:100&#160;<br/>&#160; &#160; &#160; &#160; RX bytes:153098921 (146.0 MB) &#160;TX bytes:261035246 (248.9 MB)&#160;<br/>&#160; &#160; &#160; &#160; Memory:fdfc0000-fdfe0000&#160;<br/>
lo &#160; &#160; &#160;Link encap:Local Loopback &#160;<br/>&#160; &#160; &#160; &#160; inet addr:127.0.0.1 &#160;Mask:255.0.0.0&#160;<br/>&#160; &#160; &#160; &#160; inet6 addr: ::1/128 Scope:Host&#160;<br/>&#160; &#160; &#160; &#160; UP LOOPBACK RUNNING &#160;MTU:16436 &#160;Metric:1&#160;<br/>&#160; &#160; &#160; &#160; RX packets:2208 errors:0 dropped:0 overruns:0 frame:0&#160;<br/>&#160; &#160; &#160; &#160; TX packets:2208 errors:0 dropped:0 overruns:0 carrier:0&#160;<br/>&#160; &#160; &#160; &#160; collisions:0 txqueuelen:0&#160;<br/>&#160; &#160; &#160; &#160; RX bytes:111490 (108.8 KB) &#160;TX bytes:111490 (108.8 KB)<br/>
205<br/>
<hr/>
<a name=230></a>16 – Networking<br/>
Using&#160;the&#160;-r&#160;option&#160;will&#160;display&#160;the&#160;kernel’s&#160;network&#160;routing&#160;table.&#160;This&#160;shows&#160;how&#160;the<br/>network is&#160;configured&#160;to send packets&#160;from&#160;network to&#160;network.<br/>
[me@linuxbox ~]$&#160;<b>netstat -r<br/></b>Kernel IP routing table&#160;<br/>Destination &#160;Gateway &#160; &#160; Genmask &#160; &#160; &#160; Flags &#160; MSS Window &#160;irtt Iface<br/>
192.168.1.0 &#160;* &#160; &#160; &#160; &#160; &#160; 255.255.255.0 U &#160; &#160; &#160; &#160; 0 0 &#160; &#160; &#160; &#160; &#160;0 eth0&#160;<br/>default &#160; &#160; &#160;192.168.1.1 0.0.0.0 &#160; &#160; &#160; UG &#160; &#160; &#160; &#160;0 0 &#160; &#160; &#160; &#160; &#160;0 eth0&#160;<br/>
In&#160;this&#160;simple&#160;example,&#160;we&#160;see&#160;a&#160;typical&#160;routing&#160;table&#160;for&#160;a&#160;client&#160;machine&#160;on&#160;a&#160;local&#160;area<br/>network&#160;(LAN)&#160;behind&#160;a&#160;firewall/router.&#160;The&#160;first&#160;line&#160;of&#160;the&#160;listing&#160;shows&#160;the&#160;destination<br/>192.168.1.0.&#160;IP&#160;addresses&#160;that&#160;end&#160;in&#160;zero&#160;refer&#160;to&#160;networks&#160;rather&#160;than&#160;individual<br/>hosts,&#160;so&#160;this&#160;destination&#160;means&#160;any&#160;host&#160;on&#160;the&#160;LAN.&#160;The&#160;next&#160;field,&#160;Gateway,&#160;is&#160;the<br/>name&#160;or IP&#160;address&#160;of the&#160;gateway (router)&#160;used&#160;to go from&#160;the&#160;current&#160;host&#160;to the&#160;destina-<br/>tion network.&#160;An asterisk in&#160;this&#160;field&#160;indicates&#160;that&#160;no gateway is&#160;needed.<br/>The&#160;last&#160;line&#160;contains&#160;the&#160;destination&#160;&#160;default.&#160;This&#160;means&#160;any&#160;traffic&#160;destined&#160;for&#160;a<br/>network&#160;that&#160;is&#160;not&#160;otherwise&#160;listed&#160;in&#160;the&#160;table.&#160;In&#160;our&#160;example,&#160;we&#160;see&#160;that&#160;the&#160;gateway<br/>is&#160;defined&#160;as&#160;a&#160;router&#160;with&#160;the&#160;address&#160;of&#160;192.168.1.1, which&#160;presumably&#160;knows&#160;what<br/>to do with the&#160;destination&#160;traffic.<br/>Like&#160;ip,&#160;the&#160;netstat&#160;program&#160;has&#160;many&#160;options&#160;and&#160;we&#160;have&#160;looked&#160;only&#160;at&#160;a&#160;couple.<br/>Check out&#160;the&#160;ip&#160;and&#160;netstat&#160;man pages&#160;for a&#160;complete&#160;list.<br/>
<b>Transporting&#160;Files&#160;Over&#160;a&#160;Network<br/></b>What&#160;good&#160;is&#160;a&#160;network&#160;unless&#160;we&#160;can&#160;move&#160;files&#160;across&#160;it?&#160;There&#160;are&#160;many&#160;programs<br/>that&#160;move&#160;data&#160;over&#160;networks.&#160;We&#160;will&#160;cover&#160;two&#160;of&#160;them&#160;now&#160;and&#160;several&#160;more&#160;in&#160;later<br/>sections.<br/>
ftp<br/>One&#160;of&#160;the&#160;true&#160;“classic”&#160;programs,&#160;ftp&#160;gets&#160;its&#160;name&#160;from&#160;the&#160;protocol&#160;it&#160;uses,&#160;the&#160;<i>File<br/>Transfer&#160;Protocol</i>.&#160;FTP&#160;was&#160;once&#160;the&#160;most&#160;widely&#160;used&#160;method&#160;of&#160;downloading&#160;files&#160;over<br/>the&#160;Internet.&#160;Most,&#160;if&#160;not&#160;all,&#160;web&#160;browsers&#160;support&#160;it,&#160;and&#160;you&#160;often&#160;see&#160;URIs&#160;starting<br/>with the&#160;protocol&#160;ftp://.<br/>Before&#160;there&#160;were&#160;web&#160;browsers,&#160;there&#160;was&#160;the&#160;ftp&#160;program.&#160;ftp&#160;is&#160;used&#160;to&#160;communi-<br/>cate&#160;with&#160;<i>FTP&#160;servers</i>,&#160;machines&#160;that&#160;contain&#160;files&#160;that&#160;can&#160;be&#160;uploaded&#160;and&#160;downloaded<br/>over a&#160;network.<br/>FTP&#160;(in&#160;its&#160;original&#160;form)&#160;is&#160;not&#160;secure&#160;because&#160;it&#160;sends&#160;account&#160;names&#160;and&#160;passwords&#160;in<br/>
206<br/>
<hr/>
<a name=231></a>Transporting&#160;Files&#160;Over a&#160;Network<br/>
<i>cleartext</i>.&#160;This&#160;means&#160;they&#160;are&#160;not&#160;encrypted&#160;and&#160;anyone&#160;&#160;<i>sniffing</i>&#160;&#160;the&#160;network&#160;can&#160;see<br/>them.&#160;Because&#160;of&#160;this,&#160;almost&#160;all&#160;FTP&#160;done&#160;over&#160;the&#160;Internet&#160;is&#160;done&#160;by&#160;<i>anonymous&#160;FTP<br/>servers</i>.&#160;An&#160;anonymous&#160;server&#160;allows&#160;anyone&#160;to&#160;log&#160;in&#160;using&#160;the&#160;login&#160;name&#160;“anony-<br/>mous”&#160;and a&#160;meaningless&#160;password.<br/>In&#160;the&#160;example&#160;below,&#160;we&#160;show&#160;a&#160;typical&#160;session&#160;with&#160;the&#160;ftp&#160;program&#160;downloading&#160;an<br/>Ubuntu&#160;iso&#160;image&#160;located&#160;in&#160;the&#160;/pub/cd_images/Ubuntu-18.04&#160;directory&#160;of&#160;the<br/>anonymous&#160;FTP&#160;server&#160;fileserver:<br/>
[me@linuxbox ~]$&#160;<b>ftp fileserver&#160;<br/></b>Connected to fileserver.localdomain.&#160;<br/>220 (vsFTPd 2.0.1)&#160;<br/>Name (fileserver:me):&#160;<b>anonymous&#160;<br/></b>331 Please specify the password.&#160;<br/>Password:&#160;<br/>230 Login successful.&#160;<br/>Remote system type is UNIX.&#160;<br/>Using binary mode to transfer files.&#160;<br/>ftp&gt;&#160;<b>cd pub/cd_images/Ubuntu-18.04&#160;<br/></b>250 Directory successfully changed.&#160;<br/>ftp&gt;&#160;<b>ls</b>&#160;<br/>200 PORT command successful. Consider using PASV.&#160;<br/>150 Here comes the directory listing.&#160;<br/>-rw-rw-r-- &#160; &#160;1 500 &#160; &#160; &#160;500 &#160; &#160; &#160;733079552 Apr 25 03:53 ubuntu-<br/>18.04-desktop-amd64.iso&#160;<br/>226 Directory send OK.&#160;<br/>ftp&gt;&#160;<b>lcd Desktop</b>&#160;<br/>Local directory now /home/me/Desktop&#160;<br/>ftp&gt;&#160;<b>get ubuntu-18.04-desktop-amd64.iso</b>&#160;<br/>local: ubuntu-18.04-desktop-amd64.iso remote: ubuntu-18.04-desktop-<br/>amd64.iso&#160;<br/>200 PORT command successful. Consider using PASV.&#160;<br/>150 Opening BINARY mode data connection for ubuntu-18.04-desktop-<br/>amd64.iso (733079552 bytes).&#160;<br/>226 File send OK.&#160;<br/>733079552 bytes received in 68.56 secs (10441.5 kB/s)&#160;<br/>ftp&gt;&#160;<b>bye</b>&#160;<br/>
Table&#160;16-1 provides&#160;an explanation&#160;of the&#160;commands&#160;entered during&#160;this&#160;session.<br/>
<i>Table&#160;16-1: Examples&#160;of&#160;Interactive&#160;ftp&#160;Commands</i><br/>
<b>Command</b><br/>
<b>Meaning</b><br/>
207<br/>
<hr/>
<a name=232></a>16 – Networking<br/>
ftp fileserver&#160;<br/>
Invoke&#160;the&#160;ftp&#160;program&#160;and have&#160;it&#160;<br/>connect&#160;to&#160;the&#160;FTP&#160;server&#160;<br/>fileserver.<br/>
anonymous<br/>
Login&#160;name.&#160;After the&#160;login&#160;prompt, a&#160;<br/>password prompt&#160;will&#160;appear.&#160;Some&#160;<br/>servers&#160;will&#160;accept&#160;a&#160;blank&#160;password;&#160;<br/>others&#160;will&#160;require&#160;a&#160;password in the&#160;<br/>form&#160;of an email&#160;address. In that&#160;case,&#160;<br/>try&#160;something&#160;like&#160;<br/>user@example.com.<br/>
cd pub/cd_images/Ubuntu-18.04<br/>
Change&#160;to the&#160;directory&#160;on the&#160;remote&#160;<br/>system&#160;containing the&#160;desired file.&#160;<br/>Note&#160;that&#160;on most&#160;anonymous&#160;FTP&#160;<br/>servers, the&#160;files&#160;for public&#160;<br/>downloading&#160;are&#160;found somewhere&#160;<br/>under&#160;the&#160;pub&#160;directory.<br/>
ls<br/>
List&#160;the&#160;directory&#160;on the&#160;remote&#160;<br/>system.<br/>
lcd Desktop<br/>
Change&#160;the&#160;directory&#160;on the&#160;local&#160;<br/>system&#160;to&#160;~/Desktop. In the&#160;<br/>example,&#160;the&#160;ftp&#160;program&#160;was&#160;<br/>invoked&#160;when the&#160;working directory&#160;<br/>was&#160;~.&#160;This&#160;command changes&#160;the&#160;<br/>working directory to&#160;~/Desktop.<br/>
get ubuntu-18.04-desktop-<br/>
Tell&#160;the&#160;remote&#160;system&#160;to transfer the&#160;<br/>
amd64.iso<br/>
file&#160;ubuntu-18.04-desktop-<br/>amd64.iso&#160;to&#160;the&#160;local&#160;system.&#160;<br/>Since&#160;the&#160;working directory&#160;on the&#160;<br/>local&#160;system&#160;was&#160;changed to&#160;<br/>~/Desktop, the&#160;file&#160;will&#160;be&#160;<br/>downloaded&#160;there.<br/>
bye<br/>
Log&#160;off the&#160;remote&#160;server and&#160;end the&#160;<br/>ftp&#160;program&#160;session.&#160;The&#160;commands&#160;<br/>quit&#160;and&#160;exit&#160;may also&#160;be&#160;used.<br/>
Typing&#160;help&#160;at&#160;the&#160;ftp&gt;&#160;prompt&#160;will&#160;display&#160;a&#160;list&#160;of&#160;the&#160;supported&#160;commands.&#160;Using<br/>ftp&#160;on&#160;a&#160;server&#160;where&#160;sufficient&#160;permissions&#160;have&#160;been&#160;granted,&#160;it&#160;is&#160;possible&#160;to&#160;perform<br/>
208<br/>
<hr/>
<a name=233></a>Transporting&#160;Files&#160;Over a&#160;Network<br/>
many ordinary&#160;file&#160;management&#160;tasks. It’s&#160;clumsy, but&#160;it&#160;does&#160;work.<br/>
lftp&#160;–&#160;A&#160;Better&#160;ftp<br/>ftp&#160;is&#160;not&#160;the&#160;only&#160;command-line&#160;FTP&#160;client.&#160;In&#160;fact,&#160;there&#160;are&#160;many.&#160;One&#160;of&#160;the&#160;better<br/>(and&#160;more&#160;popular)&#160;ones&#160;is&#160;lftp&#160;by&#160;Alexander&#160;Lukyanov.&#160;It&#160;works&#160;much&#160;like&#160;the&#160;tradi-<br/>tional&#160;&#160;ftp&#160;&#160;program&#160;but&#160;has&#160;many&#160;additional&#160;convenience&#160;features&#160;including&#160;multiple-<br/>protocol&#160;support&#160;(including&#160;HTTP),&#160;automatic&#160;retry&#160;on&#160;failed&#160;downloads,&#160;background<br/>processes, tab completion&#160;of path&#160;names, and many&#160;more.<br/>
wget<br/>Another&#160;popular&#160;command-line&#160;program&#160;for&#160;file&#160;downloading&#160;is&#160;&#160;wget.&#160;It&#160;is&#160;useful&#160;for<br/>downloading&#160;content&#160;from&#160;both&#160;web&#160;and&#160;FTP&#160;sites.&#160;Single&#160;files,&#160;multiple&#160;files,&#160;and&#160;even<br/>entire&#160;sites&#160;can&#160;be&#160;downloaded.&#160;To&#160;download&#160;the&#160;first&#160;page&#160;of&#160;linuxcommand.org&#160;we<br/>could do this:<br/>
[me@linuxbox ~]$&#160;<b>wget http://linuxcommand.org/index.php<br/></b>--11:02:51-- &#160;http://linuxcommand.org/index.php&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160;=&gt; `index.php'&#160;<br/>Resolving linuxcommand.org... 66.35.250.210&#160;<br/>Connecting to linuxcommand.org|66.35.250.210|:80... connected.&#160;<br/>HTTP request sent, awaiting response... 200 OK&#160;<br/>Length: unspecified [text/html]&#160;<br/>
&#160; &#160; [ &lt;=&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ] 3,120 &#160; &#160; &#160; &#160; --.--K/s&#160;<br/>
11:02:51 (161.75 MB/s) - `index.php' saved [3120]&#160;<br/>
The&#160;program's&#160;many&#160;options&#160;allow&#160;wget&#160;to&#160;recursively&#160;download,&#160;download&#160;files&#160;in&#160;the<br/>background&#160;(allowing&#160;you&#160;to&#160;log&#160;off&#160;but&#160;continue&#160;downloading),&#160;and&#160;complete&#160;the&#160;down-<br/>load&#160;of&#160;a&#160;partially&#160;downloaded&#160;file.&#160;These&#160;features&#160;are&#160;well&#160;documented&#160;in&#160;its&#160;better-than-<br/>average&#160;man page.<br/>
<b>Secure&#160;Communication&#160;with&#160;Remote&#160;Hosts<br/></b>For&#160;many&#160;years,&#160;Unix-like&#160;operating&#160;systems&#160;have&#160;had&#160;the&#160;ability&#160;to&#160;be&#160;administered&#160;re-<br/>motely&#160;via&#160;a&#160;network.&#160;In&#160;the&#160;early&#160;days,&#160;before&#160;the&#160;general&#160;adoption&#160;of&#160;the&#160;Internet,&#160;there<br/>were&#160;&#160;a&#160;&#160;&#160;couple&#160;&#160;&#160;of&#160;&#160;popular&#160;&#160;&#160;programs&#160;&#160;&#160;used&#160;&#160;to&#160;&#160;&#160;log&#160;&#160;&#160;in&#160;&#160;&#160;to&#160;&#160;&#160;remote&#160;&#160;&#160;hosts.&#160;These&#160;&#160;&#160;were&#160;&#160;&#160;the<br/>rlogin&#160;and&#160;telnet&#160;programs.&#160;These&#160;programs,&#160;however,&#160;suffer&#160;from&#160;the&#160;same&#160;fatal<br/>flaw&#160;that&#160;the&#160;ftp&#160;program&#160;does;&#160;they&#160;transmit&#160;all&#160;their&#160;communications&#160;(including&#160;login<br/>
209<br/>
<hr/>
<a name=234></a>16 – Networking<br/>
names&#160;and&#160;passwords)&#160;in&#160;cleartext.&#160;This&#160;makes&#160;them&#160;wholly&#160;inappropriate&#160;for&#160;use&#160;in&#160;the<br/>Internet&#160;age.<br/>
ssh<br/>To&#160;address&#160;this&#160;problem,&#160;a&#160;new&#160;protocol&#160;called&#160;Secure&#160;Shell&#160;(SSH)&#160;was&#160;developed.&#160;SSH<br/>solves&#160;the&#160;two basic&#160;problems&#160;of secure&#160;communication with&#160;a&#160;remote&#160;host.<br/>
1.&#160;It&#160;authenticates&#160;that&#160;the&#160;remote&#160;host&#160;is&#160;who&#160;it&#160;says&#160;it&#160;is&#160;(thus&#160;preventing&#160;so-called<br/>
man-in-the-middle&#160;attacks).<br/>
2.&#160;It&#160;encrypts&#160;all&#160;of the&#160;communications&#160;between&#160;the&#160;local&#160;and remote&#160;hosts.<br/>
SSH&#160;consists&#160;of&#160;two&#160;parts.&#160;An&#160;SSH&#160;server&#160;runs&#160;on&#160;the&#160;remote&#160;host,&#160;listening&#160;for&#160;incoming<br/>connections,&#160;by&#160;default,&#160;on&#160;port&#160;22,&#160;while&#160;an&#160;SSH&#160;client&#160;is&#160;used&#160;on&#160;the&#160;local&#160;system&#160;to<br/>communicate&#160;with the&#160;remote&#160;server.<br/>Most&#160;&#160;&#160;Linux&#160;&#160;&#160;distributions&#160;&#160;&#160;ship&#160;&#160;&#160;an&#160;&#160;&#160;implementation&#160;&#160;&#160;of&#160;&#160;&#160;SSH&#160;&#160;&#160;called&#160;&#160;OpenSSH&#160;&#160;from&#160;&#160;&#160;the<br/>OpenBSD&#160;project.&#160;Some&#160;distributions&#160;include&#160;both&#160;the&#160;client&#160;and&#160;the&#160;server&#160;packages&#160;by<br/>default&#160;(for&#160;example,&#160;Red&#160;Hat),&#160;while&#160;others&#160;(such&#160;as&#160;Ubuntu)&#160;only&#160;supply&#160;the&#160;client.&#160;To<br/>enable&#160;a&#160;system&#160;to&#160;receive&#160;remote&#160;connections,&#160;it&#160;must&#160;have&#160;the&#160;OpenSSH-server<br/>package&#160;installed,&#160;configured&#160;and&#160;running,&#160;and&#160;(if&#160;the&#160;system&#160;either&#160;is&#160;running&#160;or&#160;is&#160;be-<br/>hind a&#160;firewall)&#160;it&#160;must&#160;allow&#160;incoming network&#160;connections&#160;on&#160;TCP&#160;port&#160;22.<br/>
<b>Tip</b>:&#160;If&#160;you&#160;don’t&#160;have&#160;a&#160;remote&#160;system&#160;to&#160;connect&#160;to&#160;but&#160;want&#160;to&#160;try&#160;these&#160;exam-<br/>ples,&#160;make&#160;sure&#160;the&#160;OpenSSH-server&#160;package&#160;is&#160;installed&#160;on&#160;your&#160;system&#160;and<br/>use&#160;localhost&#160;as&#160;the&#160;name&#160;of&#160;the&#160;remote&#160;host.&#160;That&#160;way,&#160;your&#160;machine&#160;will<br/>create&#160;network connections&#160;with itself.<br/>
The&#160;SSH&#160;client&#160;program&#160;used&#160;to&#160;connect&#160;to&#160;remote&#160;SSH&#160;servers&#160;is&#160;called,&#160;appropriately<br/>enough,&#160;ssh.&#160;To&#160;connect&#160;to&#160;a&#160;remote&#160;host&#160;named&#160;remote-sys,&#160;we&#160;would&#160;use&#160;the&#160;ssh<br/>client&#160;program&#160;like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>ssh remote-sys<br/></b>The authenticity of host 'remote-sys (192.168.1.4)' can't be&#160;<br/>established.&#160;<br/>RSA key fingerprint is&#160;<br/>41:ed:7a:df:23:19:bf:3c:a5:17:bc:61:b3:7f:d9:bb.&#160;<br/>Are you sure you want to continue connecting (yes/no)?<br/>
The&#160;first&#160;time&#160;the&#160;connection&#160;is&#160;attempted,&#160;a&#160;message&#160;is&#160;displayed&#160;indicating&#160;that&#160;the&#160;au-<br/>thenticity&#160;of&#160;the&#160;remote&#160;host&#160;cannot&#160;be&#160;established.&#160;This&#160;is&#160;because&#160;the&#160;client&#160;program&#160;has<br/>never&#160;seen&#160;this&#160;remote&#160;host&#160;before.&#160;To&#160;accept&#160;the&#160;credentials&#160;of&#160;the&#160;remote&#160;host,&#160;enter<br/>
210<br/>
<hr/>
<a name=235></a>Secure&#160;Communication with&#160;Remote&#160;Hosts<br/>
“yes”&#160;when&#160;prompted.&#160;Once&#160;the&#160;connection&#160;is&#160;established,&#160;the&#160;user&#160;is&#160;prompted&#160;for&#160;a<br/>password:<br/>
Warning: Permanently added 'remote-sys,192.168.1.4' (RSA) to the list<br/>of known hosts.&#160;<br/>me@remote-sys's password:<br/>
After&#160;the&#160;password&#160;is&#160;successfully&#160;entered,&#160;we&#160;receive&#160;the&#160;shell&#160;prompt&#160;from&#160;the&#160;remote<br/>system.<br/>
Last login: Sat Aug 30 13:00:48 2016<br/>[me@remote-sys ~]$&#160;<br/>
The&#160;remote&#160;shell&#160;session&#160;continues&#160;until&#160;the&#160;user&#160;enters&#160;the&#160;exit&#160;command&#160;at&#160;the&#160;remote<br/>shell&#160;prompt,&#160;thereby&#160;closing&#160;the&#160;remote&#160;connection.&#160;At&#160;this&#160;point,&#160;the&#160;local&#160;shell&#160;session<br/>resumes, and the&#160;local&#160;shell&#160;prompt&#160;reappears.<br/>It&#160;is&#160;also&#160;possible&#160;to&#160;connect&#160;to&#160;remote&#160;systems&#160;using&#160;a&#160;different&#160;username.&#160;For&#160;example,<br/>if the&#160;local&#160;user “me”&#160;had an account&#160;named “bob”&#160;on a&#160;remote&#160;system, user&#160;me&#160;could&#160;log<br/>in to the&#160;account&#160;bob&#160;on the&#160;remote&#160;system&#160;as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>ssh bob@remote-sys<br/></b>bob@remote-sys's password:<br/>Last login: Sat Aug 30 13:03:21 2016<br/>[bob@remote-sys ~]$<br/>
As&#160;stated&#160;earlier,&#160;ssh&#160;verifies&#160;the&#160;authenticity&#160;of&#160;the&#160;remote&#160;host.&#160;If&#160;the&#160;remote&#160;host&#160;does<br/>not&#160;successfully&#160;authenticate, the&#160;following message&#160;appears:<br/>
[me@linuxbox ~]$&#160;<b>ssh remote-sys<br/></b>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#160;<br/>@ &#160; &#160;WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED! &#160; &#160; @&#160;<br/>@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&#160;<br/>IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!&#160;<br/>Someone could be eavesdropping on you right now (man-in-the-middle&#160;<br/>attack)!&#160;<br/>It is also possible that the RSA host key has just been changed.&#160;<br/>The fingerprint for the RSA key sent by the remote host is&#160;<br/>41:ed:7a:df:23:19:bf:3c:a5:17:bc:61:b3:7f:d9:bb.&#160;<br/>
211<br/>
<hr/>
<a name=236></a>16 – Networking<br/>
Please contact your system administrator.&#160;<br/>Add correct host key in /home/me/.ssh/known_hosts to get rid of this&#160;<br/>message.&#160;<br/>Offending key in /home/me/.ssh/known_hosts:1&#160;<br/>RSA host key for remote-sys has changed and you have requested strict<br/>checking.&#160;<br/>Host key verification failed.<br/>
This&#160;message&#160;is&#160;caused&#160;by&#160;one&#160;of&#160;two&#160;possible&#160;situations.&#160;First,&#160;an&#160;attacker&#160;may&#160;be&#160;at-<br/>tempting&#160;a&#160;man-in-the-middle&#160;attack.&#160;This&#160;is&#160;rare,&#160;since&#160;everybody&#160;knows&#160;that&#160;ssh&#160;alerts<br/>the&#160;user&#160;to&#160;this.&#160;The&#160;more&#160;likely&#160;culprit&#160;is&#160;that&#160;the&#160;remote&#160;system&#160;has&#160;been&#160;changed&#160;some-<br/>how;&#160;for&#160;example,&#160;its&#160;operating&#160;system&#160;or SSH&#160;server&#160;has&#160;been&#160;reinstalled.&#160;In&#160;the&#160;interests<br/>of&#160;security&#160;and&#160;safety,&#160;however,&#160;the&#160;first&#160;possibility&#160;should&#160;not&#160;be&#160;dismissed&#160;out&#160;of&#160;hand.<br/>Always&#160;check with the&#160;administrator&#160;of the&#160;remote&#160;system&#160;when this&#160;message&#160;occurs.<br/>After&#160;it&#160;has&#160;been&#160;determined&#160;that&#160;the&#160;message&#160;is&#160;because&#160;of&#160;a&#160;benign&#160;cause,&#160;it&#160;is&#160;safe&#160;to<br/>correct&#160;the&#160;problem&#160;on&#160;the&#160;client&#160;side.&#160;This&#160;is&#160;done&#160;by&#160;using&#160;a&#160;text&#160;editor&#160;(vim&#160;perhaps)<br/>to&#160;remove&#160;the&#160;obsolete&#160;key&#160;from&#160;the&#160;~/.ssh/known_hosts&#160;file.&#160;In&#160;the&#160;example&#160;mes-<br/>sage&#160;above, we&#160;see&#160;this:<br/>
Offending key in /home/me/.ssh/known_hosts:1<br/>
This&#160;means&#160;that&#160;the&#160;first&#160;line&#160;of&#160;the&#160;&#160;known_hosts&#160;&#160;file&#160;contains&#160;the&#160;offending&#160;key.<br/>Delete&#160;this&#160;line&#160;from&#160;the&#160;file,&#160;and&#160;the&#160;ssh&#160;program&#160;will&#160;be&#160;able&#160;to&#160;accept&#160;new&#160;authentica-<br/>tion credentials&#160;from&#160;the&#160;remote&#160;system.<br/>Besides&#160;opening&#160;a&#160;shell&#160;session&#160;on&#160;a&#160;remote&#160;system,&#160;ssh&#160;allows&#160;us&#160;to&#160;execute&#160;a&#160;single<br/>command&#160;on&#160;a&#160;remote&#160;system.&#160;For&#160;example,&#160;to&#160;execute&#160;the&#160;free&#160;command&#160;on&#160;a&#160;remote<br/>host&#160;named&#160;remote-sys&#160;and have&#160;the&#160;results&#160;displayed on the&#160;local&#160;system, use&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>ssh remote-sys free<br/></b>me@twin4's password:&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160;total &#160; &#160; used &#160; &#160; free &#160; &#160; shared &#160; &#160;buffers &#160; &#160; cached<br/>
Mem: &#160; &#160; &#160; &#160;775536 &#160; 507184 &#160; 268352 &#160; &#160; &#160; &#160; &#160;0 &#160; &#160; 110068 &#160; &#160; 154596<br/>
-/+ buffers/cache: &#160; 242520 &#160; 533016&#160;<br/>Swap: &#160; &#160; &#160;1572856 &#160; &#160; &#160; &#160;0 &#160; &#160;1572856<br/>[me@linuxbox ~]$<br/>
It’s&#160;possible&#160;to&#160;use&#160;this&#160;technique&#160;in&#160;more&#160;interesting&#160;ways,&#160;such&#160;as&#160;the&#160;following&#160;exam-<br/>
212<br/>
<hr/>
<a name=237></a>Secure&#160;Communication with&#160;Remote&#160;Hosts<br/>
ple&#160;in&#160;which&#160;we&#160;perform&#160;an&#160;ls&#160;on&#160;the&#160;remote&#160;system&#160;and&#160;redirect&#160;the&#160;output&#160;to&#160;a&#160;file&#160;on<br/>the&#160;local&#160;system:<br/>
[me@linuxbox ~]$&#160;<b>ssh remote-sys 'ls *' &gt; dirlist.txt<br/></b>me@twin4's password:<br/>[me@linuxbox ~]$<br/>
Notice&#160;the&#160;use&#160;of&#160;the&#160;single&#160;quotes&#160;in&#160;the&#160;command&#160;above.&#160;This&#160;is&#160;done&#160;because&#160;we&#160;do<br/>not&#160;want&#160;the&#160;pathname&#160;expansion&#160;performed&#160;on&#160;the&#160;local&#160;machine;&#160;rather,&#160;we&#160;want&#160;it&#160;to<br/>be&#160;performed&#160;on the&#160;remote&#160;system.&#160;Likewise,&#160;if&#160;we&#160;had&#160;wanted&#160;the&#160;output&#160;redirected&#160;to a<br/>file&#160;on&#160;the&#160;remote&#160;machine,&#160;we&#160;could&#160;have&#160;placed&#160;the&#160;redirection&#160;operator&#160;and&#160;the&#160;file-<br/>name&#160;within the&#160;single&#160;quotes.<br/>
[me@linuxbox ~]$&#160;<b>ssh remote-sys 'ls * &gt; dirlist.txt'</b><br/>
<b>Tunneling&#160;with&#160;SSH</b><br/>
Part&#160;of what&#160;happens&#160;when&#160;you establish&#160;a&#160;connection&#160;with&#160;a&#160;remote&#160;host&#160;via&#160;SSH<br/>is&#160;that&#160;an&#160;<i>encrypted&#160;tunnel</i>&#160;is&#160;created&#160;between&#160;the&#160;local&#160;and&#160;remote&#160;systems.&#160;Nor-<br/>mally,&#160;this&#160;tunnel&#160;is&#160;used&#160;to&#160;allow&#160;commands&#160;typed&#160;at&#160;the&#160;local&#160;system&#160;to&#160;be&#160;trans-<br/>mitted&#160;safely&#160;to&#160;the&#160;remote&#160;system&#160;and&#160;for&#160;the&#160;results&#160;to&#160;be&#160;transmitted&#160;safely<br/>back.&#160;In&#160;addition&#160;to&#160;this&#160;basic&#160;function,&#160;the&#160;SSH&#160;protocol&#160;allows&#160;most&#160;types&#160;of<br/>network&#160;traffic&#160;to&#160;be&#160;sent&#160;through&#160;the&#160;encrypted&#160;tunnel,&#160;creating&#160;a&#160;sort&#160;of&#160;virtual<br/>private&#160;network&#160;(VPN) between the&#160;local&#160;and remote&#160;systems.<br/>Perhaps&#160;the&#160;most&#160;common&#160;use&#160;of&#160;this&#160;feature&#160;is&#160;to&#160;allow&#160;X&#160;Window&#160;system&#160;traffic<br/>to&#160;be&#160;transmitted.&#160;On&#160;a&#160;system&#160;running&#160;an&#160;X&#160;server&#160;(that&#160;is,&#160;a&#160;machine&#160;displaying<br/>a&#160;GUI),&#160;it&#160;is&#160;possible&#160;to&#160;launch&#160;and&#160;run&#160;an&#160;X&#160;client&#160;program&#160;(a&#160;graphical&#160;applica-<br/>tion)&#160;on&#160;a&#160;remote&#160;system&#160;and&#160;have&#160;its&#160;display&#160;appear&#160;on&#160;the&#160;local&#160;system.&#160;It’s&#160;easy<br/>to&#160;do;&#160;here’s&#160;an&#160;example.&#160;Let’s&#160;say&#160;we&#160;are&#160;sitting&#160;at&#160;a&#160;Linux&#160;system&#160;called&#160;lin-<br/>uxbox&#160;that&#160;is&#160;running&#160;an&#160;X&#160;server,&#160;and&#160;we&#160;want&#160;to&#160;run&#160;the&#160;xload&#160;program&#160;on&#160;a<br/>remote&#160;system&#160;named&#160;remote-sys&#160;to see&#160;the&#160;program’s&#160;graphical&#160;output&#160;on our<br/>local&#160;system.&#160;We&#160;could&#160;do this:<br/>[me@linuxbox ~]$&#160;<b>ssh -X remote-sys<br/></b>me@remote-sys's password:<br/>Last login: Mon Sep 08 13:23:11 2016<br/>[me@remote-sys ~]$&#160;<b>xload</b><br/>
213<br/>
<hr/>
<a name=238></a>16 – Networking<br/>
After&#160;the&#160;xload&#160;command&#160;is&#160;executed&#160;on&#160;the&#160;remote&#160;system,&#160;its&#160;window&#160;appears<br/>on&#160;the&#160;local&#160;system.&#160;On&#160;some&#160;systems,&#160;you&#160;may&#160;need&#160;to&#160;use&#160;the&#160;“-Y”&#160;option<br/>rather&#160;than the&#160;“-X”&#160;option&#160;to do this.<br/>
scp&#160;and&#160;sftp<br/>The&#160;OpenSSH&#160;package&#160;also&#160;includes&#160;two&#160;programs&#160;that&#160;can&#160;make&#160;use&#160;of&#160;an&#160;SSH-en-<br/>crypted&#160;tunnel&#160;to&#160;copy&#160;files&#160;across&#160;the&#160;network.&#160;The&#160;first,&#160;&#160;scp&#160;&#160;(secure&#160;copy)&#160;is&#160;used<br/>much&#160;like&#160;the&#160;familiar&#160;cp&#160;program&#160;to&#160;copy&#160;files.&#160;The&#160;most&#160;notable&#160;difference&#160;is&#160;that&#160;the<br/>source&#160;or&#160;destination&#160;pathnames&#160;may&#160;be&#160;preceded&#160;with&#160;the&#160;name&#160;of&#160;a&#160;remote&#160;host,&#160;fol-<br/>lowed&#160;by&#160;a&#160;colon&#160;character.&#160;For&#160;example,&#160;if&#160;we&#160;wanted&#160;to&#160;copy&#160;a&#160;document&#160;named&#160;doc-<br/>ument.txt&#160;from&#160;our&#160;home&#160;directory&#160;on&#160;the&#160;remote&#160;system,&#160;remote-sys,&#160;to&#160;the&#160;cur-<br/>rent&#160;working directory&#160;on our local&#160;system,&#160;we&#160;could do this:<br/>
[me@linuxbox ~]$&#160;<b>scp remote-sys:document.txt .<br/></b>me@remote-sys's password:<br/>document.txt &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 100% 5581 &#160; &#160; 5.5KB/s &#160; 00:00<br/>[me@linuxbox ~]$<br/>
As&#160;with&#160;ssh,&#160;you&#160;may&#160;apply&#160;a&#160;username&#160;to&#160;the&#160;beginning&#160;of&#160;the&#160;remote&#160;host’s&#160;name&#160;if<br/>the&#160;desired&#160;remote&#160;host&#160;account&#160;name&#160;does&#160;not&#160;match that&#160;of the&#160;local&#160;system.<br/>
[me@linuxbox ~]$&#160;<b>scp bob@remote-sys:document.txt .</b>&#160;<br/>
The&#160;second&#160;SSH&#160;file-copying&#160;program&#160;is&#160;sftp&#160;which,&#160;as&#160;its&#160;name&#160;implies,&#160;is&#160;a&#160;secure&#160;re-<br/>placement&#160;for&#160;the&#160;ftp&#160;program.&#160;sftp&#160;works&#160;much&#160;like&#160;the&#160;original&#160;ftp&#160;program&#160;that<br/>we&#160;used&#160;earlier;&#160;however,&#160;instead&#160;of&#160;transmitting&#160;everything&#160;in&#160;cleartext,&#160;it&#160;uses&#160;an&#160;SSH<br/>encrypted&#160;tunnel.&#160;sftp&#160;has&#160;an important&#160;advantage&#160;over&#160;conventional&#160;ftp&#160;in&#160;that&#160;it&#160;does<br/>not&#160;require&#160;an&#160;FTP&#160;server&#160;to&#160;be&#160;running&#160;on&#160;the&#160;remote&#160;host.&#160;It&#160;requires&#160;only&#160;the&#160;SSH<br/>server.&#160;This&#160;means&#160;that&#160;any&#160;remote&#160;machine&#160;that&#160;can&#160;connect&#160;with&#160;the&#160;SSH&#160;client&#160;can&#160;also<br/>be&#160;used as&#160;an FTP-like&#160;server. Here&#160;is&#160;a&#160;sample&#160;session:<br/>
[me@linuxbox ~]$&#160;<b>sftp remote-sys<br/></b>Connecting to remote-sys...&#160;<br/>me@remote-sys's password:&#160;<br/>sftp&gt;&#160;<b>ls</b><br/>
214<br/>
<hr/>
<a name=239></a>Secure&#160;Communication with&#160;Remote&#160;Hosts<br/>
ubuntu-8.04-desktop-i386.iso &#160; &#160; &#160; &#160; &#160; &#160;<br/>sftp&gt;&#160;<b>lcd Desktop</b>&#160;<br/>sftp&gt;&#160;<b>get ubuntu-8.04-desktop-i386.iso</b>&#160;<br/>Fetching /home/me/ubuntu-8.04-desktop-i386.iso to ubuntu-8.04-<br/>desktop-i386.iso&#160;<br/>/home/me/ubuntu-8.04-desktop-i386.iso 100% &#160;699MB &#160; 7.4MB/s &#160; 01:35<br/>sftp&gt;&#160;<b>bye</b><br/>
<b>Tip:</b>&#160;&#160;The&#160;SFTP&#160;protocol&#160;is&#160;supported&#160;by&#160;many&#160;of&#160;the&#160;graphical&#160;file&#160;managers<br/>found&#160;in&#160;Linux&#160;distributions.&#160;Using&#160;either&#160;GNOME&#160;or&#160;KDE,&#160;we&#160;can&#160;enter&#160;a&#160;URI<br/>beginning&#160;with&#160;sftp://&#160;into&#160;the&#160;location&#160;bar&#160;and&#160;operate&#160;on&#160;files&#160;stored&#160;on&#160;a<br/>remote&#160;system&#160;running an SSH&#160;server.<br/>
<b>An&#160;SSH&#160;Client&#160;for&#160;Windows?</b><br/>
Let’s&#160;say&#160;you&#160;are&#160;sitting&#160;at&#160;a&#160;Windows&#160;machine&#160;but&#160;you&#160;need&#160;to&#160;log&#160;in&#160;to&#160;your<br/>Linux&#160;server&#160;and&#160;get&#160;some&#160;real&#160;work&#160;done;&#160;what&#160;do&#160;you&#160;do?&#160;Get&#160;an&#160;SSH&#160;client<br/>program&#160;for your&#160;Windows&#160;box,&#160;of course!&#160;There&#160;are&#160;a&#160;number&#160;of these.&#160;The&#160;most<br/>popular&#160;one&#160;is&#160;probably&#160;PuTTY&#160;by&#160;Simon&#160;Tatham&#160;and&#160;his&#160;team.&#160;The&#160;PuTTY&#160;pro-<br/>gram&#160;displays&#160;a&#160;terminal&#160;window&#160;and&#160;allows&#160;a&#160;Windows&#160;user&#160;to&#160;open&#160;an&#160;SSH&#160;(or<br/>telnet)&#160;session&#160;on&#160;a&#160;remote&#160;host.&#160;The&#160;program&#160;also&#160;provides&#160;analogs&#160;for&#160;the&#160;scp<br/>and&#160;sftp&#160;programs.<br/>PuTTY&#160;is&#160;available&#160;at&#160;<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/">http://www.chiark.greenend.org.uk/~sgtatham/putty/</a><br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;surveyed&#160;the&#160;field&#160;of&#160;networking&#160;tools&#160;found&#160;on&#160;most&#160;Linux&#160;systems.<br/>Since&#160;Linux&#160;is&#160;so&#160;widely&#160;used&#160;in&#160;servers&#160;and&#160;networking&#160;appliances,&#160;there&#160;are&#160;many&#160;more<br/>that&#160;can&#160;be&#160;added&#160;by&#160;installing&#160;additional&#160;software.&#160;But&#160;even&#160;with&#160;the&#160;basic&#160;set&#160;of&#160;tools,&#160;it<br/>is&#160;possible&#160;to perform&#160;many&#160;useful&#160;network-related tasks.&#160;<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
For a&#160;broad (albeit&#160;dated) look&#160;at&#160;network&#160;administration,&#160;the&#160;Linux&#160;Documenta-<br/>tion Project&#160;provides&#160;the&#160;<i>Linux&#160;Network&#160;Administrator’s&#160;Guide</i>:<br/><a href="http://tldp.org/LDP/nag2/index.html">http://tldp.org/LDP/nag2/index.html</a><br/>
215<br/>
<hr/>
<a name=240></a>16 – Networking<br/>
●<br/>
Wikipedia&#160;contains&#160;many good networking&#160;articles. Here&#160;are&#160;some&#160;of the&#160;basics:<br/><a href="http://en.wikipedia.org/wiki/Internet_protocol_address">http://en.wikipedia.org/wiki/Internet_protocol_address<br/></a><a href="http://en.wikipedia.org/wiki/Host_name">http://en.wikipedia.org/wiki/Host_name<br/></a><a href="http://en.wikipedia.org/wiki/Uniform_Resource_Identifier">http://en.wikipedia.org/wiki/Uniform_Resource_Identifier</a><br/>
216<br/>
<hr/>
<a name=241></a>17 – Searching for Files<br/>
<i><b>17&#160;–&#160;Searching&#160;for&#160;Files</b></i><br/>
As&#160;we&#160;have&#160;wandered&#160;around&#160;our&#160;Linux&#160;system,&#160;one&#160;thing&#160;has&#160;become&#160;abundantly&#160;clear:<br/>a&#160;typical&#160;Linux&#160;system&#160;has&#160;a&#160;lot&#160;of&#160;files!&#160;This&#160;begs&#160;the&#160;question,&#160;“How&#160;do&#160;we&#160;&#160;find<br/>things?”&#160;We&#160;already&#160;know&#160;that&#160;the&#160;Linux&#160;file&#160;system&#160;is&#160;well&#160;organized&#160;according&#160;to&#160;con-<br/>ventions&#160;passed&#160;down&#160;from&#160;one&#160;generation&#160;of&#160;Unix-like&#160;systems&#160;to&#160;the&#160;next,&#160;but&#160;the&#160;sheer<br/>number of files&#160;can present&#160;a&#160;daunting problem.<br/>In this&#160;chapter, we&#160;will&#160;look at&#160;two tools&#160;that&#160;are&#160;used&#160;to find files&#160;on a&#160;system.<br/>
●<br/>
locate&#160;– Find files&#160;by name<br/>
●<br/>
find&#160;– Search for files&#160;in a&#160;directory&#160;hierarchy<br/>
We&#160;will&#160;also&#160;look&#160;at&#160;a&#160;command&#160;that&#160;is&#160;often&#160;used&#160;with&#160;file-search&#160;commands&#160;to&#160;process<br/>the&#160;resulting list&#160;of files.<br/>
●<br/>
xargs&#160;– Build and&#160;execute&#160;command lines&#160;from&#160;standard&#160;input<br/>
In addition, we&#160;will&#160;introduce&#160;a&#160;couple&#160;of commands&#160;to assist&#160;us&#160;in our explorations.<br/>
●<br/>
touch&#160;– Change&#160;file&#160;times<br/>
●<br/>
stat&#160;– Display file&#160;or file&#160;system&#160;status<br/>
<b>locate&#160;–&#160;Find&#160;Files&#160;the&#160;Easy&#160;Way<br/></b>The&#160;locate&#160;program&#160;performs&#160;a&#160;rapid&#160;database&#160;search&#160;of&#160;pathnames,&#160;and&#160;then&#160;outputs<br/>every&#160;name&#160;that&#160;matches&#160;a&#160;given&#160;substring.&#160;Say,&#160;for&#160;example,&#160;we&#160;want&#160;to&#160;find&#160;all&#160;the&#160;pro-<br/>grams&#160;with&#160;names&#160;that&#160;begin&#160;with&#160;zip.&#160;Since&#160;we&#160;are&#160;looking&#160;for&#160;programs,&#160;we&#160;can&#160;as-<br/>sume&#160;that&#160;the&#160;name&#160;of&#160;the&#160;directory&#160;containing&#160;the&#160;programs&#160;would&#160;end&#160;with&#160;&#160;bin/.<br/>Therefore,&#160;we&#160;could try&#160;to use&#160;locate&#160;this&#160;way to find&#160;our files:<br/>
[me@linuxbox ~]$&#160;<b>locate bin/zip</b><br/>
locate&#160;&#160;will&#160;search&#160;its&#160;database&#160;of&#160;pathnames&#160;and&#160;output&#160;any&#160;that&#160;contain&#160;the&#160;string<br/>bin/zip.<br/>
217<br/>
<hr/>
<a name=242></a>17 – Searching&#160;for Files<br/>
/usr/bin/zip&#160;<br/>/usr/bin/zipcloak&#160;<br/>/usr/bin/zipgrep&#160;<br/>/usr/bin/zipinfo&#160;<br/>/usr/bin/zipnote&#160;<br/>/usr/bin/zipsplit<br/>
If the&#160;search&#160;requirement&#160;is&#160;not&#160;so simple, we&#160;can&#160;combine&#160;locate&#160;with&#160;other tools&#160;such<br/>as&#160;grep&#160;to design more&#160;interesting searches.<br/>
[me@linuxbox ~]$&#160;<b>locate zip | grep bin<br/></b>/bin/bunzip2&#160;<br/>/bin/bzip2&#160;<br/>/bin/bzip2recover&#160;<br/>/bin/gunzip&#160;<br/>/bin/gzip&#160;<br/>/usr/bin/funzip&#160;<br/>/usr/bin/gpg-zip&#160;<br/>/usr/bin/preunzip&#160;<br/>/usr/bin/prezip&#160;<br/>/usr/bin/prezip-bin&#160;<br/>/usr/bin/unzip&#160;<br/>/usr/bin/unzipsfx&#160;<br/>/usr/bin/zip&#160;<br/>/usr/bin/zipcloak&#160;<br/>/usr/bin/zipgrep&#160;<br/>/usr/bin/zipinfo&#160;<br/>/usr/bin/zipnote&#160;<br/>/usr/bin/zipsplit&#160;<br/>
The&#160;locate&#160;program&#160;has&#160;been&#160;around&#160;for&#160;a&#160;number&#160;of&#160;years,&#160;and&#160;there&#160;are&#160;several&#160;vari-<br/>ants&#160;in&#160;common&#160;use.&#160;The&#160;two&#160;most&#160;common&#160;ones&#160;found&#160;in&#160;modern&#160;Linux&#160;distributions<br/>are&#160;&#160;slocate&#160;&#160;and&#160;&#160;mlocate,&#160;&#160;though&#160;&#160;they&#160;&#160;&#160;are&#160;&#160;usually&#160;&#160;&#160;accessed&#160;&#160;by&#160;&#160;a&#160;&#160;&#160;symbolic&#160;&#160;&#160;link<br/>named&#160;locate.&#160;The&#160;different&#160;versions&#160;of&#160;locate&#160;have&#160;overlapping&#160;options&#160;sets.&#160;Some<br/>versions&#160;include&#160;regular&#160;expression&#160;matching&#160;(which&#160;we’ll&#160;cover&#160;in&#160;Chapter&#160;19,&#160;“Regular<br/>Expressions”)&#160;&#160;and&#160;&#160;&#160;wildcard&#160;&#160;&#160;support.&#160;&#160;&#160;Check&#160;&#160;&#160;the&#160;&#160;&#160;man&#160;&#160;&#160;page&#160;&#160;&#160;for&#160;&#160;locate&#160;&#160;to&#160;determine<br/>which version of&#160;locate&#160;is&#160;installed.<br/>
218<br/>
<hr/>
<a name=243></a>locate&#160;– Find Files&#160;the&#160;Easy&#160;Way<br/>
<b>Where&#160;Does&#160;the&#160;locate&#160;Database&#160;Come&#160;From?</b><br/>
You&#160;may&#160;notice&#160;that,&#160;on&#160;some&#160;distributions,&#160;locate&#160;fails&#160;to&#160;work&#160;just&#160;after&#160;the<br/>system&#160;is&#160;installed,&#160;but&#160;if&#160;you&#160;try&#160;again&#160;the&#160;next&#160;day,&#160;it&#160;works&#160;fine.&#160;What&#160;gives?<br/>The&#160;&#160;locate&#160;database&#160;is&#160;created&#160;by&#160;another&#160;program&#160;named&#160;&#160;updatedb.&#160;Usu-<br/>ally,&#160;it&#160;is&#160;run&#160;periodically&#160;as&#160;a&#160;<i>cron&#160;job</i>,&#160;that&#160;is,&#160;a&#160;task&#160;performed&#160;at&#160;regular&#160;inter-<br/>vals&#160;by&#160;the&#160;cron&#160;daemon.&#160;&#160;Most&#160;systems&#160;equipped&#160;with&#160;locate&#160;run&#160;updatedb<br/>once&#160;a&#160;day.&#160;Since&#160;the&#160;database&#160;is&#160;not&#160;updated&#160;continuously,&#160;you&#160;will&#160;notice&#160;that<br/>very&#160;recent&#160;files&#160;do&#160;not&#160;show&#160;up&#160;when using&#160;locate.&#160;&#160;To&#160;overcome&#160;this,&#160;it’s&#160;pos-<br/>sible&#160;to&#160;run&#160;the&#160;&#160;updatedb&#160;&#160;program&#160;manually&#160;by&#160;becoming&#160;the&#160;superuser&#160;and<br/>running&#160;updatedb&#160;at&#160;the&#160;prompt.&#160;<br/>
<b>find&#160;–&#160;Find&#160;Files&#160;the&#160;Hard&#160;Way<br/></b>While&#160;the&#160;locate&#160;program&#160;can&#160;find&#160;a&#160;file&#160;based&#160;solely&#160;on&#160;its&#160;name,&#160;the&#160;find&#160;program<br/>searches&#160;a&#160;given&#160;directory&#160;(and&#160;its&#160;subdirectories)&#160;for&#160;files&#160;based&#160;on&#160;a&#160;variety&#160;of&#160;at-<br/>tributes.&#160;We’re&#160;going&#160;to&#160;spend&#160;a&#160;lot&#160;of&#160;time&#160;with&#160;find&#160;because&#160;it&#160;has&#160;a&#160;lot&#160;of&#160;interesting<br/>features&#160;that&#160;we&#160;will&#160;see&#160;again and again when we&#160;start&#160;to cover programming&#160;concepts&#160;in<br/>later&#160;chapters.<br/>In&#160;its&#160;simplest&#160;use,&#160;find&#160;is&#160;given&#160;one&#160;or&#160;more&#160;names&#160;of&#160;directories&#160;to&#160;search.&#160;For&#160;exam-<br/>ple, to&#160;produce&#160;a&#160;listing of our home&#160;directory we&#160;can&#160;use&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>find ~</b><br/>
On&#160;most&#160;active&#160;user&#160;accounts,&#160;this&#160;will&#160;produce&#160;a&#160;large&#160;list.&#160;Since&#160;the&#160;list&#160;is&#160;sent&#160;to&#160;stan-<br/>dard&#160;output,&#160;we&#160;can&#160;pipe&#160;the&#160;list&#160;into&#160;other&#160;programs.&#160;Let’s&#160;use&#160;wc&#160;to&#160;count&#160;the&#160;number&#160;of<br/>files.<br/>
[me@linuxbox ~]$&#160;<b>find ~ | wc -l<br/></b>47068<br/>
Wow,&#160;we’ve&#160;been&#160;busy!&#160;The&#160;beauty&#160;of&#160;find&#160;is&#160;that&#160;it&#160;can&#160;be&#160;used&#160;to&#160;identify&#160;files&#160;that<br/>meet&#160;specific&#160;criteria.&#160;It&#160;does&#160;this&#160;through&#160;the&#160;(slightly&#160;strange)&#160;application&#160;of&#160;&#160;<i>options</i>,<br/><i>tests</i>, and&#160;<i>actions</i>.&#160;We’ll&#160;look at&#160;the&#160;tests&#160;first.<br/>
219<br/>
<hr/>
<a name=244></a>17 – Searching&#160;for Files<br/>
Tests<br/>Let’s&#160;say&#160;we&#160;want&#160;a&#160;list&#160;of&#160;directories&#160;from&#160;our&#160;search.&#160;To&#160;do&#160;this,&#160;we&#160;could&#160;add&#160;the&#160;fol&#160;-<br/>lowing test:<br/>
[me@linuxbox ~]$&#160;<b>find ~ -type d | wc -l<br/></b>1695<br/>
Adding&#160;the&#160;test&#160;-type&#160;d&#160;limited&#160;the&#160;search&#160;to&#160;directories.&#160;Conversely,&#160;we&#160;could&#160;have<br/>limited&#160;the&#160;search&#160;to regular&#160;files&#160;with&#160;this&#160;test:<br/>
[me@linuxbox ~]$&#160;<b>find ~ -type f | wc -l<br/></b>38737<br/>
Table&#160;17-1 lists&#160;the&#160;common file&#160;type&#160;tests&#160;supported by find.<br/>
<i>Table&#160;17-1:&#160;find&#160;File&#160;Types</i><br/>
<b>File&#160;Type</b><br/>
<b>Description</b><br/>
b<br/>
Block&#160;special&#160;device&#160;file<br/>
c<br/>
Character&#160;special&#160;device&#160;file<br/>
d<br/>
Directory<br/>
f<br/>
Regular file<br/>
l<br/>
Symbolic&#160;link<br/>
We&#160;can&#160;also&#160;search&#160;by&#160;file&#160;size&#160;and&#160;filename&#160;by&#160;adding&#160;some&#160;additional&#160;tests.&#160;Let’s&#160;look<br/>for&#160;all&#160;the&#160;regular&#160;files&#160;that&#160;match&#160;the&#160;wildcard&#160;pattern&#160;&#160;*.JPG&#160;and&#160;are&#160;larger&#160;than&#160;one<br/>megabyte.<br/>
[me@linuxbox ~]$&#160;<b>find ~ -type f -name &#34;*.JPG&#34; -size +1M | wc -l<br/></b>840<br/>
In&#160;this&#160;example,&#160;we&#160;add&#160;the&#160;-name&#160;test&#160;followed&#160;by&#160;the&#160;wildcard&#160;pattern.&#160;Notice&#160;how&#160;we<br/>enclose&#160;it&#160;in&#160;quotes&#160;to&#160;prevent&#160;pathname&#160;expansion&#160;by&#160;the&#160;shell.&#160;Next,&#160;we&#160;add&#160;the&#160;-size<br/>test&#160;followed&#160;by&#160;the&#160;string&#160;“+1M”.&#160;The&#160;leading&#160;plus&#160;sign&#160;indicates&#160;that&#160;we&#160;are&#160;looking&#160;for<br/>files&#160;larger&#160;than&#160;the&#160;specified&#160;number.&#160;A&#160;leading&#160;minus&#160;sign&#160;would&#160;change&#160;the&#160;meaning&#160;of<br/>the&#160;string&#160;to&#160;be&#160;smaller&#160;than&#160;the&#160;specified&#160;number.&#160;Using&#160;no&#160;sign&#160;means,&#160;“match&#160;the&#160;value<br/>
220<br/>
<hr/>
<a name=245></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
exactly.”&#160;The&#160;trailing&#160;letter&#160;M&#160;indicates&#160;that&#160;the&#160;unit&#160;of&#160;measurement&#160;is&#160;megabytes.&#160;Table<br/>17-2 lists&#160;the&#160;characters&#160;that&#160;can be&#160;used&#160;to specify units.<br/>
<i>Table&#160;17-2:&#160;find&#160;Size&#160;Units</i><br/>
<b>Character</b><br/>
<b>Unit</b><br/>
b<br/>
512-byte&#160;blocks.&#160;This&#160;is&#160;the&#160;default&#160;if no unit&#160;is&#160;specified.<br/>
c<br/>
Bytes.<br/>
w<br/>
2-byte&#160;words.<br/>
k<br/>
Kilobytes&#160;(units&#160;of 1024 bytes).<br/>
M<br/>
Megabytes&#160;(units&#160;of 1048576 bytes).<br/>
G<br/>
Gigabytes&#160;(units&#160;of 1073741824 bytes).<br/>
find&#160;supports&#160;a&#160;large&#160;number&#160;of&#160;tests.&#160;Table&#160;17-3&#160;provides&#160;a&#160;rundown&#160;of&#160;the&#160;common<br/>ones.&#160;Note&#160;that&#160;in&#160;cases&#160;where&#160;a&#160;numeric&#160;argument&#160;is&#160;required,&#160;the&#160;same&#160;+&#160;and&#160;-&#160;notation<br/>discussed&#160;above&#160;can&#160;be&#160;applied.<br/>
<i>Table&#160;17-3:&#160;find&#160;Tests</i><br/>
<b>Test</b><br/>
<b>Description</b><br/>
-cmin&#160;<i>n</i><br/>
Match files&#160;or directories&#160;whose&#160;content&#160;or attributes&#160;were&#160;<br/>last&#160;modified&#160;exactly&#160;<i>n</i>&#160;minutes&#160;ago.&#160;To specify&#160;less&#160;than&#160;<i>n</i>&#160;<br/>minutes&#160;ago, use&#160;<i>-n</i>, and to specify&#160;more&#160;than&#160;<i>n</i>&#160;minutes&#160;<br/>ago, use&#160;<i>+n</i>.<br/>
-cnewer&#160;<i>file</i><br/>
Match files&#160;or directories&#160;whose&#160;contents&#160;or attributes&#160;were&#160;<br/>last&#160;modified&#160;more&#160;recently&#160;than those&#160;of&#160;<i>file</i>.<br/>
-ctime&#160;<i>n</i><br/>
Match files&#160;or directories&#160;whose&#160;contents&#160;or attributes&#160;were&#160;<br/>last&#160;modified&#160;<i>n</i>*24 hours&#160;ago.<br/>
-empty<br/>
Match empty files&#160;and directories.<br/>
-group&#160;<i>name</i><br/>
Match file&#160;or directories&#160;belonging&#160;to&#160;<i>group</i>.&#160;<i>group</i>&#160;may&#160;<br/>be&#160;expressed either as&#160;a&#160;group name&#160;or as&#160;a&#160;numeric&#160;group&#160;<br/>ID.<br/>
-iname&#160;<i>pattern</i><br/>
Like&#160;the&#160;-name&#160;test&#160;but&#160;case-insensitive.<br/>
-inum&#160;<i>n</i><br/>
Match files&#160;with inode&#160;number&#160;<i>n</i>.&#160;This&#160;is&#160;helpful&#160;for finding<br/>all&#160;the&#160;hard&#160;links&#160;to a&#160;particular inode.<br/>
221<br/>
<hr/>
<a name=246></a>17 – Searching&#160;for Files<br/>
-mmin&#160;<i>n</i><br/>
Match files&#160;or directories&#160;whose&#160;contents&#160;were&#160;last&#160;<br/>modified&#160;<i>n</i>&#160;minutes&#160;ago.<br/>
-mtime&#160;<i>n</i><br/>
Match files&#160;or directories&#160;whose&#160;contents&#160;were&#160;last&#160;<br/>modified&#160;<i>n</i>*24 hours&#160;ago.<br/>
-name&#160;<i>pattern</i><br/>
Match files&#160;and directories&#160;with the&#160;specified&#160;wildcard&#160;<br/><i>pattern</i>.<br/>
-newer&#160;<i>file</i><br/>
Match files&#160;and directories&#160;whose&#160;contents&#160;were&#160;modified&#160;<br/>more&#160;recently&#160;than the&#160;specified&#160;<i>file</i>.&#160;This&#160;is&#160;useful&#160;when&#160;<br/>writing shell&#160;scripts&#160;that&#160;perform&#160;file&#160;backups. Each&#160;time&#160;<br/>you make&#160;a&#160;backup, update&#160;a&#160;file&#160;(such as&#160;a&#160;log)&#160;and then&#160;<br/>use&#160;find&#160;to determine&#160;which files&#160;have&#160;changed&#160;since&#160;the&#160;<br/>last&#160;update.<br/>
-nouser<br/>
Match file&#160;and directories&#160;that&#160;do not&#160;belong&#160;to a&#160;valid user.<br/>This&#160;can&#160;be&#160;used to find files&#160;belonging&#160;to deleted&#160;accounts&#160;<br/>or to detect&#160;activity by attackers.<br/>
-nogroup<br/>
Match files&#160;and directories&#160;that&#160;do not&#160;belong to&#160;a&#160;valid&#160;<br/>group.<br/>
-perm&#160;<i>mode</i><br/>
Match files&#160;or directories&#160;that&#160;have&#160;permissions&#160;set&#160;to&#160;the&#160;<br/>specified&#160;<i>mode</i>.&#160;<i>mode</i>&#160;can be&#160;expressed&#160;by either&#160;octal&#160;or&#160;<br/>symbolic&#160;notation.<br/>
-samefile&#160;<i>name</i><br/>
Similar to the&#160;-inum&#160;test.&#160;Match files&#160;that&#160;share&#160;the&#160;same&#160;<br/>inode&#160;number&#160;as&#160;file&#160;<i>name</i>.<br/>
-size&#160;<i>n</i><br/>
Match files&#160;of size&#160;<i>n</i>.<br/>
-type&#160;<i>c</i><br/>
Match files&#160;of type&#160;<i>c</i>.<br/>
-user&#160;<i>name</i><br/>
Match files&#160;or directories&#160;belonging to&#160;user&#160;<i>name</i>.&#160;The&#160;user<br/>may be&#160;expressed&#160;by a&#160;username&#160;or by a&#160;numeric&#160;user ID.<br/>
This&#160;is&#160;not&#160;a&#160;complete&#160;list.&#160;The&#160;find&#160;man page&#160;has&#160;all&#160;the&#160;details.<br/>
Operators<br/>Even&#160;with&#160;all&#160;the&#160;tests&#160;that&#160;find&#160;provides,&#160;we&#160;may&#160;still&#160;need&#160;a&#160;better&#160;way&#160;to&#160;describe&#160;the<br/><i>logical&#160;relationships</i>&#160;&#160;between&#160;the&#160;tests.&#160;For&#160;example,&#160;what&#160;if&#160;we&#160;needed&#160;to&#160;determine<br/>whether&#160;all&#160;the&#160;files&#160;and&#160;subdirectories&#160;in&#160;a&#160;directory&#160;had&#160;secure&#160;permissions?&#160;We&#160;would<br/>look&#160;for&#160;all&#160;the&#160;files&#160;with&#160;permissions&#160;that&#160;are&#160;not&#160;0600&#160;and&#160;the&#160;directories&#160;with&#160;permis-<br/>sions&#160;that&#160;are&#160;not&#160;0700.&#160;Fortunately,&#160;find&#160;provides&#160;a&#160;way&#160;to&#160;combine&#160;tests&#160;using&#160;<i>logical</i><br/>
222<br/>
<hr/>
<a name=247></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
<i>operators</i>&#160;&#160;to&#160;create&#160;more&#160;complex&#160;logical&#160;relationships.&#160;To&#160;express&#160;the&#160;aforementioned<br/>test, we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>find ~ \( -type f -not -perm 0600 \) -or \( -type d&#160;<br/>-not -perm 0700 \)</b><br/>
Yikes!&#160;That&#160;sure&#160;looks&#160;weird.&#160;What&#160;is&#160;all&#160;this&#160;stuff?&#160;Actually,&#160;the&#160;operators&#160;are&#160;not&#160;that<br/>complicated&#160;once&#160;you&#160;get&#160;to&#160;know&#160;them.&#160;Table&#160;17-4&#160;describes&#160;the&#160;logical&#160;operators&#160;used<br/>with&#160;find.<br/>
<i>Table&#160;17-4:&#160;find&#160;Logical&#160;Operators</i><br/>
<b>Operator</b><br/>
<b>Description</b><br/>
-and<br/>
Match if&#160;the&#160;tests&#160;on both&#160;sides&#160;of the&#160;operator are&#160;true.&#160;<br/>This&#160;can&#160;be&#160;shortened to&#160;-a. Note&#160;that&#160;when no operator&#160;is&#160;<br/>present,&#160;-and&#160;is&#160;implied&#160;by default.<br/>
-or<br/>
Match if&#160;a&#160;test&#160;on either&#160;side&#160;of the&#160;operator is&#160;true.&#160;This&#160;<br/>can be&#160;shortened to&#160;-o.<br/>
-not<br/>
Match if&#160;the&#160;test&#160;following the&#160;operator&#160;is&#160;false.&#160;This&#160;can be<br/>abbreviated with&#160;an exclamation point&#160;(!).<br/>
( )<br/>
Groups&#160;tests&#160;and&#160;operators&#160;together to&#160;form&#160;larger&#160;<br/>expressions.&#160;This&#160;is&#160;used&#160;to control&#160;the&#160;precedence&#160;of the&#160;<br/>logical&#160;evaluations. By default,&#160;find&#160;evaluates&#160;from&#160;left&#160;to<br/>right. It&#160;is&#160;often necessary&#160;to override&#160;the&#160;default&#160;evaluation<br/>order to obtain the&#160;desired result.&#160;Even&#160;if not&#160;needed,&#160;it&#160;is&#160;<br/>helpful&#160;sometimes&#160;to include&#160;the&#160;grouping characters&#160;to&#160;<br/>improve&#160;the&#160;readability of the&#160;command. Note&#160;that&#160;since&#160;<br/>the&#160;parentheses&#160;have&#160;special&#160;meaning&#160;to the&#160;shell, they&#160;<br/>must&#160;be&#160;quoted&#160;when using them&#160;on the&#160;command&#160;line&#160;to&#160;<br/>allow&#160;them&#160;to&#160;be&#160;passed&#160;as&#160;arguments&#160;to&#160;find. Usually the<br/>backslash character&#160;is&#160;used&#160;to escape&#160;them.<br/>
With&#160;this&#160;list&#160;of&#160;operators&#160;in&#160;hand,&#160;let’s&#160;deconstruct&#160;our&#160;find&#160;command.&#160;When&#160;viewed<br/>from&#160;the&#160;uppermost&#160;level,&#160;we&#160;see&#160;that&#160;our&#160;tests&#160;are&#160;arranged&#160;as&#160;two&#160;groupings&#160;separated<br/>by an&#160;-or&#160;operator.<br/>(&#160;<i>expression 1</i>&#160;) -or (&#160;<i>expression 2</i>&#160;)<br/>This&#160;makes&#160;sense,&#160;since&#160;we&#160;are&#160;searching&#160;for&#160;files&#160;with&#160;a&#160;certain&#160;set&#160;of&#160;permissions&#160;and<br/>
223<br/>
<hr/>
<a name=248></a>17 – Searching&#160;for Files<br/>
for&#160;directories&#160;with&#160;a&#160;different&#160;set.&#160;If&#160;we&#160;are&#160;looking&#160;for&#160;both&#160;files&#160;and&#160;directories,&#160;why&#160;do<br/>we&#160;use&#160;-or&#160;instead&#160;of&#160;-and?&#160;As&#160;find&#160;scans&#160;through&#160;the&#160;files&#160;and&#160;directories,&#160;each&#160;one<br/>is&#160;evaluated&#160;to&#160;see&#160;whether&#160;it&#160;matches&#160;the&#160;specified&#160;tests.&#160;We&#160;want&#160;to&#160;know&#160;whether&#160;it&#160;is<br/><i>either</i>&#160;a&#160;file&#160;with&#160;bad&#160;permissions&#160;<i>or</i>&#160;a&#160;directory&#160;with&#160;bad&#160;permissions.&#160;It&#160;can’t&#160;be&#160;both&#160;at<br/>the&#160;same&#160;time. So if we&#160;expand&#160;the&#160;grouped expressions, we&#160;can&#160;see&#160;it&#160;this&#160;way:<br/>( file with bad perms ) -or ( directory with bad perms )<br/>Our next&#160;challenge&#160;is&#160;how&#160;to&#160;test&#160;for “bad&#160;permissions.”&#160;How&#160;do we&#160;do that?&#160;Actually, we<br/>don’t.&#160;What&#160;we&#160;will&#160;test&#160;for&#160;is&#160;“not&#160;good&#160;permissions”&#160;since&#160;we&#160;know&#160;what&#160;“good&#160;per-<br/>missions”&#160;are.&#160;In&#160;the&#160;case&#160;of&#160;files,&#160;we&#160;define&#160;good&#160;as&#160;0600&#160;and&#160;for&#160;directories,&#160;we&#160;define<br/>it&#160;as&#160;0700.&#160;The&#160;expression that&#160;will&#160;test&#160;files&#160;for “not&#160;good”&#160;permissions&#160;is&#160;as&#160;follows:<br/>-type f -and -not -perms 0600<br/>For directories&#160;it&#160;is&#160;as&#160;follows:<br/>-type d -and -not -perms 0700<br/>As&#160;noted&#160;in&#160;the&#160;Table&#160;17-4&#160;above,&#160;the&#160;-and&#160;operator&#160;can&#160;be&#160;safely&#160;removed&#160;since&#160;it&#160;is<br/>implied by default.&#160;So if&#160;we&#160;put&#160;this&#160;all&#160;back&#160;together,&#160;we&#160;get&#160;our final&#160;command.<br/>find ~ ( -type f -not -perms 0600 ) -or ( -type d -not -<br/>perms 0700 )<br/>However,&#160;since&#160;the&#160;parentheses&#160;have&#160;special&#160;meaning&#160;to&#160;the&#160;shell,&#160;we&#160;must&#160;escape&#160;them<br/>to&#160;prevent&#160;the&#160;shell&#160;from&#160;trying&#160;to&#160;interpret&#160;them.&#160;Preceding&#160;each&#160;one&#160;with&#160;a&#160;backslash<br/>character does&#160;the&#160;trick.<br/>There&#160;is&#160;another&#160;feature&#160;of&#160;logical&#160;operators&#160;that&#160;is&#160;important&#160;to&#160;understand.&#160;Let’s&#160;say&#160;that<br/>we&#160;have&#160;two expressions&#160;separated by a&#160;logical&#160;operator.<br/><i>expr1</i>&#160;-operator&#160;<i>expr2<br/></i>In&#160;all&#160;cases,&#160;&#160;<i>expr1</i>&#160;&#160;will&#160;always&#160;be&#160;performed;&#160;however,&#160;the&#160;operator&#160;will&#160;determine<br/>whether&#160;<i>expr2</i>&#160;is&#160;performed.&#160;Table&#160;17-5 outlines&#160;how&#160;it&#160;works.<br/>
<i>Table&#160;17-5:&#160;find&#160;AND/OR&#160;Logic</i><br/>
<b>Results&#160;of&#160;<i>expr1</i></b><br/>
<b>Operator</b><br/>
<i><b>expr2</b></i><b>&#160;is...</b><br/>
True<br/>
-and<br/>
Always&#160;performed<br/>
False<br/>
-and<br/>
Never performed<br/>
True<br/>
-or<br/>
Never performed<br/>
False<br/>
-or<br/>
Always&#160;performed<br/>
Why&#160;does&#160;this&#160;happen?&#160;It’s&#160;done&#160;to&#160;improve&#160;performance.&#160;Take&#160;-and,&#160;for&#160;example.&#160;We<br/>
224<br/>
<hr/>
<a name=249></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
know&#160;that&#160;the&#160;expression&#160;<i>expr1</i>&#160;-and&#160;<i>expr2</i>&#160;cannot&#160;be&#160;true&#160;if&#160;the&#160;result&#160;of&#160;<i>expr1</i>&#160;is<br/>false,&#160;so&#160;there&#160;is&#160;no&#160;point&#160;in&#160;performing&#160;&#160;<i>expr2</i>.&#160;Likewise,&#160;if&#160;we&#160;have&#160;the&#160;expression<br/><i>expr1</i>&#160;-or&#160;<i>expr2</i>&#160;and&#160;the&#160;result&#160;of&#160;<i>expr1</i>&#160;is&#160;true,&#160;there&#160;is&#160;no&#160;point&#160;in&#160;performing<br/><i>expr2,</i>&#160;as&#160;we&#160;already&#160;know&#160;that&#160;the&#160;expression&#160;<i>expr1</i>&#160;-or&#160;<i>expr2</i>&#160;is&#160;true.<br/>OK,&#160;so&#160;it&#160;helps&#160;it&#160;go&#160;faster.&#160;Why&#160;is&#160;this&#160;important?&#160;It’s&#160;important&#160;because&#160;we&#160;can&#160;rely&#160;on<br/>this&#160;behavior&#160;to control&#160;how&#160;actions&#160;are&#160;performed, as&#160;we&#160;will&#160;soon see.<br/>
Predefined&#160;Actions<br/>Let’s&#160;get&#160;some&#160;work done! Having&#160;a&#160;list&#160;of results&#160;from&#160;our&#160;find&#160;command is&#160;useful,&#160;but<br/>what&#160;we&#160;really&#160;want&#160;to&#160;do&#160;is&#160;act&#160;on the&#160;items&#160;on the&#160;list.&#160;Fortunately,&#160;find&#160;allows&#160;actions<br/>to&#160;be&#160;performed&#160;based on&#160;the&#160;search&#160;results.&#160;There&#160;are&#160;a&#160;set&#160;of&#160;predefined&#160;actions&#160;and sev-<br/>eral&#160;ways&#160;to&#160;apply&#160;user-defined&#160;actions.&#160;First,&#160;let’s&#160;look&#160;at&#160;a&#160;few&#160;of&#160;the&#160;predefined&#160;actions<br/>listed&#160;in&#160;Table&#160;17-6.<br/>
<i>Table&#160;17-6: Predefined&#160;find&#160;Actions</i><br/>
<b>Action</b><br/>
<b>Description</b><br/>
-delete<br/>
Delete&#160;the&#160;currently matching&#160;file.<br/>
-ls<br/>
Perform&#160;the&#160;equivalent&#160;of&#160;ls -dils&#160;on the&#160;matching&#160;file.<br/>Output&#160;is&#160;sent&#160;to standard&#160;output.<br/>
-print<br/>
Output&#160;the&#160;full&#160;pathname&#160;of the&#160;matching file&#160;to&#160;standard&#160;<br/>output.&#160;This&#160;is&#160;the&#160;default&#160;action if no other&#160;action is&#160;<br/>specified.<br/>
-quit<br/>
Quit&#160;once&#160;a&#160;match&#160;has&#160;been&#160;made.<br/>
As&#160;with the&#160;tests, there&#160;are&#160;many more&#160;actions.&#160;See&#160;the&#160;find&#160;man&#160;page&#160;for full&#160;details.<br/>In the&#160;first&#160;example, we&#160;did this:<br/>
<b>find ~</b><br/>
This&#160;produced&#160;a&#160;list&#160;of every&#160;file&#160;and&#160;subdirectory&#160;contained&#160;within&#160;our home&#160;directory.&#160;It<br/>produced&#160;a&#160;list&#160;because&#160;the&#160;&#160;-print&#160;&#160;action&#160;is&#160;implied&#160;if&#160;no&#160;other&#160;action&#160;is&#160;specified.<br/>Thus, our command&#160;could&#160;also be&#160;expressed as&#160;follows:<br/>
<b>find ~ -print</b><br/>
225<br/>
<hr/>
<a name=250></a>17 – Searching&#160;for Files<br/>
We&#160;can use&#160;find&#160;to delete&#160;files&#160;that&#160;meet&#160;certain&#160;criteria. For example,&#160;to delete&#160;files&#160;that<br/>have&#160;the&#160;file&#160;extension&#160;.bak&#160;(which&#160;is&#160;often&#160;used&#160;to&#160;designate&#160;backup&#160;files),&#160;we&#160;could<br/>use&#160;this&#160;command:<br/>
<b>find ~ -type f -name '*.bak' -delete</b><br/>
In this&#160;example,&#160;every file&#160;in the&#160;user’s&#160;home&#160;directory&#160;(and its&#160;subdirectories)&#160;is&#160;searched<br/>for filenames&#160;ending&#160;in&#160;.bak.&#160;When&#160;they are&#160;found, they are&#160;deleted.<br/>
<b>Warning:</b>&#160;&#160;It&#160;should&#160;go&#160;without&#160;&#160;saying&#160;that&#160;&#160;you&#160;should&#160;&#160;<i><b>use&#160;extreme&#160;caution<br/></b></i>when&#160;using&#160;the&#160;-delete&#160;action.&#160;Always&#160;test&#160;the&#160;command&#160;first&#160;by&#160;substituting<br/>the&#160;-print&#160;action&#160;for&#160;-delete&#160;to confirm&#160;the&#160;search results.<br/>
Before&#160;we&#160;go&#160;on,&#160;let’s&#160;take&#160;another&#160;look&#160;at&#160;how&#160;the&#160;logical&#160;operators&#160;affect&#160;actions.&#160;Con-<br/>sider the&#160;following command:<br/>
<b>find ~ -type f -name '*.bak' -print</b><br/>
As&#160;we&#160;have&#160;seen,&#160;this&#160;command&#160;will&#160;look&#160;for&#160;every&#160;regular&#160;file&#160;(-type&#160;f)&#160;whose&#160;name<br/>ends&#160;with&#160;&#160;.bak&#160;&#160;(-name<b>&#160;&#160;'*</b>.bak')&#160;and&#160;will&#160;output&#160;the&#160;relative&#160;pathname&#160;of&#160;each<br/>matching&#160;file&#160;to&#160;standard&#160;output&#160;(-print).&#160;However,&#160;the&#160;reason&#160;the&#160;command&#160;performs<br/>the&#160;way&#160;it&#160;does&#160;is&#160;determined&#160;by&#160;the&#160;logical&#160;relationships&#160;between&#160;each&#160;of&#160;the&#160;tests&#160;and<br/>actions.&#160;Remember,&#160;there&#160;is,&#160;by&#160;default,&#160;an&#160;implied&#160;-and&#160;relationship&#160;between&#160;each&#160;test<br/>and&#160;action.&#160;We&#160;could&#160;also&#160;express&#160;the&#160;command&#160;this&#160;way&#160;to&#160;make&#160;the&#160;logical&#160;relation-<br/>ships&#160;easier to&#160;see:<br/>
<b>find ~ -type f -and -name '*.bak' -and -print</b><br/>
With&#160;our&#160;command&#160;fully&#160;expressed,&#160;let’s&#160;look&#160;at&#160;how&#160;the&#160;logical&#160;operators&#160;affect&#160;its&#160;exe-<br/>cution:<br/>
<b>Test/Action</b><br/>
<b>Is&#160;Performed&#160;Only&#160;If...</b><br/>
-print<br/>
-type f&#160;and&#160;-name '*.bak'&#160;are&#160;true<br/>
-name ‘*.bak’<br/>
-type f&#160;is&#160;true<br/>
-type f<br/>
Is&#160;always&#160;performed,&#160;since&#160;it&#160;is&#160;the&#160;first&#160;test/action in an&#160;-<br/>and&#160;relationship.<br/>
226<br/>
<hr/>
<a name=251></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
Since&#160;the&#160;logical&#160;relationship&#160;between&#160;the&#160;tests&#160;and&#160;actions&#160;determines&#160;which&#160;of&#160;them&#160;are<br/>performed,&#160;we&#160;can&#160;see&#160;that&#160;the&#160;order&#160;of&#160;the&#160;tests&#160;and&#160;actions&#160;is&#160;important.&#160;For&#160;instance,&#160;if<br/>we&#160;were&#160;to&#160;reorder&#160;the&#160;tests&#160;and&#160;actions&#160;so&#160;that&#160;the&#160;-print&#160;action&#160;was&#160;the&#160;first&#160;one,&#160;the<br/>command&#160;would behave&#160;much differently.<br/>
<b>find ~ -print -and -type f -and -name '*.bak'</b><br/>
This&#160;version&#160;of&#160;the&#160;command&#160;will&#160;print&#160;each&#160;file&#160;(the&#160;-print&#160;action&#160;always&#160;evaluates&#160;to<br/>true) and&#160;then test&#160;for file&#160;type&#160;and&#160;the&#160;specified file&#160;extension.<br/>
User-Defined&#160;Actions<br/>In&#160;addition&#160;to&#160;the&#160;predefined&#160;actions,&#160;we&#160;can&#160;also&#160;invoke&#160;arbitrary&#160;commands.&#160;The&#160;tradi-<br/>tional&#160;way of doing this&#160;is&#160;with the&#160;-exec&#160;action.&#160;This&#160;action works&#160;like&#160;this:<br/>-exec&#160;<i>command</i>&#160;{} ;<br/>Here&#160;<i>command</i>&#160;is&#160;the&#160;name&#160;of&#160;a&#160;command,&#160;{}&#160;is&#160;a&#160;symbolic&#160;representation&#160;of&#160;the&#160;current<br/>pathname,&#160;and&#160;the&#160;semicolon&#160;is&#160;a&#160;required&#160;delimiter&#160;indicating&#160;the&#160;end&#160;of&#160;the&#160;command.<br/>Here’s&#160;an example&#160;of using&#160;-exec&#160;to act&#160;like&#160;the&#160;-delete&#160;action discussed earlier:<br/>
-exec rm '{}' ';'<br/>
Again,&#160;since&#160;the&#160;brace&#160;and&#160;semicolon&#160;characters&#160;have&#160;special&#160;meaning&#160;to&#160;the&#160;shell,&#160;they<br/>must&#160;be&#160;quoted&#160;or escaped.&#160;<br/>It’s&#160;also&#160;possible&#160;to&#160;execute&#160;a&#160;user-defined&#160;action&#160;interactively.&#160;By&#160;using&#160;the&#160;-ok&#160;action<br/>in place&#160;of&#160;-exec, the&#160;user is&#160;prompted&#160;before&#160;execution&#160;of each specified command.<br/>
<b>find ~ -type f -name 'foo*' -ok ls -l '{}' ';'<br/></b>&lt; ls ... /home/me/bin/foo &gt; ?&#160;<b>y</b>&#160;<br/>-rwxr-xr-x 1 me &#160; me 224 2007-10-29 18:44 /home/me/bin/foo&#160;<br/>&lt; ls ... /home/me/foo.txt &gt; ?&#160;<b>y</b>&#160;<br/>-rw-r--r-- 1 me &#160; me &#160; 0 2016-09-19 12:53 /home/me/foo.txt<br/>
In&#160;this&#160;example,&#160;we&#160;search&#160;for&#160;files&#160;with&#160;names&#160;starting&#160;with&#160;the&#160;string&#160;foo&#160;and&#160;execute<br/>the&#160;command&#160;ls&#160;-l&#160;each&#160;time&#160;one&#160;is&#160;found.&#160;Using&#160;the&#160;-ok&#160;action&#160;prompts&#160;the&#160;user&#160;be-<br/>fore&#160;the&#160;ls&#160;command&#160;is&#160;executed.<br/>
227<br/>
<hr/>
<a name=252></a>17 – Searching&#160;for Files<br/>
Improving&#160;Efficiency<br/>When&#160;the&#160;&#160;-exec&#160;action&#160;is&#160;used,&#160;it&#160;launches&#160;a&#160;new&#160;instance&#160;of&#160;the&#160;specified&#160;command<br/>each&#160;time&#160;a&#160;matching&#160;file&#160;is&#160;found.&#160;There&#160;are&#160;times&#160;when&#160;we&#160;might&#160;prefer&#160;to&#160;combine&#160;all<br/>of&#160;the&#160;search&#160;results&#160;and&#160;launch&#160;a&#160;single&#160;instance&#160;of&#160;the&#160;command.&#160;For&#160;example,&#160;rather<br/>than executing&#160;the&#160;commands&#160;like&#160;this:<br/>ls -l&#160;<i>file1<br/></i>ls -l&#160;<i>file2<br/></i>we&#160;may prefer&#160;to execute&#160;them&#160;this&#160;way:<br/>ls -l&#160;<i>file1 file2<br/></i>This&#160;causes&#160;the&#160;command&#160;to&#160;be&#160;executed&#160;only&#160;one&#160;time&#160;rather&#160;than&#160;multiple&#160;times.&#160;There<br/>are&#160;two ways&#160;we&#160;can do this:&#160;the&#160;traditional&#160;way, using&#160;the&#160;external&#160;command&#160;xargs&#160;and<br/>the&#160;alternate&#160;way,&#160;using&#160;a&#160;new&#160;feature&#160;in&#160;find&#160;itself.&#160;We’ll&#160;talk&#160;about&#160;the&#160;alternate&#160;way<br/>first.<br/>By&#160;changing&#160;the&#160;trailing&#160;semicolon&#160;character&#160;to&#160;a&#160;plus&#160;sign,&#160;we&#160;activate&#160;the&#160;ability&#160;of<br/>find&#160;to&#160;combine&#160;the&#160;results&#160;of&#160;the&#160;search&#160;into&#160;an&#160;argument&#160;list&#160;for&#160;a&#160;single&#160;execution&#160;of<br/>the&#160;desired&#160;command.&#160;Going&#160;back&#160;to&#160;our&#160;example,&#160;this&#160;will&#160;execute&#160;&#160;ls&#160;&#160;each&#160;time&#160;a<br/>matching file&#160;is&#160;found:<br/>
<b>find ~ -type f -name 'foo*' -exec ls -l '{}' ';'<br/></b>-rwxr-xr-x 1 me &#160; me 224 2007-10-29 18:44 /home/me/bin/foo<br/>-rw-r--r-- 1 me &#160; me &#160; 0 2016-09-19 12:53 /home/me/foo.txt<br/>
By changing&#160;the&#160;command to&#160;the&#160;following:<br/>
<b>find ~ -type f -name 'foo*' -exec ls -l '{}' +<br/></b>-rwxr-xr-x 1 me &#160; me 224 2007-10-29 18:44 /home/me/bin/foo<br/>-rw-r--r-- 1 me &#160; me &#160; 0 2016-09-19 12:53 /home/me/foo.txt<br/>
we&#160;get&#160;the&#160;same&#160;results,&#160;but&#160;the&#160;system&#160;has&#160;to execute&#160;the&#160;ls&#160;command&#160;only once.<br/>
xargs<br/>The&#160;xargs&#160;command&#160;performs&#160;an interesting&#160;function.&#160;It&#160;accepts&#160;input&#160;from&#160;standard&#160;in-<br/>put&#160;and&#160;converts&#160;it&#160;into&#160;an&#160;argument&#160;list&#160;for&#160;a&#160;specified&#160;command.&#160;With&#160;our&#160;example,&#160;we<br/>would&#160;use&#160;it&#160;like&#160;this:<br/>
228<br/>
<hr/>
<a name=253></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
<b>find ~ -type f -name 'foo*' -print | xargs ls -l<br/></b>-rwxr-xr-x 1 me &#160; me 224 2007-10-29 18:44 /home/me/bin/foo<br/>-rw-r--r-- 1 me &#160; me &#160; 0 2016-09-19 12:53 /home/me/foo.txt<br/>
Here&#160;we&#160;see&#160;the&#160;output&#160;of&#160;the&#160;find&#160;command&#160;piped&#160;into&#160;xargs,&#160;which,&#160;in&#160;turn,&#160;con-<br/>structs&#160;an argument&#160;list&#160;for the&#160;ls&#160;command&#160;and then&#160;executes&#160;it.<br/>
<b>Note:</b>&#160;While&#160;the&#160;number&#160;of&#160;arguments&#160;that&#160;can&#160;be&#160;placed&#160;into&#160;a&#160;command&#160;line&#160;is<br/>quite&#160;large,&#160;it’s&#160;not&#160;unlimited.&#160;It&#160;is&#160;possible&#160;to&#160;create&#160;commands&#160;that&#160;are&#160;too&#160;long<br/>for&#160;the&#160;shell&#160;to&#160;accept.&#160;When&#160;a&#160;command&#160;line&#160;exceeds&#160;the&#160;maximum&#160;length&#160;sup-<br/>ported&#160;by&#160;the&#160;system,&#160;&#160;xargs&#160;&#160;executes&#160;the&#160;specified&#160;command&#160;with&#160;the&#160;maxi-<br/>mum&#160;number&#160;of&#160;arguments&#160;possible&#160;and&#160;then&#160;repeats&#160;this&#160;process&#160;until&#160;standard<br/>input&#160;&#160;&#160;is&#160;&#160;exhausted.&#160;&#160;To&#160;&#160;see&#160;&#160;&#160;the&#160;&#160;maximum&#160;&#160;&#160;size&#160;&#160;of&#160;&#160;the&#160;&#160;&#160;command&#160;&#160;line,&#160;&#160;&#160;execute<br/>xargs&#160;with&#160;the&#160;--show-limits&#160;option.<br/>
<b>Dealing&#160;with&#160;Funny&#160;Filenames</b><br/>
Unix-like&#160;&#160;systems&#160;&#160;allow&#160;embedded&#160;spaces&#160;(and&#160;&#160;even&#160;newlines!)&#160;&#160;in&#160;&#160;filenames.<br/>This&#160;causes&#160;problems&#160;for&#160;programs&#160;like&#160;xargs&#160;that&#160;construct&#160;argument&#160;lists&#160;for<br/>other&#160;programs.&#160;An&#160;embedded&#160;space&#160;will&#160;be&#160;treated&#160;as&#160;a&#160;delimiter,&#160;and&#160;the&#160;result-<br/>ing&#160;command&#160;will&#160;interpret&#160;each&#160;space-separated&#160;word&#160;as&#160;a&#160;separate&#160;argument.&#160;To<br/>overcome&#160;this,&#160;find&#160;and&#160;xargs&#160;allow&#160;the&#160;optional&#160;use&#160;of&#160;a&#160;<i>null&#160;character</i>&#160;as&#160;an<br/>argument&#160;separator.&#160;A&#160;null&#160;character&#160;is&#160;defined&#160;in&#160;ASCII&#160;as&#160;the&#160;character&#160;repre-<br/>sented by the&#160;number zero&#160;(as&#160;opposed to, for example,&#160;the&#160;space&#160;character, which<br/>is&#160;defined&#160;in&#160;ASCII&#160;as&#160;the&#160;character&#160;represented&#160;by&#160;the&#160;number&#160;32).&#160;The&#160;&#160;find<br/>command&#160;provides&#160;the&#160;action&#160;&#160;-print0,&#160;which&#160;produces&#160;null-separated&#160;output,<br/>and&#160;the&#160;&#160;xargs&#160;&#160;command&#160;has&#160;the&#160;&#160;--null&#160;&#160;(or&#160;&#160;-0)&#160;option,&#160;which&#160;accepts&#160;null<br/>separated&#160;input. Here’s&#160;an example:<br/>find ~ -iname '*.jpg' -print0 | xargs --null ls -l<br/>Using this&#160;technique, we&#160;can&#160;ensure&#160;that&#160;all&#160;files, even&#160;those&#160;containing embedded<br/>spaces&#160;in their names,&#160;are&#160;handled&#160;correctly.<br/>
A&#160;Return&#160;to&#160;the&#160;Playground<br/>It’s&#160;time&#160;to&#160;put&#160;find&#160;to&#160;some&#160;(almost)&#160;practical&#160;use.&#160;We’ll&#160;create&#160;a&#160;playground&#160;and&#160;try<br/>some&#160;of what&#160;we&#160;have&#160;learned.<br/>
229<br/>
<hr/>
<a name=254></a>17 – Searching&#160;for Files<br/>
First, let’s&#160;create&#160;a&#160;playground&#160;with lots&#160;of subdirectories&#160;and files.<br/>
[me@linuxbox ~]$&#160;<b>mkdir -p playground/dir-{001..100}<br/></b>[me@linuxbox ~]$&#160;<b>touch playground/dir-{001..100}/file-{A..Z}</b><br/>
Marvel&#160;at&#160;the&#160;power&#160;of&#160;the&#160;command&#160;line!&#160;With&#160;these&#160;two&#160;lines,&#160;we&#160;created&#160;a&#160;playground<br/>directory&#160;containing&#160;100&#160;subdirectories&#160;each&#160;containing&#160;26&#160;empty&#160;files.&#160;Try&#160;that&#160;with&#160;the<br/>GUI!<br/>The&#160;&#160;&#160;method&#160;&#160;&#160;we&#160;&#160;&#160;employed&#160;&#160;&#160;to&#160;&#160;&#160;accomplish&#160;&#160;&#160;this&#160;&#160;&#160;magic&#160;&#160;&#160;involved&#160;&#160;&#160;a&#160;&#160;&#160;familiar&#160;&#160;&#160;command<br/>(mkdir),&#160;an&#160;exotic&#160;shell&#160;expansion&#160;(braces),&#160;and&#160;a&#160;new&#160;command,&#160;touch.&#160;By&#160;combin-<br/>ing&#160;mkdir&#160;with&#160;the&#160;-p&#160;option&#160;(which&#160;causes&#160;mkdir&#160;to&#160;create&#160;the&#160;parent&#160;directories&#160;of<br/>the&#160;specified paths) with brace&#160;expansion, we&#160;were&#160;able&#160;to&#160;create&#160;100 subdirectories.<br/>The&#160;&#160;touch&#160;&#160;command&#160;is&#160;usually&#160;used&#160;to&#160;set&#160;or&#160;update&#160;the&#160;access,&#160;change,&#160;and&#160;modify<br/>times&#160;of&#160;files.&#160;However,&#160;if&#160;a&#160;filename&#160;argument&#160;is&#160;that&#160;of&#160;a&#160;nonexistent&#160;file,&#160;an&#160;empty&#160;file<br/>is&#160;created.&#160;<br/>In our playground, we&#160;created&#160;100 instances&#160;of a&#160;file&#160;named&#160;file-A. Let’s&#160;find&#160;them.<br/>
[me@linuxbox ~]$&#160;<b>find playground -type f -name 'file-A'</b><br/>
Note&#160;that&#160;unlike&#160;&#160;ls,&#160;&#160;find&#160;&#160;does&#160;not&#160;produce&#160;results&#160;in&#160;sorted&#160;order.&#160;Its&#160;order&#160;is&#160;deter-<br/>mined&#160;by&#160;the&#160;layout&#160;of&#160;the&#160;storage&#160;device.&#160;We&#160;can&#160;confirm&#160;that&#160;we&#160;actually&#160;have&#160;100&#160;in-<br/>stances&#160;of the&#160;file&#160;this&#160;way.<br/>
[me@linuxbox ~]$&#160;<b>find playground -type f -name 'file-A' | wc -l<br/></b>100<br/>
Next,&#160;let’s&#160;look&#160;at&#160;finding&#160;files&#160;based&#160;on&#160;their&#160;modification&#160;times.&#160;This&#160;will&#160;be&#160;helpful<br/>when&#160;creating&#160;backups&#160;or&#160;organizing&#160;files&#160;in&#160;chronological&#160;order.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;first<br/>create&#160;a&#160;reference&#160;file&#160;against&#160;which&#160;we&#160;will&#160;compare&#160;modification time.<br/>
[me@linuxbox ~]$&#160;<b>touch playground/timestamp</b><br/>
This&#160;creates&#160;an&#160;empty&#160;file&#160;named&#160;timestamp&#160;and&#160;sets&#160;its&#160;modification&#160;time&#160;to&#160;the&#160;cur-<br/>rent&#160;time.&#160;We&#160;can&#160;verify&#160;this&#160;by&#160;using&#160;another&#160;handy&#160;command,&#160;stat,&#160;which&#160;is&#160;a&#160;kind&#160;of<br/>souped-up&#160;version&#160;of&#160;&#160;ls.&#160;The&#160;&#160;stat&#160;&#160;command&#160;reveals&#160;all&#160;that&#160;the&#160;system&#160;understands<br/>about&#160;a&#160;file&#160;and its&#160;attributes.<br/>
230<br/>
<hr/>
<a name=255></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
[me@linuxbox ~]$&#160;<b>stat playground/timestamp<br/></b>&#160; File: `playground/timestamp'&#160;<br/>&#160; Size: 0 &#160; &#160; &#160; &#160; &#160;Blocks: 0 &#160; &#160; &#160; IO Block: 4096 regular empty file&#160;<br/>Device: 803h/2051d Inode: 14265061 Links: 1&#160;<br/>Access: (0644/-rw-r--r--) &#160;Uid: ( 1001/ me) &#160; Gid: ( 1001/ me)&#160;<br/>Access: 2018-10-08 15:15:39.000000000 -0400&#160;<br/>Modify: 2018-10-08 15:15:39.000000000 -0400&#160;<br/>Change: 2018-10-08 15:15:39.000000000 -0400<br/>
If&#160;we&#160;use&#160;touch&#160;again&#160;and&#160;then&#160;examine&#160;the&#160;file&#160;with&#160;stat,&#160;we&#160;will&#160;see&#160;that&#160;the&#160;file’s<br/>times&#160;have&#160;been&#160;updated.<br/>
[me@linuxbox ~]$&#160;<b>touch playground/timestamp<br/></b>[me@linuxbox ~]$&#160;<b>stat playground/timestamp<br/></b>&#160; File: `playground/timestamp'&#160;<br/>&#160; Size: 0 &#160; &#160; &#160; &#160; &#160;Blocks: 0 &#160; &#160; &#160; IO Block: 4096 regular empty file&#160;<br/>Device: 803h/2051d Inode: 14265061 Links: 1&#160;<br/>Access: (0644/-rw-r--r--) &#160;Uid: ( 1001/ me) &#160; Gid: ( 1001/ me)&#160;<br/>Access: 2018-10-08 15:23:33.000000000 -0400&#160;<br/>Modify: 2018-10-08 15:23:33.000000000 -0400&#160;<br/>Change: 2018-10-08 15:23:33.000000000 -0400<br/>
Next, let’s&#160;use&#160;find&#160;to update&#160;some&#160;of our playground&#160;files.<br/>
[me@linuxbox ~]$&#160;<b>find playground -type f -name 'file-B' -exec touch&#160;<br/>'{}' ';'</b><br/>
This&#160;updates&#160;all&#160;files&#160;in&#160;the&#160;playground&#160;named&#160;file-B.&#160;Next&#160;we’ll&#160;use&#160;find&#160;to&#160;identify<br/>the&#160;updated files&#160;by comparing&#160;all&#160;the&#160;files&#160;to the&#160;reference&#160;file&#160;timestamp.<br/>
[me@linuxbox ~]$&#160;<b>find playground -type f -newer playground/timestamp</b><br/>
The&#160;results&#160;contain&#160;all&#160;100 instances&#160;of&#160;file-B. Since&#160;we&#160;performed&#160;a&#160;touch&#160;on all&#160;the<br/>files&#160;in&#160;the&#160;playground&#160;named&#160;&#160;file-B&#160;&#160;after&#160;we&#160;updated&#160;&#160;timestamp,&#160;they&#160;are&#160;now<br/>“newer”&#160;than&#160;timestamp&#160;and&#160;thus&#160;can be&#160;identified with the&#160;-newer&#160;test.<br/>Finally,&#160;let’s&#160;go&#160;back&#160;to&#160;the&#160;bad&#160;permissions&#160;test&#160;we&#160;performed&#160;earlier&#160;and&#160;apply&#160;it&#160;to<br/>playground.<br/>
231<br/>
<hr/>
<a name=256></a>17 – Searching&#160;for Files<br/>
[me@linuxbox ~]$&#160;<b>find playground \( -type f -not -perm 0600 \) -or \(<br/>-type d -not -perm 0700 \)</b><br/>
This&#160;command&#160;lists&#160;all&#160;100&#160;directories&#160;and&#160;2,600&#160;files&#160;in&#160;&#160;playground&#160;&#160;(as&#160;well&#160;as<br/>timestamp&#160;and&#160;playground&#160;itself,&#160;for&#160;a&#160;total&#160;of&#160;2,702)&#160;because&#160;none&#160;of&#160;them&#160;meets<br/>our&#160;definition&#160;of&#160;“good&#160;permissions.”&#160;With&#160;our&#160;knowledge&#160;of&#160;operators&#160;and&#160;actions,&#160;we<br/>can&#160;add&#160;actions&#160;to&#160;this&#160;command&#160;to&#160;apply&#160;new&#160;permissions&#160;to&#160;the&#160;files&#160;and&#160;directories&#160;in<br/>our playground.<br/>
[me@linuxbox ~]$&#160;<b>find playground \( -type f -not -perm 0600 -exec&#160;<br/>chmod 0600 '{}' ';' \) -or \( -type d -not -perm 0700 -exec chmod&#160;<br/>0700 '{}' ';' \)</b><br/>
On&#160;a&#160;day-to-day&#160;basis,&#160;we&#160;might&#160;find&#160;it&#160;easier&#160;to&#160;issue&#160;two&#160;commands,&#160;one&#160;for&#160;the&#160;direc-<br/>tories&#160;and&#160;one&#160;for&#160;the&#160;files,&#160;rather&#160;than&#160;this&#160;one&#160;large&#160;compound&#160;command,&#160;but&#160;it’s&#160;nice&#160;to<br/>know&#160;that&#160;we&#160;can&#160;do it&#160;this&#160;way.&#160;The&#160;important&#160;point&#160;here&#160;is&#160;to understand&#160;how&#160;the&#160;opera-<br/>tors&#160;and actions&#160;can be&#160;used&#160;together&#160;to perform&#160;useful&#160;tasks.<br/>
Options<br/>Finally,&#160;we&#160;have&#160;the&#160;options.&#160;The&#160;options&#160;are&#160;used&#160;to&#160;control&#160;the&#160;scope&#160;of&#160;a&#160;find&#160;search.<br/>They&#160;may&#160;be&#160;included&#160;with&#160;other&#160;tests&#160;and&#160;actions&#160;when&#160;constructing&#160;find&#160;expressions.<br/>Table&#160;17-7 lists&#160;the&#160;most&#160;commonly used&#160;find&#160;options.<br/>
<i>Table&#160;17-7:&#160;find&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
-depth<br/>
Direct&#160;find&#160;to&#160;process&#160;a&#160;directory’s&#160;files&#160;before&#160;the&#160;<br/>directory itself.&#160;This&#160;option is&#160;automatically applied when<br/>the&#160;-delete&#160;action&#160;is&#160;specified.<br/>
-maxdepth&#160;<i>levels</i><br/>
Set&#160;the&#160;maximum&#160;number of levels&#160;that&#160;find&#160;will&#160;<br/>descend&#160;into a&#160;directory&#160;tree&#160;when&#160;performing tests&#160;and&#160;<br/>actions.<br/>
-mindepth&#160;<i>levels</i><br/>
Set&#160;the&#160;minimum&#160;number of levels&#160;that&#160;find&#160;will&#160;<br/>descend&#160;into a&#160;directory&#160;tree&#160;before&#160;applying tests&#160;and&#160;<br/>actions.<br/>
-mount<br/>
Direct&#160;find&#160;not&#160;to traverse&#160;directories&#160;that&#160;are&#160;mounted&#160;<br/>on other&#160;file&#160;systems.<br/>
232<br/>
<hr/>
<a name=257></a>find&#160;– Find Files&#160;the&#160;Hard&#160;Way<br/>
-noleaf<br/>
Direct&#160;find&#160;not&#160;to optimize&#160;its&#160;search&#160;based&#160;on the&#160;<br/>assumption&#160;that&#160;it&#160;is&#160;searching a&#160;Unix-like&#160;file&#160;system.&#160;<br/>This&#160;is&#160;needed when scanning&#160;DOS/Windows&#160;file&#160;<br/>systems&#160;and CD-ROMs.<br/>
<b>Summing&#160;Up<br/></b>It's&#160;easy&#160;to&#160;see&#160;that&#160;locate&#160;is&#160;as&#160;simple&#160;as&#160;find&#160;is&#160;complicated.&#160;They&#160;both&#160;have&#160;their<br/>uses.&#160;Take&#160;the&#160;time&#160;to&#160;explore&#160;the&#160;many&#160;features&#160;of&#160;find.&#160;It&#160;can,&#160;with&#160;regular&#160;use,&#160;im-<br/>prove&#160;your understanding&#160;of Linux&#160;file&#160;system&#160;operations.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;locate,&#160;updatedb,&#160;find, and&#160;xargs&#160;programs&#160;are&#160;all&#160;part&#160;the&#160;GNU&#160;<br/>Project’s&#160;<i>findutils</i>&#160;package.&#160;The&#160;GNU&#160;Project&#160;provides&#160;a&#160;website&#160;with extensive&#160;<br/>on-line&#160;documentation,&#160;which is&#160;quite&#160;good and should be&#160;read&#160;if you are&#160;using&#160;<br/>these&#160;programs&#160;in high security environments:<br/><a href="http://www.gnu.org/software/findutils/">http://www.gnu.org/software/findutils/</a><br/>
233<br/>
<hr/>
<a name=258></a>18 –&#160;Archiving&#160;and Backup<br/>
<i><b>18&#160;–&#160;Archiving&#160;and&#160;Backup</b></i><br/>
One&#160;of&#160;the&#160;primary&#160;tasks&#160;of&#160;a&#160;computer&#160;system’s&#160;administrator&#160;is&#160;keeping&#160;the&#160;system’s<br/>data&#160;secure.&#160;One&#160;way&#160;this&#160;is&#160;done&#160;is&#160;by&#160;performing&#160;timely&#160;backups&#160;of&#160;the&#160;system’s&#160;files.<br/>Even&#160;if&#160;you’re&#160;not&#160;a&#160;system&#160;administrator,&#160;it&#160;is&#160;often&#160;useful&#160;to&#160;make&#160;copies&#160;of&#160;things&#160;and<br/>move&#160;large&#160;collections&#160;of files&#160;from&#160;place&#160;to place&#160;and from&#160;device&#160;to device.<br/>In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;several&#160;common&#160;programs&#160;that&#160;are&#160;used&#160;to&#160;manage&#160;collec-<br/>tions&#160;of files.&#160;These&#160;are&#160;the&#160;file&#160;compression&#160;programs:<br/>
●<br/>
gzip&#160;– Compress&#160;or expand files<br/>
●<br/>
bzip2&#160;–&#160;A&#160;block&#160;sorting file&#160;compressor<br/>
These&#160;are&#160;the&#160;archiving&#160;programs:<br/>
●<br/>
tar&#160;–&#160;Tape&#160;archiving utility<br/>
●<br/>
zip&#160;– Package&#160;and compress&#160;files<br/>
This&#160;is&#160;the&#160;file&#160;synchronization program:<br/>
●<br/>
rsync&#160;– Remote&#160;file&#160;and directory synchronization<br/>
<b>Compressing&#160;Files<br/></b>Throughout&#160;the&#160;history&#160;of&#160;computing,&#160;there&#160;has&#160;been&#160;a&#160;struggle&#160;to&#160;get&#160;the&#160;most&#160;data&#160;into<br/>the&#160;smallest&#160;available&#160;space,&#160;whether&#160;that&#160;space&#160;be&#160;memory,&#160;storage&#160;devices,&#160;or&#160;network<br/>bandwidth.&#160;Many&#160;of&#160;the&#160;data&#160;services&#160;that&#160;we&#160;take&#160;for&#160;granted&#160;today,&#160;such&#160;as&#160;mobile<br/>phone&#160;service,&#160;high-definition&#160;television,&#160;or&#160;broadband&#160;Internet,&#160;owe&#160;their&#160;existence&#160;to&#160;ef-<br/>fective&#160;<i>data&#160;compression</i>&#160;techniques.<br/>Data&#160;compression&#160;is&#160;the&#160;process&#160;of&#160;removing&#160;&#160;<i>redundancy</i>&#160;&#160;from&#160;data.&#160;Let’s&#160;consider&#160;an<br/>imaginary&#160;example.&#160;Say&#160;we&#160;had&#160;an&#160;entirely&#160;black&#160;picture&#160;file&#160;with&#160;the&#160;dimensions&#160;of&#160;100<br/>pixels&#160;by&#160;100&#160;pixels.&#160;In&#160;terms&#160;of&#160;data&#160;storage&#160;(assuming&#160;24&#160;bits,&#160;or&#160;3&#160;bytes&#160;per&#160;pixel),&#160;the<br/>image&#160;will&#160;occupy 30,000 bytes&#160;of storage.<br/>100 * 100 * 3 =&#160;30,000<br/>An&#160;image&#160;that&#160;is&#160;all&#160;one&#160;color&#160;contains&#160;entirely&#160;redundant&#160;data.&#160;If&#160;we&#160;were&#160;clever,&#160;we<br/>could&#160;encode&#160;the&#160;data&#160;in&#160;such&#160;a&#160;way&#160;that&#160;we&#160;simply&#160;describe&#160;the&#160;fact&#160;that&#160;we&#160;have&#160;a&#160;block<br/>
234<br/>
<hr/>
<a name=259></a>Compressing Files<br/>
of&#160;10,000&#160;black&#160;pixels.&#160;So,&#160;instead&#160;of&#160;storing&#160;a&#160;block&#160;of&#160;data&#160;containing&#160;30,000&#160;zeros<br/>(black&#160;is&#160;usually&#160;represented&#160;in&#160;image&#160;files&#160;as&#160;zero),&#160;we&#160;could&#160;compress&#160;the&#160;data&#160;into&#160;the<br/>number&#160;&#160;&#160;10,000,&#160;&#160;&#160;followed&#160;&#160;&#160;by&#160;&#160;&#160;a&#160;&#160;&#160;zero&#160;&#160;&#160;to&#160;&#160;&#160;represent&#160;&#160;&#160;our&#160;&#160;&#160;data.&#160;&#160;&#160;Such&#160;&#160;&#160;a&#160;&#160;&#160;data&#160;&#160;&#160;compression<br/>scheme&#160;is&#160;called&#160;&#160;<i>run-length&#160;encoding</i>&#160;&#160;and&#160;is&#160;one&#160;of&#160;the&#160;most&#160;rudimentary&#160;compression<br/>techniques.&#160;Today’s&#160;techniques&#160;are&#160;much&#160;more&#160;advanced&#160;and&#160;complex,&#160;but&#160;the&#160;basic&#160;goal<br/>remains&#160;the&#160;same — get&#160;rid&#160;of redundant&#160;data.<br/><i>Compression&#160;algorithms</i>&#160;(the&#160;mathematical&#160;techniques&#160;used&#160;to&#160;carry&#160;out&#160;the&#160;compression)<br/>fall&#160;into two general&#160;categories.<br/>
•<br/>
<i>Lossless</i>:&#160;Lossless&#160;compression&#160;preserves&#160;all&#160;the&#160;data&#160;contained&#160;in&#160;the&#160;original.<br/>This&#160;means&#160;that&#160;when&#160;a&#160;file&#160;is&#160;restored&#160;from&#160;a&#160;compressed&#160;version,&#160;the&#160;restored<br/>file&#160;is&#160;exactly the&#160;same&#160;as&#160;the&#160;original,&#160;uncompressed version.<br/>
•<br/>
<i>Lossy</i>:&#160;&#160;Lossy&#160;compression,&#160;on&#160;the&#160;other&#160;hand,&#160;removes&#160;data&#160;as&#160;the&#160;compression&#160;is<br/>performed&#160;to&#160;allow&#160;more&#160;compression&#160;to&#160;be&#160;applied.&#160;When&#160;a&#160;lossy&#160;file&#160;is&#160;restored,<br/>it&#160;does&#160;not&#160;match&#160;the&#160;original&#160;version;&#160;rather,&#160;it&#160;is&#160;a&#160;close&#160;approximation.&#160;Exam-<br/>ples&#160;of lossy compression are&#160;JPEG&#160;(for images) and MP3 (for music).<br/>
In&#160;our&#160;discussion,&#160;we&#160;will&#160;look&#160;exclusively&#160;at&#160;lossless&#160;compression&#160;since&#160;most&#160;data&#160;on<br/>computers&#160;cannot&#160;tolerate&#160;any data&#160;loss.&#160;<br/>
gzip<br/>The&#160;gzip&#160;program&#160;is&#160;used&#160;to&#160;compress&#160;one&#160;or&#160;more&#160;files.&#160;When&#160;executed,&#160;it&#160;replaces&#160;the<br/>original&#160;file&#160;with&#160;a&#160;compressed&#160;version&#160;of&#160;the&#160;original.&#160;The&#160;corresponding&#160;gunzip&#160;pro-<br/>gram&#160;is&#160;used&#160;to&#160;restore&#160;compressed&#160;files&#160;to&#160;their&#160;original,&#160;uncompressed&#160;form.&#160;Here&#160;is&#160;an<br/>example:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /etc &gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.*<br/></b>-rw-r--r-- 1 me &#160; &#160;me &#160; &#160;15738 2018-10-14 07:15 foo.txt<br/>[me@linuxbox ~]$&#160;<b>gzip foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.*<br/></b>-rw-r--r-- 1 me &#160; &#160;me &#160; &#160;3230 2018-10-14 07:15 foo.txt.gz<br/>[me@linuxbox ~]$&#160;<b>gunzip foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.*<br/></b>-rw-r--r-- 1 me &#160; &#160;me &#160; &#160;15738 2018-10-14 07:15 foo.txt<br/>
In&#160;this&#160;example,&#160;we&#160;create&#160;a&#160;text&#160;file&#160;named&#160;foo.txt&#160;from&#160;a&#160;directory&#160;listing.&#160;Next,&#160;we<br/>run&#160;gzip,&#160;which&#160;replaces&#160;the&#160;original&#160;file&#160;with&#160;a&#160;compressed&#160;version&#160;named&#160;foo.tx-<br/>t.gz.&#160;In&#160;the&#160;directory&#160;listing&#160;of&#160;foo.*,&#160;we&#160;see&#160;that&#160;the&#160;original&#160;file&#160;has&#160;been&#160;replaced<br/>with the&#160;compressed version and&#160;that&#160;the&#160;compressed&#160;version&#160;is&#160;about&#160;one-fifth the&#160;size&#160;of<br/>the&#160;original.&#160;We&#160;can&#160;also&#160;see&#160;that&#160;the&#160;compressed&#160;file&#160;has&#160;the&#160;same&#160;permissions&#160;and&#160;time-<br/>
235<br/>
<hr/>
<a name=260></a>18 –&#160;Archiving&#160;and Backup<br/>
stamp as&#160;the&#160;original.<br/>Next,&#160;we&#160;run&#160;the&#160;gunzip&#160;program&#160;to&#160;uncompress&#160;the&#160;file.&#160;Afterward,&#160;we&#160;can&#160;see&#160;that&#160;the<br/>compressed&#160;version&#160;of&#160;the&#160;file&#160;has&#160;been&#160;replaced&#160;with&#160;the&#160;original,&#160;again&#160;with&#160;the&#160;permis-<br/>sions&#160;and&#160;timestamp&#160;preserved.<br/>
gzip&#160;has&#160;many options,&#160;as&#160;described in&#160;Table&#160;18-1.<br/>
<i>Table&#160;18-1:&#160;gzip&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-c<br/>
--stdout<br/>
Write&#160;output&#160;to&#160;standard output&#160;and keep&#160;the&#160;<br/>
--to-stdout<br/>
original&#160;files.<br/>
-d<br/>
--decompress<br/>
Decompress.&#160;This&#160;causes&#160;gzip&#160;to act&#160;like&#160;<br/>
--uncompress<br/>
gunzip.<br/>
-f<br/>
--force<br/>
Force&#160;compression even&#160;if a&#160;compressed&#160;<br/>version&#160;of the&#160;original&#160;file&#160;already exists.<br/>
-h<br/>
--help<br/>
Display&#160;usage&#160;information.<br/>
-l<br/>
--list<br/>
List&#160;compression statistics&#160;for each file&#160;<br/>compressed.<br/>
-r<br/>
--recursive<br/>
If one&#160;or more&#160;arguments&#160;on the&#160;command&#160;line<br/>is&#160;a&#160;directory,&#160;recursively&#160;compress&#160;files&#160;<br/>contained&#160;within them.<br/>
-t<br/>
--test<br/>
Test&#160;the&#160;integrity&#160;of a&#160;compressed file.<br/>
-v<br/>
--verbose<br/>
Display&#160;verbose&#160;messages&#160;while&#160;compressing.&#160;<br/>
-<i>number</i><br/>
Set&#160;amount&#160;of compression.&#160;<i>number</i>&#160;is&#160;an&#160;<br/>integer in&#160;the&#160;range&#160;of 1 (fastest, least&#160;<br/>compression)&#160;to 9 (slowest, most&#160;<br/>compression).&#160;The&#160;values&#160;1 and 9 may&#160;also be&#160;<br/>expressed as&#160;--fast&#160;and&#160;--best,&#160;<br/>respectively.&#160;The&#160;default&#160;value&#160;is&#160;6.<br/>
Let’s&#160;return to&#160;our earlier example.<br/>
[me@linuxbox ~]$&#160;<b>gzip foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>gzip -tv foo.txt.gz<br/></b>foo.txt.gz:<br/>
&#160;OK<br/>
236<br/>
<hr/>
<a name=261></a>Compressing Files<br/>
[me@linuxbox ~]$&#160;<b>gzip -d foo.txt.gz</b><br/>
Here,&#160;we&#160;replaced&#160;the&#160;file&#160;foo.txt&#160;with&#160;a&#160;compressed&#160;version&#160;named&#160;foo.txt.gz.<br/>Next,&#160;we&#160;tested&#160;the&#160;integrity&#160;of&#160;the&#160;compressed&#160;version,&#160;using&#160;the&#160;-t&#160;and&#160;-v&#160;options.&#160;Fi-<br/>nally,&#160;we&#160;decompressed the&#160;file&#160;to its&#160;original&#160;form.<br/>
gzip&#160;can also&#160;be&#160;used&#160;in interesting&#160;ways&#160;via&#160;standard input&#160;and output.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /etc | gzip &gt; foo.txt.gz</b><br/>
This&#160;command creates&#160;a&#160;compressed version of a&#160;directory&#160;listing.<br/>The&#160;gunzip&#160;program,&#160;which&#160;uncompresses&#160;gzip&#160;files,&#160;assumes&#160;that&#160;filenames&#160;end&#160;in&#160;the<br/>extension&#160;.gz,&#160;so&#160;it’s&#160;not&#160;necessary&#160;to&#160;specify&#160;it,&#160;as&#160;long&#160;as&#160;the&#160;specified&#160;name&#160;is&#160;not&#160;in<br/>conflict&#160;with&#160;an existing&#160;uncompressed file.<br/>
[me@linuxbox ~]$&#160;<b>gunzip foo.txt</b><br/>
If our goal&#160;were&#160;only to view&#160;the&#160;contents&#160;of a&#160;compressed&#160;text&#160;file, we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>gunzip -c foo.txt | less</b><br/>
Alternately,&#160;there&#160;is&#160;a&#160;program&#160;supplied&#160;with&#160;&#160;gzip,&#160;called&#160;&#160;zcat,&#160;that&#160;is&#160;equivalent&#160;to<br/>gunzip&#160;with&#160;the&#160;-c&#160;option.&#160;It&#160;can&#160;be&#160;used&#160;like&#160;the&#160;cat&#160;command&#160;on&#160;gzip&#160;compressed<br/>files.<br/>
[me@linuxbox ~]$&#160;<b>zcat foo.txt.gz | less</b><br/>
<b>Tip:</b>&#160;There&#160;is&#160;a&#160;zless&#160;program,&#160;too.&#160;It&#160;performs&#160;the&#160;same&#160;function&#160;as&#160;the&#160;previ-<br/>ous&#160;pipeline.<br/>
bzip2<br/>The&#160;bzip2&#160;program,&#160;by&#160;Julian&#160;Seward,&#160;is&#160;similar&#160;to&#160;gzip&#160;but&#160;uses&#160;a&#160;different&#160;compres-<br/>sion&#160;algorithm&#160;that&#160;achieves&#160;higher&#160;levels&#160;of&#160;compression&#160;at&#160;the&#160;cost&#160;of&#160;compression<br/>speed.&#160;In&#160;most&#160;regards,&#160;it&#160;works&#160;in&#160;the&#160;same&#160;fashion&#160;as&#160;&#160;gzip.&#160;A&#160;file&#160;compressed&#160;with<br/>
237<br/>
<hr/>
<a name=262></a>18 –&#160;Archiving&#160;and Backup<br/>
bzip2&#160;is&#160;denoted&#160;with the&#160;extension&#160;.bz2.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /etc &gt; foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt<br/></b>-rw-r--r-- 1 me &#160; &#160;me &#160; &#160;15738 2018-10-17 13:51 foo.txt&#160;<br/>[me@linuxbox ~]$&#160;<b>bzip2 foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls -l foo.txt.bz2<br/></b>-rw-r--r-- 1 me &#160; &#160;me &#160; &#160; 2792 2018-10-17 13:51 foo.txt.bz2<br/>[me@linuxbox ~]$&#160;<b>bunzip2 foo.txt.bz2</b><br/>
As&#160;we&#160;can&#160;see,&#160;bzip2&#160;can&#160;be&#160;used&#160;the&#160;same&#160;way&#160;as&#160;gzip.&#160;All&#160;the&#160;options&#160;(except&#160;for&#160;-<br/>r)&#160;that&#160;we&#160;discussed&#160;for&#160;&#160;gzip&#160;&#160;are&#160;also&#160;supported&#160;in&#160;&#160;bzip2.&#160;Note,&#160;however,&#160;that&#160;the<br/>compression-level&#160;&#160;&#160;option&#160;&#160;&#160;(-<i>number</i>)&#160;&#160;&#160;has&#160;&#160;&#160;a&#160;&#160;&#160;somewhat&#160;&#160;&#160;different&#160;&#160;&#160;meaning&#160;&#160;&#160;to&#160;&#160;bzip2.<br/>bzip2&#160;comes&#160;with&#160;bunzip2&#160;and&#160;bzcat&#160;for decompressing files.<br/>
bzip2&#160;also&#160;comes&#160;with&#160;the&#160;bzip2recover&#160;program,&#160;which&#160;will&#160;try&#160;to&#160;recover&#160;dam-<br/>aged&#160;.bz2&#160;files.<br/>
<b>Don’t&#160;Be&#160;Compressive&#160;Compulsive</b><br/>
I&#160;occasionally&#160;see&#160;people&#160;attempting&#160;to&#160;compress&#160;a&#160;file&#160;that&#160;has&#160;already&#160;been<br/>compressed&#160;with&#160;an&#160;effective&#160;compression&#160;algorithm&#160;by&#160;doing&#160;something&#160;like<br/>this:<br/>
$&#160;<b>gzip picture.jpg</b>&#160;<br/>Don’t&#160;do&#160;it.&#160;You’re&#160;probably&#160;just&#160;wasting&#160;time&#160;and&#160;space!&#160;If&#160;you&#160;apply&#160;compres-<br/>sion&#160;to&#160;a&#160;file&#160;that&#160;is&#160;already&#160;compressed,&#160;you&#160;will&#160;usually&#160;end&#160;up&#160;with&#160;a&#160;larger&#160;file.<br/>This&#160;is&#160;because&#160;all&#160;compression&#160;techniques&#160;involve&#160;some&#160;overhead&#160;that&#160;is&#160;added<br/>to&#160;the&#160;file&#160;to&#160;describe&#160;the&#160;compression.&#160;If&#160;you&#160;try&#160;to&#160;compress&#160;a&#160;file&#160;that&#160;already<br/>contains&#160;no&#160;redundant&#160;information,&#160;the&#160;compression&#160;will&#160;most&#160;often&#160;not&#160;result&#160;in<br/>any savings&#160;to offset&#160;the&#160;additional&#160;overhead.<br/>
<b>Archiving&#160;Files<br/></b>A&#160;common&#160;file-management&#160;task&#160;often&#160;used&#160;in&#160;conjunction&#160;with&#160;compression&#160;is&#160;<i>archiv-<br/>ing</i>.&#160;Archiving is&#160;the&#160;process&#160;of gathering&#160;up many files&#160;and bundling&#160;them&#160;together into&#160;a<br/>single&#160;large&#160;file.&#160;Archiving&#160;is&#160;often&#160;done&#160;as&#160;part&#160;of&#160;system&#160;backups.&#160;It&#160;is&#160;also&#160;used&#160;when<br/>old data&#160;is&#160;moved&#160;from&#160;a&#160;system&#160;to&#160;some&#160;type&#160;of long-term&#160;storage.&#160;<br/>
238<br/>
<hr/>
<a name=263></a>Archiving&#160;Files<br/>
tar<br/>In the&#160;Unix-like&#160;world&#160;of&#160;software,&#160;the&#160;tar&#160;program&#160;is&#160;the&#160;classic&#160;tool&#160;for&#160;archiving&#160;files.<br/>Its&#160;name,&#160;short&#160;for&#160;<i>tape&#160;archive</i>, reveals&#160;its&#160;roots&#160;as&#160;a&#160;tool&#160;for&#160;making&#160;backup&#160;tapes.&#160;While<br/>it&#160;is&#160;still&#160;used&#160;for&#160;that&#160;traditional&#160;task,&#160;it&#160;is&#160;equally&#160;adept&#160;on&#160;other&#160;storage&#160;devices.&#160;We&#160;of-<br/>ten&#160;see&#160;filenames&#160;that&#160;end&#160;with&#160;the&#160;extension&#160;.tar&#160;or&#160;.tgz,&#160;which&#160;indicate&#160;a&#160;“plain”&#160;tar<br/>archive&#160;and&#160;a&#160;gzipped&#160;archive,&#160;respectively.&#160;A&#160;tar&#160;archive&#160;can&#160;consist&#160;of&#160;a&#160;group&#160;of&#160;sepa-<br/>rate&#160;files,&#160;one&#160;or&#160;more&#160;directory&#160;hierarchies,&#160;or&#160;a&#160;mixture&#160;of&#160;both.&#160;The&#160;command&#160;syntax<br/>works&#160;like&#160;this:<br/>tar&#160;<i>mode</i>[<i>options</i>]&#160;<i>pathname</i>...<br/>Here&#160;<i>mode</i>&#160;is&#160;one&#160;of&#160;the&#160;following&#160;operating&#160;modes&#160;listed&#160;in&#160;Table&#160;18-2&#160;(only&#160;a&#160;partial&#160;list<br/>is&#160;shown here;&#160;see&#160;the&#160;tar&#160;man page&#160;for a&#160;complete&#160;list).<br/>
<i>Table&#160;18-2:&#160;tar&#160;Modes</i><br/>
<b>Mode</b><br/>
<b>Description</b><br/>
c<br/>
Create&#160;an archive&#160;from&#160;a&#160;list&#160;of files&#160;and/or&#160;directories.<br/>
x<br/>
Extract&#160;an&#160;archive.<br/>
r<br/>
Append&#160;specified&#160;pathnames&#160;to the&#160;end of an archive.<br/>
t<br/>
List&#160;the&#160;contents&#160;of an archive.<br/>
tar&#160;uses&#160;a&#160;slightly&#160;odd&#160;way&#160;of&#160;expressing&#160;options,&#160;so&#160;we’ll&#160;need&#160;some&#160;examples&#160;to&#160;show<br/>how&#160;it&#160;works. First,&#160;let’s&#160;re-create&#160;our playground&#160;from&#160;the&#160;previous&#160;chapter.<br/>
[me@linuxbox ~]$&#160;<b>mkdir -p playground/dir-{001..100}<br/></b>[me@linuxbox ~]$&#160;<b>touch playground/dir-{001..100}/file-{A..Z}</b><br/>
Next, let’s&#160;create&#160;a&#160;tar archive&#160;of the&#160;entire&#160;playground.<br/>
[me@linuxbox ~]$&#160;<b>tar cf playground.tar playground</b><br/>
This&#160;command&#160;creates&#160;a&#160;tar&#160;archive&#160;named&#160;playground.tar&#160;that&#160;contains&#160;the&#160;entire<br/>playground&#160;directory&#160;hierarchy.&#160;We&#160;can&#160;see&#160;that&#160;the&#160;mode&#160;and&#160;the&#160;f&#160;option,&#160;which&#160;is&#160;used<br/>to&#160;specify&#160;the&#160;name&#160;of&#160;the&#160;tar&#160;archive,&#160;may&#160;be&#160;joined&#160;together&#160;and&#160;do&#160;not&#160;require&#160;a&#160;lead-<br/>ing&#160;dash.&#160;Note,&#160;however,&#160;that&#160;the&#160;mode&#160;must&#160;always&#160;be&#160;specified&#160;first,&#160;before&#160;any&#160;other<br/>option.<br/>To list&#160;the&#160;contents&#160;of the&#160;archive, we&#160;can&#160;do this:<br/>
239<br/>
<hr/>
<a name=264></a>18 –&#160;Archiving&#160;and Backup<br/>
[me@linuxbox ~]$&#160;<b>tar tf playground.tar</b><br/>
For a&#160;more&#160;detailed listing, we&#160;can&#160;add the&#160;v&#160;(verbose) option.<br/>
[me@linuxbox ~]$&#160;<b>tar tvf playground.tar</b><br/>
Now,&#160;let’s&#160;extract&#160;the&#160;playground&#160;in&#160;a&#160;new&#160;location.&#160;We&#160;will&#160;do&#160;this&#160;by&#160;creating&#160;a&#160;new&#160;di-<br/>rectory&#160;named&#160;foo, changing the&#160;directory&#160;and extracting&#160;the&#160;tar archive.<br/>
[me@linuxbox ~]$&#160;<b>mkdir foo<br/></b>[me@linuxbox ~]$&#160;<b>cd foo<br/></b>[me@linuxbox foo]$&#160;<b>tar xf ../playground.tar<br/></b>[me@linuxbox foo]$&#160;<b>ls<br/></b>playground<br/>
If&#160;we&#160;examine&#160;the&#160;contents&#160;of&#160;~/foo/playground,&#160;we&#160;see&#160;that&#160;the&#160;archive&#160;was&#160;suc-<br/>cessfully&#160;installed,&#160;&#160;creating&#160;a&#160;precise&#160;reproduction&#160;of&#160;the&#160;&#160;original&#160;files.&#160;There&#160;is&#160;one<br/>caveat,&#160;however.&#160;Unless&#160;we&#160;are&#160;operating&#160;as&#160;the&#160;superuser,&#160;files&#160;and&#160;directories&#160;extracted<br/>from&#160;archives&#160;take&#160;on&#160;the&#160;ownership&#160;of&#160;the&#160;user&#160;performing&#160;the&#160;restoration,&#160;rather&#160;than<br/>the&#160;original&#160;owner.<br/>Another&#160;interesting&#160;behavior&#160;of&#160;tar&#160;is&#160;the&#160;way&#160;it&#160;handles&#160;pathnames&#160;in&#160;archives.&#160;The&#160;de-<br/>fault&#160;for&#160;pathnames&#160;is&#160;relative,&#160;rather&#160;than&#160;absolute.&#160;tar&#160;does&#160;this&#160;by&#160;simply&#160;removing<br/>any&#160;leading&#160;slash&#160;from&#160;the&#160;pathname&#160;when&#160;creating&#160;the&#160;archive.&#160;To&#160;demonstrate,&#160;we&#160;will<br/>re-create&#160;our archive, this&#160;time&#160;specifying&#160;an absolute&#160;pathname.<br/>
[me@linuxbox foo]$&#160;<b>cd<br/></b>[me@linuxbox ~]$&#160;<b>tar cf playground2.tar ~/playground</b><br/>
Remember,&#160;&#160;~/playground&#160;&#160;will&#160;&#160;&#160;expand&#160;&#160;&#160;into&#160;&#160;/home/me/playground&#160;&#160;when&#160;&#160;&#160;we<br/>press&#160;the&#160;Enter&#160;key,&#160;so&#160;we&#160;will&#160;get&#160;an&#160;absolute&#160;pathname&#160;for&#160;our&#160;demonstration.&#160;Next,<br/>we&#160;will&#160;extract&#160;the&#160;archive&#160;as&#160;before&#160;and watch&#160;what&#160;happens.<br/>
[me@linuxbox ~]$&#160;<b>cd foo<br/></b>[me@linuxbox foo]$&#160;<b>tar xf ../playground2.tar<br/></b>[me@linuxbox foo]$&#160;<b>ls<br/></b>home &#160; playground<br/>[me@linuxbox foo]$&#160;<b>ls home</b><br/>
240<br/>
<hr/>
<a name=265></a>Archiving&#160;Files<br/>
me<br/>[me@linuxbox foo]$&#160;<b>ls home/me<br/></b>playground<br/>
Here&#160;we&#160;can&#160;see&#160;that&#160;when&#160;we&#160;extracted&#160;our&#160;second&#160;archive,&#160;it&#160;re-created&#160;the&#160;directory<br/>home/me/playground&#160;relative&#160;to&#160;our&#160;current&#160;working&#160;directory,&#160;~/foo,&#160;not&#160;relative<br/>to&#160;the&#160;root&#160;directory,&#160;as&#160;would&#160;have&#160;been&#160;the&#160;case&#160;with&#160;an&#160;absolute&#160;pathname.&#160;This&#160;may<br/>seem&#160;like&#160;an&#160;odd&#160;way&#160;for&#160;it&#160;to&#160;work,&#160;but&#160;it’s&#160;actually&#160;more&#160;useful&#160;this&#160;way,&#160;because&#160;it&#160;al-<br/>lows&#160;us&#160;to extract&#160;archives&#160;to any location&#160;rather&#160;than being&#160;forced to&#160;extract&#160;them&#160;to their<br/>original&#160;locations. Repeating&#160;the&#160;exercise&#160;with&#160;the&#160;inclusion of the&#160;verbose&#160;option (v) will<br/>give&#160;a&#160;clearer&#160;picture&#160;of what’s&#160;going&#160;on.<br/>Let’s&#160;consider&#160;a&#160;hypothetical,&#160;yet&#160;practical,&#160;example&#160;of&#160;tar&#160;in&#160;action.&#160;Imagine&#160;we&#160;want<br/>to&#160;copy&#160;the&#160;home&#160;directory&#160;and&#160;its&#160;contents&#160;from&#160;one&#160;system&#160;to&#160;another&#160;and&#160;we&#160;have&#160;a<br/>large&#160;USB&#160;hard&#160;drive&#160;that&#160;we&#160;can&#160;use&#160;for&#160;the&#160;transfer.&#160;On&#160;our&#160;modern&#160;Linux&#160;system,&#160;the<br/>drive&#160;is&#160;“automagically”&#160;mounted&#160;in&#160;the&#160;/media&#160;directory.&#160;Let’s&#160;also&#160;imagine&#160;that&#160;the<br/>disk&#160;has&#160;a&#160;volume&#160;name&#160;of&#160;BigDisk&#160;when&#160;we&#160;attach&#160;it.&#160;To&#160;make&#160;the&#160;tar&#160;archive,&#160;we&#160;can<br/>do the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>sudo tar cf /media/BigDisk/home.tar /home</b><br/>
After&#160;the&#160;tar&#160;file&#160;is&#160;written,&#160;we&#160;unmount&#160;the&#160;drive&#160;and&#160;attach&#160;it&#160;to&#160;the&#160;second&#160;computer.<br/>Again, it&#160;is&#160;mounted&#160;at&#160;/media/BigDisk.&#160;To extract&#160;the&#160;archive, we&#160;do this:<br/>
[me@linuxbox2 ~]$&#160;<b>cd /<br/></b>[me@linuxbox2 /]$&#160;<b>sudo tar xf /media/BigDisk/home.tar</b><br/>
What’s&#160;important&#160;to&#160;see&#160;here&#160;is&#160;that&#160;we&#160;must&#160;first&#160;change&#160;directory&#160;to&#160;/&#160;so&#160;that&#160;the&#160;extrac-<br/>tion is&#160;relative&#160;to&#160;the&#160;root&#160;directory,&#160;since&#160;all&#160;pathnames&#160;within&#160;the&#160;archive&#160;are&#160;relative.<br/>When&#160;extracting&#160;an&#160;archive,&#160;it’s&#160;possible&#160;to&#160;limit&#160;what&#160;is&#160;extracted&#160;from&#160;the&#160;archive.&#160;For<br/>example, if&#160;we&#160;wanted&#160;to extract&#160;a&#160;single&#160;file&#160;from&#160;an archive, it&#160;could be&#160;done&#160;like&#160;this:&#160;<br/>
<b>tar xf&#160;<i>archive.tar</i></b><b>&#160;<i>pathname</i></b><br/>
By adding&#160;the&#160;trailing&#160;<i>pathname</i>&#160;to&#160;the&#160;command,&#160;tar&#160;will&#160;restore&#160;only&#160;the&#160;specified&#160;file.<br/>Multiple&#160;pathnames&#160;may&#160;be&#160;specified. Note&#160;that&#160;the&#160;pathname&#160;must&#160;be&#160;the&#160;full, exact&#160;rela-<br/>tive&#160;pathname&#160;as&#160;stored&#160;in&#160;the&#160;archive.&#160;When&#160;specifying&#160;pathnames,&#160;wildcards&#160;are&#160;not<br/>normally&#160;supported;&#160;however,&#160;the&#160;GNU&#160;version&#160;of&#160;tar&#160;(which&#160;is&#160;the&#160;version&#160;most&#160;often<br/>
241<br/>
<hr/>
<a name=266></a>18 –&#160;Archiving&#160;and Backup<br/>
found&#160;in&#160;Linux&#160;distributions)&#160;supports&#160;them&#160;with&#160;the&#160;--wildcards&#160;option.&#160;Here&#160;is&#160;an<br/>example&#160;using our previous&#160;playground.tar&#160;file:<br/>
[me@linuxbox ~]$&#160;<b>cd foo<br/></b>[me@linuxbox foo]$&#160;<b>tar xf ../playground2.tar --wildcards 'home/me/pla<br/>yground/dir-*/file-A'</b><br/>
This&#160;command&#160;will&#160;extract&#160;only&#160;files&#160;matching&#160;the&#160;specified&#160;pathname&#160;including&#160;the<br/>wildcard&#160;dir-*.<br/>
tar&#160;is&#160;often used in&#160;conjunction with&#160;find&#160;to&#160;produce&#160;archives. In this&#160;example,&#160;we&#160;will<br/>use&#160;find&#160;to produce&#160;a&#160;set&#160;of files&#160;to include&#160;in&#160;an archive.<br/>
[me@linuxbox ~]$&#160;<b>find playground -name 'file-A' -exec tar rf&#160;<br/>playground.tar '{}' '+'</b><br/>
Here&#160;we&#160;use&#160;find&#160;to&#160;match&#160;all&#160;the&#160;files&#160;in&#160;playground&#160;named&#160;file-A&#160;and&#160;then,&#160;us-<br/>ing&#160;the&#160;-exec&#160;action,&#160;we&#160;invoke&#160;tar&#160;in&#160;the&#160;append&#160;mode&#160;(r)&#160;to&#160;add&#160;the&#160;matching&#160;files<br/>to the&#160;archive&#160;playground.tar.<br/>Using&#160;tar&#160;with&#160;find&#160;is&#160;a&#160;good&#160;way&#160;of&#160;creating&#160;<i>incremental&#160;backups</i>&#160;of&#160;a&#160;directory&#160;tree<br/>or&#160;an&#160;entire&#160;system.&#160;By&#160;using&#160;find&#160;to&#160;match&#160;files&#160;newer&#160;than&#160;a&#160;timestamp&#160;file,&#160;we&#160;could<br/>create&#160;an&#160;archive&#160;that&#160;contains&#160;only&#160;those&#160;files&#160;newer&#160;than&#160;the&#160;last&#160;archive,&#160;assuming&#160;that<br/>the&#160;timestamp file&#160;is&#160;updated&#160;right&#160;after each archive&#160;is&#160;created.<br/>
tar&#160;can also&#160;make&#160;use&#160;of both&#160;standard input&#160;and output.&#160;Here&#160;is&#160;a&#160;comprehensive&#160;exam-<br/>ple:<br/>
[me@linuxbox foo]$&#160;<b>cd<br/></b>[me@linuxbox ~]$&#160;<b>find playground -name 'file-A' | tar cf - --files-<br/>from=- | gzip &gt; playground.tgz</b><br/>
In&#160;this&#160;example,&#160;we&#160;used&#160;the&#160;find&#160;program&#160;to&#160;produce&#160;a&#160;list&#160;of&#160;matching&#160;files&#160;and&#160;piped<br/>them&#160;into&#160;tar.&#160;If&#160;the&#160;filename&#160;-&#160;is&#160;specified,&#160;it&#160;is&#160;taken&#160;to&#160;mean&#160;standard&#160;input&#160;or&#160;output,<br/>as&#160;needed.&#160;(By&#160;the&#160;way,&#160;this&#160;convention&#160;of&#160;using&#160;-&#160;to&#160;represent&#160;standard&#160;input/output&#160;is<br/>used&#160;by&#160;a&#160;number&#160;of&#160;other&#160;programs,&#160;too).&#160;The&#160;--files-from&#160;option&#160;(which&#160;may&#160;also<br/>be&#160;specified&#160;as&#160;-T)&#160;causes&#160;tar&#160;to&#160;read&#160;its&#160;list&#160;of&#160;pathnames&#160;from&#160;a&#160;file&#160;rather&#160;than&#160;the<br/>command&#160;line.&#160;Lastly,&#160;the&#160;archive&#160;produced&#160;by&#160;&#160;tar&#160;&#160;is&#160;piped&#160;into&#160;&#160;gzip&#160;&#160;to&#160;create&#160;the<br/>compressed&#160;archive&#160;playground.tgz.&#160;The&#160;.tgz&#160;extension&#160;is&#160;the&#160;conventional&#160;exten-<br/>sion&#160;given&#160;to&#160;&#160;gzip-compressed&#160;tar&#160;files.&#160;The&#160;extension&#160;&#160;.tar.gz&#160;&#160;is&#160;also&#160;used&#160;some-<br/>
242<br/>
<hr/>
<a name=267></a>Archiving&#160;Files<br/>
times.<br/>While&#160;we&#160;used&#160;the&#160;gzip&#160;program&#160;externally&#160;to&#160;produce&#160;our&#160;compressed&#160;archive,&#160;modern<br/>versions&#160;of&#160;GNU&#160;tar&#160;support&#160;both&#160;gzip&#160;and&#160;bzip2&#160;compression&#160;directly&#160;with&#160;the&#160;use<br/>of&#160;the&#160;z&#160;and&#160;j&#160;options,&#160;respectively.&#160;Using&#160;our&#160;previous&#160;example&#160;as&#160;a&#160;base,&#160;we&#160;can&#160;sim-<br/>plify it&#160;this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>find playground -name 'file-A' | tar czf</b>&#160;<br/><b>playground.tgz -T -</b><br/>
If&#160;we&#160;had&#160;wanted&#160;to&#160;create&#160;a&#160;&#160;bzip2-compressed&#160;archive&#160;instead,&#160;we&#160;could&#160;have&#160;done<br/>this:<br/>
[me@linuxbox ~]$&#160;<b>find playground -name 'file-A' | tar cjf&#160;<br/>playground.tbz -T -</b><br/>
By&#160;simply&#160;changing&#160;the&#160;compression&#160;option&#160;from&#160;z&#160;to&#160;j&#160;(and&#160;changing&#160;the&#160;output&#160;file’s<br/>extension&#160;to&#160;.tbz&#160;to&#160;indicate&#160;a&#160;bzip2-compressed&#160;file)&#160;we&#160;enabled&#160;bzip2-compres-<br/>sion.<br/>Another&#160;interesting&#160;use&#160;of&#160;standard&#160;input&#160;and&#160;output&#160;with&#160;the&#160;&#160;tar&#160;&#160;command&#160;involves<br/>transferring&#160;files&#160;between&#160;systems&#160;over&#160;a&#160;network.&#160;Imagine&#160;that&#160;we&#160;had&#160;two&#160;machines<br/>running&#160;a&#160;Unix-like&#160;system&#160;equipped&#160;with&#160;&#160;tar&#160;and&#160;ssh.&#160;In&#160;such&#160;a&#160;scenario,&#160;we&#160;could<br/>transfer&#160;a&#160;directory&#160;from&#160;a&#160;remote&#160;system&#160;(named&#160;remote-sys&#160;for&#160;this&#160;example)&#160;to&#160;our<br/>local&#160;system.<br/>
[me@linuxbox ~]$&#160;<b>mkdir remote-stuff<br/></b>[me@linuxbox ~]$&#160;<b>cd remote-stuff<br/></b>[me@linuxbox remote-stuff]$&#160;<b>ssh remote-sys 'tar cf - Documents' | tar<br/>xf -<br/></b>me@remote-sys’s password:<br/>[me@linuxbox remote-stuff]$&#160;<b>ls<br/></b>Documents<br/>
Here&#160;we&#160;were&#160;able&#160;to&#160;copy&#160;a&#160;directory&#160;named&#160;Documents&#160;from&#160;the&#160;remote&#160;system&#160;re-<br/>mote-sys&#160;to&#160;a&#160;directory&#160;within&#160;the&#160;directory&#160;named&#160;remote-stuff&#160;on&#160;the&#160;local&#160;sys-<br/>tem.&#160;How&#160;did&#160;we&#160;do&#160;this?&#160;First,&#160;we&#160;launched&#160;the&#160;tar&#160;program&#160;on&#160;the&#160;remote&#160;system&#160;us-<br/>ing&#160;&#160;ssh.&#160;You&#160;will&#160;recall&#160;that&#160;&#160;ssh&#160;&#160;allows&#160;us&#160;to&#160;execute&#160;a&#160;program&#160;remotely&#160;on&#160;a&#160;net-<br/>worked&#160;computer&#160;and&#160;“see”&#160;the&#160;results&#160;on&#160;the&#160;local&#160;system — the&#160;standard&#160;output&#160;pro-<br/>duced&#160;on&#160;the&#160;remote&#160;system&#160;is&#160;sent&#160;to&#160;the&#160;local&#160;system&#160;for&#160;viewing.&#160;We&#160;can&#160;take&#160;advan-<br/>
243<br/>
<hr/>
<a name=268></a>18 –&#160;Archiving&#160;and Backup<br/>
tage&#160;of&#160;this&#160;by&#160;having&#160;tar&#160;create&#160;an&#160;archive&#160;(the&#160;c&#160;mode)&#160;and&#160;send&#160;it&#160;to&#160;standard&#160;output,<br/>rather&#160;than&#160;a&#160;file&#160;(the&#160;f&#160;option&#160;with&#160;the&#160;dash&#160;argument),&#160;thereby&#160;transporting&#160;the&#160;archive<br/>over&#160;the&#160;encrypted&#160;tunnel&#160;provided&#160;by&#160;ssh&#160;to&#160;the&#160;local&#160;system.&#160;On&#160;the&#160;local&#160;system,&#160;we<br/>execute&#160;tar&#160;and&#160;have&#160;it&#160;expand&#160;an&#160;archive&#160;(the&#160;x&#160;mode)&#160;supplied&#160;from&#160;standard&#160;input<br/>(again,&#160;the&#160;f&#160;option&#160;with the&#160;dash argument).<br/>
zip<br/>The&#160;zip&#160;program&#160;is&#160;both&#160;a&#160;compression&#160;tool&#160;and&#160;an&#160;archiver.&#160;The&#160;file&#160;format&#160;used&#160;by&#160;the<br/>program&#160;is&#160;familiar&#160;to&#160;Windows&#160;users,&#160;as&#160;it&#160;reads&#160;and&#160;writes&#160;.zip&#160;files.&#160;In&#160;Linux,&#160;how-<br/>ever,&#160;gzip&#160;is&#160;the&#160;predominant&#160;compression program, with&#160;bzip2&#160;being a&#160;close&#160;second.<br/>In its&#160;most&#160;basic&#160;usage,&#160;zip&#160;is&#160;invoked&#160;like&#160;this:<br/>zip&#160;<i>options</i>&#160;<i>zipfile</i>&#160;<i>file...<br/></i>For example,&#160;to make&#160;a&#160;zip&#160;archive&#160;of our playground,&#160;we&#160;would&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>zip -r playground.zip playground</b><br/>
Unless&#160;we&#160;include&#160;the&#160;&#160;-r&#160;&#160;option&#160;for&#160;recursion,&#160;only&#160;the&#160;&#160;playground&#160;&#160;directory&#160;(but<br/>none&#160;of&#160;its&#160;contents)&#160;is&#160;stored.&#160;Although&#160;the&#160;addition&#160;of&#160;the&#160;extension&#160;.zip&#160;is&#160;automatic,<br/>we&#160;will&#160;include&#160;the&#160;file&#160;extension&#160;for clarity.<br/>During&#160;the&#160;creation&#160;of&#160;the&#160;zip&#160;archive,&#160;&#160;zip&#160;will&#160;normally&#160;display&#160;a&#160;series&#160;of&#160;messages<br/>like&#160;this:<br/>
&#160;adding: playground/dir-020/file-Z (stored 0%)&#160;<br/>&#160;adding: playground/dir-020/file-Y (stored 0%)&#160;<br/>&#160;adding: playground/dir-020/file-X (stored 0%)&#160;<br/>&#160;adding: playground/dir-087/ (stored 0%)&#160;<br/>&#160;adding: playground/dir-087/file-S (stored 0%)&#160;<br/>
These&#160;messages&#160;show&#160;the&#160;status&#160;of&#160;each&#160;file&#160;added&#160;to&#160;the&#160;archive.&#160;zip&#160;will&#160;add&#160;files&#160;to<br/>the&#160;archive&#160;using&#160;one&#160;of&#160;two&#160;storage&#160;methods:&#160;either&#160;it&#160;will&#160;“store”&#160;a&#160;file&#160;without&#160;com-<br/>pression,&#160;as&#160;shown&#160;here,&#160;or&#160;it&#160;will&#160;“deflate”&#160;the&#160;file&#160;that&#160;performs&#160;compression.&#160;The&#160;nu-<br/>meric&#160;value&#160;displayed&#160;after&#160;the&#160;storage&#160;method&#160;indicates&#160;the&#160;amount&#160;of&#160;compression<br/>achieved.&#160;Since&#160;our&#160;playground&#160;contains&#160;only&#160;empty&#160;files,&#160;no&#160;compression&#160;is&#160;performed<br/>on its&#160;contents.<br/>Extracting&#160;the&#160;contents&#160;of a&#160;zip&#160;file&#160;is&#160;straightforward&#160;when&#160;using&#160;the&#160;unzip&#160;program.<br/>
244<br/>
<hr/>
<a name=269></a>Archiving&#160;Files<br/>
[me@linuxbox ~]$&#160;<b>cd foo<br/></b>[me@linuxbox foo]$&#160;<b>unzip ../playground.zip</b><br/>
One&#160;thing&#160;to&#160;note&#160;about&#160;zip&#160;(as&#160;opposed&#160;to&#160;tar)&#160;is&#160;that&#160;if&#160;an&#160;existing&#160;archive&#160;is&#160;speci-<br/>fied,&#160;it&#160;is&#160;updated&#160;rather&#160;than&#160;replaced.&#160;This&#160;means&#160;the&#160;existing&#160;archive&#160;is&#160;preserved,&#160;but<br/>new&#160;files&#160;are&#160;added and&#160;matching files&#160;are&#160;replaced.<br/>Files&#160;may&#160;be&#160;listed&#160;and&#160;extracted&#160;selectively&#160;from&#160;a&#160;zip&#160;archive&#160;by&#160;specifying&#160;them&#160;to<br/>unzip.<br/>
[me@linuxbox ~]$&#160;<b>unzip -l playground.zip playground/dir-087/file-Z<br/></b>Archive: &#160;../playground.zip&#160;<br/>&#160; Length &#160; &#160; Date &#160; Time &#160; &#160;Name&#160;<br/>&#160;-------- &#160; &#160;---- &#160; ---- &#160; &#160;----&#160;<br/>&#160; &#160; &#160; &#160; 0 &#160;10-05-16 09:25 &#160; playground/dir-087/file-Z&#160;<br/>&#160;-------- &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; -------&#160;<br/>&#160; &#160; &#160; &#160; 0 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 1 file<br/>[me@linuxbox ~]$&#160;<b>cd foo<br/></b>[me@linuxbox foo]$&#160;<b>unzip ../playground.zip playground/dir-087/file-Z<br/></b>Archive: &#160;../playground.zip&#160;<br/>replace playground/dir-087/file-Z? [y]es, [n]o, [A]ll, [N]one,&#160;<br/>[r]ename:&#160;<b>y</b>&#160;<br/>&#160;extracting: playground/dir-087/file-Z&#160;<br/>
Using&#160;the&#160;-l&#160;option&#160;causes&#160;unzip&#160;to&#160;merely&#160;list&#160;the&#160;contents&#160;of&#160;the&#160;archive&#160;without&#160;ex-<br/>tracting&#160;the&#160;file.&#160;If&#160;no&#160;files&#160;are&#160;specified,&#160;unzip&#160;will&#160;list&#160;all&#160;files&#160;in&#160;the&#160;archive.&#160;The&#160;-v<br/>option&#160;can&#160;be&#160;added&#160;to&#160;increase&#160;the&#160;verbosity&#160;of&#160;the&#160;listing.&#160;Note&#160;that&#160;when&#160;the&#160;archive<br/>extraction&#160;conflicts&#160;with an existing file, the&#160;user&#160;is&#160;prompted&#160;before&#160;the&#160;file&#160;is&#160;replaced.&#160;<br/>Like&#160;tar,&#160;zip&#160;can&#160;make&#160;use&#160;of&#160;standard&#160;input&#160;and&#160;output,&#160;though&#160;its&#160;implementation&#160;is<br/>somewhat&#160;less&#160;useful. It&#160;is&#160;possible&#160;to pipe&#160;a&#160;list&#160;of filenames&#160;to&#160;zip&#160;via&#160;the&#160;-@&#160;option.<br/>
[me@linuxbox foo]$&#160;<b>cd<br/></b>[me@linuxbox ~]$&#160;<b>find playground -name &#34;file-A&#34; | zip -@ file-A.zip</b><br/>
Here&#160;we&#160;use&#160;find&#160;to&#160;generate&#160;a&#160;list&#160;of&#160;files&#160;matching&#160;the&#160;test&#160;-name&#160;&#34;file-A&#34;&#160;and<br/>then&#160;pipe&#160;the&#160;list&#160;into&#160;zip,&#160;which&#160;creates&#160;the&#160;archive&#160;file-A.zip&#160;containing&#160;the&#160;se-<br/>lected files.<br/>
zip&#160;also&#160;supports&#160;writing&#160;its&#160;output&#160;to&#160;standard&#160;output,&#160;but&#160;its&#160;use&#160;is&#160;limited&#160;because&#160;few<br/>programs&#160;can&#160;make&#160;use&#160;of&#160;the&#160;output.&#160;Unfortunately,&#160;the&#160;unzip&#160;program&#160;does&#160;not&#160;accept<br/>
245<br/>
<hr/>
<a name=270></a>18 –&#160;Archiving&#160;and Backup<br/>
standard&#160;input.&#160;This&#160;prevents&#160;zip&#160;and&#160;unzip&#160;from&#160;being&#160;used&#160;together&#160;to&#160;perform&#160;net-<br/>work file&#160;copying&#160;like&#160;tar.<br/>
zip&#160;&#160;can,&#160;however,&#160;accept&#160;standard&#160;input,&#160;so&#160;it&#160;can&#160;be&#160;used&#160;to&#160;compress&#160;the&#160;output&#160;of<br/>other programs.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /etc/ | zip ls-etc.zip -<br/></b>&#160;adding: - (deflated 80%)<br/>
In&#160;this&#160;example,&#160;we&#160;pipe&#160;the&#160;output&#160;of&#160;ls&#160;into&#160;zip.&#160;Like&#160;tar,&#160;zip&#160;interprets&#160;the&#160;trailing<br/>dash as&#160;“use&#160;standard input&#160;for the&#160;input&#160;file.”<br/>The&#160;&#160;unzip&#160;&#160;program&#160;allows&#160;its&#160;output&#160;to&#160;be&#160;sent&#160;to&#160;standard&#160;output&#160;when&#160;the&#160;&#160;-p&#160;&#160;(for<br/>pipe) option is&#160;specified.<br/>
[me@linuxbox ~]$&#160;<b>unzip -p ls-etc.zip |&#160;less</b><br/>
We&#160;touched&#160;on&#160;some&#160;of&#160;the&#160;basic&#160;things&#160;that&#160;zip/unzip&#160;can&#160;do.&#160;They&#160;both&#160;have&#160;a&#160;lot&#160;of<br/>options&#160;that&#160;add&#160;to&#160;their&#160;flexibility,&#160;though&#160;some&#160;are&#160;platform&#160;specific&#160;to&#160;other&#160;systems.<br/>The&#160;man&#160;pages&#160;for&#160;both&#160;zip&#160;and&#160;unzip&#160;are&#160;pretty&#160;good&#160;and&#160;contain&#160;useful&#160;examples.<br/>However,&#160;the&#160;main&#160;use&#160;of&#160;these&#160;programs&#160;is&#160;for&#160;exchanging&#160;files&#160;with&#160;Windows&#160;systems,<br/>rather&#160;than&#160;performing&#160;compression&#160;and&#160;archiving&#160;on&#160;Linux,&#160;where&#160;tar&#160;and&#160;gzip&#160;are<br/>greatly&#160;preferred.<br/>
<b>Synchronizing&#160;Files&#160;and&#160;Directories<br/></b>A&#160;common&#160;strategy&#160;for&#160;maintaining&#160;a&#160;backup&#160;copy&#160;of&#160;a&#160;system&#160;involves&#160;keeping&#160;one&#160;or<br/>more&#160;directories&#160;synchronized&#160;with&#160;another&#160;directory&#160;(or&#160;directories)&#160;located&#160;on&#160;either&#160;the<br/>local&#160;system&#160;(usually&#160;a&#160;removable&#160;storage&#160;device&#160;of&#160;some&#160;kind)&#160;or&#160;a&#160;remote&#160;system.&#160;We<br/>might,&#160;for&#160;example,&#160;have&#160;a&#160;local&#160;copy&#160;of&#160;a&#160;website&#160;under&#160;development&#160;and&#160;synchronize&#160;it<br/>from&#160;time&#160;to&#160;time&#160;with the&#160;“live”&#160;copy&#160;on a&#160;remote&#160;web server.<br/>In&#160;the&#160;Unix-like&#160;world,&#160;the&#160;preferred&#160;tool&#160;for&#160;this&#160;task&#160;is&#160;rsync.&#160;This&#160;program&#160;can&#160;syn-<br/>chronize&#160;both&#160;local&#160;and&#160;remote&#160;directories&#160;by&#160;using&#160;the&#160;&#160;<i>rsync&#160;remote-update&#160;protocol</i>,<br/>which&#160;allows&#160;rsync&#160;to&#160;quickly&#160;detect&#160;the&#160;differences&#160;between&#160;two&#160;directories&#160;and&#160;per-<br/>form&#160;the&#160;minimum&#160;amount&#160;of&#160;copying&#160;required&#160;to&#160;bring&#160;them&#160;into&#160;sync.&#160;This&#160;makes<br/>rsync&#160;very fast&#160;and&#160;economical&#160;to use, compared&#160;to other&#160;kinds&#160;of copy programs.<br/>
rsync&#160;is&#160;invoked like&#160;this:<br/>rsync&#160;<i>options</i>&#160;<i>source</i>&#160;<i>destination<br/></i>where&#160;<i>source</i>&#160;and&#160;<i>destination</i>&#160;are&#160;one&#160;of the&#160;following:<br/>
246<br/>
<hr/>
<a name=271></a>Synchronizing&#160;Files&#160;and Directories<br/>
●<br/>
A&#160;local&#160;file&#160;or directory<br/>
●<br/>
A&#160;remote&#160;file&#160;or directory in the&#160;form&#160;of&#160;<i>[user@]host:path</i><br/>
●<br/>
A&#160;remote&#160;rsync&#160;server specified with a&#160;URI of&#160;<i>rsync://[user@]host[:port]/path</i><br/>
Note&#160;that&#160;either the&#160;source&#160;or the&#160;destination&#160;must&#160;be&#160;a&#160;local&#160;file.&#160;Remote-to-remote&#160;copy-<br/>ing is&#160;not&#160;supported.<br/>Let’s&#160;try&#160;rsync&#160;out&#160;on some&#160;local&#160;files.&#160;First,&#160;let’s&#160;clean&#160;out&#160;our&#160;foo&#160;directory.<br/>
[me@linuxbox ~]$&#160;<b>rm -rf foo/*</b><br/>
Next, we’ll&#160;synchronize&#160;the&#160;playground&#160;directory&#160;with a&#160;corresponding copy in&#160;foo.<br/>
[me@linuxbox ~]$&#160;<b>rsync -av playground foo</b><br/>
We’ve&#160;included&#160;both&#160;the&#160;-a&#160;option&#160;(for&#160;archiving — causes&#160;recursion&#160;and&#160;preservation&#160;of<br/>file&#160;attributes)&#160;and&#160;the&#160;-v&#160;option&#160;(verbose&#160;output)&#160;to&#160;make&#160;a&#160;<i>mirror</i>&#160;of&#160;the&#160;playground<br/>directory&#160;within&#160;foo.&#160;While&#160;the&#160;command&#160;runs,&#160;we&#160;will&#160;see&#160;a&#160;list&#160;of&#160;the&#160;files&#160;and&#160;directo-<br/>ries&#160;being&#160;copied.&#160;At&#160;the&#160;end,&#160;we&#160;will&#160;see&#160;a&#160;summary&#160;message&#160;like&#160;this&#160;indicating&#160;the<br/>amount&#160;of copying performed:<br/>
sent 135759 bytes &#160;received 57870 bytes &#160;387258.00 bytes/sec&#160;<br/>total size is 3230 &#160;speedup is 0.02<br/>
If we&#160;run the&#160;command again, we&#160;will&#160;see&#160;a&#160;different&#160;result.<br/>
[me@linuxbox ~]$&#160;<b>rsync -av playground foo<br/></b>building file list ... done&#160;<br/>
sent 22635 bytes &#160;received 20 bytes &#160;45310.00 bytes/sec&#160;<br/>total size is 3230 &#160;speedup is 0.14<br/>
Notice&#160;that&#160;there&#160;was&#160;no&#160;listing&#160;of&#160;files.&#160;This&#160;is&#160;because&#160;rsync&#160;detected&#160;that&#160;there&#160;were<br/>no&#160;differences&#160;between&#160;&#160;~/playground&#160;&#160;and&#160;&#160;~/foo/playground,&#160;and&#160;therefore&#160;it<br/>didn’t&#160;need&#160;to copy anything. If we&#160;modify&#160;a&#160;file&#160;in&#160;playground&#160;and&#160;run&#160;rsync&#160;again:<br/>
[me@linuxbox ~]$&#160;<b>touch playground/dir-099/file-Z</b><br/>
247<br/>
<hr/>
<a name=272></a>18 –&#160;Archiving&#160;and Backup<br/>
[me@linuxbox ~]$&#160;<b>rsync -av playground foo<br/></b>building file list ... done&#160;<br/>playground/dir-099/file-Z&#160;<br/>sent 22685 bytes &#160;received 42 bytes &#160;45454.00 bytes/sec&#160;<br/>total size is 3230 &#160;speedup is 0.14<br/>
we&#160;see&#160;that&#160;rsync&#160;detected the&#160;change&#160;and copied&#160;only the&#160;updated&#160;file.<br/>There&#160;is&#160;a&#160;subtle&#160;but&#160;useful&#160;feature&#160;we&#160;can&#160;use&#160;when&#160;we&#160;specify&#160;an&#160;rsync&#160;source.&#160;Let’s<br/>consider two directories.<br/>
<a href="mailto:me@linuxbox">[me@linuxbox</a>&#160;~]$&#160;<b>ls<br/></b>source &#160; &#160; &#160; &#160;destination<br/>
Directory&#160;&#160;source&#160;&#160;contains&#160;one&#160;file&#160;named&#160;&#160;file1&#160;&#160;and&#160;directory&#160;&#160;destination&#160;&#160;is<br/>empty.&#160;If we&#160;perform&#160;a&#160;copy of&#160;source&#160;to&#160;destination&#160;like&#160;so:<br/>
<a href="mailto:me@linuxbox">[me@linuxbox</a>&#160;~]$&#160;<b>rsync source destination</b><br/>
then&#160;rsync&#160;copies&#160;the&#160;directory&#160;source&#160;into&#160;destination.<br/>
<a href="mailto:me@linuxbox">[me@linuxbox</a>&#160;~]$&#160;<b>ls destination<br/></b>source<br/>
However,&#160;if&#160;we&#160;append&#160;a&#160;trailing&#160;/&#160;to&#160;the&#160;source&#160;directory&#160;name,&#160;rsync&#160;will&#160;copy&#160;only<br/>the&#160;contents&#160;of the&#160;source&#160;directory and not&#160;the&#160;directory itself.<br/>
<a href="mailto:me@linuxbox">[me@linuxbox</a>&#160;~]$&#160;<b>rsync source/ destination<br/></b><a href="mailto:me@linuxbox">[me@linuxbox</a>&#160;~]$ ls destination<br/>file1<br/>
This&#160;is&#160;handy&#160;if&#160;we&#160;want&#160;only&#160;the&#160;contents&#160;of&#160;a&#160;directory&#160;copied&#160;without&#160;creating&#160;another<br/>level&#160;of&#160;directories&#160;within&#160;the&#160;destination.&#160;We&#160;can&#160;think&#160;of&#160;it&#160;as&#160;being&#160;like&#160;source/*&#160;in<br/>its&#160;outcome,&#160;but&#160;this&#160;method&#160;will&#160;copy&#160;all&#160;of&#160;the&#160;source&#160;directory’s&#160;content&#160;including&#160;the<br/>hidden files.<br/>As&#160;a&#160;practical&#160;example,&#160;let’s&#160;consider&#160;the&#160;imaginary&#160;external&#160;hard&#160;drive&#160;that&#160;we&#160;used&#160;ear-<br/>lier&#160;with&#160;&#160;tar.&#160;If&#160;we&#160;attach&#160;the&#160;drive&#160;to&#160;our&#160;system&#160;and&#160;it&#160;is&#160;mounted&#160;at&#160;&#160;/media/<br/>
248<br/>
<hr/>
<a name=273></a>Synchronizing&#160;Files&#160;and Directories<br/>
BigDisk&#160;once&#160;again,&#160;we&#160;can&#160;perform&#160;a&#160;useful&#160;system&#160;backup&#160;by&#160;first&#160;creating&#160;a&#160;direc-<br/>tory&#160;named&#160;/backup&#160;on&#160;the&#160;external&#160;drive&#160;and&#160;then&#160;using&#160;rsync&#160;to&#160;copy&#160;the&#160;most&#160;im-<br/>portant&#160;stuff from&#160;our system&#160;to the&#160;external&#160;drive.<br/>
[me@linuxbox ~]$&#160;<b>mkdir /media/BigDisk/backup<br/></b>[me@linuxbox ~]$&#160;<b>sudo rsync -av --delete /etc /home /usr/local&#160;<br/>/media/BigDisk/backup</b><br/>
In&#160;this&#160;example,&#160;we&#160;copied&#160;the&#160;/etc,&#160;/home,&#160;and&#160;/usr/local&#160;directories&#160;from&#160;our<br/>system&#160;to&#160;our&#160;imaginary&#160;storage&#160;device.&#160;We&#160;included&#160;the&#160;--delete&#160;option&#160;to&#160;remove<br/>files&#160;that&#160;may&#160;have&#160;existed&#160;on&#160;the&#160;backup&#160;device&#160;that&#160;no&#160;longer&#160;existed&#160;on&#160;the&#160;source&#160;de-<br/>vice&#160;(this&#160;is&#160;irrelevant&#160;the&#160;first&#160;time&#160;we&#160;make&#160;a&#160;backup&#160;but&#160;will&#160;be&#160;useful&#160;on&#160;subsequent<br/>copies).&#160;Repeating&#160;the&#160;procedure&#160;of&#160;attaching&#160;the&#160;external&#160;drive&#160;and&#160;running&#160;this&#160;rsync<br/>command&#160;would&#160;be&#160;a&#160;useful&#160;(though&#160;not&#160;ideal)&#160;way&#160;of&#160;keeping&#160;a&#160;small&#160;system&#160;backed&#160;up.<br/>Of&#160;course,&#160;an&#160;alias&#160;would&#160;be&#160;helpful&#160;here,&#160;too.&#160;We&#160;could&#160;create&#160;an&#160;alias&#160;and&#160;add&#160;it&#160;to&#160;our<br/>.bashrc&#160;file&#160;to provide&#160;this&#160;feature.<br/>
alias backup='sudo rsync -av --delete /etc /home /usr/local&#160;<br/>/media/BigDisk/backup'<br/>
Now&#160;all&#160;we&#160;have&#160;to&#160;do&#160;is&#160;attach&#160;our&#160;external&#160;drive&#160;and&#160;run&#160;the&#160;backup&#160;command&#160;to&#160;do<br/>the&#160;job.<br/>
Using&#160;rsync&#160;Over&#160;a&#160;Network<br/>One&#160;of&#160;the&#160;real&#160;beauties&#160;of&#160;rsync&#160;is&#160;that&#160;it&#160;can&#160;be&#160;used&#160;to&#160;copy&#160;files&#160;over&#160;a&#160;network.&#160;Af-<br/>ter&#160;all,&#160;the&#160;r&#160;in&#160;rsync&#160;stands&#160;for&#160;“remote.”&#160;Remote&#160;copying&#160;can&#160;be&#160;done&#160;in&#160;one&#160;of&#160;two<br/>ways.&#160;The&#160;first&#160;way&#160;is&#160;with&#160;another&#160;system&#160;that&#160;has&#160;rsync&#160;installed,&#160;along&#160;with&#160;a&#160;remote<br/>shell&#160;program&#160;such&#160;as&#160;ssh.&#160;Let’s&#160;say&#160;we&#160;had&#160;another&#160;system&#160;on&#160;our&#160;local&#160;network&#160;with&#160;a<br/>lot&#160;of&#160;available&#160;hard&#160;drive&#160;space&#160;and&#160;we&#160;wanted&#160;to&#160;perform&#160;our&#160;backup&#160;operation&#160;using<br/>the&#160;remote&#160;system&#160;instead&#160;of&#160;an&#160;external&#160;drive.&#160;Assuming&#160;that&#160;it&#160;already&#160;had&#160;a&#160;directory<br/>named&#160;/backup&#160;where&#160;we&#160;could deliver&#160;our files, we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>sudo rsync -av --delete --rsh=ssh /etc /home&#160;<br/>/usr/local remote-sys:/backup</b><br/>
We&#160;made&#160;two&#160;changes&#160;to&#160;our&#160;command&#160;to&#160;facilitate&#160;the&#160;network&#160;copy.&#160;First,&#160;we&#160;added&#160;the<br/>--rsh=ssh&#160;option,&#160;which&#160;instructs&#160;rsync&#160;to&#160;use&#160;the&#160;ssh&#160;program&#160;as&#160;its&#160;remote&#160;shell.<br/>
249<br/>
<hr/>
<a name=274></a>18 –&#160;Archiving&#160;and Backup<br/>
In&#160;this&#160;way,&#160;we&#160;were&#160;able&#160;to&#160;use&#160;an&#160;&#160;ssh-encrypted&#160;tunnel&#160;to&#160;securely&#160;transfer&#160;the&#160;data<br/>from&#160;the&#160;local&#160;system&#160;to&#160;the&#160;remote&#160;host.&#160;Second,&#160;we&#160;specified&#160;the&#160;remote&#160;host&#160;by&#160;prefix-<br/>ing&#160;its&#160;name&#160;(in&#160;this&#160;case&#160;the&#160;remote&#160;host&#160;is&#160;named&#160;&#160;remote-sys)&#160;to&#160;the&#160;destination<br/>pathname.<br/>The&#160;second&#160;way&#160;that&#160;rsync&#160;can&#160;be&#160;used&#160;to&#160;synchronize&#160;files&#160;over&#160;a&#160;network&#160;is&#160;by&#160;using<br/>an&#160;<i>rsync&#160;server</i>.&#160;rsync&#160;can&#160;be&#160;configured&#160;to&#160;run&#160;as&#160;a&#160;daemon&#160;and&#160;listen&#160;to&#160;incoming&#160;re-<br/>quests&#160;for&#160;synchronization.&#160;This&#160;is&#160;often&#160;done&#160;to&#160;allow&#160;mirroring&#160;of&#160;a&#160;remote&#160;system.&#160;For<br/>example,&#160;Red&#160;Hat&#160;Software&#160;maintains&#160;a&#160;large&#160;repository&#160;of&#160;software&#160;packages&#160;under&#160;de-<br/>velopment&#160;for&#160;its&#160;Fedora&#160;distribution.&#160;It&#160;is&#160;useful&#160;for&#160;software&#160;testers&#160;to&#160;mirror&#160;this&#160;collec-<br/>tion&#160;during&#160;the&#160;testing&#160;phase&#160;of&#160;the&#160;distribution&#160;release&#160;cycle.&#160;Since&#160;files&#160;in&#160;the&#160;repository<br/>change&#160;frequently&#160;(often&#160;more&#160;than&#160;once&#160;a&#160;day),&#160;it&#160;is&#160;desirable&#160;to&#160;maintain&#160;a&#160;local&#160;mirror<br/>by&#160;periodic&#160;synchronization,&#160;rather&#160;than&#160;by&#160;bulk&#160;copying&#160;of&#160;the&#160;repository.&#160;One&#160;of&#160;these<br/>repositories&#160;is&#160;kept&#160;at&#160;Duke&#160;University;&#160;we&#160;could&#160;mirror&#160;it&#160;using&#160;our local&#160;copy&#160;of&#160;rsync<br/>and their&#160;rsync&#160;server like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>mkdir fedora-devel<br/></b>[me@linuxbox ~]$&#160;<b>rsync -av –delete rsync://archive.linux.duke.edu/<br/>fedora/linux/development/rawhide/Everything/x86_64/os/ fedora-devel</b>&#160;<br/>
In&#160;this&#160;example,&#160;we&#160;use&#160;the&#160;URI&#160;of&#160;the&#160;remote&#160;rsync&#160;server,&#160;which&#160;consists&#160;of&#160;a&#160;proto-<br/>col&#160;(rsync://),&#160;followed&#160;by&#160;the&#160;remote&#160;host-name&#160;(archive.linux.duke.edu),<br/>followed by the&#160;pathname&#160;of the&#160;repository.<br/>
<b>Summing&#160;Up<br/></b>We've&#160;looked&#160;at&#160;the&#160;common&#160;compression&#160;and&#160;archiving&#160;programs&#160;used&#160;on&#160;Linux&#160;and<br/>other&#160;Unix-like&#160;operating&#160;systems.&#160;For&#160;archiving&#160;files,&#160;the&#160;tar/gzip&#160;combination&#160;is&#160;the<br/>preferred&#160;method&#160;on&#160;Unix-like&#160;systems&#160;while&#160;&#160;zip/unzip&#160;&#160;is&#160;used&#160;for&#160;interoperability<br/>with&#160;Windows&#160;systems.&#160;Finally,&#160;we&#160;looked&#160;at&#160;the&#160;rsync&#160;program&#160;(a&#160;personal&#160;favorite)<br/>which is&#160;very handy&#160;for efficient&#160;synchronization&#160;of files&#160;and directories&#160;across&#160;systems.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;man&#160;pages&#160;for all&#160;of the&#160;commands&#160;discussed here&#160;are&#160;pretty clear and&#160;con-<br/>tain&#160;useful&#160;examples. In addition, the&#160;GNU&#160;Project&#160;has&#160;a&#160;good online&#160;manual&#160;for&#160;<br/>its&#160;version of&#160;tar. It&#160;can be&#160;found here:<br/><a href="http://www.gnu.org/software/tar/manual/index.html">http://www.gnu.org/software/tar/manual/index.html</a><br/>
250<br/>
<hr/>
<a name=275></a>19 – Regular Expressions<br/>
<i><b>19&#160;–&#160;Regular&#160;Expressions</b></i><br/>
In&#160;the&#160;next&#160;few&#160;chapters,&#160;we&#160;are&#160;going&#160;to&#160;look&#160;at&#160;tools&#160;used&#160;to&#160;manipulate&#160;text.&#160;As&#160;we<br/>have&#160;seen,&#160;text&#160;data&#160;plays&#160;an&#160;important&#160;role&#160;on&#160;all&#160;Unix-like&#160;systems,&#160;such&#160;as&#160;Linux.&#160;But<br/>before&#160;we&#160;can&#160;fully&#160;appreciate&#160;all&#160;the&#160;features&#160;offered&#160;by&#160;these&#160;tools,&#160;we&#160;have&#160;to&#160;first&#160;ex-<br/>amine&#160;a&#160;technology&#160;that&#160;is&#160;frequently&#160;associated&#160;with&#160;the&#160;most&#160;sophisticated&#160;uses&#160;of&#160;these<br/>tools — <i>regular&#160;expressions</i>.<br/>As&#160;we&#160;have&#160;navigated&#160;the&#160;many&#160;features&#160;and&#160;facilities&#160;offered&#160;by&#160;the&#160;command&#160;line,&#160;we<br/>have&#160;encountered&#160;some&#160;truly&#160;arcane&#160;shell&#160;features&#160;and&#160;commands,&#160;such&#160;as&#160;shell&#160;expan-<br/>sion&#160;and&#160;quoting,&#160;keyboard&#160;shortcuts,&#160;and&#160;command&#160;history,&#160;not&#160;to&#160;mention&#160;the&#160;vi&#160;editor.<br/>Regular&#160;expressions&#160;continue&#160;this&#160;“tradition”&#160;and&#160;may&#160;be&#160;(arguably)&#160;the&#160;most&#160;arcane&#160;fea-<br/>ture&#160;of&#160;them&#160;all.&#160;This&#160;is&#160;not&#160;to&#160;suggest&#160;that&#160;the&#160;time&#160;it&#160;takes&#160;to&#160;learn&#160;about&#160;them&#160;is&#160;not<br/>worth&#160;the&#160;effort.&#160;Quite&#160;the&#160;contrary.&#160;A&#160;good&#160;understanding&#160;will&#160;enable&#160;us&#160;to&#160;perform<br/>amazing feats, though their&#160;full&#160;value&#160;may not&#160;be&#160;immediately apparent.<br/>
What&#160;are&#160;Regular&#160;Expressions?<br/>Simply&#160;put, regular&#160;expressions&#160;are&#160;symbolic&#160;notations&#160;used to identify patterns&#160;in&#160;text. In<br/>some&#160;ways,&#160;they&#160;resemble&#160;the&#160;shell’s&#160;wildcard&#160;method&#160;of&#160;matching&#160;file&#160;and&#160;pathnames<br/>but&#160;on&#160;a&#160;much&#160;grander&#160;scale.&#160;Regular&#160;expressions&#160;are&#160;supported&#160;by&#160;many&#160;command&#160;line<br/>tools&#160;and&#160;by&#160;most&#160;programming&#160;languages&#160;to&#160;facilitate&#160;the&#160;solution&#160;of&#160;text&#160;manipulation<br/>problems.&#160;However,&#160;to&#160;further&#160;confuse&#160;things,&#160;not&#160;all&#160;regular&#160;expressions&#160;are&#160;the&#160;same;<br/>they&#160;vary&#160;slightly&#160;from&#160;tool&#160;to&#160;tool&#160;and&#160;from&#160;programming&#160;language&#160;to&#160;language.&#160;For&#160;our<br/>discussion,&#160;we&#160;will&#160;limit&#160;ourselves&#160;to&#160;regular&#160;expressions&#160;as&#160;described&#160;in&#160;the&#160;POSIX&#160;stan-<br/>dard&#160;(which&#160;will&#160;cover&#160;most&#160;of&#160;the&#160;command&#160;line&#160;tools),&#160;as&#160;opposed&#160;to&#160;many&#160;program-<br/>ming languages&#160;(most&#160;notably&#160;<i>Perl</i>), which use&#160;slightly&#160;larger&#160;and richer&#160;sets&#160;of notations.<br/>
<b>grep<br/></b>The&#160;main&#160;program&#160;we&#160;will&#160;use&#160;to&#160;work&#160;with&#160;regular&#160;expressions&#160;is&#160;our&#160;old&#160;pal&#160;grep.&#160;The<br/>name&#160;“grep”&#160;is&#160;actually&#160;derived&#160;from&#160;the&#160;phrase&#160;“global&#160;regular&#160;expression&#160;print,”&#160;so&#160;we<br/>can&#160;see&#160;that&#160;&#160;grep&#160;&#160;has&#160;something&#160;to&#160;do&#160;with&#160;regular&#160;expressions.&#160;In&#160;essence,&#160;&#160;grep<br/>searches&#160;text&#160;files&#160;for&#160;the&#160;occurrence&#160;text&#160;matching&#160;a&#160;specified&#160;regular&#160;expression&#160;and<br/>outputs&#160;any line&#160;containing&#160;a&#160;match to&#160;standard output.&#160;<br/>
251<br/>
<hr/>
<a name=276></a>19 – Regular&#160;Expressions<br/>
So far, we&#160;have&#160;used&#160;grep&#160;with&#160;fixed strings, like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | grep zip</b><br/>
This&#160;will&#160;list&#160;all&#160;the&#160;files&#160;in&#160;the&#160;/usr/bin&#160;directory&#160;whose&#160;names&#160;contain&#160;the&#160;substring<br/>zip.<br/>The&#160;grep&#160;program&#160;accepts&#160;options&#160;and&#160;arguments&#160;this&#160;way,&#160;where&#160;<i>regex</i>&#160;is&#160;a&#160;regular&#160;ex-<br/>pression:<br/>grep [<i>options</i>]&#160;<i>regex</i>&#160;[<i>file...</i>]<br/>Table&#160;19-1 describes&#160;the&#160;commonly&#160;used&#160;grep&#160;options.<br/>
<i>Table&#160;19-1:&#160;grep&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-i<br/>
--ignore-case<br/>
Ignore&#160;case. Do not&#160;distinguish&#160;<br/>between&#160;uppercase&#160;and lowercase&#160;<br/>characters.<br/>
-v<br/>
--invert-match<br/>
Invert&#160;match.&#160;Normally,&#160;grep&#160;<br/>prints&#160;lines&#160;that&#160;contain&#160;a&#160;match.&#160;<br/>This&#160;option&#160;causes&#160;grep&#160;to print&#160;<br/>every line&#160;that&#160;does&#160;not&#160;contain&#160;a&#160;<br/>match.<br/>
-c<br/>
--count<br/>
Print&#160;the&#160;number of matches&#160;(or&#160;<br/>non-matches&#160;if the&#160;-v&#160;option is&#160;<br/>also specified) instead&#160;of the&#160;lines&#160;<br/>themselves.<br/>
-l<br/>
--files-with-matches<br/>
Print&#160;the&#160;name&#160;of each file&#160;that&#160;<br/>contains&#160;a&#160;match instead&#160;of the&#160;<br/>lines&#160;themselves.<br/>
-L<br/>
--files-without-match<br/>
Like&#160;the&#160;-l&#160;option,&#160;but&#160;print&#160;only&#160;<br/>the&#160;names&#160;of files&#160;that&#160;do not&#160;<br/>contain&#160;matches.<br/>
-n<br/>
--line-number<br/>
Prefix each&#160;matching line&#160;with&#160;the&#160;<br/>number of the&#160;line&#160;within&#160;the&#160;file.<br/>
-h<br/>
--no-filename<br/>
For multi-file&#160;searches, suppress&#160;<br/>the&#160;output&#160;of filenames.<br/>
252<br/>
<hr/>
<a name=277></a>grep<br/>
To more&#160;fully&#160;explore&#160;grep, let’s&#160;create&#160;some&#160;text&#160;files&#160;to search.<br/>
[me@linuxbox ~]$&#160;<b>ls /bin &gt; dirlist-bin.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls /usr/bin &gt; dirlist-usr-bin.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls /sbin &gt; dirlist-sbin.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls /usr/sbin &gt; dirlist-usr-sbin.txt<br/></b>[me@linuxbox ~]$&#160;<b>ls dirlist*.txt<br/></b>dirlist-bin.txt &#160; dirlist-sbin.txt &#160; &#160; dirlist-usr-sbin.txt&#160;<br/>dirlist-usr-bin.txt<br/>
We&#160;can perform&#160;a&#160;simple&#160;search of our list&#160;of files&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>grep bzip dirlist*.txt<br/></b>dirlist-bin.txt:bzip2&#160;<br/>dirlist-bin.txt:bzip2recover<br/>
In&#160;this&#160;example,&#160;&#160;grep&#160;&#160;searches&#160;all&#160;the&#160;listed&#160;files&#160;for&#160;the&#160;string&#160;&#160;bzip&#160;&#160;and&#160;finds&#160;two<br/>matches,&#160;both&#160;in&#160;the&#160;file&#160;dirlist-bin.txt.&#160;If&#160;we&#160;were&#160;interested&#160;only&#160;in&#160;the&#160;list&#160;of<br/>files&#160;that&#160;contained&#160;matches&#160;rather&#160;than&#160;the&#160;matches&#160;themselves,&#160;we&#160;could&#160;specify&#160;the&#160;-l<br/>option.<br/>
[me@linuxbox ~]$&#160;<b>grep -l bzip dirlist*.txt<br/></b>dirlist-bin.txt<br/>
Conversely,&#160;if&#160;we&#160;wanted&#160;to&#160;see&#160;only&#160;a&#160;list&#160;of&#160;the&#160;files&#160;that&#160;did&#160;not&#160;contain&#160;a&#160;match,&#160;we<br/>could do this:<br/>
[me@linuxbox ~]$&#160;<b>grep -L bzip dirlist*.txt<br/></b>dirlist-sbin.txt&#160;<br/>dirlist-usr-bin.txt&#160;<br/>dirlist-usr-sbin.txt<br/>
<b>Metacharacters&#160;and&#160;Literals<br/></b>While&#160;it&#160;may&#160;not&#160;seem&#160;apparent,&#160;our&#160;grep&#160;searches&#160;have&#160;been&#160;using&#160;regular&#160;expressions<br/>all&#160;along,&#160;albeit&#160;very&#160;simple&#160;ones.&#160;The&#160;regular&#160;expression&#160;bzip&#160;is&#160;taken&#160;to&#160;mean&#160;that&#160;a<br/>
253<br/>
<hr/>
<a name=278></a>19 – Regular&#160;Expressions<br/>
match&#160;will&#160;occur&#160;only if&#160;the&#160;line&#160;in&#160;the&#160;file&#160;contains&#160;at&#160;least&#160;four characters&#160;and&#160;that&#160;some-<br/>where&#160;in the&#160;line&#160;the&#160;characters&#160;b,&#160;z,&#160;i, and&#160;p&#160;are&#160;found in&#160;that&#160;order, with no other&#160;char-<br/>acters&#160;in&#160;between.&#160;The&#160;characters&#160;in&#160;the&#160;string&#160;bzip&#160;are&#160;all&#160;<i>literal&#160;characters</i>, in&#160;that&#160;they<br/>match&#160;themselves.&#160;In&#160;addition&#160;to&#160;literals,&#160;regular&#160;expressions&#160;may&#160;also&#160;include&#160;<i>metachar-<br/>acters</i>&#160;that&#160;are&#160;used&#160;to&#160;specify&#160;more&#160;complex&#160;matches.&#160;Regular&#160;expression&#160;metacharacters<br/>consist&#160;of the&#160;following:<br/>^ $ . [ ] { } - ? * + ( ) | \<br/>All&#160;other&#160;characters&#160;are&#160;considered&#160;literals,&#160;though&#160;the&#160;backslash&#160;character&#160;is&#160;used&#160;in&#160;a<br/>few&#160;cases&#160;to&#160;create&#160;<i>meta&#160;sequences</i>,&#160;as&#160;well&#160;as&#160;allowing&#160;the&#160;metacharacters&#160;to&#160;be&#160;escaped<br/>and treated as&#160;literals&#160;instead&#160;of being interpreted as&#160;metacharacters.<br/>
<b>Note:</b>&#160;As&#160;we&#160;can&#160;see,&#160;many&#160;of&#160;the&#160;regular&#160;expression&#160;metacharacters&#160;are&#160;also<br/>characters&#160;that&#160;have&#160;meaning to the&#160;shell&#160;when&#160;expansion is&#160;performed.&#160;When we<br/>pass&#160;regular&#160;expressions&#160;containing&#160;metacharacters&#160;on&#160;the&#160;command&#160;line,&#160;it&#160;is&#160;vi-<br/>tal&#160;that&#160;they&#160;be&#160;enclosed&#160;in&#160;quotes&#160;to&#160;prevent&#160;the&#160;shell&#160;from&#160;attempting&#160;to&#160;expand<br/>them.<br/>
<b>The&#160;Any&#160;Character<br/></b>The&#160;first&#160;metacharacter&#160;we&#160;will&#160;look&#160;at&#160;is&#160;the&#160;dot&#160;or&#160;period&#160;character,&#160;which&#160;is&#160;used&#160;to<br/>match&#160;any&#160;character.&#160;If&#160;we&#160;include&#160;it&#160;in&#160;a&#160;regular&#160;expression,&#160;it&#160;will&#160;match&#160;any&#160;character<br/>in that&#160;character&#160;position. Here’s&#160;an&#160;example:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '.zip' dirlist*.txt&#160;<br/></b>bunzip2&#160;<br/>bzip2&#160;<br/>bzip2recover&#160;<br/>gunzip&#160;<br/>gzip&#160;<br/>funzip&#160;<br/>gpg-zip&#160;<br/>preunzip&#160;<br/>prezip&#160;<br/>prezip-bin&#160;<br/>unzip&#160;<br/>unzipsfx<br/>
We&#160;searched&#160;for&#160;any&#160;line&#160;in&#160;our&#160;files&#160;that&#160;matches&#160;the&#160;regular&#160;expression&#160;.zip.&#160;There&#160;are<br/>a&#160;couple&#160;of&#160;interesting&#160;things&#160;to&#160;note&#160;about&#160;the&#160;results.&#160;Notice&#160;that&#160;the&#160;zip&#160;program&#160;was<br/>
254<br/>
<hr/>
<a name=279></a>The&#160;Any Character<br/>
not&#160;found.&#160;This&#160;is&#160;because&#160;the&#160;inclusion of the&#160;dot&#160;metacharacter in our regular expression<br/>increased&#160;the&#160;length&#160;of&#160;the&#160;required&#160;match&#160;to&#160;four&#160;characters,&#160;and&#160;because&#160;the&#160;name&#160;zip<br/>only&#160;contains&#160;three,&#160;it&#160;does&#160;not&#160;match.&#160;Also,&#160;if&#160;any&#160;files&#160;in&#160;our&#160;lists&#160;had&#160;contained&#160;the&#160;file<br/>extension&#160;.zip,&#160;they&#160;would&#160;have&#160;been&#160;matched&#160;as&#160;well,&#160;because&#160;the&#160;period&#160;character&#160;in<br/>the&#160;file&#160;extension would be&#160;matched&#160;by the&#160;“any&#160;character,”&#160;too.<br/>
<b>Anchors<br/></b>The&#160;caret&#160;(^)&#160;and&#160;dollar&#160;sign&#160;($)&#160;characters&#160;are&#160;treated&#160;as&#160;<i>anchors</i>&#160;in&#160;regular&#160;expressions.<br/>This&#160;means&#160;they&#160;cause&#160;the&#160;match&#160;to&#160;occur&#160;only&#160;if&#160;the&#160;regular&#160;expression&#160;is&#160;found&#160;at&#160;the<br/>beginning&#160;of the&#160;line&#160;(^) or at&#160;the&#160;end&#160;of the&#160;line&#160;($).<br/>
[me@linuxbox ~]$&#160;<b>grep -h '^zip' dirlist*.txt<br/></b>zip&#160;<br/>zipcloak&#160;<br/>zipgrep&#160;<br/>zipinfo&#160;<br/>zipnote&#160;<br/>zipsplit<br/>[me@linuxbox ~]$&#160;<b>grep -h 'zip$' dirlist*.txt<br/></b>gunzip&#160;<br/>gzip&#160;<br/>funzip&#160;<br/>gpg-zip&#160;<br/>preunzip&#160;<br/>prezip&#160;<br/>unzip&#160;<br/>zip<br/>[me@linuxbox ~]$&#160;<b>grep -h '^zip$' dirlist*.txt<br/></b>zip<br/>
Here&#160;we&#160;searched&#160;the&#160;list&#160;of&#160;files&#160;for&#160;the&#160;string&#160;zip&#160;located&#160;at&#160;the&#160;beginning&#160;of&#160;the&#160;line,<br/>the&#160;end&#160;of&#160;the&#160;line,&#160;and&#160;on&#160;a&#160;line&#160;where&#160;it&#160;is&#160;at&#160;both&#160;the&#160;beginning&#160;and&#160;the&#160;end&#160;of&#160;the&#160;line<br/>(i.e.,&#160;by&#160;itself&#160;on&#160;the&#160;line).&#160;Note&#160;that&#160;the&#160;regular&#160;expression&#160;^$&#160;(a&#160;beginning&#160;and&#160;an&#160;end<br/>with nothing&#160;in between)&#160;will&#160;match&#160;blank lines.<br/>
255<br/>
<hr/>
<a name=280></a>19 – Regular&#160;Expressions<br/>
<b>A&#160;Crossword&#160;Puzzle&#160;Helper</b><br/>
Even&#160;with&#160;our&#160;limited&#160;knowledge&#160;of&#160;regular&#160;expressions&#160;at&#160;this&#160;point,&#160;we&#160;can&#160;do<br/>something&#160;useful.<br/>My&#160;wife&#160;loves&#160;crossword&#160;puzzles&#160;and&#160;she&#160;will&#160;sometimes&#160;ask&#160;me&#160;for&#160;help&#160;with&#160;a<br/>particular&#160;question.&#160;Something&#160;like,&#160;“What’s&#160;a&#160;five-letter&#160;word&#160;whose&#160;third&#160;letter<br/>is&#160;‘j’&#160;and last&#160;letter&#160;is&#160;‘r’&#160;that&#160;means...?”&#160;This&#160;kind of question got&#160;me&#160;thinking.<br/>Did&#160;you&#160;know&#160;that&#160;your&#160;Linux&#160;system&#160;contains&#160;a&#160;dictionary?&#160;It&#160;does.&#160;Take&#160;a&#160;look<br/>in&#160;the&#160;&#160;/usr/share/dict&#160;&#160;directory&#160;and&#160;you&#160;might&#160;find&#160;one&#160;or&#160;several.&#160;The<br/>dictionary&#160;files&#160;located&#160;there&#160;are&#160;just&#160;long&#160;lists&#160;of&#160;words,&#160;one&#160;per&#160;line,&#160;arranged&#160;in<br/>alphabetical&#160;&#160;&#160;order.&#160;&#160;&#160;On&#160;&#160;&#160;my&#160;&#160;&#160;system,&#160;&#160;&#160;the&#160;&#160;words&#160;&#160;file&#160;&#160;contains&#160;&#160;just&#160;&#160;over&#160;&#160;&#160;98,500<br/>words.&#160;To&#160;&#160;find&#160;&#160;possible&#160;&#160;answers&#160;to&#160;&#160;the&#160;&#160;crossword&#160;puzzle&#160;&#160;question&#160;&#160;above,&#160;&#160;we<br/>could do this:<br/>[me@linuxbox ~]$&#160;<b>grep -i '^..j.r$' /usr/share/dict/words<br/></b>Major&#160;<br/>
major<br/>
Using&#160;this&#160;regular&#160;expression,&#160;we&#160;can&#160;find&#160;all&#160;the&#160;words&#160;in&#160;our&#160;dictionary&#160;file&#160;that<br/>are&#160;five&#160;letters&#160;long and&#160;have&#160;a&#160;j&#160;in&#160;the&#160;third&#160;position&#160;and an&#160;r&#160;in&#160;the&#160;last&#160;position.<br/>
<b>Bracket&#160;Expressions&#160;and&#160;Character&#160;Classes<br/></b>In&#160;addition&#160;to&#160;matching&#160;any&#160;character&#160;at&#160;a&#160;given&#160;position&#160;in&#160;our&#160;regular&#160;expression,&#160;we<br/>can&#160;also&#160;match&#160;a&#160;single&#160;character&#160;from&#160;a&#160;specified&#160;set&#160;of&#160;characters&#160;by&#160;using&#160;<i>bracket&#160;ex-<br/>pressions</i>.&#160;With&#160;bracket&#160;expressions,&#160;we&#160;can&#160;specify&#160;a&#160;set&#160;of&#160;characters&#160;(including&#160;charac-<br/>ters&#160;that&#160;would&#160;otherwise&#160;be&#160;interpreted&#160;as&#160;metacharacters)&#160;to&#160;be&#160;matched.&#160;In&#160;this&#160;exam-<br/>ple, using a&#160;two-character set, we&#160;match&#160;any line&#160;that&#160;contains&#160;the&#160;string&#160;bzip&#160;or&#160;gzip:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '[bg]zip' dirlist*.txt<br/></b>bzip2&#160;<br/>bzip2recover&#160;<br/>gzip&#160;<br/>
A&#160;set&#160;may&#160;contain&#160;any&#160;number&#160;of&#160;characters,&#160;and&#160;metacharacters&#160;lose&#160;their&#160;special&#160;mean-<br/>ing&#160;when&#160;placed&#160;within&#160;brackets.&#160;However,&#160;there&#160;are&#160;two&#160;cases&#160;in&#160;which&#160;metacharacters<br/>are&#160;used&#160;within&#160;bracket&#160;expressions&#160;and&#160;have&#160;different&#160;meanings.&#160;The&#160;first&#160;is&#160;the&#160;caret<br/>(^),&#160;which&#160;is&#160;used&#160;to&#160;indicate&#160;negation;&#160;the&#160;second&#160;is&#160;the&#160;dash&#160;(-),&#160;which&#160;is&#160;used&#160;to&#160;indi-<br/>cate&#160;a&#160;character&#160;range.<br/>
256<br/>
<hr/>
<a name=281></a>Bracket&#160;Expressions&#160;and Character Classes<br/>
Negation<br/>If&#160;the&#160;first&#160;character&#160;in&#160;a&#160;bracket&#160;expression&#160;is&#160;a&#160;caret&#160;(^),&#160;the&#160;remaining&#160;characters&#160;are<br/>taken&#160;to&#160;be&#160;a&#160;set&#160;of&#160;characters&#160;that&#160;must&#160;not&#160;be&#160;present&#160;at&#160;the&#160;given&#160;character&#160;position.&#160;We<br/>do this&#160;by modifying our previous&#160;example,&#160;as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '[^bg]zip' dirlist*.txt<br/></b>bunzip2&#160;<br/>gunzip&#160;<br/>funzip&#160;<br/>gpg-zip&#160;<br/>preunzip&#160;<br/>prezip&#160;<br/>prezip-bin&#160;<br/>unzip&#160;<br/>unzipsfx<br/>
With&#160;negation&#160;activated,&#160;we&#160;get&#160;a&#160;list&#160;of&#160;files&#160;that&#160;contain&#160;the&#160;string&#160;zip&#160;preceded&#160;by&#160;any<br/>character&#160;except&#160;b&#160;or&#160;g.&#160;Notice&#160;that&#160;the&#160;file&#160;zip&#160;was&#160;not&#160;found.&#160;A&#160;negated&#160;character&#160;set<br/>still&#160;requires&#160;a&#160;character&#160;at&#160;the&#160;given&#160;position,&#160;but&#160;the&#160;character&#160;must&#160;not&#160;be&#160;a&#160;member&#160;of<br/>the&#160;negated set.<br/>The&#160;caret&#160;character&#160;only&#160;invokes&#160;negation&#160;if&#160;it&#160;is&#160;the&#160;first&#160;character&#160;within&#160;a&#160;bracket&#160;ex-<br/>pression;&#160;otherwise,&#160;it&#160;loses&#160;its&#160;special&#160;meaning&#160;and&#160;becomes&#160;an&#160;ordinary&#160;character&#160;in&#160;the<br/>set.<br/>
Traditional&#160;Character&#160;Ranges<br/>If&#160;we&#160;wanted&#160;to&#160;construct&#160;a&#160;regular&#160;expression&#160;that&#160;would&#160;find&#160;every&#160;file&#160;in&#160;our&#160;lists&#160;be-<br/>ginning with&#160;an uppercase&#160;letter, we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '^[ABCDEFGHIJKLMNOPQRSTUVWXZY]' dirlist*.txt</b><br/>
It’s&#160;just&#160;a&#160;matter&#160;of&#160;putting&#160;all&#160;26 uppercase&#160;letters&#160;in&#160;a&#160;bracket&#160;expression.&#160;But&#160;the&#160;idea&#160;of<br/>all&#160;that&#160;typing is&#160;deeply troubling, so there&#160;is&#160;another way.<br/>
[me@linuxbox ~]$&#160;<b>grep -h '^[A-Z]' dirlist*.txt</b>&#160;<br/>MAKEDEV&#160;<br/>ControlPanel&#160;<br/>GET&#160;<br/>
257<br/>
<hr/>
<a name=282></a>19 – Regular&#160;Expressions<br/>
HEAD&#160;<br/>POST&#160;<br/>X&#160;<br/>X11&#160;<br/>Xorg&#160;<br/>MAKEFLOPPIES&#160;<br/>NetworkManager&#160;<br/>NetworkManagerDispatcher<br/>
By&#160;using&#160;a&#160;three-character&#160;range,&#160;we&#160;can&#160;abbreviate&#160;the&#160;26&#160;letters.&#160;Any&#160;range&#160;of&#160;charac-<br/>ters&#160;can&#160;be&#160;expressed&#160;this&#160;way&#160;including&#160;multiple&#160;ranges,&#160;such&#160;as&#160;this&#160;expression&#160;that<br/>matches&#160;all&#160;filenames&#160;starting with letters&#160;and numbers:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '^[A-Za-z0-9]' dirlist*.txt</b><br/>
In&#160;character&#160;ranges, we&#160;see&#160;that&#160;the&#160;dash character&#160;is&#160;treated&#160;specially,&#160;so how&#160;do&#160;we&#160;actu-<br/>ally&#160;include&#160;a&#160;dash&#160;character&#160;in&#160;a&#160;bracket&#160;expression?&#160;By&#160;making&#160;it&#160;the&#160;first&#160;character&#160;in<br/>the&#160;expression.&#160;Consider&#160;these&#160;two examples:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '[A-Z]' dirlist*.txt</b><br/>
This&#160;will&#160;match&#160;every&#160;filename&#160;containing&#160;an&#160;uppercase&#160;letter.&#160;The&#160;following&#160;will&#160;match<br/>every filename&#160;containing&#160;a&#160;dash, or an uppercase&#160;A&#160;or an uppercase&#160;Z:<br/>
[me@linuxbox ~]$&#160;<b>grep -h '[-AZ]' dirlist*.txt</b><br/>
POSIX&#160;Character&#160;Classes<br/>The&#160;traditional&#160;character&#160;ranges&#160;are&#160;an&#160;easily&#160;understood&#160;and&#160;effective&#160;way&#160;to&#160;handle&#160;the<br/>problem&#160;of&#160;quickly&#160;specifying&#160;sets&#160;of&#160;characters.&#160;Unfortunately,&#160;they&#160;don’t&#160;always&#160;work.<br/>While&#160;we&#160;have&#160;not&#160;encountered&#160;any&#160;problems&#160;with&#160;our&#160;use&#160;of&#160;grep&#160;so&#160;far,&#160;we&#160;might&#160;run<br/>into problems&#160;using other&#160;programs.<br/>In&#160;Chapter&#160;4,&#160;we&#160;looked&#160;at&#160;how&#160;wildcards&#160;are&#160;used&#160;to&#160;perform&#160;pathname&#160;expansion.&#160;In<br/>that&#160;discussion,&#160;we&#160;said&#160;that&#160;character&#160;ranges&#160;could&#160;be&#160;used&#160;in&#160;a&#160;manner&#160;almost&#160;identical<br/>to the&#160;way they are&#160;used&#160;in regular&#160;expressions, but&#160;here’s&#160;the&#160;problem:<br/>
258<br/>
<hr/>
<a name=283></a>Bracket&#160;Expressions&#160;and Character Classes<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/sbin/[ABCDEFGHIJKLMNOPQRSTUVWXYZ]*<br/></b>/usr/sbin/MAKEFLOPPIES<br/>/usr/sbin/NetworkManagerDispatcher&#160;<br/>/usr/sbin/NetworkManager&#160;<br/>
(Depending&#160;on&#160;the&#160;Linux&#160;distribution,&#160;we&#160;will&#160;get&#160;a&#160;different&#160;list&#160;of&#160;files,&#160;possibly&#160;an<br/>empty&#160;list.&#160;This&#160;example&#160;is&#160;from&#160;Ubuntu).&#160;This&#160;command&#160;produces&#160;the&#160;expected&#160;result — <br/>a&#160;list&#160;of only the&#160;files&#160;whose&#160;names&#160;begin&#160;with an uppercase&#160;letter,&#160;but&#160;with this&#160;command<br/>we&#160;get&#160;an&#160;entirely different&#160;result&#160;(only a&#160;partial&#160;listing&#160;of the&#160;results&#160;is&#160;shown):<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/sbin/[A-Z]*<br/></b>/usr/sbin/biosdecode&#160;<br/>/usr/sbin/chat&#160;<br/>/usr/sbin/chgpasswd&#160;<br/>/usr/sbin/chpasswd&#160;<br/>/usr/sbin/chroot&#160;<br/>/usr/sbin/cleanup-info&#160;<br/>/usr/sbin/complain&#160;<br/>/usr/sbin/console-kit-daemon&#160;<br/>
Why is&#160;that?&#160;It’s&#160;a&#160;long story, but&#160;here’s&#160;the&#160;short&#160;version:<br/>Back&#160;when&#160;Unix&#160;was&#160;first&#160;developed,&#160;it&#160;knew&#160;only&#160;about&#160;ASCII&#160;characters,&#160;and&#160;this&#160;fea-<br/>ture&#160;reflects&#160;that&#160;fact.&#160;In&#160;ASCII,&#160;the&#160;first&#160;32&#160;characters&#160;(numbers&#160;0-31)&#160;are&#160;control&#160;codes<br/>(things&#160;such&#160;as&#160;tabs,&#160;backspaces,&#160;and&#160;carriage&#160;returns).&#160;The&#160;next&#160;32&#160;(32-63)&#160;contain&#160;print-<br/>able&#160;characters,&#160;including&#160;most&#160;punctuation&#160;characters&#160;and&#160;the&#160;numerals&#160;0-9.&#160;The&#160;next&#160;32<br/>(numbers&#160;64-95)&#160;contain&#160;the&#160;uppercase&#160;letters&#160;and&#160;a&#160;few&#160;more&#160;punctuation&#160;symbols.&#160;The<br/>final&#160;31&#160;(numbers&#160;96-126)&#160;contain&#160;the&#160;lowercase&#160;letters&#160;and&#160;yet&#160;more&#160;punctuation&#160;sym-<br/>bols.&#160;Based&#160;on&#160;this&#160;arrangement,&#160;systems&#160;using&#160;ASCII&#160;used&#160;a&#160;<i>collation&#160;order</i>&#160;that&#160;looks<br/>like&#160;this:<br/>ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz<br/>This&#160;differs&#160;from&#160;proper dictionary order,&#160;which&#160;is&#160;like&#160;this:<br/>aAbBcCdDeEfFgGhHiIjJkKlLmMnNoOpPqQrRsStTuUvVwWxXyYzZ<br/>As&#160;the&#160;popularity&#160;of&#160;Unix&#160;spread&#160;beyond&#160;the&#160;United&#160;States,&#160;there&#160;grew&#160;a&#160;need&#160;to&#160;support<br/>characters&#160;not&#160;found&#160;in&#160;U.S.&#160;English.&#160;The&#160;ASCII&#160;table&#160;was&#160;expanded&#160;to&#160;use&#160;a&#160;full&#160;eight<br/>bits,&#160;adding&#160;characters&#160;128-255,&#160;which&#160;accommodated&#160;many&#160;more&#160;languages.&#160;To&#160;support<br/>this&#160;ability,&#160;the&#160;POSIX&#160;standards&#160;introduced&#160;a&#160;concept&#160;called&#160;a&#160;<i>locale</i>,&#160;which&#160;could&#160;be&#160;ad-<br/>justed&#160;to&#160;select&#160;the&#160;character&#160;set&#160;needed&#160;for&#160;a&#160;particular&#160;location.&#160;We&#160;can&#160;see&#160;the&#160;language<br/>setting&#160;of our system&#160;using this&#160;command:<br/>
259<br/>
<hr/>
<a name=284></a>19 – Regular&#160;Expressions<br/>
[me@linuxbox ~]$&#160;<b>echo $LANG<br/></b>en_US.UTF-8<br/>
With&#160;this&#160;setting,&#160;POSIX-compliant&#160;applications&#160;will&#160;use&#160;a&#160;&#160;dictionary&#160;&#160;collation&#160;order<br/>rather&#160;than&#160;ASCII&#160;order.&#160;This&#160;explains&#160;the&#160;behavior&#160;of&#160;the&#160;previous&#160;commands.&#160;A&#160;charac-<br/>ter&#160;range&#160;of&#160;&#160;[A-Z]&#160;&#160;when&#160;interpreted&#160;in&#160;dictionary&#160;order&#160;includes&#160;all&#160;of&#160;the&#160;alphabetic<br/>characters&#160;except&#160;the&#160;lowercase&#160;a, hence&#160;our results.<br/>To&#160;partially&#160;work&#160;around&#160;this&#160;problem,&#160;the&#160;POSIX&#160;standard&#160;includes&#160;a&#160;number&#160;of&#160;charac-<br/>ter classes&#160;that&#160;provide&#160;useful&#160;ranges&#160;of characters&#160;as&#160;described in&#160;Table&#160;19-2.<br/>Table&#160;19-2:&#160;POSIX&#160;Character Classes<br/>
<b>Character&#160;Class</b><br/>
<b>Description</b><br/>
[:alnum:]<br/>
The&#160;alphanumeric&#160;characters.&#160;In&#160;ASCII, equivalent&#160;to:<br/>[A-Za-z0-9]<br/>
[:word:]<br/>
The&#160;same&#160;as&#160;[:alnum:], with&#160;the&#160;addition&#160;of the&#160;underscore&#160;<br/>(_) character.<br/>
[:alpha:]<br/>
The&#160;alphabetic&#160;characters.&#160;In&#160;ASCII, equivalent&#160;to:<br/>[A-Za-z]<br/>
[:blank:]<br/>
Includes&#160;the&#160;space&#160;and&#160;tab characters.<br/>
[:cntrl:]<br/>
The&#160;ASCII control&#160;codes. Includes&#160;the&#160;ASCII characters&#160;0&#160;<br/>through 31 and 127.<br/>
[:digit:]<br/>
The&#160;numerals&#160;0 through&#160;9.<br/>
[:graph:]<br/>
The&#160;visible&#160;characters.&#160;In&#160;ASCII, it&#160;includes&#160;characters&#160;33&#160;<br/>through 126.<br/>
[:lower:]<br/>
The&#160;lowercase&#160;letters.<br/>
[:punct:]<br/>
The&#160;punctuation&#160;characters. In&#160;ASCII, equivalent&#160;to:<br/>[-!&#34;#$%&amp;'()*+,./:;&lt;=&gt;?@[\\\]_`{|}~]<br/>
[:print:]<br/>
The&#160;printable&#160;characters.&#160;All&#160;the&#160;characters&#160;in&#160;[:graph:]&#160;<br/>plus&#160;the&#160;space&#160;character.<br/>
[:space:]<br/>
The&#160;whitespace&#160;characters&#160;including&#160;space, tab,&#160;carriage&#160;<br/>return, newline, vertical&#160;tab, and&#160;form&#160;feed.&#160;In&#160;ASCII,&#160;<br/>equivalent&#160;to:<br/>[ \t\r\n\v\f]<br/>
[:upper:]<br/>
The&#160;uppercase&#160;characters.<br/>
260<br/>
<hr/>
<a name=285></a>Bracket&#160;Expressions&#160;and Character Classes<br/>
[:xdigit:]<br/>
Characters&#160;used&#160;to express&#160;hexadecimal&#160;numbers. In&#160;ASCII,&#160;<br/>equivalent&#160;to:<br/>[0-9A-Fa-f]<br/>
Even&#160;with&#160;the&#160;character&#160;classes,&#160;there&#160;is&#160;still&#160;no&#160;convenient&#160;way&#160;to&#160;express&#160;partial&#160;ranges,<br/>such&#160;as&#160;[A-M].<br/>Using character classes, we&#160;can&#160;repeat&#160;our directory&#160;listing&#160;and see&#160;an improved result.<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/sbin/[[:upper:]]*<br/></b>/usr/sbin/MAKEFLOPPIES<br/>/usr/sbin/NetworkManagerDispatcher&#160;<br/>/usr/sbin/NetworkManager<br/>
Remember,&#160;however,&#160;that&#160;this&#160;is&#160;not&#160;an&#160;example&#160;of&#160;a&#160;regular&#160;expression;&#160;rather,&#160;it&#160;is&#160;the<br/>shell&#160;performing&#160;pathname&#160;expansion.&#160;We&#160;show&#160;it&#160;here&#160;because&#160;POSIX&#160;character&#160;classes<br/>can be&#160;used for both.<br/>
<b>Reverting&#160;to&#160;Traditional&#160;Collation&#160;Order</b><br/>
You&#160;can&#160;opt&#160;to&#160;have&#160;your&#160;system&#160;use&#160;the&#160;&#160;traditional&#160;&#160;(ASCII)&#160;&#160;collation&#160;order&#160;&#160;by<br/>changing&#160;the&#160;value&#160;of&#160;the&#160;&#160;LANG&#160;&#160;environment&#160;variable.&#160;As&#160;we&#160;saw&#160;earlier,&#160;the<br/>LANG&#160;variable&#160;contains&#160;the&#160;name&#160;of&#160;the&#160;language&#160;and&#160;character&#160;set&#160;used&#160;in&#160;your<br/>locale.&#160;This&#160;value&#160;was&#160;originally&#160;determined&#160;when&#160;you&#160;selected&#160;an&#160;installation<br/>language&#160;as&#160;your Linux version&#160;was&#160;installed.<br/>To see&#160;the&#160;locale&#160;settings, use&#160;the&#160;locale&#160;command.<br/>[me@linuxbox ~]$&#160;<b>locale<br/></b>LANG=en_US.UTF-8&#160;<br/>LC_CTYPE=&#34;en_US.UTF-8&#34;&#160;<br/>LC_NUMERIC=&#34;en_US.UTF-8&#34;&#160;<br/>LC_TIME=&#34;en_US.UTF-8&#34;&#160;<br/>LC_COLLATE=&#34;en_US.UTF-8&#34;&#160;<br/>LC_MONETARY=&#34;en_US.UTF-8&#34;&#160;<br/>LC_MESSAGES=&#34;en_US.UTF-8&#34;&#160;<br/>LC_PAPER=&#34;en_US.UTF-8&#34;&#160;<br/>LC_NAME=&#34;en_US.UTF-8&#34;&#160;<br/>LC_ADDRESS=&#34;en_US.UTF-8&#34;&#160;<br/>
261<br/>
<hr/>
<a name=286></a>19 – Regular&#160;Expressions<br/>
LC_TELEPHONE=&#34;en_US.UTF-8&#34;&#160;<br/>LC_MEASUREMENT=&#34;en_US.UTF-8&#34;&#160;<br/>LC_IDENTIFICATION=&#34;en_US.UTF-8&#34;&#160;<br/>LC_ALL=<br/>To change&#160;the&#160;locale&#160;to&#160;use&#160;the&#160;traditional&#160;Unix behaviors, set&#160;the&#160;LANG&#160;variable&#160;<br/>to&#160;POSIX.<br/>[me@linuxbox ~]$&#160;<b>export LANG=POSIX<br/></b>Note&#160;that&#160;this&#160;change&#160;converts&#160;the&#160;system&#160;to&#160;use&#160;U.S.&#160;English&#160;(more&#160;specifically,<br/>ASCII) for its&#160;character set, so be&#160;sure&#160;if&#160;this&#160;is&#160;really what&#160;you want.<br/>You can&#160;make&#160;this&#160;change&#160;permanent&#160;by adding&#160;this&#160;line&#160;to your&#160;.bashrc&#160;file.<br/>export LANG=POSIX&#160;<br/>
<b>POSIX&#160;Basic&#160;vs.&#160;Extended&#160;Regular&#160;Expressions<br/></b>Just&#160;when&#160;we&#160;thought&#160;this&#160;couldn’t&#160;get&#160;any&#160;more&#160;confusing,&#160;we&#160;discover&#160;that&#160;POSIX&#160;also<br/>splits&#160;&#160;&#160;regular&#160;&#160;&#160;expression&#160;&#160;&#160;implementations&#160;&#160;&#160;into&#160;&#160;&#160;two&#160;&#160;&#160;kinds:&#160;&#160;<i>basic&#160;&#160;regular&#160;&#160;&#160;expressions<br/>(BRE)</i>&#160;and&#160;<i>extended&#160;regular&#160;expressions&#160;(ERE)</i>.&#160;The&#160;features&#160;we&#160;have&#160;covered&#160;so&#160;far&#160;are<br/>supported&#160;by&#160;any&#160;application&#160;that&#160;is&#160;POSIX&#160;compliant&#160;and&#160;implements&#160;BRE.&#160;Our&#160;grep<br/>program&#160;is&#160;one&#160;such&#160;program.<br/>What’s&#160;the&#160;difference&#160;between&#160;BRE&#160;and&#160;ERE?&#160;It’s&#160;a&#160;matter&#160;of&#160;metacharacters.&#160;With&#160;BRE,<br/>the&#160;following metacharacters&#160;are&#160;recognized:<br/>^ $ . [ ] *<br/>All&#160;other&#160;characters&#160;are&#160;considered&#160;literals.&#160;With&#160;ERE,&#160;the&#160;following&#160;metacharacters&#160;(and<br/>their&#160;associated&#160;functions) are&#160;added:<br/>( ) { } ? + |<br/>However&#160;(and&#160;this&#160;is&#160;the&#160;fun&#160;part),&#160;the&#160;(,&#160;),&#160;{,&#160;and&#160;}&#160;characters&#160;are&#160;treated&#160;as&#160;metachar-<br/>acters&#160;in&#160;BRE&#160;&#160;<i>if</i>&#160;&#160;they&#160;are&#160;escaped&#160;with&#160;a&#160;backslash,&#160;whereas&#160;with&#160;ERE,&#160;preceding&#160;any<br/>metacharacter&#160;with&#160;a&#160;backslash&#160;causes&#160;it&#160;to&#160;be&#160;treated&#160;as&#160;a&#160;literal.&#160;Any&#160;weirdness&#160;that<br/>comes&#160;along&#160;will&#160;be&#160;covered&#160;in the&#160;discussions&#160;that&#160;follow.<br/>Since&#160;the&#160;features&#160;we&#160;are&#160;going&#160;to&#160;discuss&#160;next&#160;are&#160;part&#160;of&#160;ERE,&#160;we&#160;are&#160;going&#160;to&#160;need&#160;to<br/>use&#160;a&#160;different&#160;grep.&#160;Traditionally,&#160;this&#160;has&#160;been&#160;performed&#160;by&#160;the&#160;egrep&#160;program,&#160;but<br/>the&#160;GNU&#160;version&#160;of&#160;grep&#160;also&#160;supports&#160;extended&#160;regular&#160;expressions&#160;when&#160;the&#160;-E&#160;op-<br/>tion is&#160;used.<br/>
262<br/>
<hr/>
<a name=287></a>POSIX&#160;Basic&#160;vs. Extended Regular Expressions<br/>
<b>POSIX</b><br/>
During&#160;the&#160;1980’s,&#160;Unix became&#160;a&#160;very&#160;popular&#160;commercial&#160;operating&#160;system,&#160;but<br/>by&#160;1988,&#160;the&#160;Unix&#160;world&#160;was&#160;in&#160;turmoil.&#160;Many&#160;computer&#160;manufacturers&#160;had&#160;li-<br/>censed&#160;the&#160;Unix&#160;source&#160;code&#160;from&#160;its&#160;creators,&#160;AT&amp;T,&#160;and&#160;were&#160;supplying&#160;various<br/>versions&#160;of&#160;the&#160;operating&#160;system&#160;with&#160;their&#160;systems.&#160;However,&#160;in&#160;their&#160;efforts&#160;to<br/>create&#160;product&#160;differentiation,&#160;each&#160;manufacturer&#160;added&#160;proprietary&#160;changes&#160;and<br/>extensions.&#160;This&#160;started&#160;to&#160;limit&#160;the&#160;compatibility&#160;of&#160;the&#160;software.&#160;As&#160;always&#160;with<br/>proprietary&#160;vendors,&#160;each&#160;was&#160;trying&#160;to&#160;play&#160;a&#160;winning&#160;game&#160;of&#160;“lock-in”&#160;with<br/>their&#160;customers.&#160;This&#160;dark&#160;time&#160;in&#160;the&#160;history&#160;of&#160;Unix&#160;is&#160;known&#160;today&#160;as&#160;“<i>the<br/>Balkanization</i>.”<br/>Enter&#160;the&#160;Institute&#160;of&#160;Electrical&#160;and&#160;Electronics&#160;Engineers&#160;(IEEE).&#160;In&#160;the&#160;mid-<br/>1980s,&#160;the&#160;IEEE&#160;began&#160;developing&#160;a&#160;set&#160;of&#160;standards&#160;that&#160;would&#160;define&#160;how&#160;Unix<br/>(and&#160;&#160;&#160;Unix-like)&#160;&#160;&#160;systems&#160;&#160;&#160;would&#160;&#160;&#160;perform.&#160;&#160;These&#160;&#160;&#160;standards,&#160;&#160;&#160;formally&#160;&#160;&#160;known&#160;&#160;&#160;as<br/>IEEE&#160;1003,&#160;define&#160;the&#160;<i>application&#160;programming&#160;interfaces</i>&#160;(APIs),&#160;shell&#160;and&#160;utili-<br/>ties&#160;that&#160;are&#160;to&#160;be&#160;found&#160;on&#160;a&#160;standard&#160;Unix-like&#160;system.&#160;The&#160;name&#160;POSIX,&#160;which<br/>stands&#160;for&#160;<i>Portable&#160;Operating&#160;System&#160;Interface</i>&#160;(with&#160;the&#160;X&#160;added&#160;to&#160;the&#160;end&#160;for<br/>extra&#160;snappiness),&#160;was&#160;suggested&#160;by&#160;Richard&#160;&#160;Stallman&#160;(yes,&#160;&#160;<i>that</i>&#160;&#160;Richard&#160;Stall-<br/>man) and&#160;was&#160;adopted by the&#160;IEEE.<br/>
<b>Alternation<br/></b>The&#160;first&#160;of&#160;the&#160;extended&#160;regular&#160;expression&#160;features&#160;we&#160;will&#160;discuss&#160;is&#160;called&#160;<i>alternation</i>,<br/>which&#160;is&#160;the&#160;facility&#160;that&#160;allows&#160;a&#160;match&#160;to&#160;occur&#160;from&#160;among&#160;a&#160;set&#160;of&#160;expressions.&#160;Just&#160;as<br/>a&#160;bracket&#160;expression&#160;allows&#160;a&#160;single&#160;character&#160;to&#160;match&#160;from&#160;a&#160;set&#160;of&#160;specified&#160;characters,<br/>alternation&#160;allows&#160;matches&#160;from&#160;a&#160;set&#160;of strings&#160;or other&#160;regular expressions.<br/>To&#160;demonstrate,&#160;we’ll&#160;use&#160;&#160;grep&#160;&#160;in&#160;conjunction&#160;with&#160;&#160;echo.&#160;First,&#160;let’s&#160;try&#160;a&#160;plain&#160;old<br/>string match.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;AAA&#34; | grep AAA<br/></b>AAA<br/>[me@linuxbox ~]$&#160;<b>echo &#34;BBB&#34; | grep AAA<br/></b>[me@linuxbox ~]$&#160;<br/>
This&#160;is&#160;a&#160;pretty&#160;straightforward&#160;example,&#160;in&#160;which&#160;we&#160;pipe&#160;the&#160;output&#160;of&#160;echo&#160;into&#160;grep<br/>and&#160;see&#160;the&#160;results.&#160;When&#160;a&#160;match&#160;occurs,&#160;we&#160;see&#160;it&#160;printed&#160;out;&#160;when&#160;no&#160;match&#160;occurs,<br/>we&#160;see&#160;no results.<br/>Now&#160;we’ll&#160;add alternation, signified&#160;by the&#160;vertical-bar&#160;metacharacter.<br/>
263<br/>
<hr/>
<a name=288></a>19 – Regular&#160;Expressions<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;AAA&#34; | grep -E 'AAA|BBB'<br/></b>AAA<br/>[me@linuxbox ~]$&#160;<b>echo &#34;BBB&#34; | grep -E 'AAA|BBB'<br/></b>BBB<br/>[me@linuxbox ~]$&#160;<b>echo &#34;CCC&#34; | grep -E 'AAA|BBB'<br/></b>[me@linuxbox ~]$&#160;<br/>
Here&#160;we&#160;see&#160;the&#160;regular&#160;expression&#160;'AAA|BBB',&#160;which&#160;means&#160;“match&#160;either&#160;the&#160;string<br/>AAA&#160;or&#160;the&#160;string&#160;BBB.”&#160;Notice&#160;that&#160;since&#160;this&#160;is&#160;an&#160;extended&#160;feature,&#160;we&#160;added&#160;the&#160;-E<br/>option&#160;to&#160;grep&#160;(though&#160;we&#160;could&#160;have&#160;just&#160;used&#160;the&#160;egrep&#160;program&#160;instead),&#160;and&#160;we<br/>enclosed&#160;the&#160;regular&#160;expression&#160;in&#160;quotes&#160;to&#160;prevent&#160;the&#160;shell&#160;from&#160;interpreting&#160;the&#160;verti-<br/>cal-bar metacharacter&#160;as&#160;a&#160;pipe&#160;operator.&#160;Alternation is&#160;not&#160;limited&#160;to two choices.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;AAA&#34; | grep -E 'AAA|BBB|CCC'<br/></b>AAA<br/>
To&#160;combine&#160;alternation&#160;with&#160;other&#160;regular&#160;expression&#160;elements,&#160;we&#160;can&#160;use&#160;()&#160;to&#160;separate<br/>the&#160;alternation.<br/>
[me@linuxbox ~]$&#160;<b>grep -Eh '^(bz|gz|zip)' dirlist*.txt</b><br/>
This&#160;expression will&#160;match the&#160;filenames&#160;in our lists&#160;that&#160;start&#160;with&#160;either&#160;bz,&#160;gz, or&#160;zip.<br/>Had&#160;we&#160;left&#160;off&#160;the&#160;parentheses,&#160;the&#160;meaning&#160;of&#160;this&#160;regular&#160;expression&#160;changes&#160;to&#160;match<br/>any filename&#160;that&#160;begins&#160;with&#160;bz&#160;<i>or&#160;contains</i>&#160;gz&#160;<i>or&#160;contains</i>&#160;zip:<br/>
[me@linuxbox ~]$&#160;<b>grep -Eh '^bz|gz|zip' dirlist*.txt</b><br/>
<b>Quantifiers<br/></b>Extended&#160;regular&#160;expressions&#160;support&#160;several&#160;ways&#160;to&#160;specify&#160;the&#160;number&#160;of&#160;times&#160;an&#160;ele-<br/>ment&#160;is&#160;matched, as&#160;described&#160;in the&#160;sections&#160;that&#160;follow.<br/>
?&#160;-&#160;Match&#160;an&#160;Element&#160;Zero&#160;or&#160;One&#160;Time<br/>This&#160;quantifier&#160;means,&#160;in&#160;effect,&#160;“Make&#160;the&#160;preceding&#160;element&#160;optional.”&#160;Let’s&#160;say&#160;we<br/>wanted&#160;to&#160;check&#160;a&#160;phone&#160;number&#160;for&#160;validity&#160;and&#160;we&#160;considered&#160;a&#160;phone&#160;number&#160;to&#160;be<br/>valid&#160;if it&#160;matched either of these&#160;two forms, where&#160;<i>n</i>&#160;is&#160;a&#160;numeral:<br/>
264<br/>
<hr/>
<a name=289></a>Quantifiers<br/>
(<i>nnn</i>)&#160;<i>nnn</i>-<i>nnnn</i><br/>
<i>nnn</i>&#160;<i>nnn</i>-<i>nnnn</i><br/>
We&#160;could construct&#160;a&#160;regular expression like&#160;this:<br/>^\(?[0-9][0-9][0-9]\)? [0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]$<br/>
In&#160;this&#160;expression,&#160;we&#160;follow&#160;the&#160;parentheses&#160;characters&#160;with&#160;question&#160;marks&#160;to&#160;indicate<br/>that&#160;they&#160;are&#160;to&#160;be&#160;matched&#160;zero&#160;or&#160;one&#160;time.&#160;Again,&#160;since&#160;the&#160;parentheses&#160;are&#160;normally<br/>metacharacters&#160;(in&#160;ERE),&#160;we&#160;precede&#160;them&#160;with&#160;backslashes&#160;to&#160;cause&#160;them&#160;to&#160;be&#160;treated<br/>as&#160;literals&#160;instead.<br/>Let’s&#160;try it.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;(555) 123-4567&#34; | grep -E '^\(?[0-9][0-9][0-9]<br/>\)? [0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]$'<br/></b>(555) 123-4567<br/>[me@linuxbox ~]$&#160;<b>echo &#34;555 123-4567&#34; | grep -E '^\(?[0-9][0-9][0-9]\)<br/>? [0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]$'<br/></b>555 123-4567<br/>[me@linuxbox ~]$&#160;<b>echo &#34;AAA 123-4567&#34; | grep -E '^\(?[0-9][0-9][0-9]\)<br/>? [0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]$'<br/></b>[me@linuxbox ~]$&#160;<br/>
Here&#160;we&#160;see&#160;that&#160;the&#160;expression&#160;matches&#160;both&#160;forms&#160;of&#160;the&#160;phone&#160;number&#160;but&#160;does&#160;not<br/>match&#160;one&#160;containing&#160;non-numeric&#160;characters.&#160;This&#160;expression&#160;is&#160;not&#160;perfect&#160;as&#160;it&#160;still&#160;al-<br/>lows&#160;mismatched&#160;parentheses&#160;around&#160;the&#160;area&#160;code,&#160;but&#160;it&#160;will&#160;perform&#160;the&#160;first&#160;stage&#160;of&#160;a<br/>verification.<br/>
*&#160;-&#160;Match&#160;an&#160;Element&#160;Zero&#160;or&#160;More&#160;Times<br/>Like&#160;the&#160;?&#160;metacharacter,&#160;the&#160;*&#160;is&#160;used&#160;to&#160;denote&#160;an&#160;optional&#160;item;&#160;however,&#160;unlike&#160;the&#160;?,<br/>the&#160;item&#160;may&#160;occur&#160;any&#160;number&#160;of&#160;times,&#160;not&#160;just&#160;once.&#160;Let’s&#160;say&#160;we&#160;wanted&#160;to&#160;see<br/>whether&#160;a&#160;string&#160;was&#160;a&#160;sentence;&#160;that&#160;is,&#160;it&#160;starts&#160;with&#160;an&#160;uppercase&#160;letter,&#160;then&#160;contains<br/>any&#160;number&#160;of&#160;uppercase&#160;and&#160;lowercase&#160;letters&#160;and&#160;spaces,&#160;and&#160;ends&#160;with&#160;a&#160;period.&#160;To<br/>match&#160;this&#160;(crude)&#160;definition of a&#160;sentence,&#160;we&#160;could use&#160;a&#160;regular expression like&#160;this:<br/>[[:upper:]][[:upper:][:lower:] ]*\.<br/>
The&#160;expression&#160;consists&#160;of&#160;three&#160;items:&#160;a&#160;bracket&#160;expression&#160;containing&#160;the&#160;[:upper:]<br/>character&#160;class,&#160;a&#160;bracket&#160;expression&#160;containing&#160;both&#160;the&#160;[:upper:]&#160;and&#160;[:lower:]<br/>character&#160;classes&#160;and&#160;a&#160;space,&#160;and&#160;a&#160;period&#160;escaped&#160;with&#160;a&#160;backslash.&#160;The&#160;second&#160;element<br/>is&#160;trailed&#160;with&#160;an&#160;&#160;*&#160;&#160;metacharacter&#160;so&#160;that&#160;after&#160;the&#160;leading&#160;uppercase&#160;letter&#160;in&#160;our&#160;sen-<br/>tence,&#160;any&#160;number&#160;of&#160;uppercase&#160;and&#160;lowercase&#160;letters&#160;and&#160;spaces&#160;may&#160;follow&#160;it&#160;and&#160;still<br/>match.<br/>
265<br/>
<hr/>
<a name=290></a>19 – Regular&#160;Expressions<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;This works.&#34; | grep -E '[[:upper:]][[:upper:][<br/>:lower:] ]*\.'</b>&#160;<br/>This works.<br/>[me@linuxbox ~]$&#160;<b>echo &#34;This Works.&#34; | grep -E '[[:upper:]][[:upper:][<br/>:lower:] ]*\.'&#160;<br/></b>This Works.<br/>[me@linuxbox ~]$&#160;<b>echo &#34;this does not&#34; | grep -E '[[:upper:]][[:upper:<br/>][:lower:] ]*\.'<br/></b>[me@linuxbox ~]$&#160;<br/>
The&#160;expression&#160;matches&#160;the&#160;first&#160;two&#160;tests,&#160;but&#160;not&#160;the&#160;third,&#160;since&#160;it&#160;lacks&#160;the&#160;required<br/>leading&#160;uppercase&#160;character and trailing period.<br/>
+&#160;-&#160;Match&#160;an&#160;Element&#160;One&#160;or&#160;More&#160;Times<br/>The&#160;+&#160;metacharacter&#160;works&#160;much&#160;like&#160;the&#160;*,&#160;except&#160;it&#160;requires&#160;at&#160;least&#160;one&#160;instance&#160;of&#160;the<br/>preceding&#160;element&#160;to&#160;cause&#160;a&#160;match.&#160;Here&#160;is&#160;a&#160;regular&#160;expression&#160;that&#160;will&#160;match&#160;only&#160;the<br/>lines&#160;consisting&#160;of&#160;groups&#160;of&#160;one&#160;or&#160;more&#160;alphabetic&#160;characters&#160;separated&#160;by&#160;single&#160;spa-<br/>ces:<br/>^([[:alpha:]]+ ?)+$<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;This that&#34; | grep -E '^([[:alpha:]]+ ?)+$'<br/></b>This that<br/>[me@linuxbox ~]$&#160;<b>echo &#34;a b c&#34; | grep -E '^([[:alpha:]]+ ?)+$'<br/></b>a b c<br/>[me@linuxbox ~]$&#160;<b>echo &#34;a b 9&#34; | grep -E '^([[:alpha:]]+ ?)+$'<br/></b>[me@linuxbox ~]$&#160;<b>echo &#34;abc &#160;d&#34; | grep -E '^([[:alpha:]]+ ?)+$'<br/></b>[me@linuxbox ~]$&#160;<br/>
We&#160;see&#160;that&#160;this&#160;expression&#160;does&#160;not&#160;match&#160;the&#160;line&#160;a&#160;b&#160;9&#160;because&#160;it&#160;contains&#160;a&#160;non-al-<br/>phabetic&#160;character;&#160;nor&#160;does&#160;it&#160;match&#160;&#160;abc&#160;&#160;d&#160;because&#160;more&#160;than&#160;one&#160;space&#160;character<br/>separates&#160;the&#160;characters&#160;c&#160;and&#160;d.<br/>
{&#160;}&#160;-&#160;Match&#160;an&#160;Element&#160;a&#160;Specific&#160;Number&#160;of&#160;Times<br/>The&#160;{&#160;and&#160;}&#160;metacharacters&#160;are&#160;used&#160;to&#160;express&#160;minimum&#160;and&#160;maximum&#160;numbers&#160;of&#160;re-<br/>quired matches.&#160;They&#160;may be&#160;specified&#160;in four possible&#160;ways&#160;as&#160;outlined in&#160;Table&#160;19-3.<br/>
<i>Table&#160;19-3: Specifying the&#160;Number&#160;of&#160;Matches</i><br/>
<b>Specifier</b><br/>
<b>Meaning</b><br/>
266<br/>
<hr/>
<a name=291></a>Quantifiers<br/>
{<i>n</i>}<br/>
Match&#160;the&#160;preceding element&#160;if&#160;it&#160;occurs&#160;exactly&#160;<i>n</i>&#160;times.<br/>
{<i>n</i>,<i>m</i>}<br/>
Match&#160;the&#160;preceding element&#160;if&#160;it&#160;occurs&#160;at&#160;least&#160;<i>n</i>&#160;times&#160;but&#160;no&#160;<br/>more&#160;than&#160;<i>m</i>&#160;times.<br/>
{<i>n</i>,}<br/>
Match&#160;the&#160;preceding element&#160;if&#160;it&#160;occurs&#160;<i>n</i>&#160;or more&#160;times.<br/>
{,<i>m</i>}<br/>
Match&#160;the&#160;preceding element&#160;if&#160;it&#160;occurs&#160;no more&#160;than&#160;<i>m</i>&#160;times.<br/>
Going&#160;back&#160;to&#160;our&#160;earlier&#160;example&#160;with&#160;the&#160;phone&#160;numbers,&#160;we&#160;can&#160;use&#160;this&#160;method&#160;of<br/>specifying&#160;repetitions&#160;to simplify our original&#160;regular&#160;expression&#160;from&#160;the&#160;following:<br/>^\(?[0-9][0-9][0-9]\)? &#160;[0-9][0-9][0-9]-[0-9][0-9][0-9][0-9]$<br/>
to the&#160;following:<br/>^\(?[0-9]{3}\)? &#160;[0-9]{3}-[0-9]{4}$<br/>
Let’s&#160;try it.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;(555) 123-4567&#34; | grep -E '^\(?[0-9]{3}\)? [0-<br/>9]{3}-[0-9]{4}$'&#160;<br/></b>(555) 123-4567<br/>[me@linuxbox ~]$&#160;<b>echo &#34;555 123-4567&#34; | grep -E '^\(?[0-9]{3}\)? [0-9]<br/>{3}-[0-9]{4}$'&#160;<br/></b>555 123-4567<br/>[me@linuxbox ~]$&#160;<b>echo &#34;5555 123-4567&#34; | grep -E '^\(?[0-9]{3}\)? [0-9<br/>]{3}-[0-9]{4}$'&#160;<br/></b>[me@linuxbox ~]$&#160;<br/>
As&#160;we&#160;can&#160;see,&#160;our&#160;revised&#160;expression&#160;can&#160;successfully&#160;validate&#160;numbers&#160;both&#160;with&#160;and<br/>without&#160;the&#160;parentheses, while&#160;rejecting those&#160;numbers&#160;that&#160;are&#160;not&#160;properly&#160;formatted.<br/>
<b>Putting&#160;Regular&#160;Expressions&#160;to&#160;Work<br/></b>Let’s&#160;look&#160;at&#160;some&#160;of&#160;the&#160;commands&#160;we&#160;already&#160;know&#160;and&#160;see&#160;how&#160;they&#160;can&#160;be&#160;used&#160;with<br/>regular&#160;expressions.<br/>
Validating&#160;a&#160;Phone&#160;List&#160;With&#160;grep<br/>In&#160;our&#160;earlier&#160;example,&#160;we&#160;looked&#160;at&#160;single&#160;phone&#160;numbers&#160;and&#160;checked&#160;them&#160;for&#160;proper<br/>formatting.&#160;A&#160;more&#160;realistic&#160;scenario&#160;would&#160;be&#160;checking&#160;a&#160;list&#160;of&#160;numbers&#160;instead,&#160;so&#160;let’s<br/>make&#160;a&#160;list.&#160;We’ll&#160;do&#160;this&#160;by&#160;reciting&#160;a&#160;magical&#160;incantation&#160;to&#160;the&#160;command&#160;line.&#160;It&#160;will&#160;be<br/>magic&#160;because&#160;we&#160;have&#160;not&#160;covered&#160;most&#160;of&#160;the&#160;commands&#160;involved,&#160;but&#160;worry&#160;not.&#160;We<br/>will&#160;get&#160;there&#160;in future&#160;chapters.&#160;Here&#160;is&#160;the&#160;incantation:<br/>
267<br/>
<hr/>
<a name=292></a>19 – Regular&#160;Expressions<br/>
[me@linuxbox ~]$&#160;<b>for i in {1..10}; do echo &#34;(${RANDOM:0:3}) ${RANDO<br/>M:0:3}-${RANDOM:0:4}&#34; &gt;&gt; phonelist.txt; done</b><br/>
This&#160;command&#160;will&#160;produce&#160;a&#160;file&#160;named&#160;phonelist.txt&#160;containing&#160;ten&#160;phone&#160;num-<br/>bers.&#160;Each&#160;time&#160;the&#160;command&#160;is&#160;repeated,&#160;another&#160;ten&#160;numbers&#160;are&#160;added&#160;to&#160;the&#160;list.&#160;We<br/>can&#160;also&#160;change&#160;the&#160;value&#160;&#160;10&#160;&#160;near&#160;the&#160;beginning&#160;of&#160;the&#160;command&#160;to&#160;produce&#160;more&#160;or<br/>fewer&#160;phone&#160;numbers.&#160;If&#160;we&#160;examine&#160;the&#160;contents&#160;of&#160;the&#160;file,&#160;however,&#160;we&#160;see&#160;we&#160;have&#160;a<br/>problem.<br/>
[me@linuxbox ~]$&#160;<b>cat phonelist.txt<br/></b>(232) 298-2265&#160;<br/>(624) 381-1078&#160;<br/>(540) 126-1980&#160;<br/>(874) 163-2885&#160;<br/>(286) 254-2860&#160;<br/>(292) 108-518&#160;<br/>(129) 44-1379&#160;<br/>(458) 273-1642&#160;<br/>(686) 299-8268&#160;<br/>(198) 307-2440<br/>
Some&#160;of&#160;the&#160;numbers&#160;are&#160;malformed,&#160;which&#160;is&#160;perfect&#160;for&#160;our&#160;purposes,&#160;since&#160;we&#160;will&#160;use<br/>grep&#160;to validate&#160;them.<br/>One&#160;useful&#160;method&#160;of validation&#160;would&#160;be&#160;to scan the&#160;file&#160;for invalid numbers&#160;and&#160;display<br/>the&#160;resulting list.<br/>
[me@linuxbox ~]$&#160;<b>grep -Ev '^\([0-9]{3}\) [0-9]{3}-[0-9]{4}$'</b>&#160;<br/>phonelist.txt<br/>(292) 108-518&#160;<br/>(129) 44-1379<br/>[me@linuxbox ~]$&#160;<br/>
Here&#160;we&#160;use&#160;the&#160;-v&#160;option&#160;to&#160;produce&#160;an&#160;inverse&#160;match&#160;so&#160;that&#160;we&#160;will&#160;output&#160;only&#160;the<br/>lines&#160;in&#160;the&#160;list&#160;that&#160;do&#160;not&#160;match&#160;the&#160;specified&#160;expression.&#160;The&#160;expression&#160;itself&#160;includes<br/>the&#160;anchor&#160;metacharacters&#160;at&#160;each&#160;end to ensure&#160;that&#160;the&#160;number has&#160;no extra&#160;characters&#160;at<br/>either&#160;end.&#160;This&#160;expression&#160;also&#160;requires&#160;that&#160;the&#160;parentheses&#160;be&#160;present&#160;in&#160;a&#160;valid&#160;num-<br/>ber, unlike&#160;our earlier&#160;phone&#160;number example.<br/>
268<br/>
<hr/>
<a name=293></a>Putting&#160;Regular Expressions&#160;to&#160;Work<br/>
Finding&#160;Ugly&#160;Filenames&#160;with&#160;find<br/>The&#160;find&#160;command&#160;supports&#160;a&#160;test&#160;based&#160;on&#160;a&#160;regular&#160;expression.&#160;There&#160;is&#160;an&#160;important<br/>consideration&#160;to&#160;keep&#160;in&#160;mind&#160;when&#160;using&#160;regular&#160;expressions&#160;in&#160;&#160;find&#160;&#160;versus&#160;&#160;grep.<br/>Whereas&#160;grep&#160;will&#160;print&#160;a&#160;line&#160;when&#160;the&#160;line&#160;<i>contains</i>&#160;a&#160;string&#160;that&#160;matches&#160;an&#160;expres-<br/>sion,&#160;find&#160;requires&#160;that&#160;the&#160;pathname&#160;<i>exactly&#160;match</i>&#160;the&#160;regular&#160;expression.&#160;In&#160;the&#160;fol-<br/>lowing&#160;example,&#160;we&#160;will&#160;use&#160;find&#160;with&#160;a&#160;regular&#160;expression&#160;to&#160;find&#160;every&#160;pathname&#160;that<br/>contains&#160;any character that&#160;is&#160;not&#160;a&#160;member of the&#160;following set:<br/>[-_./0-9a-zA-Z]<br/>Such&#160;a&#160;scan&#160;would&#160;reveal&#160;pathnames&#160;that&#160;contain&#160;embedded&#160;spaces&#160;and&#160;other&#160;potentially<br/>offensive&#160;characters.<br/>
[me@linuxbox ~]$&#160;<b>find . -regex '.*[^-_./0-9a-zA-Z].*'</b><br/>
Because&#160;of&#160;the&#160;requirement&#160;for&#160;an&#160;exact&#160;match&#160;of&#160;the&#160;entire&#160;pathname,&#160;we&#160;use&#160;.*&#160;at&#160;both<br/>ends&#160;of&#160;the&#160;expression&#160;to&#160;match&#160;zero&#160;or&#160;more&#160;instances&#160;of&#160;any&#160;character.&#160;In&#160;the&#160;middle&#160;of<br/>the&#160;expression,&#160;we&#160;use&#160;a&#160;negated&#160;bracket&#160;expression&#160;containing&#160;our&#160;set&#160;of&#160;acceptable<br/>pathname&#160;characters.<br/>
Searching&#160;for&#160;Files&#160;with&#160;locate<br/>The&#160;locate&#160;program&#160;supports&#160;both&#160;basic&#160;(the&#160;--regexp&#160;option)&#160;and&#160;extended&#160;(the&#160;--<br/>regex&#160;option)&#160;regular&#160;expressions.&#160;With&#160;it,&#160;we&#160;can&#160;perform&#160;many&#160;of&#160;the&#160;same&#160;operations<br/>that&#160;we&#160;performed earlier&#160;with our&#160;dirlist&#160;files.<br/>
[me@linuxbox ~]$&#160;<b>locate --regex 'bin/(bz|gz|zip)'<br/></b>/bin/bzcat&#160;<br/>/bin/bzcmp&#160;<br/>/bin/bzdiff&#160;<br/>/bin/bzegrep&#160;<br/>/bin/bzexe&#160;<br/>/bin/bzfgrep&#160;<br/>/bin/bzgrep&#160;<br/>/bin/bzip2&#160;<br/>/bin/bzip2recover&#160;<br/>/bin/bzless&#160;<br/>/bin/bzmore&#160;<br/>/bin/gzexe&#160;<br/>/bin/gzip&#160;<br/>/usr/bin/zip&#160;<br/>
269<br/>
<hr/>
<a name=294></a>19 – Regular&#160;Expressions<br/>
/usr/bin/zipcloak&#160;<br/>/usr/bin/zipgrep&#160;<br/>/usr/bin/zipinfo&#160;<br/>/usr/bin/zipnote&#160;<br/>/usr/bin/zipsplit&#160;<br/>
Using&#160;alternation,&#160;we&#160;perform&#160;a&#160;search&#160;for&#160;pathnames&#160;that&#160;contain&#160;either&#160;bin/bz,&#160;bin/<br/>gz, or&#160;/bin/zip.<br/>
Searching&#160;for&#160;Text&#160;with&#160;less&#160;and&#160;vim<br/>less&#160;and&#160;vim&#160;both&#160;share&#160;the&#160;same&#160;method&#160;of&#160;searching&#160;for&#160;text.&#160;Pressing&#160;the&#160;/&#160;key&#160;fol-<br/>lowed&#160;&#160;&#160;by&#160;&#160;&#160;a&#160;&#160;&#160;regular&#160;&#160;&#160;expression&#160;&#160;&#160;will&#160;&#160;&#160;perform&#160;&#160;&#160;a&#160;&#160;&#160;search.&#160;&#160;&#160;If&#160;&#160;&#160;we&#160;&#160;&#160;use&#160;&#160;less&#160;&#160;to&#160;&#160;view&#160;&#160;our<br/>phonelist.txt&#160;file,&#160;like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>less phonelist.txt</b><br/>
then search&#160;for our validation&#160;expression,&#160;like&#160;this:<br/>
(232) 298-2265&#160;<br/>(624) 381-1078&#160;<br/>(540) 126-1980&#160;<br/>(874) 163-2885&#160;<br/>(286) 254-2860&#160;<br/>(292) 108-518&#160;<br/>(129) 44-1379&#160;<br/>(458) 273-1642&#160;<br/>(686) 299-8268&#160;<br/>(198) 307-2440&#160;<br/>~&#160;<br/>~&#160;<br/>~&#160;<br/><b>/^\([0-9]{3}\) [0-9]{3}-[0-9]{4}$</b><br/>
less&#160;will&#160;highlight&#160;the&#160;strings&#160;that&#160;match, leaving&#160;the&#160;invalid ones&#160;easy&#160;to spot.<br/>
(232) 298-2265<br/>(624) 381-1078&#160;<br/>(540) 126-1980&#160;<br/>
270<br/>
<hr/>
<a name=295></a>Putting&#160;Regular Expressions&#160;to&#160;Work<br/>
(874) 163-2885&#160;<br/>(286) 254-2860&#160;<br/>(292) 108-518&#160;<br/>(129) 44-1379&#160;<br/>(458) 273-1642<br/>(686) 299-8268<br/>(198) 307-2440&#160;<br/>~&#160;<br/>~&#160;<br/>~&#160;<br/>(END)<br/>
vim,&#160;on&#160;the&#160;other&#160;hand,&#160;supports&#160;&#160;basic&#160;&#160;regular&#160;expressions,&#160;so&#160;our&#160;search&#160;expression<br/>would&#160;look like&#160;this:<br/>/([0-9]\{3\}) [0-9]\{3\}-[0-9]\{4\}<br/>We&#160;can&#160;see&#160;that&#160;the&#160;expression&#160;is&#160;mostly&#160;the&#160;same;&#160;however,&#160;many&#160;of&#160;the&#160;characters&#160;that<br/>are&#160;considered&#160;metacharacters&#160;in&#160;extended&#160;expressions&#160;are&#160;considered&#160;literals&#160;in&#160;basic&#160;ex-<br/>pressions.&#160;They&#160;are&#160;treated&#160;only&#160;as&#160;metacharacters&#160;when&#160;escaped&#160;with&#160;a&#160;backslash.&#160;De-<br/>pending&#160;on&#160;the&#160;particular&#160;configuration&#160;of&#160;vim&#160;on&#160;our&#160;system,&#160;the&#160;matching&#160;will&#160;be&#160;high-<br/>lighted. If not, try&#160;this&#160;command mode&#160;command&#160;to activate&#160;highlighting:<br/>:hlsearch<br/>
<b>Note:</b>&#160;Depending&#160;on&#160;your&#160;distribution,&#160;vim&#160;may&#160;or&#160;may&#160;not&#160;support&#160;text&#160;search<br/>highlighting.&#160;Ubuntu,&#160;in&#160;particular,&#160;supplies&#160;a&#160;stripped-down&#160;version&#160;of&#160;vim&#160;by<br/>default.&#160;On&#160;such&#160;systems,&#160;you&#160;may&#160;want&#160;to&#160;use&#160;your&#160;package&#160;manager&#160;to&#160;install&#160;a<br/>more&#160;complete&#160;version of&#160;vim.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;saw&#160;a&#160;few&#160;of&#160;the&#160;many&#160;uses&#160;of&#160;regular&#160;expressions.&#160;We&#160;can&#160;find&#160;even<br/>more&#160;if&#160;we&#160;use&#160;regular&#160;expressions&#160;to&#160;search&#160;for&#160;additional&#160;applications&#160;that&#160;use&#160;them.&#160;We<br/>can do that&#160;by searching&#160;the&#160;man pages.<br/>
[me@linuxbox ~]$&#160;<b>cd /usr/share/man/man1<br/></b>[me@linuxbox man1]$&#160;<b>zgrep -El 'regex|regular expression' *.gz</b><br/>
The&#160;zgrep&#160;program&#160;provides&#160;a&#160;front&#160;end&#160;for&#160;grep,&#160;allowing&#160;it&#160;to&#160;read&#160;compressed&#160;files.<br/>In&#160;our&#160;example,&#160;we&#160;search&#160;the&#160;compressed&#160;section&#160;1&#160;man&#160;page&#160;files&#160;in&#160;their&#160;usual&#160;loca-<br/>
271<br/>
<hr/>
<a name=296></a>19 – Regular&#160;Expressions<br/>
tion.&#160;The&#160;result&#160;of this&#160;command&#160;is&#160;a&#160;list&#160;of files&#160;containing&#160;either the&#160;string&#160;regex&#160;or the<br/>string&#160;regular&#160;expression.&#160;As&#160;we&#160;can&#160;see,&#160;regular&#160;expressions&#160;show&#160;up&#160;in&#160;a&#160;lot&#160;of<br/>programs.<br/>There&#160;is&#160;one&#160;feature&#160;found&#160;in&#160;basic&#160;regular&#160;expressions&#160;that&#160;we&#160;did&#160;not&#160;cover.&#160;Called&#160;<i>back<br/>references</i>, this&#160;feature&#160;will&#160;be&#160;discussed in the&#160;next&#160;chapter.<br/>
<b>Further&#160;Reading<br/></b>There&#160;are&#160;many&#160;online&#160;resources&#160;for&#160;learning&#160;regular&#160;expressions,&#160;including&#160;various&#160;tuto-<br/>rials&#160;and&#160;cheat&#160;sheets.<br/>In addition, the&#160;Wikipedia&#160;has&#160;good articles&#160;on the&#160;following&#160;background topics:<br/>
●<br/>
POSIX:<a href="http://en.wikipedia.org/wiki/Posix">&#160;http://en.wikipedia.org/wiki/Posix</a><br/>
●<br/>
ASCII:&#160;<a href="http://en.wikipedia.org/wiki/Ascii">http://en.wikipedia.org/wiki/Ascii</a><br/>
272<br/>
<hr/>
<a name=297></a>20 –&#160;Text&#160;Processing<br/>
<i><b>20&#160;–&#160;Text&#160;Processing</b></i><br/>
All&#160;Unix-like&#160;operating&#160;systems&#160;rely&#160;heavily&#160;on&#160;text&#160;files&#160;for&#160;data&#160;storage.&#160;So&#160;it&#160;makes<br/>sense&#160;that&#160;there&#160;are&#160;many&#160;tools&#160;for&#160;manipulating&#160;text.&#160;In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;pro-<br/>grams&#160;that&#160;are&#160;used&#160;to&#160;“slice&#160;and&#160;dice”&#160;text.&#160;In&#160;the&#160;next&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;more&#160;text<br/>processing,&#160;focusing&#160;on&#160;programs&#160;that&#160;are&#160;used&#160;to&#160;format&#160;text&#160;for&#160;printing&#160;and&#160;other&#160;kinds<br/>of human consumption.<br/>This&#160;chapter will&#160;revisit&#160;some&#160;old friends&#160;and introduce&#160;us&#160;to some&#160;new&#160;ones:<br/>
●<br/>
cat&#160;– Concatenate&#160;files&#160;and&#160;print&#160;on the&#160;standard output<br/>
●<br/>
sort&#160;– Sort&#160;lines&#160;of text&#160;files<br/>
●<br/>
uniq&#160;– Report&#160;or omit&#160;repeated&#160;lines<br/>
●<br/>
cut&#160;– Remove&#160;sections&#160;from&#160;each line&#160;of files<br/>
●<br/>
paste&#160;– Merge&#160;lines&#160;of files<br/>
●<br/>
join&#160;– Join&#160;lines&#160;of two files&#160;on a&#160;common field<br/>
●<br/>
comm&#160;– Compare&#160;two sorted&#160;files&#160;line&#160;by line<br/>
●<br/>
diff&#160;– Compare&#160;files&#160;line&#160;by line<br/>
●<br/>
patch&#160;–&#160;Apply a&#160;diff&#160;file&#160;to an original<br/>
●<br/>
tr&#160;–&#160;Translate&#160;or delete&#160;characters<br/>
●<br/>
sed&#160;– Stream&#160;editor&#160;for filtering and transforming text<br/>
●<br/>
aspell&#160;– Interactive&#160;spell&#160;checker<br/>
<b>Applications&#160;of&#160;Text<br/></b>So&#160;far,&#160;we&#160;have&#160;learned&#160;a&#160;couple&#160;of&#160;text&#160;editors&#160;(nano&#160;and&#160;vim),&#160;looked&#160;at&#160;a&#160;bunch&#160;of<br/>configuration&#160;files,&#160;and&#160;have&#160;witnessed the&#160;output&#160;of dozens&#160;of commands,&#160;all&#160;in&#160;text.&#160;But<br/>what&#160;else&#160;is&#160;text&#160;used for?&#160;For many&#160;things, it&#160;turns&#160;out.<br/>
273<br/>
<hr/>
<a name=298></a>20 –&#160;Text&#160;Processing<br/>
Documents<br/>Many&#160;people&#160;write&#160;documents&#160;using&#160;plain&#160;text&#160;formats.&#160;While&#160;it&#160;is&#160;easy&#160;to&#160;see&#160;how&#160;a<br/>small&#160;text&#160;file&#160;could&#160;be&#160;useful&#160;for&#160;keeping&#160;simple&#160;notes,&#160;it&#160;is&#160;also&#160;possible&#160;to&#160;write&#160;large<br/>documents&#160;in text&#160;format.&#160;One&#160;popular approach is&#160;to write&#160;a&#160;large&#160;document&#160;in a&#160;text&#160;for-<br/>mat&#160;and&#160;then&#160;embed&#160;a&#160;<i>markup&#160;language</i>&#160;to&#160;describe&#160;the&#160;formatting&#160;of&#160;the&#160;finished&#160;docu-<br/>ment.&#160;Many scientific&#160;papers&#160;are&#160;written&#160;using this&#160;method, as&#160;Unix-based text&#160;processing<br/>systems&#160;were&#160;among&#160;the&#160;first&#160;systems&#160;that&#160;supported&#160;the&#160;advanced&#160;typographical&#160;layout<br/>needed&#160;by writers&#160;in technical&#160;disciplines.<br/>
Web&#160;Pages<br/>The&#160;world’s&#160;most&#160;popular&#160;type&#160;of&#160;electronic&#160;document&#160;is&#160;probably&#160;the&#160;&#160;web&#160;page.&#160;Web<br/>pages&#160;are&#160;text&#160;documents&#160;that&#160;use&#160;either<i>&#160;Hypertext&#160;Markup&#160;Language</i>&#160;(<i>HTML</i>)&#160;or<i>&#160;Exten-<br/>sible&#160;Markup&#160;Language</i>&#160;&#160;(<i>XML</i>)&#160;as&#160;markup&#160;languages&#160;to&#160;describe&#160;the&#160;document’s&#160;visual<br/>format.<br/>
Email<br/>Email&#160;is&#160;an&#160;intrinsically&#160;text-based&#160;medium.&#160;Even&#160;non-text&#160;attachments&#160;are&#160;converted<br/>into&#160;a&#160;text&#160;representation&#160;for&#160;transmission.&#160;We&#160;can&#160;see&#160;this&#160;for&#160;ourselves&#160;by&#160;downloading<br/>an&#160;email&#160;message&#160;and&#160;then&#160;viewing&#160;it&#160;in&#160;less.&#160;We&#160;will&#160;see&#160;that&#160;the&#160;message&#160;begins&#160;with<br/>a&#160;<i>header</i>&#160;that&#160;describes&#160;the&#160;source&#160;of&#160;the&#160;message&#160;and&#160;the&#160;processing it&#160;received&#160;during&#160;its<br/>journey,&#160;followed by the&#160;<i>body</i>&#160;of the&#160;message&#160;with&#160;its&#160;content.<br/>
Printer&#160;Output<br/>On&#160;Unix-like&#160;systems,&#160;output&#160;destined&#160;for&#160;a&#160;printer&#160;is&#160;sent&#160;as&#160;plain&#160;text&#160;or,&#160;if&#160;the&#160;page<br/>contains&#160;graphics,&#160;is&#160;converted&#160;into&#160;a&#160;text&#160;format&#160;&#160;<i>page&#160;description&#160;language</i>&#160;&#160;known&#160;as<br/><i>PostScript</i>,&#160;which is&#160;then&#160;sent&#160;to a&#160;program&#160;that&#160;generates&#160;the&#160;graphic&#160;dots&#160;to&#160;be&#160;printed.&#160;<br/>
Program&#160;Source&#160;Code<br/>Many&#160;of&#160;the&#160;command&#160;line&#160;programs&#160;found&#160;on&#160;Unix-like&#160;systems&#160;were&#160;created&#160;to&#160;support<br/>system&#160;administration&#160;and&#160;software&#160;development,&#160;and&#160;text&#160;processing&#160;programs&#160;are&#160;no<br/>exception.&#160;Many&#160;of&#160;them&#160;are&#160;designed&#160;to&#160;solve&#160;software&#160;development&#160;problems.&#160;The&#160;rea-<br/>son&#160;text&#160;processing&#160;is&#160;important&#160;to&#160;software&#160;developers&#160;is&#160;that&#160;all&#160;software&#160;starts&#160;out&#160;as<br/>text.&#160;<i>Source&#160;code</i>,&#160;the&#160;part&#160;of&#160;the&#160;program&#160;the&#160;programmer&#160;actually&#160;writes,&#160;is&#160;always&#160;in<br/>text&#160;format.<br/>
<b>Revisiting&#160;Some&#160;Old&#160;Friends<br/></b>Back&#160;in&#160;Chapter&#160;6,&#160;“Redirection,”&#160;we&#160;learned&#160;about&#160;some&#160;commands&#160;that&#160;are&#160;able&#160;to&#160;ac-<br/>
274<br/>
<hr/>
<a name=299></a>Revisiting Some&#160;Old Friends<br/>
cept&#160;standard&#160;input&#160;in&#160;addition&#160;to&#160;command&#160;line&#160;arguments.&#160;We&#160;touched&#160;on&#160;them&#160;only<br/>briefly&#160;then,&#160;but&#160;now&#160;we&#160;will&#160;take&#160;a&#160;closer&#160;look&#160;at&#160;how&#160;they&#160;can&#160;be&#160;used&#160;to&#160;perform&#160;text<br/>processing.<br/>
cat<br/>The&#160;&#160;cat&#160;program&#160;has&#160;a&#160;number&#160;of&#160;interesting&#160;options.&#160;Many&#160;of&#160;them&#160;are&#160;used&#160;to&#160;help<br/>better&#160;visualize&#160;text&#160;content.&#160;One&#160;example&#160;is&#160;the&#160;-A&#160;option,&#160;which&#160;is&#160;used&#160;to&#160;display&#160;non-<br/>printing&#160;characters&#160;in&#160;the&#160;text.&#160;There&#160;are&#160;times&#160;when&#160;we&#160;want&#160;to&#160;know&#160;whether&#160;&#160;&#160;control<br/>characters&#160;are&#160;embedded&#160;in&#160;our&#160;otherwise&#160;visible&#160;text.&#160;The&#160;most&#160;common&#160;of&#160;these&#160;are&#160;tab<br/>characters&#160;(as&#160;opposed&#160;to&#160;spaces)&#160;and&#160;carriage&#160;returns,&#160;often&#160;present&#160;as&#160;end-of-line&#160;char-<br/>acters&#160;in&#160;MS-DOS-style&#160;text&#160;files.&#160;Another&#160;common&#160;situation&#160;is&#160;a&#160;file&#160;containing&#160;lines&#160;of<br/>text&#160;with trailing&#160;spaces.<br/>Let’s&#160;create&#160;a&#160;test&#160;file&#160;using&#160;cat&#160;as&#160;a&#160;primitive&#160;word&#160;processor.&#160;To&#160;do&#160;this,&#160;we’ll&#160;just&#160;en-<br/>ter&#160;the&#160;command&#160;&#160;cat&#160;(along&#160;with&#160;specifying&#160;a&#160;file&#160;for&#160;redirected&#160;output)&#160;and&#160;type&#160;our<br/>text,&#160;followed&#160;by&#160;Enter&#160;to&#160;properly&#160;end&#160;the&#160;line&#160;and&#160;then&#160;Ctrl-d,&#160;to&#160;indicate&#160;to&#160;cat<br/>that&#160;we&#160;have&#160;reached&#160;end-of-file.&#160;In&#160;this&#160;example,&#160;we&#160;enter&#160;a&#160;leading&#160;tab&#160;character&#160;and<br/>follow&#160;the&#160;line&#160;with some&#160;trailing&#160;spaces:<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; foo.txt</b><br/>
The quick brown fox jumped over the lazy dog.<br/>
[me@linuxbox ~]$&#160;<br/>
Next, we&#160;will&#160;use&#160;cat&#160;with the&#160;-A&#160;option to&#160;display the&#160;text:<br/>
[me@linuxbox ~]$&#160;<b>cat -A foo.txt<br/></b>^IThe quick brown fox jumped over the lazy dog. &#160; $<br/>[me@linuxbox ~]$&#160;<br/>
As&#160;we&#160;can&#160;see&#160;in&#160;the&#160;results,&#160;the&#160;tab&#160;character&#160;in&#160;our&#160;text&#160;is&#160;represented&#160;by&#160;^I.&#160;This&#160;is&#160;a<br/>common&#160;notation&#160;that&#160;means&#160;Ctrl-i&#160;which,&#160;as&#160;it&#160;turns&#160;out,&#160;is&#160;the&#160;same&#160;as&#160;a&#160;tab&#160;charac-<br/>ter.&#160;We&#160;also&#160;see&#160;that&#160;a&#160;$&#160;appears&#160;at&#160;the&#160;true&#160;end&#160;of&#160;the&#160;line,&#160;indicating&#160;that&#160;our&#160;text&#160;con-<br/>tains&#160;trailing&#160;spaces.<br/>
275<br/>
<hr/>
<a name=300></a>20 –&#160;Text&#160;Processing<br/>
<b>MS-DOS&#160;Text&#160;vs.&#160;Unix&#160;Text</b><br/>
One&#160;of&#160;the&#160;reasons&#160;you&#160;may&#160;want&#160;to&#160;use&#160;cat&#160;to&#160;look&#160;for&#160;non-printing&#160;characters<br/>in&#160;text&#160;is&#160;to&#160;spot&#160;hidden&#160;carriage&#160;returns.&#160;Where&#160;do&#160;hidden&#160;carriage&#160;returns&#160;come<br/>from?&#160;DOS&#160;and&#160;Windows!&#160;Unix&#160;and&#160;DOS&#160;don’t&#160;define&#160;the&#160;end&#160;of&#160;a&#160;line&#160;the&#160;same<br/>way in&#160;text&#160;files.&#160;Unix&#160;ends&#160;a&#160;line&#160;with a&#160;linefeed&#160;character&#160;(ASCII 10)&#160;while&#160;MS-<br/>DOS&#160;and&#160;its&#160;derivatives&#160;use&#160;the&#160;sequence&#160;carriage&#160;return&#160;(ASCII&#160;13)&#160;and&#160;linefeed<br/>to terminate&#160;each&#160;line&#160;of text.<br/>There&#160;are&#160;a&#160;several&#160;ways&#160;to&#160;convert&#160;files&#160;from&#160;DOS&#160;to&#160;Unix&#160;format.&#160;On&#160;many<br/>Linux&#160;systems,&#160;there&#160;are&#160;programs&#160;called&#160;dos2unix&#160;and&#160;unix2dos,&#160;which&#160;can<br/>convert&#160;text&#160;files&#160;to&#160;and&#160;from&#160;DOS&#160;format.&#160;However,&#160;if&#160;you&#160;don’t&#160;have&#160;dos2u-<br/>nix&#160;on&#160;your&#160;system,&#160;don’t&#160;worry.&#160;The&#160;process&#160;of&#160;converting&#160;text&#160;from&#160;DOS&#160;to<br/>Unix&#160;format&#160;is&#160;simple;&#160;it&#160;involves&#160;the&#160;removal&#160;of&#160;the&#160;offending&#160;carriage&#160;returns.<br/>That&#160;is&#160;easily&#160;accomplished&#160;by&#160;a&#160;couple&#160;of&#160;the&#160;programs&#160;discussed&#160;later&#160;in&#160;this<br/>chapter.<br/>
cat&#160;also&#160;has&#160;options&#160;that&#160;are&#160;used&#160;to&#160;modify&#160;text.&#160;The&#160;two&#160;most&#160;prominent&#160;are&#160;-n,&#160;which<br/>numbers&#160;lines,&#160;and&#160;&#160;-s,&#160;which&#160;suppresses&#160;the&#160;output&#160;of&#160;&#160;multiple&#160;blank&#160;lines.&#160;We&#160;can<br/>demonstrate&#160;thusly:<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; foo.txt<br/></b>The quick brown fox<br/>
jumped over the lazy dog.<br/>[me@linuxbox ~]$&#160;<b>cat -ns foo.txt</b>&#160;<br/>&#160; &#160; &#160;1<br/>
The quick brown fox&#160;<br/>
&#160; &#160; &#160;2<br/>
&#160;<br/>
&#160; &#160; &#160;3<br/>
jumped over the lazy dog.<br/>
[me@linuxbox ~]$&#160;<br/>
In&#160;this&#160;example,&#160;we&#160;create&#160;a&#160;new&#160;version&#160;of&#160;our&#160;foo.txt&#160;test&#160;file,&#160;which&#160;contains&#160;two<br/>lines&#160;of&#160;text&#160;separated&#160;by&#160;two&#160;blank&#160;lines.&#160;After&#160;processing&#160;by&#160;cat&#160;with&#160;the&#160;-ns&#160;options,<br/>the&#160;extra&#160;blank&#160;line&#160;is&#160;removed&#160;and&#160;the&#160;remaining&#160;lines&#160;are&#160;numbered.&#160;While&#160;this&#160;is&#160;not<br/>much of a&#160;process&#160;to&#160;perform&#160;on text, it&#160;is&#160;a&#160;process.<br/>
276<br/>
<hr/>
<a name=301></a>Revisiting Some&#160;Old Friends<br/>
sort<br/>The&#160;sort&#160;program&#160;sorts&#160;the&#160;contents&#160;of&#160;standard&#160;input,&#160;or&#160;one&#160;or&#160;more&#160;files&#160;specified&#160;on<br/>the&#160;command&#160;line,&#160;and&#160;sends&#160;the&#160;results&#160;to standard&#160;output.&#160;Using&#160;the&#160;same&#160;technique&#160;that<br/>we&#160;used&#160;with&#160;&#160;cat,&#160;we&#160;can&#160;demonstrate&#160;processing&#160;of&#160;standard&#160;input&#160;directly&#160;from&#160;the<br/>keyboard as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>sort &gt; foo.txt&#160;<br/></b>c&#160;<br/>b&#160;<br/>a&#160;<br/>[me@linuxbox ~]$&#160;<b>cat foo.txt</b>&#160;<br/>a&#160;<br/>b&#160;<br/>c&#160;<br/>
After&#160;entering&#160;the&#160;command,&#160;we&#160;type&#160;the&#160;letters&#160;c,&#160;b,&#160;and&#160;a,&#160;and&#160;then&#160;we&#160;press&#160;Ctrl-d<br/>to indicate&#160;end-of-file.&#160;We&#160;then view&#160;the&#160;resulting file&#160;and see&#160;that&#160;the&#160;lines&#160;now&#160;appear&#160;in<br/>sorted order.<br/>Since&#160;sort&#160;can&#160;accept&#160;multiple&#160;files&#160;on&#160;the&#160;command&#160;line&#160;as&#160;arguments,&#160;it&#160;is&#160;possible&#160;to<br/><i>merge</i>&#160;multiple&#160;files&#160;into a&#160;single&#160;sorted&#160;whole.&#160;For example,&#160;if we&#160;had three&#160;text&#160;files&#160;and<br/>wanted to&#160;combine&#160;them&#160;into a&#160;single&#160;sorted file, we&#160;could&#160;do something&#160;like&#160;this:&#160;<br/>
<b>sort file1.txt file2.txt file3.txt &gt; final_sorted_list.txt</b><br/>
sort&#160;has&#160;several&#160;interesting&#160;options.&#160;Table&#160;20-1 contains&#160;a&#160;partial&#160;list:<br/>
<i>Table&#160;20-1: Common&#160;sort&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-b<br/>
--ignore-leading-blanks<br/>
By default, sorting&#160;is&#160;performed&#160;on<br/>the&#160;entire&#160;line,&#160;starting&#160;with the&#160;<br/>first&#160;character in&#160;the&#160;line.&#160;This&#160;<br/>option&#160;causes&#160;sort&#160;to&#160;ignore&#160;<br/>leading spaces&#160;in lines&#160;and&#160;<br/>calculates&#160;sorting&#160;based&#160;on the&#160;first<br/>non-whitespace&#160;character&#160;on the&#160;<br/>line.<br/>
-f<br/>
--ignore-case<br/>
Make&#160;sorting&#160;case-insensitive.<br/>
277<br/>
<hr/>
<a name=302></a>20 –&#160;Text&#160;Processing<br/>
-n<br/>
--numeric-sort<br/>
Perform&#160;sorting&#160;based on the&#160;<br/>numeric&#160;evaluation of a&#160;string.&#160;<br/>Using this&#160;option&#160;allows&#160;sorting&#160;to&#160;<br/>be&#160;performed on numeric&#160;values&#160;<br/>rather than&#160;alphabetic&#160;values.<br/>
-r<br/>
--reverse<br/>
Sort&#160;in&#160;reverse&#160;order.&#160;Results&#160;are&#160;in<br/>descending rather&#160;than ascending&#160;<br/>order.<br/>
-k<br/>
--key=<i>field1</i>[,<i>field2</i>]<br/>
Sort&#160;based&#160;on a&#160;key field&#160;located&#160;<br/>from&#160;<i>field1</i>&#160;to&#160;<i>field2</i>&#160;rather than&#160;the<br/>entire&#160;line. See&#160;the&#160;following&#160;<br/>discussion.<br/>
-m<br/>
--merge<br/>
Treat&#160;each&#160;argument&#160;as&#160;the&#160;name&#160;<br/>of a&#160;presorted file.&#160;Merge&#160;multiple&#160;<br/>files&#160;into&#160;a&#160;single&#160;sorted&#160;result&#160;<br/>without&#160;performing&#160;any additional&#160;<br/>sorting.<br/>
-o<br/>
--output=<i>file</i><br/>
Send sorted&#160;output&#160;to&#160;<i>file</i>&#160;rather&#160;<br/>than&#160;standard output.<br/>
-t<br/>
--field-separator=<i>char</i><br/>
Define&#160;the&#160;field-separator&#160;<br/>character. By default&#160;fields&#160;are&#160;<br/>separated by spaces&#160;or tabs.<br/>
Although&#160;most&#160;of&#160;these&#160;options&#160;are&#160;pretty&#160;self-explanatory,&#160;some&#160;are&#160;not.&#160;First,&#160;let’s&#160;look<br/>at&#160;the&#160;-n&#160;option,&#160;used&#160;for&#160;numeric&#160;sorting.&#160;With&#160;this&#160;option,&#160;it&#160;is&#160;possible&#160;to&#160;sort&#160;values<br/>based&#160;on&#160;numeric&#160;values.&#160;We&#160;can&#160;demonstrate&#160;this&#160;by&#160;sorting&#160;the&#160;results&#160;of&#160;the&#160;du&#160;com-<br/>mand to&#160;determine&#160;the&#160;largest&#160;users&#160;of disk space.&#160;Normally,&#160;the&#160;du&#160;command&#160;lists&#160;the&#160;re-<br/>sults&#160;of a&#160;summary&#160;in pathname&#160;order.<br/>
[me@linuxbox ~]$&#160;<b>du -s /usr/share/* | head</b>&#160;<br/>252<br/>
/usr/share/aclocal&#160;<br/>
96<br/>
/usr/share/acpi-support&#160;<br/>
8<br/>
/usr/share/adduser&#160;<br/>
196<br/>
/usr/share/alacarte&#160;<br/>
344<br/>
/usr/share/alsa&#160;<br/>
8<br/>
/usr/share/alsa-base&#160;<br/>
12488<br/>
/usr/share/anthy&#160;<br/>
8<br/>
/usr/share/apmd&#160;<br/>
278<br/>
<hr/>
<a name=303></a>Revisiting Some&#160;Old Friends<br/>
21440<br/>
/usr/share/app-install&#160;<br/>
48<br/>
/usr/share/application-registry&#160;<br/>
In&#160;this&#160;example,&#160;we&#160;pipe&#160;the&#160;results&#160;into&#160;head&#160;to&#160;limit&#160;the&#160;results&#160;to&#160;the&#160;first&#160;10&#160;lines.&#160;We<br/>can produce&#160;a&#160;numerically sorted list&#160;to show&#160;the&#160;10 largest&#160;consumers&#160;of space&#160;this&#160;way.<br/>
[me@linuxbox ~]$&#160;<b>du -s /usr/share/* | sort -nr | head</b>&#160;<br/>509940<br/>
/usr/share/locale-langpack&#160;<br/>
242660<br/>
/usr/share/doc&#160;<br/>
197560<br/>
/usr/share/fonts&#160;<br/>
179144<br/>
/usr/share/gnome&#160;<br/>
146764<br/>
/usr/share/myspell&#160;<br/>
144304<br/>
/usr/share/gimp&#160;<br/>
135880<br/>
/usr/share/dict&#160;<br/>
76508<br/>
/usr/share/icons&#160;<br/>
68072<br/>
/usr/share/apps&#160;<br/>
62844<br/>
/usr/share/foomatic<br/>
By&#160;using&#160;the&#160;n&#160;and&#160;r&#160;options,&#160;we&#160;produce&#160;a&#160;reverse&#160;numerical&#160;sort,&#160;with&#160;the&#160;largest&#160;val-<br/>ues&#160;appearing&#160;first&#160;in&#160;the&#160;results.&#160;This&#160;sort&#160;works&#160;because&#160;the&#160;numerical&#160;values&#160;occur&#160;at<br/>the&#160;beginning&#160;of&#160;each&#160;line.&#160;But&#160;what&#160;if&#160;we&#160;want&#160;to&#160;sort&#160;a&#160;list&#160;based&#160;on&#160;some&#160;value&#160;found<br/>within the&#160;line?&#160;For example, here&#160;are&#160;the&#160;results&#160;of&#160;ls -l:<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin | head<br/></b>total 152948&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160;34824 2016-04-04 02:42 [&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; 101556 2007-11-27 06:08 a2p&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160;13036 2016-02-27 08:22 aconnect&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160;10552 2007-08-15 10:34 acpi&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160; 3800 2016-04-14 03:51 acpi_fakekey&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160; 7536 2016-04-19 00:19 acpi_listen&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160; 3576 2016-04-29 07:57 addpart&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; &#160;20808 2016-01-03 18:02 addr2line&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160; 489704 2016-10-09 17:02 adept_batch<br/>
Ignoring,&#160;for&#160;the&#160;moment,&#160;that&#160;ls&#160;can&#160;sort&#160;its&#160;results&#160;by&#160;size,&#160;we&#160;could&#160;use&#160;sort&#160;to&#160;sort<br/>this&#160;list&#160;by file&#160;size, as&#160;well.<br/>
[me@linuxbox ~]$&#160;<b>ls -l /usr/bin | sort -nrk 5 | head&#160;</b><br/>
279<br/>
<hr/>
<a name=304></a>20 –&#160;Text&#160;Processing<br/>
-rwxr-xr-x 1 root &#160; root &#160; &#160;8234216 2016-04-07 17:42 inkscape&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;8222692 2016-04-07 17:42 inkview&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;3746508 2016-03-07 23:45 gimp-2.4&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;3654020 2016-08-26 16:16 quanta&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2928760 2016-09-10 14:31 gdbtui&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2928756 2016-09-10 14:31 gdb&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2602236 2016-10-10 12:56 net&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2304684 2016-10-10 12:56 rpcclient&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2241832 2016-04-04 05:56 aptitude&#160;<br/>-rwxr-xr-x 1 root &#160; root &#160; &#160;2202476 2016-10-10 12:56 smbcacls<br/>
Many&#160;uses&#160;of&#160;sort&#160;involve&#160;the&#160;processing&#160;of&#160;<i>tabular&#160;data</i>,&#160;such&#160;as&#160;the&#160;results&#160;of&#160;the&#160;pre-<br/>vious&#160;ls&#160;command.&#160;If&#160;we&#160;apply&#160;database&#160;terminology&#160;to&#160;the&#160;previous&#160;table,&#160;we&#160;would<br/>say&#160;that&#160;each&#160;row&#160;is&#160;a&#160;<i>record</i>&#160;and&#160;that&#160;each&#160;record&#160;consists&#160;of&#160;multiple&#160;<i>fields</i>,&#160;such&#160;as&#160;the<br/>file&#160;attributes,&#160;link&#160;count,&#160;filename,&#160;file&#160;size,&#160;and&#160;so&#160;on.&#160;sort&#160;is&#160;able&#160;to&#160;process&#160;individ-<br/>ual&#160;fields.&#160;In&#160;database&#160;terms,&#160;we&#160;are&#160;able&#160;to&#160;specify&#160;one&#160;or&#160;more&#160;<i>key&#160;fields</i>&#160;to&#160;use&#160;as&#160;<i>sort<br/>keys</i>.&#160;In&#160;the&#160;previous&#160;example,&#160;we&#160;specify&#160;the&#160;n&#160;and&#160;r&#160;options&#160;to&#160;perform&#160;a&#160;reverse&#160;nu-<br/>merical&#160;sort&#160;and specify&#160;-k 5&#160;to&#160;make&#160;sort&#160;use&#160;the&#160;fifth field as&#160;the&#160;key for sorting.<br/>The&#160;&#160;k&#160;option&#160;is&#160;interesting&#160;and&#160;has&#160;many&#160;features,&#160;but&#160;first&#160;we&#160;need&#160;to&#160;talk&#160;about&#160;how<br/>sort&#160;defines&#160;fields.&#160;Let’s&#160;consider&#160;the&#160;following&#160;simple&#160;text&#160;file&#160;consisting&#160;of&#160;a&#160;single<br/>line&#160;containing the&#160;author’s&#160;name:<br/>
William Shotts<br/>
By&#160;default,&#160;sort&#160;sees&#160;this&#160;line&#160;as&#160;having&#160;two&#160;fields.&#160;The&#160;first&#160;field&#160;contains&#160;these&#160;charac-<br/>ters:<br/>“William”<br/>The&#160;second&#160;field contains&#160;these&#160;characters:<br/>“Shotts”<br/>This&#160;means&#160;that&#160;whitespace&#160;characters&#160;(spaces&#160;and&#160;tabs)&#160;are&#160;used&#160;as&#160;delimiters&#160;between<br/>fields&#160;and&#160;that&#160;the&#160;delimiters&#160;are&#160;included&#160;in the&#160;field when sorting&#160;is&#160;performed.<br/>Looking&#160;again&#160;at&#160;a&#160;line&#160;from&#160;our&#160;ls&#160;output,&#160;as&#160;follows,&#160;we&#160;can&#160;see&#160;that&#160;a&#160;line&#160;contains<br/>eight&#160;fields&#160;and&#160;that&#160;the&#160;fifth&#160;field&#160;is&#160;the&#160;file&#160;size:<br/>
-rwxr-xr-x 1 root &#160; root &#160; &#160;8234216 2016-04-07 17:42 inkscape<br/>
280<br/>
<hr/>
<a name=305></a>Revisiting Some&#160;Old Friends<br/>
For&#160;our&#160;next&#160;series&#160;of&#160;experiments,&#160;let’s&#160;consider&#160;the&#160;following&#160;file&#160;containing&#160;the&#160;history<br/>of&#160;three&#160;popular&#160;Linux&#160;distributions&#160;released&#160;from&#160;2006&#160;to&#160;2008.&#160;Each&#160;line&#160;in&#160;the&#160;file&#160;has<br/>three&#160;&#160;&#160;fields:&#160;&#160;&#160;the&#160;&#160;&#160;distribution&#160;&#160;&#160;name,&#160;&#160;&#160;version&#160;&#160;&#160;number,&#160;&#160;&#160;and&#160;&#160;&#160;date&#160;&#160;&#160;of&#160;&#160;release&#160;&#160;&#160;in&#160;&#160;&#160;MM/DD/<br/>YYYY&#160;format.<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007&#160;<br/>
SUSE<br/>
10.1<br/>
05/11/2006&#160;<br/>
Fedora<br/>
6<br/>
10/24/2006&#160;<br/>
Fedora<br/>
9<br/>
05/13/2008&#160;<br/>
Ubuntu<br/>
6.06<br/>
06/01/2006&#160;<br/>
Ubuntu<br/>
8.10<br/>
10/30/2008&#160;<br/>
Fedora<br/>
5<br/>
03/20/2006<br/>
Using&#160;a&#160;text&#160;editor&#160;(perhaps&#160;vim),&#160;we’ll&#160;enter&#160;this&#160;data&#160;and&#160;name&#160;the&#160;resulting&#160;file&#160;dis-<br/>tros.txt.<br/>Next, we’ll&#160;try sorting the&#160;file&#160;and observe&#160;these&#160;results:<br/>
[me@linuxbox ~]$&#160;<b>sort distros.txt<br/></b>Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
Fedora<br/>
5<br/>
03/20/2006&#160;<br/>
Fedora<br/>
6<br/>
10/24/2006&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
Fedora<br/>
9<br/>
05/13/2008&#160;<br/>
SUSE<br/>
10.1<br/>
05/11/2006&#160;<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
Ubuntu<br/>
6.06<br/>
06/01/2006&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
281<br/>
<hr/>
<a name=306></a>20 –&#160;Text&#160;Processing<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Ubuntu<br/>
8.10<br/>
10/30/2008<br/>
Well,&#160;it&#160;mostly&#160;worked.&#160;The&#160;problem&#160;occurs&#160;in&#160;the&#160;sorting&#160;of&#160;the&#160;Fedora&#160;version&#160;numbers.<br/>Since&#160;&#160;1&#160;comes&#160;before&#160;5&#160;in&#160;the&#160;character&#160;set,&#160;version&#160;10&#160;ends&#160;up&#160;at&#160;the&#160;top&#160;while&#160;version&#160;9<br/>falls&#160;to&#160;the&#160;bottom.<br/>To fix&#160;this&#160;problem,&#160;we&#160;are&#160;going&#160;to have&#160;to&#160;sort&#160;on multiple&#160;keys.&#160;We&#160;want&#160;to&#160;perform&#160;an<br/>alphabetic&#160;sort&#160;on&#160;the&#160;first&#160;field&#160;and&#160;then&#160;a&#160;numeric&#160;sort&#160;on&#160;the&#160;second&#160;field.&#160;sort&#160;allows<br/>multiple&#160;instances&#160;of&#160;the&#160;-k&#160;option&#160;so&#160;that&#160;multiple&#160;sort&#160;keys&#160;can&#160;be&#160;specified.&#160;In&#160;fact,&#160;a<br/>key&#160;may&#160;include&#160;a&#160;range&#160;of&#160;fields.&#160;If&#160;no&#160;range&#160;is&#160;specified&#160;(as&#160;has&#160;been&#160;the&#160;case&#160;with&#160;our<br/>previous&#160;examples),&#160;sort&#160;uses&#160;a&#160;key&#160;that&#160;begins&#160;with&#160;the&#160;specified&#160;field&#160;and&#160;extends&#160;to<br/>the&#160;end&#160;of the&#160;line. Here&#160;is&#160;the&#160;syntax for our multi-key&#160;sort:<br/>
[me@linuxbox ~]$&#160;<b>sort --key=1,1 --key=2n distros.txt</b>&#160;<br/>Fedora<br/>
5<br/>
03/20/2006&#160;<br/>
Fedora<br/>
6<br/>
10/24/2006&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
Fedora<br/>
9<br/>
05/13/2008&#160;<br/>
Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
SUSE<br/>
10.1<br/>
05/11/2006&#160;<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
Ubuntu<br/>
6.06<br/>
06/01/2006&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Ubuntu<br/>
8.10<br/>
10/30/2008<br/>
Though&#160;we&#160;used&#160;the&#160;long&#160;form&#160;of&#160;the&#160;option&#160;for&#160;clarity,&#160;-k&#160;1,1&#160;-k&#160;2n&#160;would&#160;be&#160;ex-<br/>actly&#160;equivalent.&#160;In&#160;the&#160;first&#160;instance&#160;of&#160;the&#160;key&#160;option,&#160;we&#160;specified&#160;a&#160;range&#160;of&#160;fields&#160;to<br/>include&#160;in&#160;the&#160;first&#160;key.&#160;Since&#160;we&#160;wanted&#160;to&#160;limit&#160;the&#160;sort&#160;to&#160;just&#160;the&#160;first&#160;field,&#160;we&#160;speci-<br/>fied&#160;&#160;1,1&#160;which&#160;means&#160;“start&#160;at&#160;field&#160;1&#160;and&#160;end&#160;at&#160;field&#160;1.”&#160;In&#160;the&#160;second&#160;instance,&#160;we<br/>specified&#160;2n,&#160;which&#160;means&#160;field&#160;2&#160;is&#160;the&#160;sort&#160;key&#160;and&#160;that&#160;the&#160;sort&#160;should&#160;be&#160;numeric.&#160;An<br/>option letter&#160;may&#160;be&#160;included&#160;at&#160;the&#160;end of a&#160;key specifier&#160;to indicate&#160;the&#160;type&#160;of sort&#160;to&#160;be<br/>performed.&#160;These&#160;option&#160;letters&#160;are&#160;the&#160;same&#160;as&#160;the&#160;global&#160;options&#160;for&#160;the&#160;sort&#160;program:<br/>b&#160;(ignore&#160;leading&#160;blanks),&#160;n&#160;(numeric&#160;sort),&#160;r&#160;(reverse&#160;sort), and so on.<br/>The&#160;third&#160;field&#160;in&#160;our&#160;list&#160;contains&#160;a&#160;date&#160;in&#160;an&#160;inconvenient&#160;format&#160;for&#160;sorting.&#160;On&#160;com-<br/>
282<br/>
<hr/>
<a name=307></a>Revisiting Some&#160;Old Friends<br/>
puters,&#160;dates&#160;are&#160;usually&#160;formatted&#160;in&#160;YYYY-MM-DD&#160;order&#160;to&#160;make&#160;chronological&#160;sort-<br/>ing&#160;easy,&#160;but&#160;ours&#160;are&#160;in&#160;the&#160;American&#160;format&#160;of&#160;MM/DD/YYYY.&#160;How&#160;can&#160;we&#160;sort&#160;this<br/>list&#160;in&#160;chronological&#160;order?<br/>Fortunately,&#160;sort&#160;provides&#160;a&#160;way.&#160;The&#160;key&#160;option&#160;allows&#160;specification&#160;of&#160;<i>offsets</i>&#160;within<br/>fields, so we&#160;can define&#160;keys&#160;within&#160;fields.<br/>
[me@linuxbox ~]$&#160;<b>sort -k 3.7nbr -k 3.1nbr -k 3.4nbr distros.txt</b>&#160;<br/>Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
Ubuntu<br/>
8.10<br/>
10/30/2008&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
Fedora<br/>
9<br/>
05/13/2008&#160;<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007&#160;<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Fedora<br/>
6<br/>
10/24/2006&#160;<br/>
Ubuntu<br/>
6.06<br/>
06/01/2006&#160;<br/>
SUSE<br/>
10.1<br/>
05/11/2006&#160;<br/>
Fedora<br/>
5<br/>
03/20/2006&#160;<br/>
By&#160;specifying&#160;&#160;-k&#160;3.7,&#160;we&#160;instruct&#160;sort&#160;to&#160;use&#160;a&#160;sort&#160;key&#160;that&#160;begins&#160;at&#160;the&#160;seventh<br/>character&#160;within&#160;the&#160;third&#160;field,&#160;which&#160;corresponds&#160;to&#160;the&#160;start&#160;of&#160;the&#160;year.&#160;Likewise,&#160;we<br/>specify&#160;-k&#160;3.1&#160;and&#160;-k&#160;3.4&#160;to&#160;isolate&#160;the&#160;month&#160;and&#160;day&#160;portions&#160;of&#160;the&#160;date.&#160;We&#160;also<br/>add&#160;the&#160;n&#160;and&#160;r&#160;options&#160;to&#160;achieve&#160;a&#160;reverse&#160;numeric&#160;sort.&#160;The&#160;b&#160;option&#160;is&#160;included&#160;to<br/>suppress&#160;the&#160;leading&#160;spaces&#160;(whose&#160;numbers&#160;vary&#160;from&#160;line&#160;to&#160;line,&#160;thereby&#160;affecting&#160;the<br/>outcome&#160;of the&#160;sort)&#160;in the&#160;date&#160;field.<br/>Some&#160;files&#160;don’t&#160;use&#160;tabs&#160;and&#160;spaces&#160;as&#160;field&#160;delimiters;&#160;for&#160;example,&#160;here’s&#160;the&#160;/etc/<br/>passwd&#160;file:<br/>
[me@linuxbox ~]$&#160;<b>head /etc/passwd&#160;<br/></b>root:x:0:0:root:/root:/bin/bash&#160;<br/>daemon:x:1:1:daemon:/usr/sbin:/bin/sh&#160;<br/>bin:x:2:2:bin:/bin:/bin/sh&#160;<br/>sys:x:3:3:sys:/dev:/bin/sh&#160;<br/>sync:x:4:65534:sync:/bin:/bin/sync&#160;<br/>games:x:5:60:games:/usr/games:/bin/sh&#160;<br/>
283<br/>
<hr/>
<a name=308></a>20 –&#160;Text&#160;Processing<br/>
man:x:6:12:man:/var/cache/man:/bin/sh&#160;<br/>lp:x:7:7:lp:/var/spool/lpd:/bin/sh&#160;<br/>mail:x:8:8:mail:/var/mail:/bin/sh&#160;<br/>news:x:9:9:news:/var/spool/news:/bin/sh<br/>
The&#160;fields&#160;in&#160;this&#160;file&#160;are&#160;delimited&#160;with&#160;colons&#160;(:), so how&#160;would&#160;we&#160;sort&#160;this&#160;file&#160;using&#160;a<br/>key&#160;field?&#160;sort&#160;provides&#160;the&#160;-t&#160;option&#160;to&#160;define&#160;the&#160;field&#160;separator&#160;character.&#160;To&#160;sort&#160;the<br/>passwd&#160;file&#160;on the&#160;seventh&#160;field&#160;(the&#160;account’s&#160;default&#160;shell), we&#160;could&#160;do this:<br/>
[me@linuxbox ~]$&#160;<b>sort -t ':' -k 7 /etc/passwd | head<br/></b>me:x:1001:1001:Myself,,,:/home/me:/bin/bash<br/>root:x:0:0:root:/root:/bin/bash<br/>dhcp:x:101:102::/nonexistent:/bin/false&#160;<br/>gdm:x:106:114:Gnome Display Manager:/var/lib/gdm:/bin/false<br/>hplip:x:104:7:HPLIP system user,,,:/var/run/hplip:/bin/false<br/>klog:x:103:104::/home/klog:/bin/false<br/>messagebus:x:108:119::/var/run/dbus:/bin/false<br/>polkituser:x:110:122:PolicyKit,,,:/var/run/PolicyKit:/bin/false<br/>pulse:x:107:116:PulseAudio daemon,,,:/var/run/pulse:/bin/false<br/>
By specifying&#160;the&#160;colon&#160;character as&#160;the&#160;field&#160;separator,&#160;we&#160;can sort&#160;on the&#160;seventh field.<br/>
uniq<br/>Compared&#160;to&#160;sort,&#160;the&#160;uniq&#160;program&#160;is&#160;lightweight.&#160;uniq&#160;performs&#160;a&#160;seemingly&#160;triv-<br/>ial&#160;task.&#160;When&#160;given&#160;a&#160;sorted&#160;file&#160;(or&#160;standard&#160;input),&#160;it&#160;removes&#160;any&#160;duplicate&#160;lines&#160;and<br/>sends&#160;the&#160;results&#160;to&#160;standard output.&#160;It&#160;is&#160;often&#160;used&#160;in conjunction with&#160;sort&#160;to&#160;clean&#160;the<br/>output&#160;of duplicates.<br/>
<b>Tip:</b>&#160;While&#160;uniq&#160;is&#160;a&#160;traditional&#160;Unix&#160;tool&#160;often&#160;used&#160;with&#160;sort,&#160;the&#160;GNU&#160;ver-<br/>sion&#160;of&#160;&#160;sort&#160;supports&#160;a&#160;-u&#160;option,&#160;which&#160;removes&#160;duplicates&#160;from&#160;the&#160;sorted<br/>output.<br/>
Let’s&#160;make&#160;a&#160;text&#160;file&#160;to try this&#160;as&#160;shown here:<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; foo.txt&#160;<br/>a&#160;<br/>b&#160;<br/>c&#160;</b><br/>
284<br/>
<hr/>
<a name=309></a>Revisiting Some&#160;Old Friends<br/>
<b>a&#160;<br/>b&#160;<br/>c</b><br/>
Remember to&#160;type&#160;Ctrl-d&#160;to&#160;terminate&#160;standard input.&#160;Now, if&#160;we&#160;run&#160;uniq&#160;on our text<br/>file,&#160;we&#160;get&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>uniq foo.txt</b>&#160;<br/>a&#160;<br/>b&#160;<br/>c&#160;<br/>a&#160;<br/>b&#160;<br/>c&#160;<br/>
The&#160;results&#160;are&#160;no&#160;different&#160;from&#160;our&#160;original&#160;file;&#160;the&#160;duplicates&#160;were&#160;not&#160;removed.&#160;For<br/>uniq&#160;to do its&#160;job,&#160;the&#160;input&#160;must&#160;be&#160;sorted&#160;first.<br/>
[me@linuxbox ~]$&#160;<b>sort foo.txt | uniq</b>&#160;<br/>a&#160;<br/>b&#160;<br/>c<br/>
This&#160;is&#160;because&#160;uniq&#160;only removes&#160;duplicate&#160;lines&#160;that&#160;are&#160;adjacent&#160;to each other.<br/>
uniq&#160;has&#160;several&#160;options.&#160;Table&#160;20-2 lists&#160;the&#160;common ones.<br/>
<i>Table&#160;20-2: Common&#160;uniq&#160;Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-c<br/>
--count<br/>
Output&#160;a&#160;list&#160;of duplicate&#160;lines&#160;preceded&#160;by<br/>the&#160;number of times&#160;the&#160;line&#160;occurs.<br/>
-d<br/>
--repeated<br/>
Output&#160;only repeated lines, rather&#160;than&#160;<br/>unique&#160;lines.&#160;<br/>
-f&#160;<i>n</i><br/>
--skip-fields=<i>n</i><br/>
Ignore&#160;<i>n</i>&#160;leading&#160;fields&#160;in each&#160;line.&#160;Fields&#160;<br/>are&#160;separated&#160;by whitespace&#160;as&#160;they are&#160;in&#160;<br/>sort;&#160;however,&#160;unlike&#160;sort,&#160;uniq&#160;has&#160;<br/>no option&#160;for setting&#160;an alternate&#160;field&#160;<br/>separator.<br/>
285<br/>
<hr/>
<a name=310></a>20 –&#160;Text&#160;Processing<br/>
-i<br/>
--ignore-case<br/>
Ignore&#160;case&#160;during the&#160;line&#160;comparisons.<br/>
-s&#160;<i>n</i><br/>
--skip-chars=<i>n</i><br/>
Skip (ignore)&#160;the&#160;leading&#160;<i>n</i>&#160;characters&#160;of&#160;<br/>each line.<br/>
-u<br/>
--unique<br/>
Output&#160;only unique&#160;lines. Lines&#160;with&#160;<br/>duplicates&#160;are&#160;ignored.<br/>
Here&#160;we&#160;see&#160;uniq&#160;used&#160;to&#160;report&#160;the&#160;number&#160;of&#160;duplicates&#160;found&#160;in&#160;our&#160;text&#160;file,&#160;using<br/>the&#160;-c&#160;option:<br/>
[me@linuxbox ~]$&#160;<b>sort foo.txt | uniq -c</b>&#160;<br/>&#160; &#160; &#160; 2 a&#160;<br/>&#160; &#160; &#160; 2 b&#160;<br/>&#160; &#160; &#160; 2 c<br/>
<b>Slicing&#160;and&#160;Dicing<br/></b>The&#160;next&#160;three&#160;programs&#160;we&#160;will&#160;discuss&#160;are&#160;used&#160;to&#160;peel&#160;columns&#160;of&#160;text&#160;out&#160;of&#160;files&#160;and<br/>recombine&#160;them&#160;in useful&#160;ways.<br/>
cut<br/>The&#160;cut&#160;program&#160;is&#160;used&#160;to&#160;extract&#160;a&#160;section&#160;of&#160;text&#160;from&#160;a&#160;line&#160;and&#160;output&#160;the&#160;extracted<br/>section&#160;to standard output. It&#160;can&#160;accept&#160;multiple&#160;file&#160;arguments&#160;or input&#160;from&#160;standard in-<br/>put.<br/>Specifying&#160;the&#160;section&#160;of&#160;the&#160;line&#160;to&#160;be&#160;extracted&#160;is&#160;somewhat&#160;awkward&#160;and&#160;is&#160;specified<br/>using&#160;the&#160;options&#160;listed&#160;in&#160;Table&#160;20-3.<br/>
<i>Table&#160;20-3:&#160;cut&#160;Selection Options</i><br/>
<b>Option</b><br/>
<b>Long&#160;Option</b><br/>
<b>Description</b><br/>
-c&#160;<i>list</i><br/>
--characters=<i>list</i><br/>
Extract&#160;the&#160;portion of the&#160;<br/>line&#160;defined by&#160;<i>list</i>.&#160;The&#160;list&#160;<br/>may&#160;consist&#160;of one&#160;or more&#160;<br/>comma-separated numerical&#160;<br/>ranges.<br/>
-f&#160;<i>list</i><br/>
--fields=<i>list</i><br/>
Extract&#160;one&#160;or more&#160;fields&#160;<br/>from&#160;the&#160;line&#160;as&#160;defined&#160;by&#160;<br/><i>list</i>.&#160;The&#160;list&#160;may contain&#160;one<br/>
286<br/>
<hr/>
<a name=311></a>Slicing and&#160;Dicing<br/>
or more&#160;fields&#160;or field ranges<br/>separated by commas.<br/>
-d&#160;<i>delim</i><br/>
--delimeter=<i>delim</i><br/>
When&#160;-f&#160;is&#160;specified,&#160;use&#160;<br/><i>delim</i>&#160;as&#160;the&#160;field delimiting&#160;<br/>character. By default, fields&#160;<br/>must&#160;be&#160;separated&#160;by a&#160;<br/>single&#160;tab character.<br/>
--complement<br/>
Extract&#160;the&#160;entire&#160;line&#160;of&#160;<br/>text, except&#160;for those&#160;<br/>portions&#160;specified&#160;by&#160;-c&#160;<br/>and/or&#160;-f.<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;way&#160;cut&#160;extracts&#160;text&#160;is&#160;rather&#160;inflexible.&#160;cut&#160;is&#160;best&#160;used&#160;to&#160;extract<br/>text&#160;from&#160;files&#160;that&#160;are&#160;produced&#160;by&#160;other&#160;programs,&#160;rather&#160;than&#160;text&#160;directly&#160;typed&#160;by&#160;hu-<br/>mans.&#160;We’ll&#160;take&#160;a&#160;look&#160;at&#160;our&#160;distros.txt&#160;file&#160;to&#160;see&#160;whether&#160;it&#160;is&#160;“clean”&#160;enough&#160;to<br/>be&#160;a&#160;good&#160;specimen&#160;for&#160;our&#160;cut&#160;examples.&#160;If&#160;we&#160;use&#160;cat&#160;with&#160;the&#160;-A&#160;option,&#160;we&#160;can&#160;see<br/>whether the&#160;file&#160;meets&#160;our requirements&#160;of tab-separated&#160;fields:<br/>
[me@linuxbox ~]$&#160;<b>cat -A distros.txt&#160;<br/></b>SUSE^I10.2^I12/07/2006$&#160;<br/>Fedora^I10^I11/25/2008$&#160;<br/>SUSE^I11.0^I06/19/2008$&#160;<br/>Ubuntu^I8.04^I04/24/2008$&#160;<br/>Fedora^I8^I11/08/2007$&#160;<br/>SUSE^I10.3^I10/04/2007$&#160;<br/>Ubuntu^I6.10^I10/26/2006$&#160;<br/>Fedora^I7^I05/31/2007$&#160;<br/>Ubuntu^I7.10^I10/18/2007$&#160;<br/>Ubuntu^I7.04^I04/19/2007$&#160;<br/>SUSE^I10.1^I05/11/2006$&#160;<br/>Fedora^I6^I10/24/2006$&#160;<br/>Fedora^I9^I05/13/2008$&#160;<br/>Ubuntu^I6.06^I06/01/2006$&#160;<br/>Ubuntu^I8.10^I10/30/2008$&#160;<br/>Fedora^I5^I03/20/2006$<br/>
It&#160;looks&#160;good.&#160;There&#160;are&#160;no&#160;embedded&#160;spaces,&#160;just&#160;single&#160;tab&#160;characters&#160;between&#160;the<br/>fields.&#160;Since&#160;the&#160;file&#160;uses&#160;tabs&#160;rather&#160;than&#160;spaces,&#160;we’ll&#160;use&#160;the&#160;&#160;-f&#160;&#160;option&#160;to&#160;extract&#160;a<br/>field.<br/>
287<br/>
<hr/>
<a name=312></a>20 –&#160;Text&#160;Processing<br/>
[me@linuxbox ~]$&#160;<b>cut -f 3 distros.txt</b>&#160;<br/>12/07/2006&#160;<br/>11/25/2008&#160;<br/>06/19/2008&#160;<br/>04/24/2008&#160;<br/>11/08/2007&#160;<br/>10/04/2007&#160;<br/>10/26/2006&#160;<br/>05/31/2007&#160;<br/>10/18/2007&#160;<br/>04/19/2007&#160;<br/>05/11/2006&#160;<br/>10/24/2006&#160;<br/>05/13/2008&#160;<br/>06/01/2006&#160;<br/>10/30/2008&#160;<br/>03/20/2006<br/>
Because&#160;our&#160;distros&#160;file&#160;is&#160;tab-delimited,&#160;it&#160;is&#160;best&#160;to&#160;use&#160;cut&#160;to&#160;extract&#160;fields&#160;rather<br/>than&#160;characters.&#160;This&#160;is&#160;because&#160;when&#160;a&#160;file&#160;is&#160;tab-delimited,&#160;it&#160;is&#160;unlikely&#160;that&#160;each&#160;line<br/>will&#160;contain&#160;the&#160;same&#160;number&#160;of&#160;characters,&#160;which&#160;makes&#160;calculating&#160;character&#160;positions<br/>within&#160;the&#160;line&#160;difficult&#160;or&#160;impossible.&#160;In&#160;our&#160;previous&#160;example,&#160;however,&#160;we&#160;now&#160;have<br/>extracted&#160;a&#160;field&#160;that&#160;luckily&#160;contains&#160;data&#160;of&#160;identical&#160;length,&#160;so&#160;we&#160;can&#160;show&#160;how&#160;char-<br/>acter&#160;extraction&#160;works&#160;by extracting&#160;the&#160;year&#160;from&#160;each&#160;line.<br/>
[me@linuxbox ~]$&#160;<b>cut -f 3 distros.txt | cut -c 7-10</b>&#160;<br/>2006&#160;<br/>2008&#160;<br/>2008&#160;<br/>2008&#160;<br/>2007&#160;<br/>2007&#160;<br/>2006&#160;<br/>2007&#160;<br/>2007&#160;<br/>2007&#160;<br/>2006&#160;<br/>2006&#160;<br/>2008&#160;<br/>2006&#160;<br/>2008&#160;<br/>2006<br/>
288<br/>
<hr/>
<a name=313></a>Slicing and&#160;Dicing<br/>
By&#160;running&#160;cut&#160;a&#160;second&#160;time&#160;on&#160;our&#160;list,&#160;we&#160;are&#160;able&#160;to&#160;extract&#160;character&#160;positions&#160;7<br/>through&#160;10,&#160;which&#160;corresponds&#160;to&#160;the&#160;year&#160;in&#160;our&#160;date&#160;field.&#160;The&#160;7-10&#160;notation&#160;is&#160;an&#160;ex-<br/>ample&#160;of&#160;a&#160;range.&#160;The&#160;cut&#160;man&#160;page&#160;contains&#160;a&#160;complete&#160;description&#160;of&#160;how&#160;ranges&#160;can<br/>be&#160;specified.<br/>
<b>Expanding&#160;Tabs</b><br/>
Our&#160;distros.txt&#160;file&#160;is&#160;ideally&#160;formatted&#160;for&#160;extracting&#160;fields&#160;using&#160;cut.&#160;But<br/>what&#160;if&#160;we&#160;wanted&#160;a&#160;file&#160;that&#160;could&#160;be&#160;fully&#160;manipulated&#160;with&#160;cut&#160;by&#160;characters,<br/>rather&#160;than&#160;fields?&#160;This&#160;would&#160;require&#160;us&#160;to&#160;replace&#160;the&#160;tab&#160;characters&#160;within&#160;the<br/>file&#160;with&#160;the&#160;corresponding&#160;number&#160;of&#160;spaces.&#160;Fortunately,&#160;the&#160;GNU&#160;&#160;Coreutils<br/>package&#160;includes&#160;a&#160;tool&#160;for&#160;that.&#160;Named&#160;expand,&#160;this&#160;program&#160;accepts&#160;either&#160;one<br/>or&#160;more&#160;file&#160;arguments&#160;or&#160;standard&#160;input&#160;and&#160;outputs&#160;the&#160;modified&#160;text&#160;to&#160;standard<br/>output.<br/>If&#160;we&#160;process&#160;our&#160;distros.txt&#160;file&#160;with&#160;expand,&#160;we&#160;can&#160;use&#160;cut&#160;-c&#160;to&#160;ex-<br/>tract&#160;any&#160;range&#160;of&#160;characters&#160;from&#160;the&#160;file.&#160;For&#160;example,&#160;we&#160;could&#160;use&#160;the&#160;follow-<br/>ing&#160;command&#160;to&#160;extract&#160;the&#160;year&#160;of&#160;release&#160;from&#160;our&#160;list&#160;by&#160;expanding&#160;the&#160;file&#160;and<br/>using&#160;cut&#160;to extract&#160;every character&#160;from&#160;the&#160;23rd position to&#160;the&#160;end of the&#160;line:<br/>[me@linuxbox ~]$&#160;<b>expand distros.txt | cut -c 23-</b><br/>
Coreutils&#160;also provides&#160;the&#160;unexpand&#160;program&#160;to&#160;substitute&#160;tabs&#160;for spaces.<br/>
When&#160;working&#160;with&#160;fields,&#160;it&#160;is&#160;possible&#160;to&#160;specify&#160;a&#160;different&#160;field&#160;delimiter&#160;rather&#160;than<br/>the&#160;tab&#160;character.&#160;Here&#160;we&#160;will&#160;extract&#160;the&#160;first&#160;field&#160;from&#160;the&#160;/etc/passwd&#160;file:<br/>
[me@linuxbox ~]$&#160;<b>cut -d ':' -f 1 /etc/passwd | head</b>&#160;<br/>root&#160;<br/>daemon&#160;<br/>bin&#160;<br/>sys&#160;<br/>sync&#160;<br/>games&#160;<br/>man&#160;<br/>lp&#160;<br/>mail&#160;<br/>news<br/>
Using the&#160;-d&#160;option,&#160;we&#160;are&#160;able&#160;to&#160;specify the&#160;colon character&#160;as&#160;the&#160;field delimiter.<br/>
289<br/>
<hr/>
<a name=314></a>20 –&#160;Text&#160;Processing<br/>
paste<br/>The&#160;paste&#160;command&#160;does&#160;the&#160;opposite&#160;of&#160;cut.&#160;Rather&#160;than&#160;extracting&#160;a&#160;column&#160;of&#160;text<br/>from&#160;a&#160;file,&#160;it&#160;adds&#160;one&#160;or&#160;more&#160;columns&#160;of&#160;text&#160;to&#160;a&#160;file.&#160;It&#160;does&#160;this&#160;by&#160;reading&#160;multiple<br/>files&#160;and&#160;combining&#160;the&#160;fields&#160;found&#160;in&#160;each&#160;file&#160;into&#160;a&#160;single&#160;stream&#160;on&#160;standard&#160;output.<br/>Like&#160;cut,&#160;paste&#160;accepts&#160;multiple&#160;file&#160;arguments&#160;and/or&#160;standard&#160;input.&#160;To&#160;demonstrate<br/>how&#160;paste&#160;operates,&#160;we&#160;will&#160;perform&#160;some&#160;surgery&#160;on&#160;our&#160;distros.txt&#160;file&#160;to&#160;pro-<br/>duce&#160;a&#160;chronological&#160;list&#160;of releases.<br/>From&#160;our&#160;earlier&#160;work&#160;with&#160;sort,&#160;we&#160;will&#160;first&#160;produce&#160;a&#160;list&#160;of&#160;distros&#160;sorted&#160;by&#160;date<br/>and store&#160;the&#160;result&#160;in&#160;a&#160;file&#160;called&#160;distros-by-date.txt.<br/>
[me@linuxbox ~]$&#160;<b>sort -k 3.7nbr -k 3.1nbr -k 3.4nbr distros.txt &gt; dis<br/>tros-by-date.txt</b><br/>
Next,&#160;we&#160;will&#160;use&#160;cut&#160;to&#160;extract&#160;the&#160;first&#160;two&#160;fields&#160;from&#160;the&#160;file&#160;(the&#160;distro&#160;name&#160;and<br/>version) and store&#160;that&#160;result&#160;in a&#160;file&#160;named&#160;distro-versions.txt.<br/>
[me@linuxbox ~]$&#160;<b>cut -f 1,2 distros-by-date.txt &gt; distros-versions.t<br/>xt<br/></b>[me@linuxbox ~]$&#160;<b>head distros-versions.txt<br/></b>Fedora<br/>
10&#160;<br/>
Ubuntu<br/>
8.10&#160;<br/>
SUSE<br/>
11.0&#160;<br/>
Fedora<br/>
9&#160;<br/>
Ubuntu<br/>
8.04&#160;<br/>
Fedora<br/>
8&#160;<br/>
Ubuntu<br/>
7.10&#160;<br/>
SUSE<br/>
10.3&#160;<br/>
Fedora<br/>
7&#160;<br/>
Ubuntu<br/>
7.04<br/>
The&#160;final&#160;piece&#160;of preparation&#160;is&#160;to extract&#160;the&#160;release&#160;dates&#160;and store&#160;them&#160;in a&#160;file&#160;named<br/>distro-dates.txt.<br/>
[me@linuxbox ~]$&#160;<b>cut -f 3 distros-by-date.txt &gt; distros-dates.txt<br/></b>[me@linuxbox ~]$&#160;<b>head distros-dates.txt<br/></b>11/25/2008&#160;<br/>10/30/2008&#160;<br/>06/19/2008&#160;<br/>
290<br/>
<hr/>
<a name=315></a>Slicing and&#160;Dicing<br/>
05/13/2008&#160;<br/>04/24/2008&#160;<br/>11/08/2007&#160;<br/>10/18/2007&#160;<br/>10/04/2007&#160;<br/>05/31/2007&#160;<br/>04/19/2007<br/>
We&#160;now&#160;have&#160;the&#160;parts&#160;we&#160;need.&#160;To&#160;complete&#160;the&#160;process,&#160;use&#160;paste&#160;to&#160;put&#160;the&#160;column<br/>of&#160;dates&#160;ahead&#160;of&#160;the&#160;distro&#160;names&#160;and&#160;versions,&#160;thus&#160;creating&#160;a&#160;chronological&#160;list.&#160;This&#160;is<br/>done&#160;simply&#160;by using&#160;paste&#160;and ordering&#160;its&#160;arguments&#160;in the&#160;desired arrangement.<br/>
[me@linuxbox ~]$&#160;<b>paste distros-dates.txt distros-versions.txt<br/></b>11/25/2008<br/>
Fedora<br/>
10&#160;<br/>
10/30/2008<br/>
Ubuntu<br/>
8.10&#160;<br/>
06/19/2008<br/>
SUSE<br/>
11.0&#160;<br/>
05/13/2008<br/>
Fedora<br/>
9&#160;<br/>
04/24/2008<br/>
Ubuntu<br/>
8.04&#160;<br/>
11/08/2007<br/>
Fedora<br/>
8&#160;<br/>
10/18/2007<br/>
Ubuntu<br/>
7.10&#160;<br/>
10/04/2007<br/>
SUSE<br/>
10.3&#160;<br/>
05/31/2007<br/>
Fedora<br/>
7&#160;<br/>
04/19/2007<br/>
Ubuntu<br/>
7.04&#160;<br/>
12/07/2006<br/>
SUSE<br/>
10.2&#160;<br/>
10/26/2006<br/>
Ubuntu<br/>
6.10&#160;<br/>
10/24/2006<br/>
Fedora<br/>
6&#160;<br/>
06/01/2006<br/>
Ubuntu<br/>
6.06&#160;<br/>
05/11/2006<br/>
SUSE<br/>
10.1&#160;<br/>
03/20/2006<br/>
Fedora<br/>
5<br/>
join<br/>In&#160;some&#160;ways,&#160;join&#160;is&#160;like&#160;paste&#160;in&#160;that&#160;it&#160;adds&#160;columns&#160;to&#160;a&#160;file,&#160;but&#160;it&#160;uses&#160;a&#160;unique<br/>way&#160;to&#160;do&#160;it.&#160;A&#160;<i>join</i>&#160;&#160;is&#160;an&#160;operation&#160;usually&#160;associated&#160;with&#160;&#160;<i>relational&#160;databases</i>&#160;where<br/>data&#160;from&#160;multiple&#160;&#160;<i>tables</i>&#160;with&#160;a&#160;shared&#160;key&#160;field&#160;is&#160;combined&#160;to&#160;form&#160;a&#160;desired&#160;result.<br/>The&#160;join&#160;program&#160;performs&#160;the&#160;same&#160;operation.&#160;It&#160;joins&#160;data&#160;from&#160;multiple&#160;files&#160;based<br/>on a&#160;shared key field.<br/>To see&#160;how&#160;a&#160;join operation&#160;is&#160;used&#160;in a&#160;relational&#160;database, let’s&#160;imagine&#160;a&#160;small&#160;database<br/>consisting&#160;of&#160;two&#160;tables,&#160;each&#160;containing&#160;a&#160;single&#160;record.&#160;The&#160;first&#160;table,&#160;called&#160;CUS-<br/>TOMERS,&#160;has&#160;three&#160;fields:&#160;a&#160;customer&#160;number&#160;(CUSTNUM),&#160;the&#160;customer’s&#160;first&#160;name<br/>
291<br/>
<hr/>
<a name=316></a>20 –&#160;Text&#160;Processing<br/>
(FNAME), and the&#160;customer’s&#160;last&#160;name&#160;(LNAME):<br/>CUSTNUM<br/>
FNAME<br/>
LNAME<br/>
========&#160;=====<br/>
======<br/>
4681934<br/>
John<br/>
Smith<br/>
The&#160;second&#160;table&#160;is&#160;called&#160;ORDERS&#160;and&#160;contains&#160;four&#160;fields:&#160;an&#160;order&#160;number&#160;(ORDER-<br/>NUM),&#160;the&#160;customer&#160;number&#160;(CUSTNUM),&#160;the&#160;quantity&#160;(QUAN),&#160;and&#160;the&#160;item&#160;ordered<br/>(ITEM).&#160;<br/>ORDERNUM<br/>
CUSTNUM<br/>
QUAN&#160;ITEM<br/>
========<br/>
=======<br/>
====&#160;====<br/>
3014953305<br/>
4681934<br/>
1<br/>
Blue Widget<br/>
Note&#160;that&#160;both&#160;tables&#160;share&#160;the&#160;field&#160;CUSTNUM.&#160;This&#160;is&#160;important,&#160;because&#160;it&#160;allows&#160;a<br/>relationship between the&#160;tables.<br/>Performing&#160;a&#160;join&#160;operation&#160;would&#160;allow&#160;us&#160;to&#160;combine&#160;the&#160;fields&#160;in&#160;the&#160;two&#160;tables&#160;to<br/>achieve&#160;a&#160;useful&#160;result,&#160;such&#160;as&#160;preparing&#160;an&#160;invoice.&#160;Using&#160;the&#160;matching&#160;values&#160;in&#160;the<br/>CUSTNUM&#160;fields&#160;of both tables, a&#160;join operation could&#160;produce&#160;the&#160;following:<br/>FNAME<br/>
LNAME<br/>
QUAN&#160;ITEM<br/>
=====<br/>
=====<br/>
====&#160;====<br/>
John<br/>
Smith<br/>
1<br/>
Blue Widget<br/>
To&#160;demonstrate&#160;the&#160;&#160;join&#160;program,&#160;we’ll&#160;need&#160;to&#160;make&#160;a&#160;couple&#160;of&#160;files&#160;with&#160;a&#160;shared<br/>key.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;use&#160;our&#160;distros-by-date.txt&#160;file.&#160;From&#160;this&#160;file,&#160;we&#160;will<br/>construct&#160;two&#160;additional&#160;files.&#160;One&#160;contains&#160;the&#160;release&#160;dates&#160;(which&#160;will&#160;be&#160;our&#160;shared<br/>key for this&#160;demonstration)&#160;and the&#160;release&#160;names, as&#160;shown here<br/>
[me@linuxbox ~]$&#160;<b>cut -f 1,1 distros-by-date.txt &gt; distros-names.txt<br/></b>[me@linuxbox ~]$&#160;<b>paste distros-dates.txt distros-names.txt &gt; distros-<br/>key-names.txt<br/></b>[me@linuxbox ~]$&#160;<b>head distros-key-names.txt&#160;<br/></b>11/25/2008<br/>
Fedora&#160;<br/>
10/30/2008<br/>
Ubuntu&#160;<br/>
06/19/2008<br/>
SUSE&#160;<br/>
05/13/2008<br/>
Fedora&#160;<br/>
04/24/2008<br/>
Ubuntu&#160;<br/>
11/08/2007<br/>
Fedora&#160;<br/>
10/18/2007<br/>
Ubuntu&#160;<br/>
10/04/2007<br/>
SUSE&#160;<br/>
05/31/2007<br/>
Fedora&#160;<br/>
04/19/2007<br/>
Ubuntu<br/>
The&#160;second&#160;file&#160;contains&#160;the&#160;release&#160;dates&#160;and&#160;the&#160;version numbers, as&#160;shown here:<br/>
292<br/>
<hr/>
<a name=317></a>Slicing and&#160;Dicing<br/>
[me@linuxbox ~]$&#160;<b>cut -f 2,2 distros-by-date.txt &gt; distros-vernums.txt<br/></b>[me@linuxbox ~]$&#160;<b>paste distros-dates.txt distros-vernums.txt &gt; distro<br/>s-key-vernums.txt<br/></b>[me@linuxbox ~]$&#160;<b>head distros-key-vernums.txt</b>&#160;<br/>11/25/2008<br/>
10&#160;<br/>
10/30/2008<br/>
8.10&#160;<br/>
06/19/2008<br/>
11.0&#160;<br/>
05/13/2008<br/>
9&#160;<br/>
04/24/2008<br/>
8.04&#160;<br/>
11/08/2007<br/>
8&#160;<br/>
10/18/2007<br/>
7.10&#160;<br/>
10/04/2007<br/>
10.3&#160;<br/>
05/31/2007<br/>
7&#160;<br/>
04/19/2007<br/>
7.04<br/>
We&#160;now&#160;have&#160;two files&#160;with&#160;a&#160;shared key (the&#160;“release&#160;date”&#160;field). It&#160;is&#160;important&#160;to&#160;point<br/>out&#160;that&#160;the&#160;files&#160;must&#160;be&#160;sorted on the&#160;key field&#160;for&#160;join&#160;to work properly.<br/>
[me@linuxbox ~]$&#160;<b>join distros-key-names.txt distros-key-vernums.txt |<br/>head&#160;<br/></b>11/25/2008 Fedora 10&#160;<br/>10/30/2008 Ubuntu 8.10&#160;<br/>06/19/2008 SUSE 11.0&#160;<br/>05/13/2008 Fedora 9&#160;<br/>04/24/2008 Ubuntu 8.04&#160;<br/>11/08/2007 Fedora 8&#160;<br/>10/18/2007 Ubuntu 7.10&#160;<br/>10/04/2007 SUSE 10.3&#160;<br/>05/31/2007 Fedora 7&#160;<br/>04/19/2007 Ubuntu 7.04<br/>
Note&#160;also&#160;that,&#160;by&#160;default,&#160;join&#160;uses&#160;whitespace&#160;as&#160;the&#160;input&#160;field&#160;delimiter&#160;and&#160;a&#160;single<br/>space&#160;as&#160;the&#160;output&#160;field&#160;delimiter.&#160;This&#160;behavior&#160;can&#160;be&#160;modified&#160;by&#160;specifying&#160;options.<br/>See&#160;the&#160;join&#160;man page&#160;for details.<br/>
<b>Comparing&#160;Text<br/></b>It&#160;is&#160;often&#160;useful&#160;to&#160;compare&#160;versions&#160;of&#160;text&#160;files. For&#160;system&#160;administrators&#160;and&#160;software<br/>developers,&#160;this&#160;is&#160;particularly&#160;important.&#160;A&#160;system&#160;administrator&#160;may,&#160;for&#160;example,&#160;need<br/>to&#160;compare&#160;an&#160;existing&#160;configuration&#160;file&#160;to&#160;a&#160;previous&#160;version&#160;to&#160;diagnose&#160;a&#160;system&#160;prob-<br/>lem.&#160;Likewise,&#160;a&#160;programmer&#160;frequently&#160;needs&#160;to&#160;see&#160;what&#160;changes&#160;have&#160;been&#160;made&#160;to<br/>
293<br/>
<hr/>
<a name=318></a>20 –&#160;Text&#160;Processing<br/>
programs&#160;over time.&#160;<br/>
comm<br/>The&#160;comm&#160;program&#160;compares&#160;two&#160;text&#160;files&#160;and&#160;displays&#160;the&#160;lines&#160;that&#160;are&#160;unique&#160;to&#160;each<br/>one&#160;and&#160;the&#160;lines&#160;they&#160;have&#160;in&#160;common.&#160;To&#160;demonstrate,&#160;we&#160;will&#160;create&#160;two&#160;nearly&#160;identi-<br/>cal&#160;text&#160;files&#160;using&#160;cat.<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; file1.txt&#160;<br/>a&#160;<br/>b&#160;<br/>c&#160;<br/>d<br/></b>[me@linuxbox ~]$&#160;<b>cat &gt; file2.txt&#160;<br/>b&#160;<br/>c&#160;<br/>d&#160;<br/>e</b><br/>
Next, we&#160;will&#160;compare&#160;the&#160;two files&#160;using&#160;comm:<br/>
[me@linuxbox ~]$&#160;<b>comm file1.txt file2.txt</b>&#160;<br/>a&#160;<br/>
b&#160;<br/>c&#160;<br/>d&#160;<br/>
e<br/>
As&#160;we&#160;can&#160;see,&#160;comm&#160;produces&#160;three&#160;columns&#160;of&#160;output.&#160;The&#160;first&#160;column&#160;contains&#160;lines<br/>unique&#160;to&#160;the&#160;first&#160;file&#160;argument,&#160;the&#160;second&#160;column&#160;contains&#160;the&#160;lines&#160;unique&#160;to&#160;the&#160;sec-<br/>ond&#160;file&#160;argument,&#160;and&#160;the&#160;third&#160;column&#160;contains&#160;the&#160;lines&#160;shared&#160;by&#160;both&#160;files.&#160;&#160;comm<br/>supports&#160;options&#160;in&#160;the&#160;form&#160;-<i>n</i>,&#160;where&#160;<i>n</i>&#160;is&#160;either&#160;1,&#160;2,&#160;or&#160;3.&#160;When&#160;used,&#160;these&#160;options<br/>specify&#160;which&#160;columns&#160;to&#160;suppress.&#160;For&#160;example,&#160;if&#160;we&#160;wanted&#160;to&#160;only&#160;output&#160;the&#160;lines<br/>shared&#160;by both files, we&#160;would&#160;suppress&#160;the&#160;output&#160;of the&#160;first&#160;and second&#160;columns.<br/>
[me@linuxbox ~]$&#160;<b>comm -12 file1.txt file2.txt</b>&#160;<br/>b&#160;<br/>c&#160;<br/>d<br/>
294<br/>
<hr/>
<a name=319></a>Comparing&#160;Text<br/>
diff<br/>Like&#160;the&#160;comm&#160;program,&#160;diff&#160;is&#160;used&#160;to&#160;detect&#160;the&#160;differences&#160;between&#160;files.&#160;However,<br/>diff&#160;is&#160;a&#160;much&#160;more&#160;complex&#160;tool,&#160;supporting&#160;many&#160;output&#160;formats&#160;and&#160;the&#160;ability&#160;to<br/>process&#160;large&#160;collections&#160;of&#160;text&#160;files&#160;at&#160;once.&#160;diff&#160;is&#160;often&#160;used&#160;by&#160;software&#160;developers<br/>to&#160;examine&#160;changes&#160;between&#160;different&#160;versions&#160;of&#160;program&#160;source&#160;code&#160;and&#160;thus&#160;has&#160;the<br/>ability&#160;to&#160;recursively&#160;examine&#160;directories&#160;of&#160;source&#160;code,&#160;often&#160;referred&#160;to&#160;as&#160;<i>source&#160;trees</i>.<br/>One&#160;common&#160;use&#160;for&#160;diff&#160;is&#160;the&#160;creation&#160;of&#160;<i>diff&#160;files</i>&#160;or&#160;<i>patches</i>&#160;that&#160;are&#160;used&#160;by&#160;pro-<br/>grams&#160;such&#160;as&#160;patch&#160;(which&#160;we’ll&#160;discuss&#160;shortly)&#160;to&#160;convert&#160;one&#160;version&#160;of&#160;a&#160;file&#160;(or<br/>files) to&#160;another&#160;version.<br/>If we&#160;use&#160;diff&#160;to look at&#160;our previous&#160;example&#160;files:<br/>
[me@linuxbox ~]$&#160;<b>diff file1.txt file2.txt&#160;<br/></b>1d0&#160;<br/>&lt; a&#160;<br/>4a4&#160;<br/>&gt; e<br/>
we&#160;see&#160;its&#160;default&#160;style&#160;of&#160;output:&#160;a&#160;terse&#160;description&#160;of&#160;the&#160;differences&#160;between&#160;the&#160;two<br/>files.&#160;In&#160;the&#160;default&#160;format,&#160;each&#160;group&#160;of&#160;changes&#160;is&#160;preceded&#160;by&#160;a&#160;<i>change&#160;command</i>&#160;in<br/>the&#160;form&#160;of&#160;<i>range</i>&#160;<i>operation</i>&#160;<i>range</i>&#160;to&#160;describe&#160;the&#160;positions&#160;and&#160;types&#160;of changes&#160;required<br/>to convert&#160;the&#160;first&#160;file&#160;to the&#160;second file,&#160;as&#160;outlined&#160;in&#160;Table&#160;20-4.<br/>
<i>Table&#160;20-4:&#160;diff&#160;Change&#160;Commands</i><br/>
<b>Change</b><br/>
<b>Description</b><br/>
<i>r1</i>a<i>r2</i><br/>
Append&#160;the&#160;lines&#160;at&#160;the&#160;position&#160;<i>r2</i>&#160;in&#160;the&#160;second file&#160;to&#160;the&#160;position&#160;<br/><i>r1</i>&#160;in&#160;the&#160;first&#160;file.<br/>
<i>r1</i>c<i>r2</i><br/>
Change&#160;(replace)&#160;the&#160;lines&#160;at&#160;position&#160;<i>r1</i>&#160;with the&#160;lines&#160;at&#160;the&#160;<br/>position&#160;<i>r2</i>&#160;in the&#160;second file.<br/>
<i>r1</i>d<i>r2</i><br/>
Delete&#160;the&#160;lines&#160;in the&#160;first&#160;file&#160;at&#160;position&#160;<i>r1</i>, which would have&#160;<br/>appeared&#160;at&#160;range&#160;<i>r2</i>&#160;in&#160;the&#160;second file<br/>
In&#160;this&#160;format,&#160;a&#160;range&#160;is&#160;a&#160;comma-separated&#160;list&#160;of&#160;the&#160;starting&#160;line&#160;and&#160;the&#160;ending&#160;line.<br/>While&#160;this&#160;format&#160;is&#160;the&#160;default&#160;(mostly&#160;for&#160;POSIX&#160;compliance&#160;and&#160;backward&#160;compatibil-<br/>ity&#160;with&#160;traditional&#160;Unix&#160;versions&#160;of&#160;diff),&#160;it&#160;is&#160;not&#160;as&#160;widely&#160;used&#160;as&#160;other,&#160;optional&#160;for-<br/>mats.&#160;Two of the&#160;more&#160;popular&#160;formats&#160;are&#160;the&#160;<i>context&#160;format</i>&#160;and the&#160;<i>unified format</i>.<br/>When viewed&#160;using&#160;the&#160;context&#160;format&#160;(the&#160;-c&#160;option),&#160;we&#160;will&#160;see&#160;this:<br/>
295<br/>
<hr/>
<a name=320></a>20 –&#160;Text&#160;Processing<br/>
[me@linuxbox ~]$&#160;<b>diff -c file1.txt file2.txt&#160;<br/></b>*** file1.txt2008-12-23 06:40:13.000000000 -0500&#160;<br/>--- file2.txt2008-12-23 06:40:34.000000000 -0500&#160;<br/>***************&#160;<br/>*** 1,4 ****&#160;<br/>- a&#160;<br/>&#160; b&#160;<br/>&#160; c&#160;<br/>&#160; d&#160;<br/>--- 1,4 ----&#160;<br/>&#160; b&#160;<br/>&#160; c&#160;<br/>&#160; d&#160;<br/>+ e<br/>
The&#160;output&#160;begins&#160;with&#160;the&#160;names&#160;of&#160;the&#160;two&#160;files&#160;and&#160;their&#160;timestamps.&#160;The&#160;first&#160;file&#160;is<br/>marked&#160;with&#160;asterisks&#160;and&#160;the&#160;second&#160;file&#160;is&#160;marked&#160;with&#160;dashes.&#160;Throughout&#160;the&#160;remain-<br/>der&#160;of&#160;the&#160;listing,&#160;these&#160;markers&#160;will&#160;signify&#160;their&#160;respective&#160;files.&#160;Next,&#160;we&#160;see&#160;groups&#160;of<br/>changes,&#160;including&#160;the&#160;default&#160;number&#160;of&#160;surrounding&#160;context&#160;lines.&#160;In&#160;the&#160;first&#160;group,&#160;we<br/>see&#160;this:<br/>*** 1,4 ***<br/>which indicates&#160;lines&#160;1 through 4 in&#160;the&#160;first&#160;file.&#160;Later&#160;we&#160;see&#160;this:<br/>--- 1,4 ---<br/>which&#160;indicates&#160;lines&#160;1&#160;through&#160;4&#160;in&#160;the&#160;second&#160;file.&#160;Within&#160;a&#160;change&#160;group,&#160;lines&#160;begin<br/>with one&#160;of four indicators&#160;shown in&#160;Table&#160;20-5.<br/>
<i>Table&#160;20-5:&#160;diff&#160;Context&#160;Format&#160;Change&#160;Indicators</i><br/>
<b>Indicator</b><br/>
<b>Meaning</b><br/>
blank<br/>
A&#160;line&#160;shown for context. It&#160;does&#160;not&#160;indicate&#160;a&#160;difference&#160;between&#160;<br/>the&#160;two files.<br/>
-<br/>
A&#160;line&#160;deleted.&#160;This&#160;line&#160;will&#160;appear&#160;in the&#160;first&#160;file&#160;but&#160;not&#160;in&#160;the&#160;<br/>second file.<br/>
+<br/>
A&#160;line&#160;added.&#160;This&#160;line&#160;will&#160;appear&#160;in the&#160;second file&#160;but&#160;not&#160;in&#160;the&#160;<br/>first&#160;file.<br/>
!<br/>
A&#160;line&#160;changed.&#160;The&#160;two versions&#160;of the&#160;line&#160;will&#160;be&#160;displayed, each&#160;<br/>in its&#160;respective&#160;section&#160;of the&#160;change&#160;group.<br/>
296<br/>
<hr/>
<a name=321></a>Comparing&#160;Text<br/>
The&#160;unified&#160;format&#160;is&#160;similar&#160;to&#160;the&#160;context&#160;format&#160;but&#160;is&#160;more&#160;concise.&#160;It&#160;is&#160;specified<br/>with the&#160;-u&#160;option.<br/>
[me@linuxbox ~]$&#160;<b>diff -u file1.txt file2.txt</b>&#160;<br/>--- file1.txt2008-12-23 06:40:13.000000000 -0500&#160;<br/>+++ file2.txt2008-12-23 06:40:34.000000000 -0500&#160;<br/>@@ -1,4 +1,4 @@&#160;<br/>-a&#160;<br/>&#160;b&#160;<br/>&#160;c&#160;<br/>&#160;d&#160;<br/>+e<br/>
The&#160;most&#160;notable&#160;difference&#160;between&#160;the&#160;context&#160;and&#160;unified&#160;formats&#160;is&#160;the&#160;elimination&#160;of<br/>the&#160;duplicated&#160;lines&#160;of&#160;context,&#160;making&#160;the&#160;results&#160;of&#160;the&#160;unified&#160;format&#160;shorter&#160;than&#160;those<br/>of&#160;the&#160;context&#160;format.&#160;In&#160;our&#160;previous&#160;example,&#160;we&#160;see&#160;file&#160;timestamps&#160;like&#160;those&#160;of&#160;the<br/>context&#160;format,&#160;followed&#160;by&#160;the&#160;string&#160;@@&#160;-1,4&#160;+1,4&#160;@@.&#160;This&#160;indicates&#160;the&#160;lines&#160;in<br/>the&#160;first&#160;file&#160;and&#160;the&#160;lines&#160;in&#160;the&#160;second&#160;file&#160;described&#160;in&#160;the&#160;change&#160;group.&#160;Following&#160;this<br/>are&#160;the&#160;lines&#160;themselves,&#160;with&#160;the&#160;default&#160;three&#160;lines&#160;of&#160;context.&#160;Each&#160;line&#160;starts&#160;with&#160;one<br/>of three&#160;possible&#160;characters&#160;listed in&#160;Table&#160;20-6.<br/>
<i>Table&#160;20-6:&#160;diff&#160;Unified Format&#160;Change&#160;Indicators</i><br/>
<b>Character</b><br/>
<b>Meaning</b><br/>
blank<br/>
This&#160;line&#160;is&#160;shared by both&#160;files.<br/>
-<br/>
This&#160;line&#160;was&#160;removed from&#160;the&#160;first&#160;file.<br/>
+<br/>
This&#160;line&#160;was&#160;added to the&#160;first&#160;file.<br/>
patch<br/>The&#160;patch&#160;program&#160;is&#160;used&#160;to&#160;apply&#160;changes&#160;to&#160;text&#160;files.&#160;It&#160;accepts&#160;output&#160;from&#160;diff<br/>and&#160;is&#160;generally&#160;used&#160;to&#160;convert&#160;older&#160;version&#160;files&#160;into&#160;newer&#160;versions.&#160;Let’s&#160;consider&#160;a<br/>famous&#160;example.&#160;The&#160;&#160;Linux&#160;&#160;kernel&#160;&#160;is&#160;developed&#160;by&#160;a&#160;large,&#160;loosely&#160;organized&#160;team&#160;of<br/>contributors&#160;who&#160;submit&#160;a&#160;constant&#160;stream&#160;of&#160;small&#160;changes&#160;to&#160;the&#160;source&#160;code.&#160;The<br/>Linux&#160;kernel&#160;consists&#160;of&#160;several&#160;million&#160;lines&#160;of&#160;code,&#160;while&#160;the&#160;changes&#160;that&#160;are&#160;made&#160;by<br/>one&#160;contributor&#160;at&#160;one&#160;time&#160;are&#160;quite&#160;small.&#160;It&#160;makes&#160;no&#160;sense&#160;for&#160;a&#160;contributor&#160;to&#160;send<br/>each&#160;developer&#160;an&#160;entire&#160;kernel&#160;source&#160;tree&#160;each&#160;time&#160;a&#160;small&#160;change&#160;is&#160;made.&#160;Instead,&#160;a<br/>diff&#160;file&#160;is&#160;submitted.&#160;The&#160;diff&#160;file&#160;contains&#160;the&#160;change&#160;from&#160;the&#160;previous&#160;version&#160;of&#160;the<br/>kernel&#160;to&#160;the&#160;new&#160;version&#160;with&#160;the&#160;contributor's&#160;changes.&#160;The&#160;receiver&#160;then&#160;uses&#160;the<br/>
297<br/>
<hr/>
<a name=322></a>20 –&#160;Text&#160;Processing<br/>
patch&#160;program&#160;to&#160;apply&#160;the&#160;change&#160;to&#160;his&#160;own&#160;source&#160;tree.&#160;Using&#160;diff/patch&#160;offers<br/>two significant&#160;advantages.<br/>
1.&#160;The&#160;diff&#160;file&#160;is&#160;small, compared to&#160;the&#160;full&#160;size&#160;of the&#160;source&#160;tree.<br/>2.&#160;The&#160;diff&#160;file&#160;concisely&#160;shows&#160;the&#160;change&#160;being&#160;made,&#160;allowing&#160;reviewers&#160;of&#160;the<br/>
patch&#160;to quickly&#160;evaluate&#160;it.<br/>
Of&#160;course,&#160;&#160;diff/patch&#160;&#160;will&#160;work&#160;on&#160;any&#160;text&#160;file,&#160;not&#160;just&#160;source&#160;code.&#160;It&#160;would&#160;be<br/>equally&#160;applicable&#160;to configuration&#160;files&#160;or any&#160;other text.<br/>To&#160;prepare&#160;a&#160;diff&#160;file&#160;for&#160;use&#160;with&#160;patch,&#160;the&#160;GNU&#160;documentation&#160;(see&#160;Further&#160;Reading<br/>below) suggests&#160;using&#160;diff&#160;as&#160;follows:<br/>diff -Naur&#160;<i>old_file</i>&#160;<i>new_file</i>&#160;&gt;&#160;<i>diff_file<br/></i>where&#160;&#160;<i>old_file</i>&#160;and&#160;&#160;<i>new_file</i>&#160;are&#160;either&#160;single&#160;files&#160;or&#160;directories&#160;containing&#160;files.&#160;The&#160;r<br/>option supports&#160;recursion&#160;of a&#160;directory tree.<br/>Once&#160;the&#160;diff file&#160;has&#160;been created, we&#160;can&#160;apply it&#160;to patch the&#160;old file&#160;into&#160;the&#160;new&#160;file.<br/>patch &lt;&#160;<i>diff_file<br/></i>We’ll&#160;demonstrate&#160;with our test&#160;file.<br/>
[me@linuxbox ~]$&#160;<b>diff -Naur file1.txt file2.txt &gt; patchfile.txt<br/></b>[me@linuxbox ~]$&#160;<b>patch &lt; patchfile.txt</b>&#160;<br/>patching file file1.txt<br/>[me@linuxbox ~]$&#160;<b>cat file1.txt</b>&#160;<br/>b&#160;<br/>c&#160;<br/>d&#160;<br/>e<br/>
In&#160;this&#160;&#160;example,&#160;&#160;we&#160;created&#160;&#160;a&#160;&#160;diff&#160;&#160;file&#160;&#160;named&#160;&#160;patchfile.txt&#160;&#160;and&#160;then&#160;used&#160;the<br/>patch&#160;program&#160;to&#160;apply&#160;the&#160;patch.&#160;Note&#160;that&#160;we&#160;did&#160;not&#160;have&#160;to&#160;specify&#160;a&#160;target&#160;file&#160;to<br/>patch,&#160;as&#160;the&#160;diff&#160;file&#160;(in&#160;unified&#160;format)&#160;already&#160;contains&#160;the&#160;filenames&#160;in&#160;the&#160;header.<br/>Once&#160;the&#160;patch is&#160;applied,&#160;we&#160;can&#160;see&#160;that&#160;file1.txt&#160;now&#160;matches&#160;file2.txt.<br/>
patch&#160;has&#160;a&#160;large&#160;number&#160;of&#160;options,&#160;and&#160;there&#160;are&#160;additional&#160;utility&#160;programs&#160;that&#160;can<br/>be&#160;used to analyze&#160;and edit&#160;patches.<br/>
<b>Editing&#160;on&#160;the&#160;Fly<br/></b>Our&#160;experience&#160;with&#160;text&#160;editors&#160;has&#160;been&#160;largely&#160;<i>interactive</i>,&#160;meaning&#160;that&#160;we&#160;manually<br/>move&#160;a&#160;cursor&#160;around&#160;and&#160;then&#160;type&#160;our&#160;changes.&#160;However,&#160;there&#160;are&#160;&#160;<i>non-interactive<br/></i>ways&#160;to&#160;edit&#160;text&#160;as&#160;well.&#160;It’s&#160;possible,&#160;for&#160;example,&#160;to&#160;apply&#160;a&#160;set&#160;of&#160;changes&#160;to&#160;multiple<br/>
298<br/>
<hr/>
<a name=323></a>Editing&#160;on the&#160;Fly<br/>
files&#160;with&#160;a&#160;single&#160;command.&#160;<br/>
tr<br/>The&#160;tr&#160;program&#160;is&#160;used&#160;to&#160;<i>transliterate</i>&#160;characters.&#160;We&#160;can&#160;think&#160;of&#160;this&#160;as&#160;a&#160;sort&#160;of&#160;char-<br/>acter-based&#160;search-and-replace&#160;operation.&#160;Transliteration&#160;is&#160;the&#160;process&#160;of&#160;changing&#160;char-<br/>acters&#160;from&#160;one&#160;alphabet&#160;to&#160;another.&#160;For&#160;example,&#160;converting&#160;characters&#160;from&#160;lowercase<br/>to uppercase&#160;is&#160;transliteration.&#160;We&#160;can perform&#160;such a&#160;conversion&#160;with&#160;tr&#160;as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;lowercase letters&#34; | tr a-z A-Z</b>&#160;<br/>LOWERCASE LETTERS<br/>
As&#160;we&#160;can&#160;see,&#160;tr&#160;operates&#160;on&#160;standard&#160;input,&#160;and&#160;outputs&#160;its&#160;results&#160;on&#160;standard&#160;output.<br/>tr&#160;accepts&#160;two&#160;arguments:&#160;a&#160;set&#160;of&#160;characters&#160;to&#160;convert&#160;from&#160;and&#160;a&#160;corresponding&#160;set&#160;of<br/>characters&#160;to convert&#160;to.&#160;Character&#160;sets&#160;may be&#160;expressed&#160;in one&#160;of three&#160;ways.<br/>
1.&#160;An enumerated list.&#160;For example,&#160;ABCDEFGHIJKLMNOPQRSTUVWXYZ<br/>2.&#160;A&#160;character&#160;range.&#160;For&#160;example,&#160;A-Z.&#160;Note&#160;that&#160;this&#160;method&#160;is&#160;sometimes&#160;subject<br/>
to&#160;the&#160;same&#160;issues&#160;as&#160;other&#160;commands,&#160;because&#160;of&#160;the&#160;locale&#160;collation&#160;order,&#160;and<br/>thus&#160;should&#160;be&#160;used with caution.<br/>
3.&#160;POSIX&#160;character classes. For example,&#160;[:upper:].<br/>
In&#160;most&#160;cases,&#160;both&#160;character&#160;sets&#160;should&#160;be&#160;of&#160;equal&#160;length;&#160;however,&#160;it&#160;is&#160;possible&#160;for<br/>the&#160;first&#160;set&#160;to&#160;be&#160;larger&#160;than&#160;the&#160;second,&#160;particularly&#160;if&#160;we&#160;want&#160;to&#160;convert&#160;multiple&#160;char-<br/>acters&#160;to a&#160;single&#160;character.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;lowercase letters&#34; | tr [:lower:] A</b>&#160;<br/>AAAAAAAAA AAAAAAA<br/>
In&#160;addition&#160;to&#160;transliteration,&#160;&#160;tr&#160;&#160;allows&#160;characters&#160;to&#160;simply&#160;be&#160;deleted&#160;from&#160;the&#160;input<br/>stream.&#160;Earlier&#160;in&#160;this&#160;chapter,&#160;we&#160;discussed the&#160;problem&#160;of&#160;converting&#160;MS-DOS&#160;text&#160;files<br/>to&#160;Unix-style&#160;text.&#160;To&#160;perform&#160;this&#160;conversion,&#160;carriage&#160;return&#160;characters&#160;need&#160;to&#160;be&#160;re-<br/>moved from&#160;the&#160;end&#160;of each line.&#160;This&#160;can&#160;be&#160;performed&#160;with&#160;tr&#160;as&#160;follows:<br/>tr -d '\r' &lt;&#160;<i>dos_file</i>&#160;&gt;&#160;<i>unix_file<br/></i>where&#160;<i>dos_file</i>&#160;is&#160;the&#160;file&#160;to&#160;be&#160;converted&#160;and&#160;<i>unix_file</i>&#160;is&#160;the&#160;result.&#160;This&#160;form&#160;of&#160;the&#160;com-<br/>mand&#160;uses&#160;the&#160;escape&#160;sequence&#160;&#160;\r&#160;&#160;to&#160;represent&#160;the&#160;carriage&#160;return&#160;character.&#160;To&#160;see&#160;a<br/>complete&#160;list&#160;of the&#160;sequences&#160;and&#160;character&#160;classes&#160;tr&#160;supports, try&#160;the&#160;following:<br/>
299<br/>
<hr/>
<a name=324></a>20 –&#160;Text&#160;Processing<br/>
[me@linuxbox ~]$&#160;<b>tr --help</b><br/>
<b>ROT13:&#160;The&#160;Not-So-Secret&#160;Decoder&#160;Ring</b><br/>
One&#160;amusing&#160;use&#160;of&#160;tr&#160;is&#160;to&#160;perform&#160;<i>ROT13&#160;encoding</i>&#160;of&#160;text.&#160;ROT13&#160;is&#160;a&#160;trivial<br/>type&#160;of&#160;encryption&#160;based&#160;on&#160;a&#160;simple&#160;substitution&#160;cipher.&#160;Calling&#160;ROT13&#160;“encryp-<br/>tion”&#160;is&#160;being&#160;generous;&#160;“text&#160;obfuscation”&#160;is&#160;more&#160;accurate.&#160;It&#160;is&#160;used&#160;sometimes<br/>on&#160;text&#160;to&#160;obscure&#160;potentially&#160;offensive&#160;content.&#160;The&#160;method&#160;simply&#160;moves&#160;each<br/>character&#160;13 places&#160;up the&#160;alphabet.&#160;Since&#160;this&#160;is&#160;half&#160;way up&#160;the&#160;possible&#160;26&#160;char-<br/>acters,&#160;performing the&#160;algorithm&#160;a&#160;second time&#160;on the&#160;text&#160;restores&#160;it&#160;to its&#160;original<br/>form. Use&#160;the&#160;following&#160;to perform&#160;this&#160;encoding with&#160;tr:<br/><b>echo &#34;secret text&#34; | tr a-zA-Z n-za-mN-ZA-M</b>&#160;<br/>frperg grkg<br/>
Performing the&#160;same&#160;procedure&#160;a&#160;second&#160;time&#160;results&#160;in&#160;the&#160;following&#160;translation:<br/>
<b>echo &#34;frperg grkg&#34; | tr a-zA-Z n-za-mN-ZA-M</b>&#160;<br/>secret text<br/>
A&#160;number&#160;of&#160;email&#160;programs&#160;and&#160;Usenet&#160;news&#160;readers&#160;support&#160;ROT13&#160;encoding.<br/>Wikipedia&#160;contains&#160;a&#160;good article&#160;on the&#160;subject:<br/><a href="http://en.wikipedia.org/wiki/ROT13">http://en.wikipedia.org/wiki/ROT13</a><br/>
tr&#160;&#160;can&#160;perform&#160;another&#160;trick,&#160;too.&#160;Using&#160;the&#160;&#160;-s&#160;&#160;option,&#160;&#160;tr&#160;&#160;can&#160;“squeeze”&#160;(delete)&#160;re-<br/>peated&#160;instances&#160;of a&#160;character.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;aaabbbccc&#34; | tr -s ab&#160;<br/></b>abccc<br/>
Here&#160;we&#160;have&#160;a&#160;string&#160;containing&#160;repeated&#160;characters.&#160;By&#160;specifying&#160;the&#160;set&#160;“ab”&#160;to&#160;tr,<br/>we&#160;eliminate&#160;the&#160;repeated&#160;instances&#160;of&#160;the&#160;letters&#160;in&#160;the&#160;set,&#160;while&#160;leaving&#160;the&#160;character<br/>that&#160;is&#160;missing&#160;from&#160;the&#160;set&#160;(“c”)&#160;unchanged.&#160;Note&#160;that&#160;the&#160;repeating&#160;characters&#160;must&#160;be<br/>adjoining. If they&#160;are&#160;not, the&#160;squeezing&#160;will&#160;have&#160;no effect.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;abcabcabc&#34; | tr -s ab</b>&#160;<br/>abcabcabc<br/>
300<br/>
<hr/>
<a name=325></a>Editing&#160;on the&#160;Fly<br/>
sed<br/>The&#160;name&#160;sed&#160;is&#160;short&#160;for&#160;<i>stream&#160;editor</i>.&#160;It&#160;performs&#160;text&#160;editing&#160;on&#160;a&#160;stream&#160;of&#160;text,&#160;ei-<br/>ther&#160;a&#160;set&#160;of&#160;specified&#160;files&#160;or&#160;standard&#160;input.&#160;sed&#160;is&#160;a&#160;powerful&#160;and&#160;somewhat&#160;complex<br/>program&#160;(there&#160;are&#160;entire&#160;books&#160;about&#160;it),&#160;so we&#160;will&#160;not&#160;cover&#160;it&#160;completely&#160;here.<br/>In&#160;general,&#160;the&#160;way&#160;sed&#160;works&#160;is&#160;that&#160;it&#160;is&#160;given&#160;either&#160;a&#160;single&#160;editing&#160;command&#160;(on&#160;the<br/>command&#160;line)&#160;or&#160;the&#160;name&#160;of&#160;a&#160;script&#160;file&#160;containing&#160;multiple&#160;commands,&#160;and&#160;it&#160;then<br/>performs&#160;these&#160;commands&#160;upon&#160;each&#160;line&#160;in&#160;the&#160;stream&#160;of&#160;text.&#160;Here&#160;is&#160;a&#160;&#160;simple&#160;example<br/>of&#160;sed&#160;in action:<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;front&#34; | sed 's/front/back/'<br/></b>back<br/>
In&#160;this&#160;example,&#160;we&#160;produce&#160;a&#160;one-word&#160;stream&#160;of&#160;text&#160;using&#160;echo&#160;and&#160;pipe&#160;it&#160;into&#160;sed.<br/>sed,&#160;in&#160;turn,&#160;carries&#160;out&#160;the&#160;instruction&#160;s/front/back/&#160;upon&#160;the&#160;text&#160;in&#160;the&#160;stream<br/>and&#160;produces&#160;the&#160;output&#160;“back”&#160;as&#160;a&#160;result.&#160;We&#160;can&#160;also&#160;recognize&#160;this&#160;command&#160;as&#160;re-<br/>sembling&#160;the&#160;“substitution”&#160;(search-and-replace)&#160;command&#160;in&#160;vi.<br/>Commands&#160;in&#160;&#160;sed&#160;begin&#160;with&#160;a&#160;single&#160;letter.&#160;In&#160;the&#160;previous&#160;example,&#160;the&#160;substitution<br/>command&#160;is&#160;represented&#160;by&#160;the&#160;letter&#160;s&#160;and&#160;is&#160;followed&#160;by&#160;the&#160;search-and-replace&#160;strings,<br/>separated&#160;by&#160;the&#160;slash&#160;character&#160;as&#160;a&#160;delimiter.&#160;The&#160;choice&#160;of&#160;the&#160;delimiter&#160;character&#160;is&#160;ar-<br/>bitrary.&#160;By&#160;convention,&#160;the&#160;slash&#160;character&#160;is&#160;often&#160;used,&#160;but&#160;sed&#160;will&#160;accept&#160;any&#160;charac-<br/>ter&#160;that&#160;immediately&#160;follows&#160;the&#160;command&#160;as&#160;the&#160;delimiter.&#160;We&#160;could&#160;perform&#160;the&#160;same<br/>command&#160;this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;front&#34; | sed 's_front_back_'</b>&#160;<br/>back<br/>
By&#160;using&#160;the&#160;underscore&#160;character&#160;immediately&#160;after&#160;the&#160;command,&#160;it&#160;becomes&#160;the&#160;delim-<br/>iter.&#160;The&#160;ability&#160;to&#160;set&#160;the&#160;delimiter&#160;can&#160;be&#160;used&#160;to&#160;make&#160;commands&#160;more&#160;readable,&#160;as&#160;we<br/>shall&#160;see.<br/>Most&#160;commands&#160;in&#160;sed&#160;may&#160;be&#160;preceded&#160;by&#160;an&#160;<i>address</i>,&#160;which&#160;specifies&#160;which&#160;line(s)&#160;of<br/>the&#160;input&#160;stream&#160;will&#160;be&#160;edited.&#160;If the&#160;address&#160;is&#160;omitted,&#160;then&#160;the&#160;editing&#160;command&#160;is&#160;car-<br/>ried&#160;out&#160;on&#160;every&#160;line&#160;in&#160;the&#160;input&#160;stream.&#160;The&#160;simplest&#160;form&#160;of&#160;address&#160;is&#160;a&#160;line&#160;number.<br/>We&#160;can add one&#160;to our example.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;front&#34; | sed '1s/front/back/'&#160;<br/></b>back<br/>
301<br/>
<hr/>
<a name=326></a>20 –&#160;Text&#160;Processing<br/>
Adding&#160;the&#160;address&#160;1&#160;to&#160;our command&#160;causes&#160;our substitution&#160;to be&#160;performed on the&#160;first<br/>line&#160;of&#160;our&#160;one-line&#160;input&#160;stream.&#160;If&#160;we&#160;specify&#160;another&#160;number&#160;and&#160;we&#160;see&#160;that&#160;the&#160;edit-<br/>ing is&#160;not&#160;carried&#160;out, since&#160;our input&#160;stream&#160;does&#160;not&#160;have&#160;a&#160;line&#160;2.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;front&#34; | sed '2s/front/back/'</b>&#160;<br/>front<br/>
Addresses&#160;may&#160;be&#160;expressed in many&#160;ways.&#160;Table&#160;20-7 lists&#160;the&#160;most&#160;common.<br/>
<i>Table&#160;20-7:&#160;sed&#160;Address&#160;Notation</i><br/>
<b>Address</b><br/>
<b>Description</b><br/>
<i>n</i><br/>
A&#160;line&#160;number&#160;where&#160;<i>n</i>&#160;is&#160;a&#160;positive&#160;integer.<br/>
$<br/>
The&#160;last&#160;line.<br/>
/<i>regexp</i>/<br/>
Lines&#160;matching a&#160;POSIX&#160;basic&#160;regular&#160;expression.&#160;Note&#160;that&#160;the<br/>regular expression is&#160;delimited by slash characters.&#160;Optionally,&#160;<br/>the&#160;regular&#160;expression may be&#160;delimited&#160;by an alternate&#160;<br/>character, by specifying&#160;the&#160;expression&#160;with&#160;\<i>cregexpc</i>,&#160;<br/>where&#160;<i>c</i>&#160;is&#160;the&#160;alternate&#160;character.<br/>
<i>addr1</i>,<i>addr2</i><br/>
A&#160;range&#160;of lines&#160;from&#160;<i>addr1</i>&#160;to&#160;<i>addr2</i>, inclusive.&#160;Addresses&#160;may<br/>be&#160;any of the&#160;single&#160;address&#160;forms&#160;listed&#160;earlier.<br/>
<i>first</i>~<i>step</i><br/>
Match&#160;the&#160;line&#160;represented by the&#160;number&#160;<i>first</i>, then each&#160;<br/>subsequent&#160;line&#160;at&#160;<i>step</i>&#160;intervals. For example&#160;1~2 refers&#160;to&#160;<br/>each odd numbered&#160;line,&#160;and 5~5 refers&#160;to the&#160;fifth&#160;line&#160;and&#160;<br/>every&#160;fifth line&#160;thereafter.<br/>
<i>addr1</i>,+n<br/>
Match&#160;<i>addr1</i>&#160;and&#160;the&#160;following&#160;<i>n</i>&#160;lines.<br/>
<i>addr</i>!<br/>
Match&#160;all&#160;lines&#160;except&#160;<i>addr</i>, which may&#160;be&#160;any of the&#160;forms&#160;<br/>listed earlier.<br/>
We’ll&#160;demonstrate&#160;different&#160;kinds&#160;of&#160;addresses&#160;using&#160;the&#160;distros.txt&#160;file&#160;from&#160;earlier<br/>in this&#160;chapter.&#160;First, here’s&#160;a&#160;range&#160;of line&#160;numbers:<br/>
[me@linuxbox ~]$&#160;<b>sed -n '1,5p' distros.txt</b>&#160;<br/>SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
302<br/>
<hr/>
<a name=327></a>Editing&#160;on the&#160;Fly<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007<br/>
In&#160;this&#160;example,&#160;we&#160;print&#160;a&#160;range&#160;of&#160;lines,&#160;starting&#160;with&#160;line&#160;1&#160;and&#160;continuing&#160;to&#160;line&#160;5.&#160;To<br/>do&#160;this,&#160;we&#160;use&#160;the&#160;p&#160;command,&#160;which&#160;simply&#160;causes&#160;a&#160;matched&#160;line&#160;to&#160;be&#160;printed.&#160;For<br/>this&#160;to&#160;be&#160;effective,&#160;however,&#160;we&#160;must&#160;include&#160;the&#160;option&#160;-n&#160;(the&#160;“no&#160;auto-print”&#160;option)<br/>to cause&#160;sed&#160;not&#160;to print&#160;every&#160;line&#160;by default.<br/>Next, we’ll&#160;try a&#160;regular expression.<br/>
[me@linuxbox ~]$&#160;<b>sed -n '/SUSE/p' distros.txt</b>&#160;<br/>SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
SUSE<br/>
10.1<br/>
05/11/2006<br/>
By&#160;including&#160;the&#160;slash-delimited&#160;regular&#160;expression&#160;/SUSE/,&#160;we&#160;are&#160;able&#160;to&#160;isolate&#160;the<br/>lines&#160;containing&#160;it&#160;in much the&#160;same&#160;manner as&#160;grep.<br/>Finally,&#160;we’ll&#160;try negation by adding&#160;an exclamation point&#160;(!) to the&#160;address.<br/>
[me@linuxbox ~]$&#160;<b>sed -n '/SUSE/!p' distros.txt&#160;<br/></b>Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007&#160;<br/>
Fedora<br/>
6<br/>
10/24/2006&#160;<br/>
Fedora<br/>
9<br/>
05/13/2008&#160;<br/>
Ubuntu<br/>
6.06<br/>
06/01/2006&#160;<br/>
Ubuntu<br/>
8.10<br/>
10/30/2008&#160;<br/>
Fedora<br/>
5<br/>
03/20/2006<br/>
Here&#160;we&#160;see&#160;the&#160;expected&#160;result:&#160;all&#160;the&#160;lines&#160;in&#160;the&#160;file&#160;except&#160;the&#160;ones&#160;matched&#160;by&#160;the<br/>regular&#160;expression.<br/>So&#160;far,&#160;we’ve&#160;looked&#160;at&#160;two&#160;of&#160;the&#160;sed&#160;editing&#160;commands,&#160;s&#160;and&#160;p.&#160;Table&#160;20-8&#160;provides<br/>a&#160;more&#160;complete&#160;list&#160;of the&#160;basic&#160;editing commands.<br/>
303<br/>
<hr/>
<a name=328></a>20 –&#160;Text&#160;Processing<br/>
<i>Table&#160;20-8:&#160;sed&#160;Basic&#160;Editing Commands</i><br/>
<b>Command</b><br/>
<b>Description</b><br/>
=<br/>
Output&#160;the&#160;current&#160;line&#160;number.<br/>
a<br/>
Append text&#160;after&#160;the&#160;current&#160;line.<br/>
d<br/>
Delete&#160;the&#160;current&#160;line.<br/>
i<br/>
Insert&#160;text&#160;in&#160;front&#160;of the&#160;current&#160;line.<br/>
p<br/>
Print&#160;the&#160;current&#160;line. By default,&#160;sed&#160;prints&#160;every<br/>line&#160;and only&#160;edits&#160;lines&#160;that&#160;match a&#160;specified&#160;<br/>address&#160;within&#160;the&#160;file.&#160;The&#160;default&#160;behavior&#160;can&#160;<br/>be&#160;overridden by specifying the&#160;-n&#160;option.<br/>
q<br/>
Exit&#160;sed&#160;without&#160;processing any more&#160;lines.&#160;If the<br/>-n&#160;option&#160;is&#160;not&#160;specified, output&#160;the&#160;current&#160;line.<br/>
Q<br/>
Exit&#160;sed&#160;without&#160;processing any more&#160;lines.<br/>
s/<i>regexp</i>/<i>replacement</i>/<br/>
Substitute&#160;the&#160;contents&#160;of&#160;<i>replacement</i>&#160;wherever&#160;<br/><i>regexp</i>&#160;is&#160;found.&#160;<i>replacement</i>&#160;may include&#160;the&#160;<br/>special&#160;character&#160;&amp;, which is&#160;equivalent&#160;to the&#160;text&#160;<br/>matched&#160;by&#160;<i>regexp</i>. In addition,&#160;<i>replacement</i>&#160;may&#160;<br/>include&#160;the&#160;sequences&#160;\1&#160;through&#160;\9, which are&#160;<br/>the&#160;contents&#160;of the&#160;corresponding&#160;subexpressions&#160;<br/>in&#160;<i>regexp</i>. For more&#160;about&#160;this, see&#160;the&#160;discussion&#160;<br/>of&#160;<i>back&#160;references</i>&#160;below.&#160;After&#160;the&#160;trailing slash&#160;<br/>following&#160;<i>replacement</i>, an&#160;optional&#160;flag may&#160;be&#160;<br/>specified to&#160;modify the&#160;s&#160;command’s&#160;behavior.<br/>
y/<i>set1</i>/<i>set2</i><br/>
Perform&#160;transliteration by converting characters&#160;<br/>from&#160;<i>set1</i>&#160;to&#160;the&#160;corresponding&#160;characters&#160;in&#160;<i>set2</i>.&#160;<br/>Note&#160;that&#160;unlike&#160;tr,&#160;sed&#160;requires&#160;that&#160;both sets&#160;be<br/>of the&#160;same&#160;length.<br/>
&#160;<br/>The&#160;s&#160;command&#160;is&#160;by&#160;far&#160;the&#160;most&#160;commonly&#160;used&#160;editing&#160;command.&#160;We&#160;will&#160;demon-<br/>strate&#160;just&#160;some&#160;of&#160;its&#160;power&#160;by&#160;performing&#160;an&#160;edit&#160;on&#160;our&#160;distros.txt&#160;file.&#160;We&#160;dis-<br/>cussed&#160;earlier how&#160;the&#160;date&#160;field in&#160;distros.txt&#160;was&#160;not&#160;in&#160;a&#160;“computer-friendly”&#160;for-<br/>mat.&#160;While&#160;the&#160;date&#160;is&#160;formatted&#160;MM/DD/YYYY,&#160;it&#160;would&#160;be&#160;better&#160;(for&#160;ease&#160;of&#160;sorting)<br/>if&#160;the&#160;format&#160;were&#160;YYYY-MM-DD.&#160;Performing&#160;this&#160;change&#160;on&#160;the&#160;file&#160;by&#160;hand&#160;would&#160;be<br/>both&#160;time&#160;consuming&#160;and&#160;error&#160;prone,&#160;but&#160;with&#160;sed,&#160;this&#160;change&#160;can&#160;be&#160;performed&#160;in&#160;one<br/>step.<br/>
304<br/>
<hr/>
<a name=329></a>Editing&#160;on the&#160;Fly<br/>
[me@linuxbox ~]$&#160;<b>sed 's/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\<br/>)$/\3-\1-\2/' distros.txt</b>&#160;<br/>SUSE<br/>
10.2<br/>
2006-12-07&#160;<br/>
Fedora<br/>
10<br/>
2008-11-25&#160;<br/>
SUSE<br/>
11.0<br/>
2008-06-19&#160;<br/>
Ubuntu<br/>
8.04<br/>
2008-04-24&#160;<br/>
Fedora<br/>
8<br/>
2007-11-08&#160;<br/>
SUSE<br/>
10.3<br/>
2007-10-04&#160;<br/>
Ubuntu<br/>
6.10<br/>
2006-10-26&#160;<br/>
Fedora<br/>
7<br/>
2007-05-31&#160;<br/>
Ubuntu<br/>
7.10<br/>
2007-10-18&#160;<br/>
Ubuntu<br/>
7.04<br/>
2007-04-19&#160;<br/>
SUSE<br/>
10.1<br/>
2006-05-11&#160;<br/>
Fedora<br/>
6<br/>
2006-10-24&#160;<br/>
Fedora<br/>
9<br/>
2008-05-13&#160;<br/>
Ubuntu<br/>
6.06<br/>
2006-06-01&#160;<br/>
Ubuntu<br/>
8.10<br/>
2008-10-30&#160;<br/>
Fedora<br/>
5<br/>
2006-03-20<br/>
Wow!&#160;Now&#160;that&#160;is&#160;an&#160;ugly&#160;looking&#160;command.&#160;But&#160;it&#160;works.&#160;In&#160;just&#160;one&#160;step,&#160;we&#160;have<br/>changed&#160;the&#160;date&#160;format&#160;in&#160;our&#160;file.&#160;It&#160;is&#160;also&#160;a&#160;perfect&#160;example&#160;of&#160;why&#160;regular&#160;expres-<br/>sions&#160;are&#160;sometimes&#160;jokingly&#160;referred&#160;to&#160;as&#160;a&#160;“write-only”&#160;medium.&#160;We&#160;can&#160;write&#160;them,<br/>but&#160;we&#160;sometimes&#160;cannot&#160;read&#160;them.&#160;Before&#160;we&#160;are&#160;tempted&#160;to&#160;run&#160;away&#160;in&#160;terror&#160;from<br/>this&#160;command,&#160;let’s&#160;look&#160;at&#160;how&#160;it&#160;was&#160;constructed.&#160;First,&#160;we&#160;know&#160;that&#160;the&#160;command&#160;will<br/>have&#160;this&#160;basic&#160;structure.<br/>
<b>sed 's/<i>regexp</i></b><b>/<i>replacement</i></b><b>/' distros.txt</b><br/>
Our&#160;next&#160;step&#160;is&#160;to&#160;figure&#160;out&#160;a&#160;regular&#160;expression&#160;that&#160;will&#160;isolate&#160;the&#160;date.&#160;Because&#160;it&#160;is<br/>in&#160;MM/DD/YYYY&#160;format&#160;and&#160;appears&#160;at&#160;the&#160;end&#160;of&#160;the&#160;line,&#160;we&#160;can&#160;use&#160;an&#160;expression<br/>like&#160;this:<br/>
<b>[0-9]{2}/[0-9]{2}/[0-9]{4}$</b><br/>
This&#160;matches&#160;two&#160;digits,&#160;a&#160;slash,&#160;two&#160;digits,&#160;a&#160;slash,&#160;four&#160;digits,&#160;and&#160;the&#160;end&#160;of&#160;line.&#160;So<br/>that&#160;takes&#160;care&#160;of&#160;<i>regexp</i>,&#160;but&#160;what&#160;about&#160;<i>replacement</i>?&#160;To&#160;handle&#160;that,&#160;we&#160;must&#160;introduce<br/>a&#160;new&#160;regular&#160;expression&#160;feature&#160;that&#160;appears&#160;in&#160;some&#160;applications&#160;that&#160;use&#160;BRE.&#160;This<br/>feature&#160;is&#160;called&#160;&#160;<i>back&#160;references</i>&#160;&#160;and&#160;works&#160;like&#160;this:&#160;if&#160;the&#160;sequence&#160;\<i>n</i>&#160;&#160;appears&#160;in&#160;&#160;<i>re-<br/>placement</i>&#160;where&#160;<i>n</i>&#160;is&#160;a&#160;number&#160;from&#160;1&#160;to&#160;9,&#160;the&#160;sequence&#160;will&#160;refer&#160;to&#160;the&#160;corresponding<br/>subexpression&#160;in&#160;the&#160;preceding&#160;regular&#160;expression.&#160;To&#160;create&#160;the&#160;subexpressions,&#160;we&#160;sim-<br/>
305<br/>
<hr/>
<a name=330></a>20 –&#160;Text&#160;Processing<br/>
ply enclose&#160;them&#160;in parentheses&#160;like&#160;so:<br/>
<b>([0-9]{2})/([0-9]{2})/([0-9]{4})$</b><br/>
We&#160;now&#160;have&#160;three&#160;subexpressions.&#160;The&#160;first&#160;contains&#160;the&#160;month,&#160;the&#160;second&#160;contains&#160;the<br/>day&#160;of&#160;the&#160;month,&#160;and&#160;the&#160;third&#160;contains&#160;the&#160;year.&#160;Now&#160;we&#160;can&#160;construct&#160;<i>replacement</i>&#160;as<br/>follows:<br/>
<b>\3-\1-\2</b><br/>
This&#160;gives&#160;us&#160;the&#160;year, a&#160;dash, the&#160;month,&#160;a&#160;dash, and the&#160;day.<br/>Now, our command looks&#160;like&#160;this:<br/>
<b>sed 's/([0-9]{2})/([0-9]{2})/([0-9]{4})$/\3-\1-\2/' distros.txt</b><br/>
We&#160;have&#160;two&#160;remaining&#160;problems.&#160;The&#160;first&#160;is&#160;that&#160;the&#160;extra&#160;slashes&#160;in&#160;our&#160;regular&#160;expres-<br/>sion&#160;will&#160;confuse&#160;sed&#160;when&#160;it&#160;tries&#160;to&#160;interpret&#160;the&#160;s&#160;command.&#160;The&#160;second&#160;is&#160;that&#160;since<br/>sed,&#160;by&#160;default,&#160;accepts&#160;only&#160;basic&#160;regular&#160;expressions,&#160;several&#160;of&#160;the&#160;characters&#160;in&#160;our<br/>regular&#160;expression&#160;will&#160;be&#160;taken&#160;as&#160;literals,&#160;rather&#160;than&#160;as&#160;metacharacters.&#160;We&#160;can&#160;solve<br/>both&#160;these&#160;problems&#160;with&#160;a&#160;liberal&#160;application&#160;of&#160;backslashes&#160;to&#160;escape&#160;the&#160;offending<br/>characters.<br/>
<b>sed 's/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/' dis<br/>tros.txt</b><br/>
And there&#160;you have&#160;it!<br/>Another&#160;feature&#160;of&#160;the&#160;&#160;s&#160;command&#160;is&#160;the&#160;use&#160;of&#160;optional&#160;flags&#160;that&#160;may&#160;follow&#160;the&#160;re-<br/>placement&#160;string.&#160;The&#160;most&#160;important&#160;of&#160;these&#160;is&#160;the&#160;g&#160;flag,&#160;which&#160;instructs&#160;sed&#160;to&#160;apply<br/>the&#160;search-and-replace&#160;globally&#160;to a&#160;line, not&#160;just&#160;to the&#160;first&#160;instance, which is&#160;the&#160;default.<br/>Here&#160;is&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;aaabbbccc&#34; | sed 's/b/B/'</b>&#160;<br/>aaaBbbccc<br/>
We&#160;see&#160;that&#160;the&#160;replacement&#160;was&#160;performed,&#160;but&#160;only&#160;to&#160;the&#160;first&#160;instance&#160;of&#160;the&#160;letter&#160;b,<br/>while&#160;the&#160;remaining&#160;instances&#160;were&#160;left&#160;unchanged.&#160;By&#160;adding&#160;the&#160;g&#160;flag,&#160;we&#160;are&#160;able&#160;to<br/>
306<br/>
<hr/>
<a name=331></a>Editing&#160;on the&#160;Fly<br/>
change&#160;all&#160;the&#160;instances.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;aaabbbccc&#34; | sed 's/b/B/g'</b>&#160;<br/>aaaBBBccc<br/>
So&#160;far,&#160;we&#160;have&#160;only&#160;given&#160;sed&#160;single&#160;commands&#160;via&#160;the&#160;command&#160;line.&#160;It&#160;is&#160;also&#160;possi-<br/>ble&#160;to&#160;construct&#160;more&#160;complex&#160;commands&#160;in&#160;a&#160;script&#160;file&#160;using&#160;the&#160;-f&#160;option.&#160;To&#160;demon-<br/>strate,&#160;we&#160;will&#160;use&#160;sed&#160;with&#160;our&#160;distros.txt&#160;file&#160;to&#160;build&#160;a&#160;report.&#160;Our&#160;report&#160;will<br/>feature&#160;a&#160;title&#160;at&#160;the&#160;top,&#160;our&#160;modified&#160;dates,&#160;and&#160;all&#160;the&#160;distribution&#160;names&#160;converted&#160;to<br/>uppercase.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;need&#160;to&#160;write&#160;a&#160;script,&#160;so&#160;we’ll&#160;fire&#160;up&#160;our&#160;text&#160;editor&#160;and<br/>enter&#160;the&#160;following:<br/>
<b># sed script to produce Linux distributions report&#160;</b><br/>
<b>1 i\&#160;<br/>\<br/>Linux Distributions Report\&#160;</b><br/>
<b>s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/&#160;<br/>y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/</b><br/>
We&#160;will&#160;save&#160;our&#160;sed&#160;script&#160;as&#160;distros.sed&#160;and&#160;run it&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>sed -f distros.sed distros.txt</b><br/>
Linux Distributions Report&#160;<br/>
SUSE<br/>
10.2<br/>
2006-12-07&#160;<br/>
FEDORA<br/>
10<br/>
2008-11-25&#160;<br/>
SUSE<br/>
11.0<br/>
2008-06-19&#160;<br/>
UBUNTU<br/>
8.04<br/>
2008-04-24&#160;<br/>
FEDORA<br/>
8<br/>
2007-11-08&#160;<br/>
SUSE<br/>
10.3<br/>
2007-10-04&#160;<br/>
UBUNTU<br/>
6.10<br/>
2006-10-26&#160;<br/>
FEDORA<br/>
7<br/>
2007-05-31&#160;<br/>
UBUNTU<br/>
7.10<br/>
2007-10-18&#160;<br/>
UBUNTU<br/>
7.04<br/>
2007-04-19&#160;<br/>
SUSE<br/>
10.1<br/>
2006-05-11&#160;<br/>
FEDORA<br/>
6<br/>
2006-10-24&#160;<br/>
FEDORA<br/>
9<br/>
2008-05-13&#160;<br/>
307<br/>
<hr/>
<a name=332></a>20 –&#160;Text&#160;Processing<br/>
UBUNTU<br/>
6.06<br/>
2006-06-01&#160;<br/>
UBUNTU<br/>
8.10<br/>
2008-10-30&#160;<br/>
FEDORA<br/>
5<br/>
2006-03-20<br/>
As&#160;we&#160;can&#160;see,&#160;our&#160;script&#160;produces&#160;the&#160;desired&#160;results,&#160;but&#160;how&#160;does&#160;it&#160;do&#160;it?&#160;Let’s&#160;take<br/>another&#160;look at&#160;our script.&#160;We’ll&#160;use&#160;cat&#160;to&#160;number the&#160;lines.<br/>
[me@linuxbox ~]$&#160;<b>cat -n distros.sed</b>&#160;<br/>&#160; &#160; 1<br/>
# sed script to produce Linux distributions report&#160;<br/>
&#160; &#160; 2<br/>
&#160;<br/>
&#160; &#160; 3<br/>
1 i\&#160;<br/>
&#160; &#160; 4<br/>
\&#160;<br/>
&#160; &#160; 5<br/>
Linux Distributions Report\&#160;<br/>
&#160; &#160; 6<br/>
&#160;<br/>
&#160; &#160; 7<br/>
s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/&#160;<br/>
&#160; &#160; 8<br/>
y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/<br/>
Line&#160;one&#160;of&#160;our&#160;script&#160;is&#160;a&#160;<i>comment</i>.&#160;Like&#160;many&#160;configuration&#160;files&#160;and&#160;programming&#160;lan-<br/>guages&#160;on&#160;Linux&#160;systems,&#160;comments&#160;begin&#160;with&#160;the&#160;#&#160;character&#160;and&#160;are&#160;followed&#160;by&#160;hu-<br/>man-readable&#160;text.&#160;Comments&#160;can&#160;be&#160;placed&#160;anywhere&#160;in&#160;the&#160;script&#160;(though&#160;not&#160;within<br/>commands&#160;themselves)&#160;and&#160;are&#160;helpful&#160;to&#160;any&#160;humans&#160;who&#160;might&#160;need&#160;to&#160;identify&#160;and/or<br/>maintain&#160;the&#160;script.<br/>Line&#160;2 is&#160;a&#160;blank&#160;line. Like&#160;comments,&#160;blank lines&#160;may be&#160;added to improve&#160;readability.<br/>Many&#160;sed&#160;commands&#160;support&#160;line&#160;addresses.&#160;These&#160;are&#160;used&#160;to&#160;specify&#160;which&#160;lines&#160;of<br/>the&#160;input&#160;are&#160;to&#160;be&#160;acted&#160;upon.&#160;Line&#160;addresses&#160;may&#160;be&#160;expressed&#160;as&#160;single&#160;line&#160;numbers,<br/>line&#160;number ranges, and&#160;the&#160;special&#160;line&#160;number&#160;$, which indicates&#160;the&#160;last&#160;line&#160;of input.&#160;<br/>Lines&#160;3,&#160;4,&#160;5,&#160;and&#160;6&#160;contain&#160;text&#160;to&#160;be&#160;inserted&#160;at&#160;the&#160;address&#160;1,&#160;the&#160;first&#160;line&#160;of&#160;the&#160;input.<br/>The&#160;i&#160;command&#160;is&#160;followed&#160;by&#160;the&#160;sequence&#160;of&#160;a&#160;backslash&#160;and&#160;then&#160;a&#160;carriage&#160;return&#160;to<br/>produce&#160;an&#160;escaped&#160;carriage&#160;return,&#160;or&#160;what&#160;is&#160;called&#160;a&#160;<i>line-continuation&#160;character</i>.&#160;This<br/>sequence,&#160;which&#160;can&#160;be&#160;used&#160;in&#160;many&#160;circumstances&#160;including&#160;shell&#160;scripts,&#160;allows&#160;a&#160;car-<br/>riage&#160;return&#160;to&#160;be&#160;embedded&#160;in&#160;a&#160;stream&#160;of&#160;text&#160;without&#160;signaling&#160;the&#160;interpreter&#160;(in&#160;this<br/>case&#160;sed)&#160;that&#160;the&#160;end&#160;of&#160;the&#160;line&#160;has&#160;been&#160;reached.&#160;The&#160;i,&#160;and&#160;the&#160;a&#160;(which&#160;appends<br/>text,&#160;rather&#160;than&#160;inserting&#160;it)&#160;and&#160;c&#160;(which&#160;replaces&#160;text)&#160;commands&#160;allow&#160;multiple&#160;lines<br/>of&#160;text&#160;as&#160;long&#160;as&#160;each&#160;line,&#160;except&#160;the&#160;last,&#160;ends&#160;with&#160;a&#160;line-continuation&#160;character.&#160;The<br/>sixth&#160;line&#160;of&#160;our&#160;script&#160;is&#160;actually&#160;the&#160;end&#160;of&#160;our&#160;inserted&#160;text&#160;and&#160;ends&#160;with&#160;a&#160;plain&#160;car-<br/>riage&#160;return&#160;rather&#160;than&#160;a&#160;line-continuation&#160;character,&#160;signaling&#160;the&#160;end&#160;of&#160;the&#160;&#160;i&#160;&#160;com-<br/>mand.<br/>
308<br/>
<hr/>
<a name=333></a>Editing&#160;on the&#160;Fly<br/>
<b>Note:</b>&#160;A&#160;line-continuation&#160;character&#160;is&#160;formed&#160;by&#160;a&#160;backslash&#160;followed&#160;<i>immedi-<br/>ately</i>&#160;by a&#160;carriage&#160;return. No intermediary&#160;spaces&#160;are&#160;permitted.<br/>
Line&#160;7&#160;is&#160;our&#160;search-and-replace&#160;command.&#160;Since&#160;it&#160;is&#160;not&#160;preceded&#160;by&#160;an&#160;address,&#160;each<br/>line&#160;in the&#160;input&#160;stream&#160;is&#160;subject&#160;to its&#160;action.<br/>Line&#160;8&#160;performs&#160;transliteration&#160;of&#160;the&#160;lowercase&#160;letters&#160;into&#160;uppercase&#160;letters.&#160;Note&#160;that<br/>unlike&#160;tr,&#160;the&#160;y&#160;command&#160;in&#160;sed&#160;does&#160;not&#160;support&#160;character&#160;ranges&#160;(for&#160;example,&#160;[a-<br/>z]),&#160;nor&#160;does&#160;it&#160;support&#160;POSIX&#160;character&#160;classes.&#160;Again,&#160;since&#160;the&#160;y&#160;command&#160;is&#160;not&#160;pre-<br/>ceded&#160;by an address, it&#160;applies&#160;to every&#160;line&#160;in the&#160;input&#160;stream.<br/>
<b>People&#160;Who&#160;Like&#160;sed&#160;Also&#160;Like...</b><br/>
sed&#160;is&#160;a&#160;capable&#160;program,&#160;able&#160;to&#160;perform&#160;fairly&#160;complex&#160;editing&#160;tasks&#160;to&#160;streams<br/>of&#160;text.&#160;It&#160;is&#160;most&#160;often&#160;used&#160;for&#160;simple,&#160;one-line&#160;tasks&#160;rather&#160;than&#160;long&#160;scripts.<br/>Many&#160;users&#160;prefer&#160;other&#160;tools&#160;for&#160;larger&#160;tasks.&#160;The&#160;most&#160;popular&#160;of&#160;these&#160;are&#160;awk<br/>and&#160;perl.&#160;These&#160;go&#160;beyond&#160;mere&#160;tools&#160;like&#160;the&#160;programs&#160;covered&#160;here&#160;and&#160;ex-<br/>tend&#160;into&#160;the&#160;realm&#160;of&#160;complete&#160;programming&#160;languages.&#160;perl,&#160;in&#160;particular,&#160;is<br/>often&#160;used&#160;instead&#160;of&#160;shell&#160;scripts&#160;for&#160;many&#160;system&#160;management&#160;and&#160;administra-<br/>tion tasks, as&#160;well&#160;as&#160;being a&#160;popular medium&#160;for web development.&#160;awk&#160;is&#160;a&#160;little<br/>more&#160;specialized.&#160;Its&#160;specific&#160;strength&#160;is&#160;its&#160;ability&#160;to&#160;manipulate&#160;tabular&#160;data.&#160;It<br/>resembles&#160;sed&#160;in&#160;that&#160;awk&#160;programs&#160;normally&#160;process&#160;text&#160;files&#160;line&#160;by&#160;line,&#160;us-<br/>ing&#160;a&#160;scheme&#160;similar&#160;to&#160;the&#160;&#160;sed&#160;&#160;concept&#160;of&#160;an&#160;address&#160;followed&#160;by&#160;an&#160;action.<br/>While&#160;both&#160;awk&#160;and&#160;perl&#160;are&#160;outside&#160;the&#160;scope&#160;of&#160;this&#160;book,&#160;they&#160;are&#160;good&#160;skills<br/>for the&#160;Linux command line&#160;user to learn.&#160;<br/>
aspell<br/>The&#160;last&#160;tool&#160;we&#160;will&#160;look&#160;at&#160;is&#160;aspell,&#160;an&#160;interactive&#160;spelling&#160;checker.&#160;The&#160;aspell<br/>program&#160;is&#160;the&#160;successor&#160;to&#160;an&#160;earlier&#160;program&#160;named&#160;ispell&#160;and&#160;can&#160;be&#160;used,&#160;for&#160;the<br/>most&#160;part,&#160;as&#160;a&#160;drop-in&#160;replacement.&#160;While&#160;the&#160;aspell&#160;program&#160;is&#160;mostly&#160;used&#160;by&#160;other<br/>programs&#160;that&#160;require&#160;spell-checking&#160;capability,&#160;it&#160;can&#160;also&#160;be&#160;used&#160;effectively&#160;as&#160;a&#160;stand-<br/>alone&#160;tool&#160;from&#160;the&#160;command&#160;line.&#160;It&#160;has&#160;the&#160;ability&#160;to&#160;intelligently&#160;check&#160;various&#160;types&#160;of<br/>text&#160;&#160;&#160;files,&#160;&#160;including&#160;&#160;HTML&#160;&#160;documents,&#160;&#160;&#160;C/C++&#160;&#160;&#160;programs,&#160;&#160;&#160;email&#160;&#160;&#160;messages,&#160;&#160;&#160;and&#160;&#160;other<br/>kinds&#160;of specialized&#160;texts.<br/>To spellcheck a&#160;text&#160;file&#160;containing&#160;simple&#160;prose, it&#160;could&#160;be&#160;used like&#160;this:<br/>
309<br/>
<hr/>
<a name=334></a>20 –&#160;Text&#160;Processing<br/>
aspell check&#160;<i>textfile</i><br/>
where&#160;<i>textfile</i>&#160;is&#160;the&#160;name&#160;of the&#160;file&#160;to&#160;check.&#160;As&#160;a&#160;practical&#160;example,&#160;let’s&#160;create&#160;a&#160;simple<br/>text&#160;file&#160;named&#160;foo.txt&#160;containing&#160;some&#160;deliberate&#160;spelling&#160;errors.<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; foo.txt<br/>The quick brown fox jimped over the laxy dog.</b><br/>
Next&#160;we’ll&#160;check the&#160;file&#160;using&#160;aspell:<br/>
[me@linuxbox ~]$&#160;<b>aspell check foo.txt</b><br/>
As&#160;aspell&#160;is&#160;interactive&#160;in the&#160;check mode,&#160;we&#160;will&#160;see&#160;a&#160;screen like&#160;this:<br/>
The quick brown fox&#160;jimped&#160;over the laxy dog. &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br/>
1) jumped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 6) wimped&#160;<br/>2) gimped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 7) camped&#160;<br/>3) comped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 8) humped&#160;<br/>4) limped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 9) impede&#160;<br/>5) pimped &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0) umped&#160;<br/>i) Ignore &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; I) Ignore all&#160;<br/>r) Replace &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;R) Replace all&#160;<br/>a) Add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;l) Add Lower&#160;<br/>b) Abort &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;x) Exit&#160;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br/>
?<br/>
At&#160;the&#160;top&#160;of&#160;the&#160;display,&#160;we&#160;see&#160;our&#160;text&#160;with&#160;a&#160;suspiciously&#160;spelled&#160;word&#160;highlighted.&#160;In<br/>the&#160;middle,&#160;we&#160;see&#160;ten&#160;spelling&#160;suggestions&#160;numbered&#160;zero&#160;through&#160;nine,&#160;followed&#160;by&#160;a<br/>list&#160;of&#160;other&#160;possible&#160;actions.&#160;Finally,&#160;at&#160;the&#160;bottom,&#160;we&#160;see&#160;a&#160;prompt&#160;ready&#160;to&#160;accept&#160;our<br/>choice.<br/>If&#160;we&#160;press&#160;the&#160;1&#160;key,&#160;aspell&#160;replaces&#160;the&#160;offending&#160;word&#160;with&#160;the&#160;word&#160;“jumped”&#160;and<br/>moves&#160;on&#160;to&#160;the&#160;next&#160;misspelled&#160;word,&#160;which&#160;is&#160;laxy.&#160;If&#160;we&#160;select&#160;the&#160;replacement&#160;lazy,<br/>aspell&#160;replaces&#160;it&#160;and&#160;terminates.&#160;Once&#160;aspell&#160;has&#160;finished,&#160;we&#160;can&#160;examine&#160;our&#160;file<br/>and see&#160;that&#160;the&#160;misspellings&#160;have&#160;been&#160;corrected:<br/>
310<br/>
<hr/>
<a name=335></a>Editing&#160;on the&#160;Fly<br/>
[me@linuxbox ~]$&#160;<b>cat foo.txt</b>&#160;<br/>The quick brown fox jumped over the lazy dog.<br/>
Unless&#160;told&#160;otherwise&#160;via&#160;the&#160;command&#160;line&#160;option&#160;--dont-backup,&#160;aspell&#160;creates<br/>a&#160;backup&#160;file&#160;containing&#160;the&#160;original&#160;text&#160;by&#160;appending&#160;the&#160;extension&#160;.bak&#160;to&#160;the&#160;file-<br/>name.<br/>Showing&#160;off&#160;our&#160;sed&#160;editing&#160;prowess,&#160;we’ll&#160;put&#160;our&#160;spelling&#160;mistakes&#160;back&#160;in&#160;so&#160;we&#160;can<br/>reuse&#160;our file.<br/>
[me@linuxbox ~]$&#160;<b>sed -i 's/lazy/laxy/; s/jumped/jimped/' foo.txt</b><br/>
The&#160;sed&#160;option&#160;-i&#160;tells&#160;sed&#160;to&#160;edit&#160;the&#160;file&#160;“in-place,”&#160;meaning&#160;that&#160;rather&#160;than&#160;sending<br/>the&#160;edited&#160;output&#160;to&#160;standard&#160;output,&#160;it&#160;will&#160;rewrite&#160;the&#160;file&#160;with&#160;the&#160;changes&#160;applied.&#160;We<br/>also&#160;see&#160;the&#160;ability&#160;to&#160;place&#160;more&#160;than&#160;one&#160;editing&#160;command&#160;on&#160;the&#160;line&#160;by&#160;separating<br/>them&#160;with a&#160;semicolon.<br/>Next,&#160;we’ll&#160;look at&#160;how&#160;aspell&#160;can&#160;handle&#160;different&#160;kinds&#160;of text&#160;files.&#160;Using&#160;a&#160;text&#160;edi-<br/>tor&#160;such&#160;as&#160;&#160;vim&#160;&#160;(the&#160;adventurous&#160;may&#160;want&#160;to&#160;try&#160;&#160;sed),&#160;we&#160;will&#160;add&#160;some&#160;HTML<br/>markup to&#160;our file.<br/>
<b>&lt;html&gt;</b><br/>
<b>&lt;head&gt;</b><br/>
<b>&lt;title&gt;Mispelled HTML file&lt;/title&gt;</b><br/>
<b>&lt;/head&gt;<br/>&lt;body&gt;</b><br/>
<b>&lt;p&gt;</b>The quick brown fox jimped over the laxy dog.<b>&lt;/p&gt;</b><br/>
<b>&lt;/body&gt;</b><br/>
<b>&lt;/html&gt;</b><br/>
Now,&#160;if&#160;we&#160;try&#160;to&#160;spellcheck&#160;our&#160;modified&#160;file,&#160;we&#160;run&#160;into&#160;a&#160;problem.&#160;If&#160;we&#160;do&#160;it&#160;this<br/>way:<br/>
[me@linuxbox ~]$&#160;<b>aspell check foo.txt</b><br/>
we’ll&#160;get&#160;this:<br/>
&lt;html&gt;&#160;<br/>
311<br/>
<hr/>
<a name=336></a>20 –&#160;Text&#160;Processing<br/>
&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;Mispelled HTML file&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;p&gt;The quick brown fox jimped over the laxy dog.&lt;/p&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br/>
1) HTML &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 4) Hamel&#160;<br/>2) ht ml &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;5) Hamil&#160;<br/>3) ht-ml &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;6) hotel<br/>i) Ignore &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; I) Ignore all&#160;<br/>r) Replace &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;R) Replace all&#160;<br/>a) Add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;l) Add Lower&#160;<br/>b) Abort &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;x) Exit&#160;<br/>
?&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;<br/>
aspell&#160;&#160;will&#160;see&#160;the&#160;contents&#160;of&#160;the&#160;HTML&#160;tags&#160;as&#160;misspelled.&#160;This&#160;problem&#160;can&#160;be<br/>overcome&#160;by including the&#160;-H&#160;(HTML)&#160;checking-mode&#160;option, like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>aspell -H check foo.txt</b><br/>
which will&#160;result&#160;in&#160;this:<br/>
&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;Mispelled&#160;HTML file&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;p&gt;The quick brown fox jimped over the laxy dog.&lt;/p&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#160;<br/>
1) Mi spelled &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 6) Misapplied&#160;<br/>2) Mi-spelled &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 7) Miscalled&#160;<br/>3) Misspelled &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 8) Respelled&#160;<br/>4) Dispelled &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;9) Misspell&#160;<br/>5) Spelled &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;0) Misled<br/>
312<br/>
<hr/>
<a name=337></a>Editing&#160;on the&#160;Fly<br/>
i) Ignore &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; I) Ignore all&#160;<br/>r) Replace &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;R) Replace all&#160;<br/>a) Add &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;l) Add Lower&#160;<br/>b) Abort &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;x) Exit&#160;<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;<br/>
?<br/>
The&#160;HTML&#160;is&#160;ignored,&#160;and&#160;only&#160;the&#160;non-markup&#160;portions&#160;of&#160;the&#160;file&#160;are&#160;checked.&#160;In&#160;this<br/>mode,&#160;the&#160;contents&#160;of&#160;HTML&#160;tags&#160;are&#160;ignored&#160;and&#160;not&#160;checked&#160;for&#160;spelling.&#160;However,&#160;the<br/>contents&#160;of&#160;ALT&#160;tags, which benefit&#160;from&#160;checking,&#160;are&#160;checked in&#160;this&#160;mode.<br/>
<b>Note:</b>&#160;By&#160;default,&#160;aspell&#160;will&#160;ignore&#160;URLs&#160;and&#160;email&#160;addresses&#160;in&#160;text.&#160;This<br/>behavior&#160;can&#160;be&#160;overridden&#160;with&#160;command&#160;line&#160;options.&#160;It&#160;is&#160;also&#160;possible&#160;to<br/>specify&#160;which&#160;markup&#160;tags&#160;are&#160;checked&#160;and&#160;skipped.&#160;See&#160;the&#160;aspell&#160;man&#160;page<br/>for details.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;looked&#160;at&#160;a&#160;few&#160;of&#160;the&#160;many&#160;command&#160;line&#160;tools&#160;that&#160;operate&#160;on&#160;text.<br/>In&#160;the&#160;next&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;several&#160;more.&#160;Admittedly,&#160;it&#160;may&#160;not&#160;seem&#160;immedi-<br/>ately&#160;obvious&#160;how&#160;or&#160;why&#160;you&#160;might&#160;use&#160;some&#160;of&#160;these&#160;tools&#160;on&#160;a&#160;day-to-day&#160;basis,<br/>though&#160;we&#160;have&#160;tried&#160;to&#160;show&#160;some&#160;practical&#160;examples&#160;of&#160;their&#160;use.&#160;We&#160;will&#160;find&#160;in&#160;later<br/>chapters&#160;that&#160;these&#160;tools&#160;form&#160;the&#160;basis&#160;of a&#160;tool&#160;set&#160;that&#160;is&#160;used to solve&#160;a&#160;host&#160;of practical<br/>problems.&#160;This&#160;will&#160;be&#160;particularly&#160;true&#160;when&#160;we&#160;get&#160;into&#160;shell&#160;scripting,&#160;where&#160;these<br/>tools&#160;will&#160;really&#160;show&#160;their worth.<br/>
<b>Further&#160;Reading<br/></b>The&#160;GNU&#160;Project&#160;website&#160;contains&#160;many online&#160;guides&#160;to&#160;the&#160;tools&#160;discussed in&#160;this&#160;chap-<br/>ter.<br/>
●<br/>
From&#160;the&#160;Coreutils&#160;package:<br/><a href="http://www.gnu.org/software/coreutils/manual/coreutils.html#Output-of-entire-files">http://www.gnu.org/software/coreutils/manual/coreutils.html#Output-of-entire-<br/>files<br/></a><a href="http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-sorted-files">http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-<br/>sorted-files<br/></a><a href="http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-fields">http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-fields<br/></a><a href="http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-characters">http://www.gnu.org/software/coreutils/manual/coreutils.html#Operating-on-char-<br/>acters</a><br/>
●<br/>
From&#160;the&#160;Diffutils&#160;package:<br/>
313<br/>
<hr/>
<a name=338></a>20 –&#160;Text&#160;Processing<br/>
<a href="http://www.gnu.org/software/diffutils/manual/html_mono/diff.html">http://www.gnu.org/software/diffutils/manual/html_mono/diff.html</a><br/>
●<br/>
sed:<br/><a href="http://www.gnu.org/software/sed/manual/sed.html">http://www.gnu.org/software/sed/manual/sed.html</a><br/>
●<br/>
aspell:<br/><a href="http://aspell.net/man-html/index.html">http://aspell.net/man-html/index.html</a><br/>
●<br/>
There&#160;are&#160;many&#160;other online&#160;resources&#160;for&#160;sed, in&#160;particular:<br/><a href="http://www.grymoire.com/Unix/Sed.html">http://www.grymoire.com/Unix/Sed.html<br/></a><a href="http://sed.sourceforge.net/sed1line.txt">http://sed.sourceforge.net/sed1line.txt</a><br/>
●<br/>
Also try&#160;googling “sed&#160;one&#160;liners”,&#160;“sed cheat&#160;sheets”<br/>
<b>Extra&#160;Credit<br/></b>There&#160;&#160;&#160;are&#160;&#160;&#160;a&#160;&#160;&#160;few&#160;&#160;&#160;more&#160;&#160;&#160;interesting&#160;&#160;&#160;text-manipulation&#160;&#160;&#160;commands&#160;&#160;&#160;worth&#160;&#160;&#160;investigating.<br/>Among these&#160;are&#160;split&#160;(split&#160;files&#160;into&#160;pieces),&#160;csplit&#160;(split&#160;files&#160;into&#160;pieces&#160;based&#160;on<br/>context),&#160;and&#160;sdiff&#160;(side-by-side&#160;merge&#160;of file&#160;differences).<br/>
314<br/>
<hr/>
<a name=339></a>21 – Formatting Output<br/>
<i><b>21&#160;–&#160;Formatting&#160;Output</b></i><br/>
In&#160;this&#160;chapter,&#160;we&#160;continue&#160;our&#160;look&#160;at&#160;text-related&#160;tools,&#160;focusing&#160;on&#160;programs&#160;that&#160;are<br/>used&#160;to&#160;format&#160;text&#160;output,&#160;rather&#160;than&#160;changing&#160;the&#160;text&#160;itself.&#160;These&#160;tools&#160;are&#160;often&#160;used<br/>to&#160;prepare&#160;text&#160;for&#160;eventual&#160;printing,&#160;a&#160;subject&#160;that&#160;we&#160;will&#160;cover&#160;in&#160;the&#160;next&#160;chapter.&#160;We<br/>will&#160;cover&#160;the&#160;following programs&#160;in&#160;this&#160;chapter:<br/>
●<br/>
nl&#160;– Number lines<br/>
●<br/>
fold&#160;–&#160;Wrap each line&#160;to a&#160;specified&#160;length<br/>
●<br/>
fmt&#160;–&#160;A&#160;simple&#160;text&#160;formatter<br/>
●<br/>
pr&#160;– Prepare&#160;text&#160;for printing<br/>
●<br/>
printf&#160;– Format&#160;and&#160;print&#160;data<br/>
●<br/>
groff&#160;–&#160;A&#160;document&#160;formatting&#160;system<br/>
<b>Simple&#160;Formatting&#160;Tools<br/></b>We’ll&#160;look&#160;at&#160;some&#160;of&#160;the&#160;simple&#160;formatting&#160;tools&#160;first.&#160;These&#160;are&#160;mostly&#160;single-purpose<br/>programs,&#160;and&#160;a&#160;bit&#160;unsophisticated&#160;in&#160;what&#160;they&#160;do,&#160;but&#160;they&#160;can&#160;be&#160;used&#160;for&#160;small&#160;tasks<br/>and as&#160;parts&#160;of pipelines&#160;and&#160;scripts.<br/>
nl&#160;–&#160;Number&#160;Lines<br/>The&#160;nl&#160;program&#160;is&#160;a&#160;rather&#160;arcane&#160;tool&#160;used&#160;to&#160;perform&#160;a&#160;simple&#160;task.&#160;It&#160;numbers&#160;lines.&#160;In<br/>its&#160;simplest&#160;use, it&#160;resembles&#160;cat -n.<br/>
[me@linuxbox ~]$&#160;<b>nl distros.txt | head&#160;<br/></b>&#160; &#160; &#160;1<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
&#160; &#160; &#160;2<br/>
Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
&#160; &#160; &#160;3<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
&#160; &#160; &#160;4<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
&#160; &#160; &#160;5<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
&#160; &#160; &#160;6<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
315<br/>
<hr/>
<a name=340></a>21 – Formatting Output<br/>
&#160; &#160; &#160;7<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
&#160; &#160; &#160;8<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
&#160; &#160; &#160;9<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
&#160; &#160; 10<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007<br/>
Like&#160;cat,&#160;nl&#160;can&#160;accept&#160;either&#160;multiple&#160;files&#160;as&#160;command&#160;line&#160;arguments&#160;or&#160;standard&#160;in-<br/>put.&#160;However,&#160;nl&#160;has&#160;a&#160;number&#160;of&#160;options&#160;and&#160;supports&#160;a&#160;primitive&#160;form&#160;of&#160;markup&#160;to&#160;al-<br/>low&#160;more&#160;complex&#160;kinds&#160;of numbering.<br/>
nl&#160;supports&#160;a&#160;concept&#160;called&#160;“logical&#160;pages”&#160;when&#160;numbering.&#160;This&#160;allows&#160;nl&#160;to&#160;reset<br/>(start&#160;over)&#160;the&#160;numerical&#160;sequence&#160;when&#160;numbering.&#160;Using&#160;options,&#160;it&#160;is&#160;possible&#160;to&#160;set<br/>the&#160;starting&#160;number&#160;to&#160;a&#160;specific&#160;value&#160;and,&#160;to&#160;a&#160;limited&#160;extent,&#160;its&#160;format.&#160;A&#160;logical&#160;page<br/>is&#160;further&#160;broken&#160;down&#160;into&#160;a&#160;header,&#160;body,&#160;and&#160;footer.&#160;Within&#160;each&#160;of&#160;these&#160;sections,&#160;line<br/>numbering&#160;may&#160;be&#160;reset&#160;and/or&#160;be&#160;assigned&#160;a&#160;different&#160;style.&#160;If&#160;nl&#160;is&#160;given&#160;multiple&#160;files,<br/>it&#160;treats&#160;them&#160;as&#160;a&#160;single&#160;stream&#160;of&#160;text.&#160;Sections&#160;in&#160;the&#160;text&#160;stream&#160;are&#160;indicated&#160;by&#160;the<br/>presence&#160;of&#160;some&#160;rather&#160;odd-looking&#160;markup&#160;added&#160;to&#160;the&#160;text,&#160;as&#160;described&#160;in&#160;Table&#160;21-<br/>1.<br/>
<i>Table&#160;21-1: nl&#160;Markup</i><br/>
<b>Markup</b><br/>
<b>Meaning</b><br/>
\:\:\:<br/>
Start&#160;of logical&#160;page&#160;header<br/>
\:\:<br/>
Start&#160;of logical&#160;page&#160;body<br/>
\:<br/>
Start&#160;of logical&#160;page&#160;footer<br/>
Each&#160;of&#160;the&#160;markup&#160;elements&#160;listed&#160;in&#160;Table&#160;21-1&#160;must&#160;appear&#160;alone&#160;on its&#160;own line.&#160;After<br/>processing a&#160;markup&#160;element,&#160;nl&#160;deletes&#160;it&#160;from&#160;the&#160;text&#160;stream.<br/>Table&#160;21-2 lists&#160;the&#160;common options&#160;for&#160;nl.<br/>
<i>Table&#160;21-2: Common&#160;nl&#160;Options</i><br/>
<b>Option</b><br/>
<b>Meaning</b><br/>
-b&#160;<i>style</i><br/>
Set&#160;body numbering to&#160;<i>style</i>, where&#160;<i>style</i>&#160;is&#160;one&#160;of the&#160;following:<br/>a&#160;=&#160;Number&#160;all&#160;lines<br/>t&#160;=&#160;Number&#160;only non-blank&#160;lines.&#160;This&#160;is&#160;the&#160;default.<br/>n&#160;=&#160;None<br/>p<i>regexp</i>&#160;=&#160;Number&#160;only lines&#160;matching&#160;basic&#160;regular&#160;expression&#160;<br/><i>regexp</i>.<br/>
-f&#160;<i>style</i><br/>
Set&#160;footer&#160;numbering&#160;to&#160;<i>style</i>.&#160;The&#160;default&#160;is&#160;n (none).<br/>
316<br/>
<hr/>
<a name=341></a>Simple&#160;Formatting&#160;Tools<br/>
-h&#160;<i>style</i><br/>
Set&#160;header&#160;numbering&#160;to&#160;<i>style</i>.&#160;The&#160;default&#160;is&#160;n (none).<br/>
-i&#160;<i>number</i><br/>
Set&#160;page&#160;numbering&#160;increment&#160;to&#160;<i>number</i>.&#160;The&#160;default&#160;is&#160;one.<br/>
-n&#160;<i>format</i><br/>
Sets&#160;numbering&#160;format&#160;to&#160;<i>format</i>, where&#160;<i>format</i>&#160;is&#160;one&#160;of the&#160;<br/>following:<br/>ln&#160;=&#160;Left&#160;justified,&#160;without&#160;leading zeros.<br/>rn&#160;=&#160;Right&#160;justified, without&#160;leading zeros.&#160;This&#160;is&#160;the&#160;default.<br/>rz&#160;=&#160;Right&#160;justified, with&#160;leading&#160;zeros.<br/>
-p<br/>
Do not&#160;reset&#160;page&#160;numbering&#160;at&#160;the&#160;beginning&#160;of each&#160;logical&#160;page.<br/>
-s&#160;<i>string</i><br/>
Add&#160;<i>string</i>&#160;to&#160;the&#160;end of each line&#160;number&#160;to create&#160;a&#160;separator.&#160;The&#160;<br/>default&#160;is&#160;a&#160;single&#160;tab character.<br/>
-v&#160;<i>number</i><br/>
Set&#160;first&#160;line&#160;number&#160;of each&#160;logical&#160;page&#160;to&#160;<i>number</i>.&#160;The&#160;default&#160;is&#160;<br/>one.<br/>
-w&#160;<i>width</i><br/>
Set&#160;width of the&#160;line&#160;number&#160;field to&#160;<i>width</i>.&#160;The&#160;default&#160;is&#160;6.<br/>
Admittedly,&#160;we&#160;probably&#160;won’t&#160;be&#160;numbering&#160;lines&#160;that&#160;often,&#160;but&#160;we&#160;can&#160;use&#160;nl&#160;to&#160;look<br/>at&#160;how&#160;we&#160;can&#160;combine&#160;multiple&#160;tools&#160;to&#160;perform&#160;more&#160;complex&#160;tasks.&#160;We&#160;will&#160;build&#160;on<br/>our&#160;work&#160;in&#160;the&#160;previous&#160;chapter&#160;to&#160;produce&#160;a&#160;Linux&#160;distributions&#160;report.&#160;Since&#160;we&#160;will&#160;be<br/>using&#160;nl,&#160;it&#160;will&#160;be&#160;useful&#160;to&#160;include&#160;its&#160;header/body/footer&#160;markup.&#160;To&#160;do&#160;this,&#160;we&#160;will<br/>add&#160;it&#160;to&#160;the&#160;sed&#160;script&#160;from&#160;the&#160;previous&#160;chapter.&#160;Using&#160;our&#160;text&#160;editor,&#160;we&#160;will&#160;change<br/>the&#160;script&#160;as&#160;follows&#160;and save&#160;it&#160;as&#160;distros-nl.sed:<br/>
# sed script to produce Linux distributions report&#160;<br/>
1 i\&#160;<br/><b>\\:\\:\\:\&#160;<br/></b>\&#160;<br/>Linux Distributions Report\&#160;<br/><b>\&#160;<br/>Name</b><br/>
<b>Ver.&#160;Released\&#160;</b><br/>
<b>----</b><br/>
<b>----&#160;--------\</b><br/>
<b>\\:\\:</b>&#160;<br/>s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/&#160;<br/><b>$ a\&#160;<br/>\\:\&#160;<br/>\&#160;<br/>End Of Report</b><br/>
317<br/>
<hr/>
<a name=342></a>21 – Formatting Output<br/>
The&#160;script&#160;now&#160;inserts&#160;the&#160;nl&#160;logical&#160;page&#160;markup&#160;and&#160;adds&#160;a&#160;footer&#160;at&#160;the&#160;end&#160;of&#160;the&#160;re-<br/>port.&#160;Note&#160;that&#160;we&#160;had&#160;to&#160;double&#160;up&#160;the&#160;backslashes&#160;in&#160;our&#160;markup&#160;because&#160;they&#160;are&#160;nor-<br/>mally interpreted&#160;as&#160;an escape&#160;character by&#160;sed.<br/>Next, we’ll&#160;produce&#160;our enhanced report&#160;by combining&#160;sort,&#160;sed, and&#160;nl.<br/>
[me@linuxbox ~]$&#160;<b>sort -k 1,1 -k 2n distros.txt | sed -f distros-nl.s<br/>ed | nl</b>&#160;<br/>&#160;<br/>&#160; &#160; &#160; &#160;<br/>&#160; &#160; &#160; &#160;Linux Distributions Report&#160;<br/>&#160; &#160; &#160; &#160;<br/>&#160; &#160; &#160; &#160;Name &#160; &#160; Ver. &#160; &#160;Released&#160;<br/>&#160; &#160; &#160; &#160;---- &#160; &#160; ---- &#160; &#160;--------&#160;<br/>
&#160; &#160; &#160;1 &#160;Fedora &#160;5 &#160; &#160; &#160; 2006-03-20&#160;<br/>&#160; &#160; &#160;2 &#160;Fedora &#160;6 &#160; &#160; &#160; 2006-10-24&#160;<br/>&#160; &#160; &#160;3 &#160;Fedora &#160;7 &#160; &#160; &#160; 2007-05-31&#160;<br/>&#160; &#160; &#160;4 &#160;Fedora &#160;8 &#160; &#160; &#160; 2007-11-08&#160;<br/>&#160; &#160; &#160;5 &#160;Fedora &#160;9 &#160; &#160; &#160; 2008-05-13&#160;<br/>&#160; &#160; &#160;6 &#160;Fedora &#160;10 &#160; &#160; &#160;2008-11-25&#160;<br/>&#160; &#160; &#160;7 &#160;SUSE &#160; &#160;10.1 &#160; &#160;2006-05-11&#160;<br/>&#160; &#160; &#160;8 &#160;SUSE &#160; &#160;10.2 &#160; &#160;2006-12-07&#160;<br/>&#160; &#160; &#160;9 &#160;SUSE &#160; &#160;10.3 &#160; &#160;2007-10-04&#160;<br/>&#160; &#160; 10 &#160;SUSE &#160; &#160;11.0 &#160; &#160;2008-06-19&#160;<br/>&#160; &#160; 11 &#160;Ubuntu &#160;6.06 &#160; &#160;2006-06-01&#160;<br/>&#160; &#160; 12 &#160;Ubuntu &#160;6.10 &#160; &#160;2006-10-26&#160;<br/>&#160; &#160; 13 &#160;Ubuntu &#160;7.04 &#160; &#160;2007-04-19&#160;<br/>&#160; &#160; 14 &#160;Ubuntu &#160;7.10 &#160; &#160;2007-10-18&#160;<br/>&#160; &#160; 15 &#160;Ubuntu &#160;8.04 &#160; &#160;2008-04-24&#160;<br/>&#160; &#160; 16 &#160;Ubuntu &#160;8.10 &#160; &#160;2008-10-30&#160;<br/>
&#160; &#160; &#160; &#160;<br/>&#160; &#160; &#160; &#160;End Of Report<br/>
Our&#160;report&#160;is&#160;the&#160;result&#160;of&#160;our&#160;pipeline&#160;of&#160;commands.&#160;First,&#160;we&#160;sort&#160;the&#160;list&#160;by&#160;distribution<br/>name&#160;and&#160;version&#160;(fields&#160;1&#160;and&#160;2),&#160;and&#160;then&#160;we&#160;process&#160;the&#160;results&#160;with&#160;sed,&#160;adding&#160;the<br/>report&#160;header&#160;(including&#160;the&#160;logical&#160;page&#160;markup&#160;for&#160;nl)&#160;and&#160;footer.&#160;Finally,&#160;we&#160;process<br/>the&#160;result&#160;with&#160;nl,&#160;which,&#160;by&#160;default,&#160;only&#160;numbers&#160;the&#160;lines&#160;of&#160;the&#160;text&#160;stream&#160;that&#160;be-<br/>long to the&#160;body section&#160;of the&#160;logical&#160;page.<br/>We&#160;can&#160;repeat&#160;the&#160;command&#160;and&#160;experiment&#160;with&#160;different&#160;options&#160;for&#160;nl.&#160;Some&#160;interest-<br/>
318<br/>
<hr/>
<a name=343></a>Simple&#160;Formatting&#160;Tools<br/>
ing ones&#160;are&#160;the&#160;following:<br/>
<b>nl -n rz</b><br/>
and the&#160;following:<br/>
&#160;<b>nl -w 3 -s ' '</b><br/>
fold&#160;–&#160;Wrap&#160;Each&#160;Line&#160;to&#160;a&#160;Specified&#160;Length<br/><i>Folding</i>&#160;is&#160;the&#160;process&#160;of&#160;breaking&#160;lines&#160;of&#160;text&#160;at&#160;a&#160;specified&#160;width.&#160;Like&#160;our&#160;other&#160;com-<br/>mands,&#160;fold&#160;accepts&#160;either&#160;one&#160;or&#160;more&#160;text&#160;files&#160;or&#160;standard&#160;input.&#160;If&#160;we&#160;send&#160;fold&#160;a<br/>simple&#160;stream&#160;of text, we&#160;can&#160;see&#160;how&#160;it&#160;works.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;The quick brown fox jumped over the lazy dog.&#34;<br/>| fold -w 12</b>&#160;<br/>The quick br&#160;<br/>own fox jump&#160;<br/>ed over the&#160;<br/>lazy dog.<br/>
Here&#160;we&#160;see&#160;&#160;fold&#160;in&#160;action.&#160;The&#160;text&#160;sent&#160;by&#160;the&#160;&#160;echo&#160;command&#160;is&#160;broken&#160;into&#160;seg-<br/>ments&#160;specified&#160;by&#160;the&#160;-w&#160;option.&#160;In&#160;this&#160;example,&#160;we&#160;specify&#160;a&#160;line&#160;width&#160;of&#160;12&#160;charac-<br/>ters.&#160;If&#160;no&#160;width&#160;is&#160;specified,&#160;the&#160;default&#160;is&#160;80&#160;characters.&#160;Notice&#160;how&#160;the&#160;lines&#160;are&#160;broken<br/>regardless&#160;of&#160;word&#160;boundaries.&#160;The&#160;addition&#160;of&#160;the&#160;-s&#160;option&#160;will&#160;cause&#160;fold&#160;to&#160;break<br/>the&#160;line&#160;at&#160;the&#160;last&#160;available&#160;space&#160;before&#160;the&#160;line&#160;width&#160;is&#160;reached.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;The quick brown fox jumped over the lazy dog.&#34;<br/>| fold -w 12 -s</b>&#160;<br/>The quick&#160;<br/>brown fox&#160;<br/>jumped over&#160;<br/>the lazy&#160;<br/>dog.&#160;<br/>
319<br/>
<hr/>
<a name=344></a>21 – Formatting Output<br/>
fmt&#160;–&#160;A&#160;Simple&#160;Text&#160;Formatter<br/>The&#160;fmt&#160;program&#160;also&#160;folds&#160;text,&#160;plus&#160;a&#160;lot&#160;more.&#160;It&#160;accepts&#160;either&#160;files&#160;or&#160;standard&#160;input<br/>and&#160;performs&#160;paragraph&#160;formatting&#160;on&#160;the&#160;text&#160;stream.&#160;Basically,&#160;it&#160;fills&#160;and&#160;joins&#160;lines&#160;in<br/>text&#160;while&#160;preserving&#160;blank lines&#160;and indentation.<br/>To demonstrate, we’ll&#160;need some&#160;text. Let’s&#160;lift&#160;some&#160;from&#160;the&#160;fmt&#160;info&#160;page.<br/>
&#160; &#160;`fmt' reads from the specified FILE arguments (or standard input&#160;<br/>if none are given), and writes to standard output.&#160;<br/>
&#160; &#160;By default, blank lines, spaces between words, and indentation are<br/>preserved in the output; successive input lines with different<br/>indentation are not joined; tabs are expanded on input and introduced<br/>on output.&#160;<br/>
&#160; &#160;`fmt' prefers breaking lines at the end of a sentence, and tries&#160;<br/>to avoid line breaks after the first word of a sentence or before the<br/>last word of a sentence. &#160;A &#34;sentence break&#34; is defined as either the<br/>end of a paragraph or a word ending in any of `.?!', followed by two&#160;<br/>spaces or end of line, ignoring any intervening parentheses or&#160;<br/>quotes. &#160;Like TeX, `fmt' reads entire &#34;paragraphs&#34; before choosing&#160;<br/>line breaks; the algorithm is a variant of that given by Donald E.&#160;<br/>Knuth and Michael F. Plass in &#34;Breaking Paragraphs Into Lines&#34;,&#160;<br/>`Software--Practice &amp; Experience' 11, 11 (November 1981), 1119-1184.<br/>
We’ll&#160;copy&#160;this&#160;text&#160;into&#160;our&#160;text&#160;editor&#160;and&#160;save&#160;the&#160;file&#160;as&#160;fmt-info.txt.&#160;Now,&#160;let’s<br/>say&#160;we&#160;wanted&#160;to&#160;reformat&#160;this&#160;text&#160;to&#160;fit&#160;a&#160;50-character-wide&#160;column.&#160;We&#160;could&#160;do&#160;this<br/>by processing the&#160;file&#160;with&#160;fmt&#160;and the&#160;-w&#160;option.<br/>
[me@linuxbox ~]$&#160;<b>fmt -w 50 fmt-info.txt | head&#160;<br/></b>&#160; &#160;`fmt' reads from the specified FILE arguments&#160;<br/>&#160; &#160;(or standard input if&#160;<br/>none are given), and writes to standard output.&#160;<br/>
&#160; &#160;By default, blank lines, spaces between words,&#160;<br/>&#160; &#160;and indentation are&#160;<br/>preserved in the output; successive input lines&#160;<br/>with different indentation are not joined; tabs&#160;<br/>are expanded on input and introduced on output.<br/>
Well,&#160;that’s&#160;an&#160;awkward&#160;result.&#160;Perhaps&#160;we&#160;should&#160;actually&#160;read&#160;this&#160;text&#160;since&#160;it&#160;explains<br/>
320<br/>
<hr/>
<a name=345></a>Simple&#160;Formatting&#160;Tools<br/>
what’s&#160;going on.<br/>
<i>By&#160;default, blank&#160;lines, spaces&#160;between words, and indentation&#160;are&#160;preserved&#160;in the&#160;<br/>output;&#160;successive&#160;input&#160;lines&#160;with different&#160;indentation are&#160;not&#160;joined;&#160;tabs&#160;are&#160;<br/>expanded on input&#160;and introduced on output.</i><br/>
So,&#160;fmt&#160;is&#160;preserving&#160;the&#160;indentation&#160;of&#160;the&#160;first&#160;line.&#160;Fortunately,&#160;fmt&#160;provides&#160;an&#160;op-<br/>tion to&#160;correct&#160;this.<br/>
[me@linuxbox ~]$&#160;<b>fmt -cw 50 fmt-info.txt</b>&#160;<br/>&#160; &#160;`fmt' reads from the specified FILE arguments&#160;<br/>(or standard input if none are given), and writes&#160;<br/>to standard output.&#160;<br/>
&#160; &#160;By default, blank lines, spaces between words,&#160;<br/>and indentation are preserved in the output;&#160;<br/>successive input lines with different indentation&#160;<br/>are not joined; tabs are expanded on input and&#160;<br/>introduced on output.&#160;<br/>
&#160; &#160;`fmt' prefers breaking lines at the end of a&#160;<br/>sentence, and tries to avoid line breaks after&#160;<br/>the first word of a sentence or before the&#160;<br/>last word of a sentence. &#160;A &#34;sentence break&#34;&#160;<br/>is defined as either the end of a paragraph&#160;<br/>or a word ending in any of `.?!', followed&#160;<br/>by two spaces or end of line, ignoring any&#160;<br/>intervening parentheses or quotes. &#160;Like TeX,&#160;<br/>`fmt' reads entire &#34;paragraphs&#34; before choosing&#160;<br/>line breaks; the algorithm is a variant of&#160;<br/>that given by Donald E. Knuth and Michael F.&#160;<br/>Plass in &#34;Breaking Paragraphs Into Lines&#34;,&#160;<br/>`Software--Practice &amp; Experience' 11, 11&#160;<br/>(November 1981), 1119-1184.<br/>
That’s&#160;much better.&#160;By adding the&#160;-c&#160;option, we&#160;now&#160;have&#160;the&#160;desired&#160;result.<br/>
fmt&#160;has&#160;some&#160;interesting options, as&#160;described in&#160;Table&#160;21-3.<br/>
<i>Table&#160;21-3:&#160;fmt&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
-c<br/>
Operate&#160;in&#160;<i>crown margin</i>&#160;mode.&#160;This&#160;preserves&#160;the&#160;indentation of&#160;<br/>the&#160;first&#160;two lines&#160;of a&#160;paragraph. Subsequent&#160;lines&#160;are&#160;aligned&#160;with&#160;<br/>
321<br/>
<hr/>
<a name=346></a>21 – Formatting Output<br/>
the&#160;indentation of the&#160;second line.<br/>
-p&#160;<i>string</i><br/>
Format&#160;only&#160;those&#160;lines&#160;beginning&#160;with the&#160;prefix&#160;<i>string</i>.&#160;After&#160;<br/>formatting, the&#160;contents&#160;of&#160;<i>string</i>&#160;are&#160;prefixed to each reformatted&#160;<br/>line.&#160;This&#160;option&#160;can be&#160;used to&#160;format&#160;text&#160;in&#160;source&#160;code&#160;<br/>comments. For example, any programming&#160;language&#160;or&#160;<br/>configuration file&#160;that&#160;uses&#160;a&#160;“#”&#160;character to delineate&#160;a&#160;comment&#160;<br/>could be&#160;formatted by specifying&#160;-p '# '&#160;so that&#160;only&#160;the&#160;<br/>comments&#160;will&#160;be&#160;formatted. See&#160;the&#160;example&#160;below.<br/>
-s<br/>
Split-only mode. In this&#160;mode, lines&#160;will&#160;only be&#160;split&#160;to fit&#160;the&#160;<br/>specified&#160;column&#160;width. Short&#160;lines&#160;will&#160;not&#160;be&#160;joined&#160;to fill&#160;lines.&#160;<br/>This&#160;mode&#160;is&#160;useful&#160;when formatting text&#160;such as&#160;code&#160;where&#160;<br/>joining&#160;is&#160;not&#160;desired.<br/>
-u<br/>
Perform&#160;uniform&#160;spacing.&#160;This&#160;will&#160;apply&#160;traditional&#160;“typewriter-<br/>style”&#160;formatting to&#160;the&#160;text.&#160;This&#160;means&#160;a&#160;single&#160;space&#160;between&#160;<br/>words&#160;and two spaces&#160;between sentences.&#160;This&#160;mode&#160;is&#160;useful&#160;for&#160;<br/>removing&#160;“justification,”&#160;that&#160;is, text&#160;that&#160;has&#160;been&#160;padded with&#160;<br/>spaces&#160;to force&#160;alignment&#160;on both the&#160;left&#160;and&#160;right&#160;margins.<br/>
-w&#160;<i>width</i><br/>
Format&#160;text&#160;to&#160;fit&#160;within a&#160;column&#160;<i>width</i>&#160;characters&#160;wide.&#160;The&#160;<br/>default&#160;is&#160;75 characters. Note:&#160;fmt&#160;actually&#160;formats&#160;lines&#160;slightly&#160;<br/>shorter than&#160;the&#160;specified width&#160;to allow&#160;for line&#160;balancing.<br/>
The&#160;&#160;-p&#160;option&#160;is&#160;particularly&#160;interesting.&#160;With&#160;it,&#160;we&#160;can&#160;format&#160;selected&#160;portions&#160;of&#160;a<br/>file,&#160;provided&#160;that&#160;the&#160;lines&#160;to&#160;be&#160;formatted&#160;all&#160;begin&#160;with&#160;the&#160;same&#160;sequence&#160;of&#160;charac-<br/>ters.&#160;Many&#160;programming&#160;languages&#160;use&#160;the&#160;pound&#160;sign&#160;(#)&#160;to&#160;indicate&#160;the&#160;beginning&#160;of&#160;a<br/>comment&#160;and&#160;thus&#160;can&#160;be&#160;formatted&#160;using&#160;this&#160;option.&#160;Let’s&#160;create&#160;a&#160;file&#160;that&#160;simulates&#160;a<br/>program&#160;that&#160;uses&#160;comments.<br/>
[me@linuxbox ~]$&#160;<b>cat &gt; fmt-code.txt<br/></b># This file contains code with comments.<br/>
# This line is a comment.&#160;<br/># Followed by another comment line.&#160;<br/># And another.&#160;<br/>
This, on the other hand, is a line of code.&#160;<br/>And another line of code.&#160;<br/>And another.<br/>
Our&#160;sample&#160;file&#160;contains&#160;comments&#160;that&#160;begin&#160;with&#160;the&#160;string&#160;“#&#160;”&#160;(a&#160;#&#160;followed&#160;by&#160;a<br/>
322<br/>
<hr/>
<a name=347></a>Simple&#160;Formatting&#160;Tools<br/>
space)&#160;and&#160;lines&#160;of&#160;“code”&#160;that&#160;do&#160;not.&#160;Now,&#160;using&#160;fmt,&#160;we&#160;can&#160;format&#160;the&#160;comments&#160;and<br/>leave&#160;the&#160;code&#160;untouched.<br/>
[me@linuxbox ~]$&#160;<b>fmt -w 50 -p '# ' fmt-code.txt</b>&#160;<br/># This file contains code with comments.&#160;<br/>
# This line is a comment. Followed by another&#160;<br/># comment line. And another.&#160;<br/>
This, on the other hand, is a line of code.&#160;<br/>And another line of code.&#160;<br/>And another.<br/>
Notice&#160;that&#160;the&#160;adjoining&#160;comment&#160;lines&#160;are&#160;joined,&#160;while&#160;the&#160;blank&#160;lines&#160;and&#160;the&#160;lines<br/>that&#160;do not&#160;begin&#160;with the&#160;specified&#160;prefix are&#160;preserved.<br/>
pr&#160;–&#160;Format&#160;Text&#160;for&#160;Printing<br/>The&#160;pr&#160;program&#160;is&#160;used&#160;to&#160;<i>paginate</i>&#160;text.&#160;When&#160;printing&#160;text,&#160;it&#160;is&#160;often&#160;desirable&#160;to&#160;sepa-<br/>rate&#160;the&#160;pages&#160;of&#160;output&#160;with&#160;several&#160;lines&#160;of&#160;whitespace,&#160;to&#160;provide&#160;a&#160;top&#160;margin&#160;and&#160;a<br/>bottom&#160;margin&#160;for&#160;each&#160;page.&#160;Further,&#160;this&#160;whitespace&#160;can&#160;be&#160;used&#160;to&#160;insert&#160;a&#160;header&#160;and<br/>footer on each page.<br/>We’ll&#160;demonstrate&#160;pr&#160;by&#160;formatting&#160;our&#160;distros.txt&#160;file&#160;into&#160;a&#160;series&#160;of&#160;short&#160;pages<br/>(only the&#160;first&#160;two pages&#160;are&#160;shown).<br/>
[me@linuxbox ~]$&#160;<b>pr -l 15 -w 65 distros.txt</b><br/>
2016-12-11 18:27 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;distros.txt &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Page 1&#160;<br/>
SUSE<br/>
10.2<br/>
12/07/2006&#160;<br/>
Fedora<br/>
10<br/>
11/25/2008&#160;<br/>
SUSE<br/>
11.0<br/>
06/19/2008&#160;<br/>
Ubuntu<br/>
8.04<br/>
04/24/2008&#160;<br/>
Fedora<br/>
8<br/>
11/08/2007&#160;<br/>
323<br/>
<hr/>
<a name=348></a>21 – Formatting Output<br/>
2016-12-11 18:27 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;distros.txt &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Page 2&#160;<br/>
SUSE<br/>
10.3<br/>
10/04/2007&#160;<br/>
Ubuntu<br/>
6.10<br/>
10/26/2006&#160;<br/>
Fedora<br/>
7<br/>
05/31/2007&#160;<br/>
Ubuntu<br/>
7.10<br/>
10/18/2007&#160;<br/>
Ubuntu<br/>
7.04<br/>
04/19/2007<br/>
In&#160;this&#160;example,&#160;we&#160;employ&#160;the&#160;&#160;-l&#160;&#160;option&#160;(for&#160;page&#160;length)&#160;and&#160;the&#160;&#160;-w&#160;&#160;option&#160;(page<br/>width)&#160;to&#160;define&#160;a&#160;“page”&#160;that&#160;is&#160;65&#160;columns&#160;wide&#160;and&#160;15&#160;lines&#160;long.&#160;pr&#160;paginates&#160;the<br/>contents&#160;of the&#160;distros.txt&#160;file,&#160;separates&#160;each page&#160;with several&#160;lines&#160;of whitespace,<br/>and&#160;creates&#160;a&#160;default&#160;header&#160;containing&#160;the&#160;file&#160;modification&#160;time,&#160;filename,&#160;and&#160;page<br/>number.&#160;The&#160;pr&#160;program&#160;provides&#160;many&#160;options&#160;to&#160;control&#160;page&#160;layout.&#160;We’ll&#160;take&#160;a&#160;look<br/>at&#160;them&#160;in&#160;Chapter 22, “Printing.”<br/>
printf&#160;–&#160;Format&#160;and&#160;Print&#160;Data<br/>Unlike&#160;the&#160;other&#160;commands&#160;in&#160;this&#160;chapter,&#160;the&#160;printf&#160;command&#160;is&#160;not&#160;used&#160;for&#160;pipe-<br/>lines&#160;(it&#160;does&#160;not&#160;accept&#160;standard&#160;input)&#160;nor&#160;does&#160;it&#160;find&#160;frequent&#160;application&#160;directly&#160;on<br/>the&#160;command&#160;line&#160;(it’s&#160;mostly&#160;used&#160;in&#160;scripts).&#160;So&#160;why&#160;is&#160;it&#160;important?&#160;Because&#160;it&#160;is&#160;so<br/>widely used.<br/>
printf&#160;&#160;(from&#160;the&#160;phrase&#160;“print&#160;formatted”)&#160;was&#160;originally&#160;developed&#160;for&#160;the&#160;C&#160;pro-<br/>gramming&#160;language&#160;and&#160;has&#160;been&#160;implemented&#160;in&#160;many&#160;programming&#160;languages&#160;includ-<br/>ing the&#160;shell. In fact, in&#160;bash,&#160;printf&#160;is&#160;a&#160;builtin.<br/>
printf&#160;works&#160;like&#160;this:<br/>printf “<i>format</i>”&#160;<i>arguments<br/></i>The&#160;command&#160;is&#160;given&#160;a&#160;string&#160;containing&#160;a&#160;format&#160;description,&#160;which&#160;is&#160;then&#160;applied&#160;to&#160;a<br/>list&#160;of&#160;arguments.&#160;The&#160;formatted&#160;result&#160;is&#160;sent&#160;to&#160;standard&#160;output.&#160;Here&#160;is&#160;a&#160;trivial&#160;exam-<br/>ple:<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;I formatted the string: %s\n&#34; foo</b>&#160;<br/>I formatted the string: foo<br/>
The&#160;format&#160;string&#160;may&#160;contain&#160;literal&#160;text&#160;(like&#160;“I&#160;formatted&#160;the&#160;string:”),&#160;escape&#160;se-<br/>quences&#160;(such&#160;as&#160;\n,&#160;a&#160;newline&#160;character),&#160;and&#160;sequences&#160;beginning&#160;with&#160;the&#160;%&#160;character,<br/>
324<br/>
<hr/>
<a name=349></a>Simple&#160;Formatting&#160;Tools<br/>
which&#160;are&#160;called&#160;<i>conversion&#160;specifications</i>.&#160;In&#160;the&#160;example&#160;above,&#160;the&#160;conversion&#160;specifi-<br/>cation&#160;%s&#160;is&#160;used&#160;to&#160;format&#160;the&#160;string&#160;“foo”&#160;and&#160;place&#160;it&#160;in&#160;the&#160;command’s&#160;output.&#160;Here&#160;it<br/>is&#160;again:<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;I formatted '%s' as a string.\n&#34; foo</b>&#160;<br/>I formatted 'foo' as a string.<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;%s&#160;conversion&#160;specification&#160;is&#160;replaced&#160;by&#160;the&#160;string&#160;“foo”&#160;in the&#160;com-<br/>mand’s&#160;output.&#160;The&#160;s&#160;conversion&#160;is&#160;used&#160;to&#160;format&#160;string&#160;data.&#160;There&#160;are&#160;other&#160;specifiers<br/>for other kinds&#160;of data.&#160;Table&#160;21-4 lists&#160;the&#160;commonly&#160;used data&#160;types.<br/>
<i>Table&#160;21-4: Common&#160;printf&#160;Data&#160;Type&#160;Specifiers</i><br/>
<b>Specifier</b><br/>
<b>Description</b><br/>
d<br/>
Format&#160;a&#160;number as&#160;a&#160;signed&#160;decimal&#160;integer.<br/>
f<br/>
Format&#160;and&#160;output&#160;a&#160;floating-point&#160;number.<br/>
o<br/>
Format&#160;an&#160;integer&#160;as&#160;an octal&#160;number.<br/>
s<br/>
Format&#160;a&#160;string.<br/>
x<br/>
Format&#160;an&#160;integer&#160;as&#160;a&#160;hexadecimal&#160;number&#160;using lowercase&#160;a&#160;to&#160;f&#160;<br/>where&#160;needed.<br/>
X<br/>
Same&#160;as&#160;x&#160;but&#160;use&#160;uppercase&#160;letters.<br/>
%<br/>
Print&#160;a&#160;literal&#160;%&#160;symbol&#160;(i.e., specify&#160;%%)<br/>
We’ll&#160;demonstrate&#160;the&#160;effect&#160;each of the&#160;conversion specifiers&#160;on the&#160;string&#160;380.<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;%d, %f, %o, %s, %x, %X\n&#34; 380 380 380 380&#160;<br/>380 380</b>&#160;<br/>380, 380.000000, 574, 380, 17c, 17C<br/>
Since&#160;we&#160;specified&#160;six&#160;conversion&#160;specifiers,&#160;we&#160;must&#160;also&#160;supply&#160;six&#160;arguments&#160;for<br/>printf&#160;to process.&#160;The&#160;six results&#160;show&#160;the&#160;effect&#160;of each specifier.<br/>Several&#160;optional&#160;components&#160;may&#160;be&#160;added&#160;to&#160;the&#160;conversion&#160;specifier&#160;to&#160;adjust&#160;its&#160;out-<br/>put.&#160;A&#160;complete&#160;conversion&#160;specification&#160;may consist&#160;of the&#160;following:<br/>%[<i>flags</i>][<i>width</i>][<i>.precision</i>]conversion_specification<br/>
Multiple&#160;optional&#160;components,&#160;when&#160;used, must&#160;appear&#160;in the&#160;order&#160;specified&#160;earlier&#160;to&#160;be<br/>
325<br/>
<hr/>
<a name=350></a>21 – Formatting Output<br/>
properly interpreted.&#160;Table&#160;21-5 describes&#160;each.<br/>
<i>Table&#160;21-5:&#160;printf&#160;Conversion Specification&#160;Components</i><br/>
<b>Component</b><br/>
<b>Description</b><br/>
<i>flags</i><br/>
There&#160;are&#160;five&#160;different&#160;flags:<br/>
#&#160;:&#160;Use&#160;the&#160;“alternate&#160;format”&#160;for output.&#160;This&#160;varies&#160;by data&#160;type.<br/>For&#160;o&#160;(octal&#160;number)&#160;conversion, the&#160;output&#160;is&#160;prefixed with&#160;0.&#160;<br/>For&#160;x&#160;and&#160;X&#160;(hexadecimal&#160;number) conversions, the&#160;output&#160;is&#160;<br/>prefixed&#160;with&#160;0x&#160;or&#160;0X&#160;respectively.<br/>
0&#160;(zero):&#160;Pad the&#160;output&#160;with zeros.&#160;This&#160;means&#160;that&#160;the&#160;field will&#160;<br/>be&#160;filled with&#160;leading&#160;zeros, as&#160;in&#160;000380.<br/>
-&#160;(dash):&#160;Left-align&#160;the&#160;output. By default,&#160;printf&#160;right-aligns&#160;<br/>output.<br/>
‘ ’&#160;(space):&#160;Produce&#160;a&#160;leading space&#160;for positive&#160;numbers.<br/>
+&#160;(plus&#160;sign):&#160;Sign positive&#160;numbers. By default,&#160;printf&#160;only&#160;<br/>signs&#160;negative&#160;numbers.&#160;<br/>
<i>width</i><br/>
A&#160;number specifying the&#160;minimum&#160;field width.<br/>
<i>.precision</i><br/>
For floating-point&#160;numbers, specify the&#160;number of digits&#160;of&#160;<br/>precision&#160;to be&#160;output&#160;after&#160;the&#160;decimal&#160;point.&#160;For string&#160;<br/>conversion,&#160;<i>precision</i>&#160;specifies&#160;the&#160;number of characters&#160;to&#160;<br/>output.<br/>
Table&#160;21-6 lists&#160;some&#160;examples&#160;of different&#160;formats&#160;in action.<br/>
<i>Table&#160;21-6:&#160;printf&#160;Conversion Specification&#160;Examples</i><br/>
<b>Argument</b><br/>
<b>Format</b><br/>
<b>Result</b><br/>
<b>Notes</b><br/>
380<br/>
&#34;%d&#34;<br/>
380<br/>
Simple&#160;formatting&#160;of an&#160;<br/>integer.<br/>
380<br/>
&#34;%#x&#34;<br/>
0x17c<br/>
Integer formatted&#160;as&#160;a&#160;<br/>hexadecimal&#160;number using&#160;<br/>the&#160;“alternate&#160;format”&#160;flag.<br/>
380<br/>
&#34;%05d&#34;<br/>
00380<br/>
Integer formatted&#160;with&#160;<br/>leading zeros&#160;(padding)&#160;<br/>and&#160;a&#160;minimum&#160;field width<br/>
326<br/>
<hr/>
<a name=351></a>Simple&#160;Formatting&#160;Tools<br/>
of five&#160;characters.<br/>
380<br/>
&#34;%05.5f&#34;<br/>
380.00000<br/>
Number&#160;formatted as&#160;a&#160;<br/>floating-point&#160;number&#160;with<br/>padding&#160;and five&#160;decimal&#160;<br/>places&#160;of precision.&#160;Since&#160;<br/>the&#160;specified&#160;minimum&#160;<br/>field width&#160;(5) is&#160;less&#160;than&#160;<br/>the&#160;actual&#160;width&#160;of the&#160;<br/>formatted&#160;number,&#160;the&#160;<br/>padding&#160;has&#160;no effect.<br/>
380<br/>
&#34;%010.5f&#34;<br/>
0380.00000<br/>
By increasing the&#160;<br/>minimum&#160;field&#160;width to&#160;10,<br/>the&#160;padding is&#160;now&#160;visible.<br/>
380<br/>
&#34;%+d&#34;<br/>
+380<br/>
The&#160;+&#160;flag signs&#160;a&#160;positive&#160;<br/>number.<br/>
380<br/>
&#34;%-d&#34;<br/>
380<br/>
The&#160;- flag left-aligns&#160;the&#160;<br/>formatting.<br/>
abcdefghijk<br/>
&#34;%5s&#34;<br/>
abcedfghijk<br/>
A&#160;string&#160;formatted with a&#160;<br/>minimum&#160;field&#160;width.<br/>
abcdefghijk<br/>
&#34;%.5s&#34;<br/>
abcde<br/>
By applying precision to a&#160;<br/>string,&#160;it&#160;is&#160;truncated.<br/>
Again,&#160;&#160;printf&#160;&#160;is&#160;used&#160;mostly&#160;in&#160;scripts&#160;where&#160;it&#160;is&#160;employed&#160;to&#160;format&#160;&#160;tabular&#160;data,<br/>rather&#160;than&#160;on&#160;the&#160;command&#160;line&#160;directly.&#160;But&#160;we&#160;can&#160;still&#160;show&#160;how&#160;it&#160;can&#160;be&#160;used&#160;to<br/>solve&#160;various&#160;formatting&#160;problems.&#160;First,&#160;let’s&#160;output&#160;some&#160;fields&#160;separated&#160;by&#160;tab&#160;charac-<br/>ters.<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;%s\t%s\t%s\n&#34; str1 str2 str3&#160;<br/></b>str1<br/>
str2&#160;str3<br/>
By&#160;inserting&#160;\t&#160;(the&#160;escape&#160;sequence&#160;for&#160;a&#160;tab),&#160;we&#160;achieve&#160;the&#160;desired&#160;effect.&#160;Next,&#160;here<br/>are&#160;some&#160;numbers&#160;with neat&#160;formatting:<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;Line: %05d %15.3f Result: %+15d\n&#34; 1071&#160;<br/>3.14156295 32589</b>&#160;<br/>Line: 01071 &#160; &#160; &#160; &#160; &#160; 3.142 Result: &#160; &#160; &#160; &#160; &#160;+32589<br/>
327<br/>
<hr/>
<a name=352></a>21 – Formatting Output<br/>
This&#160;shows&#160;the&#160;effect&#160;of&#160;minimum&#160;field&#160;width&#160;on&#160;the&#160;spacing&#160;of&#160;the&#160;fields.&#160;Or&#160;how&#160;about<br/>formatting a&#160;tiny web page?<br/>
[me@linuxbox ~]$&#160;<b>printf &#34;&lt;html&gt;\n\t&lt;head&gt;\n\t\t&lt;title&gt;%s&lt;/title&gt;\n<br/>\t&lt;/head&gt;\n\t&lt;body&gt;\n\t\t&lt;p&gt;%s&lt;/p&gt;\n\t&lt;/body&gt;\n&lt;/html&gt;\n&#34; &#34;Page Tit<br/>le&#34; &#34;Page Content&#34;</b>&#160;<br/>&lt;html&gt;&#160;<br/>
&lt;head&gt;&#160;<br/>
&lt;title&gt;Page Title&lt;/title&gt;&#160;<br/>
&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;<br/>
&lt;p&gt;Page Content&lt;/p&gt;&#160;<br/>
&lt;/body&gt;&#160;<br/>
&lt;/html&gt;<br/>
<b>Document&#160;Formatting&#160;Systems<br/></b>So far,&#160;we&#160;have&#160;examined&#160;the&#160;simple&#160;text-formatting&#160;tools.&#160;These&#160;are&#160;good&#160;for small,&#160;sim-<br/>ple&#160;tasks,&#160;but&#160;what&#160;about&#160;larger&#160;jobs?&#160;One&#160;of&#160;the&#160;reasons&#160;that&#160;Unix&#160;became&#160;a&#160;popular&#160;op-<br/>erating&#160;system&#160;among&#160;technical&#160;and&#160;scientific&#160;users&#160;(aside&#160;from&#160;providing&#160;a&#160;powerful<br/>multitasking,&#160;multiuser&#160;environment&#160;for&#160;all&#160;kinds&#160;of&#160;software&#160;development)&#160;is&#160;that&#160;it&#160;of-<br/>fered&#160;tools&#160;that&#160;could&#160;be&#160;used&#160;to&#160;produce&#160;many&#160;types&#160;of&#160;documents,&#160;particularly&#160;scientific<br/>and&#160;&#160;&#160;academic&#160;&#160;&#160;publications.&#160;&#160;&#160;In&#160;&#160;&#160;fact,&#160;&#160;&#160;as&#160;&#160;&#160;the&#160;&#160;&#160;GNU&#160;&#160;&#160;documentation&#160;&#160;&#160;describes,&#160;&#160;&#160;document<br/>preparation was&#160;instrumental&#160;to the&#160;development&#160;of Unix.<br/>
<i>The&#160;first&#160;version&#160;of&#160;UNIX&#160;was&#160;developed on a PDP-7 which was&#160;sitting&#160;around Bell<br/>Labs.&#160;In&#160;1971&#160;the&#160;developers&#160;wanted&#160;to&#160;get&#160;a&#160;PDP-11&#160;for&#160;further&#160;work&#160;on&#160;the<br/>operating&#160;system. In order&#160;to justify&#160;the&#160;cost&#160;for&#160;this&#160;system, they&#160;proposed that&#160;they<br/>would&#160;implement&#160;a document&#160;formatting&#160;system&#160;for&#160;the&#160;AT&amp;T&#160;patents&#160;division.&#160;This<br/>first&#160;formatting&#160;program&#160;was&#160;a&#160;reimplementation&#160;of&#160;McIllroy's&#160;`roff',&#160;written&#160;by&#160;J.<br/>F. Ossanna.</i><br/>
Two&#160;main&#160;families&#160;of&#160;document&#160;formatters&#160;dominate&#160;the&#160;field:&#160;those&#160;descended&#160;from&#160;the<br/>original&#160;&#160;roff&#160;&#160;program,&#160;&#160;&#160;including&#160;&#160;nroff&#160;&#160;and&#160;&#160;troff,&#160;&#160;&#160;and&#160;&#160;&#160;those&#160;&#160;&#160;based&#160;&#160;&#160;on&#160;&#160;&#160;Donald<br/>Knuth’s&#160;&#160;TEX&#160;&#160;(pronounced&#160;“tek”)&#160;typesetting&#160;system.&#160;And&#160;yes,&#160;the&#160;dropped&#160;“E”&#160;in&#160;the<br/>middle&#160;is&#160;part&#160;of its&#160;name.<br/>The&#160;name&#160;“roff”&#160;is&#160;derived&#160;from&#160;the&#160;term&#160;“run&#160;off”&#160;as&#160;in,&#160;“I’ll&#160;run&#160;off&#160;a&#160;copy&#160;for&#160;you.”<br/>The&#160;&#160;nroff&#160;&#160;program&#160;&#160;&#160;is&#160;&#160;&#160;used&#160;&#160;&#160;to&#160;&#160;&#160;format&#160;&#160;&#160;documents&#160;&#160;&#160;for&#160;&#160;&#160;output&#160;&#160;&#160;to&#160;&#160;&#160;devices&#160;&#160;&#160;that&#160;&#160;&#160;use<br/>monospaced&#160;fonts,&#160;such&#160;as&#160;character&#160;terminals&#160;and&#160;typewriter-style&#160;printers.&#160;At&#160;the&#160;time<br/>of&#160;its&#160;introduction,&#160;this&#160;included&#160;nearly&#160;all&#160;printing&#160;devices&#160;attached&#160;to&#160;computers.&#160;The<br/>later&#160;troff&#160;program&#160;formats&#160;documents&#160;for&#160;output&#160;on&#160;<i>typesetters</i>,&#160;devices&#160;used&#160;to&#160;pro-<br/>duce&#160;“camera-ready”&#160;type&#160;for commercial&#160;printing.&#160;Most&#160;computer printers&#160;today&#160;are&#160;able<br/>
328<br/>
<hr/>
<a name=353></a>Document&#160;Formatting Systems<br/>
to simulate&#160;the&#160;output&#160;of&#160;typesetters.&#160;The&#160;roff&#160;family also includes&#160;some&#160;other&#160;programs<br/>that&#160;are&#160;used&#160;to&#160;prepare&#160;portions&#160;of&#160;documents.&#160;These&#160;include&#160;&#160;eqn&#160;&#160;(for&#160;mathematical<br/>equations)&#160;and&#160;tbl&#160;(for tables).<br/>The&#160;TEX&#160;system&#160;(in&#160;stable&#160;form)&#160;first&#160;appeared&#160;in&#160;1989&#160;and&#160;has,&#160;to&#160;some&#160;degree,&#160;dis-<br/>placed&#160;&#160;troff&#160;&#160;as&#160;the&#160;tool&#160;of&#160;choice&#160;for&#160;typesetter&#160;output.&#160;We&#160;won’t&#160;be&#160;covering&#160;TEX<br/>here,&#160;both&#160;because&#160;of&#160;its&#160;complexity&#160;(there&#160;are&#160;entire&#160;books&#160;about&#160;it)&#160;and&#160;becaues&#160;it&#160;is&#160;not<br/>installed by default&#160;on most&#160;modern Linux systems.<br/>
<b>Tip:</b>&#160;&#160;For&#160;those&#160;interested&#160;in&#160;installing&#160;TEX,&#160;check&#160;out&#160;the&#160;&#160;texlive&#160;&#160;package<br/>which&#160;can&#160;be&#160;found&#160;in&#160;most&#160;distribution&#160;repositories,&#160;and&#160;the&#160;LyX&#160;graphical&#160;con-<br/>tent&#160;editor.<br/>
groff<br/>groff&#160;is&#160;a&#160;suite&#160;of&#160;programs&#160;containing&#160;the&#160;GNU&#160;implementation&#160;of&#160;troff.&#160;It&#160;also&#160;in-<br/>cludes&#160;a&#160;script&#160;that&#160;is&#160;used to emulate&#160;nroff&#160;and&#160;the&#160;rest&#160;of the&#160;roff&#160;family as&#160;well.<br/>While&#160;roff&#160;and&#160;its&#160;descendants&#160;are&#160;used&#160;to&#160;make&#160;formatted&#160;documents,&#160;they&#160;do&#160;it&#160;in&#160;a<br/>way&#160;that&#160;is&#160;rather&#160;foreign&#160;to&#160;modern&#160;users.&#160;Most&#160;documents&#160;today&#160;are&#160;produced&#160;using<br/>word&#160;processors&#160;that&#160;are&#160;able&#160;to&#160;perform&#160;both&#160;the&#160;composition&#160;and&#160;the&#160;layout&#160;of&#160;a&#160;docu-<br/>ment&#160;in&#160;a&#160;single&#160;step.&#160;Prior&#160;to&#160;the&#160;advent&#160;of&#160;the&#160;graphical&#160;word&#160;processor,&#160;documents<br/>were&#160;often&#160;produced&#160;in&#160;a&#160;two-step&#160;process&#160;involving&#160;the&#160;use&#160;of&#160;a&#160;text&#160;editor&#160;to&#160;perform<br/>composition,&#160;and&#160;a&#160;processor,&#160;such&#160;as&#160;troff,&#160;to&#160;apply&#160;the&#160;formatting.&#160;Instructions&#160;for<br/>the&#160;formatting&#160;program&#160;were&#160;embedded&#160;into&#160;the&#160;composed&#160;text&#160;through&#160;the&#160;use&#160;of&#160;a<br/>markup&#160;language.&#160;The&#160;modern&#160;analog&#160;for&#160;such&#160;a&#160;process&#160;is&#160;the&#160;web&#160;page,&#160;which&#160;is&#160;com-<br/>posed&#160;using&#160;a&#160;text&#160;editor&#160;of&#160;some&#160;kind&#160;and&#160;then&#160;rendered&#160;by&#160;a&#160;web&#160;browser&#160;using&#160;HTML<br/>as&#160;the&#160;markup&#160;language&#160;to describe&#160;the&#160;final&#160;page&#160;layout.<br/>We’re&#160;not&#160;going&#160;to&#160;cover&#160;groff&#160;in&#160;its&#160;entirety,&#160;as&#160;many&#160;elements&#160;of&#160;its&#160;markup&#160;language<br/>deal&#160;with&#160;rather&#160;arcane&#160;details&#160;of&#160;typography.&#160;Instead,&#160;we&#160;will&#160;concentrate&#160;on&#160;one&#160;of&#160;its<br/><i>macro&#160;packages</i>&#160;that&#160;remains&#160;in&#160;wide&#160;use.&#160;These&#160;macro&#160;packages&#160;condense&#160;many&#160;of&#160;its<br/>low-level&#160;commands&#160;into&#160;a&#160;smaller&#160;set&#160;of&#160;high-level&#160;commands&#160;that&#160;make&#160;using&#160;groff<br/>much easier.<br/>For&#160;a&#160;moment,&#160;let’s&#160;consider&#160;the&#160;humble&#160;man&#160;page.&#160;It&#160;lives&#160;in&#160;the&#160;/usr/share/man<br/>directory&#160;as&#160;a&#160;gzip&#160;compressed&#160;text&#160;file.&#160;If&#160;we&#160;were&#160;to&#160;examine&#160;its&#160;uncompressed&#160;con-<br/>tents, we&#160;would see&#160;the&#160;following&#160;(the&#160;man&#160;page&#160;for&#160;ls&#160;in&#160;section 1 is&#160;shown):<br/>
[me@linuxbox ~]$&#160;<b>zcat /usr/share/man/man1/ls.1.gz | head</b>&#160;<br/>.\&#34; DO NOT MODIFY THIS FILE! &#160;It was generated by help2man 1.47.3.<br/>
329<br/>
<hr/>
<a name=354></a>21 – Formatting Output<br/>
.TH LS &#34;1&#34; &#34;January 2018&#34; &#34;GNU coreutils 8.28&#34; &#34;User Commands&#34;<br/>.SH NAME<br/>ls \- list directory contents<br/>.SH SYNOPSIS<br/>.B ls<br/>[\fI\,OPTION\/\fR]... [\fI\,FILE\/\fR]...<br/>.SH DESCRIPTION<br/>.\&#34; Add any additional description here<br/>.PP<br/>
Compared&#160;to&#160;the&#160;man&#160;page&#160;in&#160;its&#160;normal&#160;presentation,&#160;we&#160;can&#160;begin&#160;to&#160;see&#160;a&#160;correlation<br/>between&#160;the&#160;markup&#160;language&#160;and its&#160;results.<br/>
[me@linuxbox ~]$&#160;<b>man ls | head&#160;<br/></b>LS(1) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; User Commands &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;LS(1)&#160;<br/>
NAME&#160;<br/>&#160; &#160; &#160; &#160;ls - list directory contents&#160;<br/>
SYNOPSIS&#160;<br/>&#160; &#160; &#160; &#160;ls [OPTION]... [FILE]...<br/>
The&#160;reason&#160;this&#160;is&#160;of&#160;interest&#160;is&#160;that&#160;man&#160;pages&#160;are&#160;rendered&#160;by&#160;groff,&#160;using&#160;the&#160;man-<br/>doc&#160;macro&#160;package.&#160;In&#160;fact,&#160;we&#160;can&#160;simulate&#160;the&#160;man&#160;command&#160;with&#160;the&#160;following&#160;pipe-<br/>line:<br/>
[me@linuxbox ~]$&#160;<b>zcat /usr/share/man/man1/ls.1.gz | groff -mandoc -T&#160;<br/>ascii | head</b>&#160;<br/>LS(1) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; User Commands &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;LS(1)&#160;<br/>
NAME&#160;<br/>&#160; &#160; &#160; &#160;ls - list directory contents&#160;<br/>
SYNOPSIS&#160;<br/>&#160; &#160; &#160; &#160;ls [OPTION]... [FILE]...<br/>
Here&#160;we&#160;use&#160;the&#160;&#160;groff&#160;&#160;program&#160;with&#160;the&#160;options&#160;set&#160;to&#160;specify&#160;the&#160;&#160;mandoc&#160;&#160;macro<br/>
330<br/>
<hr/>
<a name=355></a>Document&#160;Formatting Systems<br/>
package&#160;and&#160;the&#160;output&#160;driver&#160;for&#160;ASCII.&#160;groff&#160;can&#160;produce&#160;output&#160;in&#160;several&#160;formats.<br/>If no format&#160;is&#160;specified,&#160;PostScript&#160;is&#160;output&#160;by default.<br/>
[me@linuxbox ~]$&#160;<b>zcat /usr/share/man/man1/ls.1.gz | groff -mandoc |&#160;<br/>head&#160;<br/></b>%!PS-Adobe-3.0&#160;<br/>%%Creator: groff version 1.18.1&#160;<br/>%%CreationDate: Thu Feb &#160;5 13:44:37 2009&#160;<br/>%%DocumentNeededResources: font Times-Roman&#160;<br/>%%+ font Times-Bold&#160;<br/>%%+ font Times-Italic&#160;<br/>%%DocumentSuppliedResources: procset grops 1.18 1&#160;<br/>%%Pages: 4&#160;<br/>%%PageOrder: Ascend&#160;<br/>%%Orientation: Portrait<br/>
We&#160;briefly&#160;mentioned&#160;PostScript&#160;in&#160;the&#160;previous&#160;chapter&#160;and&#160;will&#160;again&#160;in&#160;the&#160;next&#160;chap-<br/>ter.&#160;PostScript&#160;is&#160;a&#160;&#160;page&#160;description&#160;language&#160;&#160;that&#160;is&#160;used&#160;to&#160;describe&#160;the&#160;contents&#160;of&#160;a<br/>printed&#160;page&#160;to&#160;a&#160;typesetter-like&#160;device.&#160;If&#160;we&#160;take&#160;the&#160;output&#160;of&#160;our&#160;command&#160;and&#160;store&#160;it<br/>to&#160;a&#160;file&#160;(assuming&#160;that&#160;we&#160;are&#160;using&#160;a&#160;graphical&#160;desktop&#160;with&#160;a&#160;Desktop&#160;directory),&#160;an<br/>icon for the&#160;output&#160;file&#160;should&#160;appear on the&#160;desktop.&#160;<br/>
[me@linuxbox ~]$&#160;<b>zcat /usr/share/man/man1/ls.1.gz | groff -mandoc &gt;&#160;<br/>~/Desktop/ls.ps</b><br/>
By&#160;double-clicking&#160;the&#160;icon,&#160;a&#160;page&#160;viewer&#160;should&#160;start&#160;up&#160;and&#160;reveal&#160;the&#160;file&#160;in&#160;its&#160;ren-<br/>dered form,&#160;as&#160;shown in Figure&#160;5.<br/>
331<br/>
<hr/>
<a name=356></a><img src="linux-command-line-356_1.png"/><br/>
21 – Formatting Output<br/>
<i>Figure&#160;5: Viewing PostScript&#160;output&#160;with a page&#160;viewer&#160;in&#160;GNOME</i><br/>
What&#160;we&#160;see&#160;is&#160;a&#160;nicely typeset&#160;man&#160;page&#160;for&#160;ls! In fact, it’s&#160;possible&#160;to convert&#160;the&#160;Post-<br/>Script&#160;file&#160;into a&#160;<i>Portable&#160;Document&#160;Format</i>&#160;(PDF) file&#160;with&#160;this&#160;command:<br/>
[me@linuxbox ~]$&#160;<b>ps2pdf ~/Desktop/foo.ps ~/Desktop/ls.pdf</b><br/>
The&#160;ps2pdf&#160;program&#160;is&#160;part&#160;of&#160;the&#160;ghostscript&#160;package,&#160;which&#160;is&#160;installed&#160;on&#160;most<br/>Linux systems&#160;that&#160;support&#160;printing.<br/>
<b>Tip</b>:&#160;Linux&#160;systems&#160;often&#160;include&#160;many&#160;command&#160;line&#160;programs&#160;for&#160;file&#160;format<br/>conversion.&#160;They&#160;are&#160;often&#160;named&#160;using&#160;the&#160;convention&#160;of&#160;&#160;<i>format</i>2<i>format</i>.&#160;Try<br/>using&#160;&#160;&#160;the&#160;&#160;&#160;command&#160;&#160;ls&#160;&#160;&#160;/usr/bin/*[[:alpha:]]2[[:alpha:]]*&#160;&#160;to<br/>identify&#160;them.&#160;Also try searching&#160;for programs&#160;named&#160;<i>format</i><b>to</b><i>format</i>.<br/>
For&#160;our&#160;last&#160;exercise&#160;with&#160;&#160;groff,&#160;we&#160;will&#160;revisit&#160;our&#160;old&#160;friend&#160;distros.txt.&#160;This<br/>time,&#160;we&#160;will&#160;use&#160;the&#160;tbl&#160;program,&#160;which&#160;is&#160;used&#160;to&#160;format&#160;tables&#160;to&#160;typeset&#160;our&#160;list&#160;of<br/>Linux&#160;distributions.&#160;To&#160;do&#160;this,&#160;we&#160;are&#160;going&#160;to&#160;use&#160;our&#160;earlier&#160;sed&#160;script&#160;to&#160;add&#160;markup<br/>
332<br/>
<hr/>
<a name=357></a>Document&#160;Formatting Systems<br/>
to a&#160;text&#160;stream&#160;that&#160;we&#160;will&#160;feed to&#160;groff.<br/>First,&#160;we&#160;need&#160;to&#160;modify&#160;our&#160;sed&#160;script&#160;to&#160;add&#160;the&#160;necessary&#160;markup&#160;elements&#160;(called&#160;<i>re-<br/>quests</i>&#160;in&#160;groff)&#160;that&#160;tbl&#160;requires.&#160;Using&#160;a&#160;text&#160;editor,&#160;we&#160;will&#160;change&#160;distros.sed<br/>to the&#160;following:<br/>
# sed script to produce Linux distributions report&#160;<br/>
<b>1 i\&#160;<br/>.TS\&#160;<br/>center box;\&#160;<br/>cb s s\&#160;<br/>cb cb cb\&#160;<br/>l n c.\&#160;<br/>Linux Distributions Report\&#160;<br/>=\&#160;<br/>Name</b><br/>
<b>Version</b><br/>
<b>Released\&#160;</b><br/>
<b>_&#160;<br/></b>s/\([0-9]\{2\}\)\/\([0-9]\{2\}\)\/\([0-9]\{4\}\)$/\3-\1-\2/&#160;<br/><b>$ a\&#160;<br/>.TE</b><br/>
Note&#160;that&#160;for the&#160;script&#160;to work properly,&#160;care&#160;must&#160;been taken to&#160;see&#160;that&#160;the&#160;words&#160;Name<br/>Version&#160;Released&#160;are&#160;separated&#160;by&#160;tabs,&#160;not&#160;spaces.&#160;We’ll&#160;save&#160;the&#160;resulting&#160;file&#160;as<br/>distros-tbl.sed.&#160;&#160;tbl&#160;&#160;uses&#160;the&#160;&#160;.TS&#160;&#160;and&#160;&#160;.TE&#160;&#160;requests&#160;to&#160;start&#160;and&#160;end&#160;the&#160;table.<br/>The&#160;rows&#160;following&#160;the&#160;.TS&#160;request&#160;define&#160;global&#160;properties&#160;of&#160;the&#160;table,&#160;which,&#160;for&#160;our<br/>example,&#160;are&#160;centered&#160;horizontally&#160;on&#160;the&#160;page&#160;and&#160;surrounded&#160;by&#160;a&#160;box.&#160;The&#160;remaining<br/>lines&#160;of&#160;the&#160;definition&#160;describe&#160;the&#160;layout&#160;of&#160;each&#160;table&#160;row.&#160;Now,&#160;if&#160;we&#160;run&#160;our&#160;report-<br/>generating pipeline&#160;again&#160;with the&#160;new&#160;sed&#160;script,&#160;we’ll&#160;get&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>sort -k 1,1 -k 2n distros.txt | sed -f distros-tbl<br/>.sed | groff -t -T ascii<br/></b>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;+------------------------------+&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|&#160;<b>Linux Distributions Report</b>&#160; &#160;|&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;+------------------------------+&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|&#160;<b>Name &#160; &#160;Version &#160; &#160;Released</b>&#160; |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;+------------------------------+&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160; 5 &#160; &#160; &#160; 2006-03-20 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160; 6 &#160; &#160; &#160; 2006-10-24 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160; 7 &#160; &#160; &#160; 2007-05-31 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160; 8 &#160; &#160; &#160; 2007-11-08 |&#160;<br/>
333<br/>
<hr/>
<a name=358></a>21 – Formatting Output<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160; 9 &#160; &#160; &#160; 2008-05-13 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Fedora &#160; &#160;10 &#160; &#160; &#160; 2008-11-25 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|SUSE &#160; &#160; &#160;10.1 &#160; &#160; 2006-05-11 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|SUSE &#160; &#160; &#160;10.2 &#160; &#160; 2006-12-07 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|SUSE &#160; &#160; &#160;10.3 &#160; &#160; 2007-10-04 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|SUSE &#160; &#160; &#160;11.0 &#160; &#160; 2008-06-19 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 6.06 &#160; &#160;2006-06-01 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 6.10 &#160; &#160;2006-10-26 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 7.04 &#160; &#160;2007-04-19 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 7.10 &#160; &#160;2007-10-18 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 8.04 &#160; &#160;2008-04-24 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;|Ubuntu &#160; &#160; 8.10 &#160; &#160;2008-10-30 |&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;+------------------------------+<br/>
Adding&#160;the&#160;-t&#160;option&#160;to&#160;groff&#160;instructs&#160;it&#160;to&#160;preprocess&#160;the&#160;text&#160;stream&#160;with&#160;tbl.&#160;Like-<br/>wise,&#160;the&#160;&#160;-T&#160;&#160;option&#160;is&#160;used&#160;to&#160;output&#160;to&#160;ASCII&#160;rather&#160;than&#160;the&#160;default&#160;output&#160;medium,<br/>PostScript.<br/>The&#160;format&#160;of&#160;the&#160;output&#160;is&#160;the&#160;best&#160;we&#160;can&#160;expect&#160;if&#160;we&#160;are&#160;limited&#160;to&#160;the&#160;capabilities&#160;of a<br/>terminal&#160;screen or typewriter-style&#160;printer.&#160;If we&#160;specify PostScript&#160;output&#160;and graphically<br/>view&#160;the&#160;output, we&#160;get&#160;a&#160;much&#160;more&#160;satisfying&#160;result, as&#160;shown in Figure&#160;6.<br/>
[me@linuxbox ~]$&#160;<b>sort -k 1,1 -k 2n distros.txt | sed -f distros-tbl<br/>.sed | groff -t &gt; ~/Desktop/foo.ps</b><br/>
334<br/>
<hr/>
<a name=359></a><img src="linux-command-line-359_1.png"/><br/>
Document&#160;Formatting Systems<br/>
<i>Figure&#160;6: Viewing the&#160;finished&#160;table</i><br/>
<b>Summing&#160;Up<br/></b>Given&#160;that&#160;text&#160;is&#160;so&#160;central&#160;to&#160;the&#160;character&#160;of&#160;Unix-like&#160;operating&#160;systems,&#160;it&#160;makes<br/>sense&#160;that&#160;there&#160;would&#160;be&#160;many&#160;tools&#160;that&#160;are&#160;used&#160;to&#160;manipulate&#160;and&#160;format&#160;text.&#160;As&#160;we<br/>have&#160;seen,&#160;there&#160;are!&#160;The&#160;simple&#160;formatting&#160;tools&#160;like&#160;fmt&#160;and&#160;pr&#160;will&#160;find&#160;many&#160;uses&#160;in<br/>scripts&#160;that&#160;produce&#160;short&#160;documents,&#160;while&#160;&#160;groff&#160;&#160;(and&#160;friends)&#160;can&#160;be&#160;used&#160;to&#160;write<br/>books.&#160;&#160;We&#160;may&#160;never&#160;write&#160;a&#160;technical&#160;paper&#160;using&#160;command&#160;line&#160;tools&#160;(though&#160;there&#160;are<br/>many people&#160;who do!), but&#160;it’s&#160;good to know&#160;that&#160;we&#160;could.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
groff&#160;User’s&#160;Guide<br/><a href="http://www.gnu.org/software/groff/manual/">http://www.gnu.org/software/groff/manual/</a><br/>
●<br/>
<i>Writing&#160;Papers&#160;With&#160;nroff&#160;Using&#160;-me</i>:<br/><a href="http://docs.freebsd.org/44doc/usd/19.memacros/paper.pdf">http://docs.freebsd.org/44doc/usd/19.memacros/paper.pdf</a><br/>
●<br/>
<i>-me&#160;Reference&#160;Manual</i>:<br/>
335<br/>
<hr/>
<a name=360></a>21 – Formatting Output<br/>
<a href="http://docs.freebsd.org/44doc/usd/20.meref/paper.pdf">http://docs.freebsd.org/44doc/usd/20.meref/paper.pdf</a><br/>
●<br/>
<i>Tbl&#160;–&#160;A&#160;Program&#160;To Format&#160;Tables</i>:<br/><a href="http://plan9.bell-labs.com/10thEdMan/tbl.pdf">http://plan9.bell-labs.com/10thEdMan/tbl.pdf</a><br/>
●<br/>
And, of course,&#160;try the&#160;following articles&#160;at&#160;Wikipedia:<br/><a href="http://en.wikipedia.org/wiki/TeX">http://en.wikipedia.org/wiki/TeX<br/></a><a href="http://en.wikipedia.org/wiki/Donald_Knuth">http://en.wikipedia.org/wiki/Donald_Knuth<br/></a><a href="http://en.wikipedia.org/wiki/Typesetting">http://en.wikipedia.org/wiki/Typesetting</a><br/>
336<br/>
<hr/>
<a name=361></a>22 – Printing<br/>
<i><b>22&#160;–&#160;Printing</b></i><br/>
After&#160;spending&#160;the&#160;last&#160;couple&#160;of&#160;chapters&#160;manipulating&#160;text,&#160;it’s&#160;time&#160;to&#160;put&#160;that&#160;text&#160;on<br/>paper.&#160;In&#160;this&#160;chapter,&#160;we’ll&#160;look&#160;at&#160;the&#160;command&#160;line&#160;tools&#160;that&#160;are&#160;used&#160;to&#160;print&#160;files&#160;and<br/>control&#160;printer&#160;operation.&#160;We&#160;won’t&#160;be&#160;looking&#160;at&#160;how&#160;to&#160;configure&#160;printing,&#160;because&#160;that<br/>varies&#160;from&#160;distribution&#160;to&#160;distribution&#160;and&#160;is&#160;usually&#160;set&#160;up&#160;automatically&#160;during&#160;installa-<br/>tion.&#160;Note&#160;that&#160;we&#160;will&#160;need&#160;a&#160;working&#160;printer&#160;configuration&#160;to&#160;perform&#160;the&#160;exercises&#160;in<br/>this&#160;chapter.<br/>We&#160;will&#160;discuss&#160;the&#160;following commands:<br/>
●<br/>
pr&#160;– Convert&#160;text&#160;files&#160;for printing<br/>
●<br/>
lpr&#160;– Print&#160;files<br/>
●<br/>
a2ps&#160;– Format&#160;files&#160;for printing on a&#160;PostScript&#160;printer<br/>
●<br/>
lpstat&#160;– Show&#160;printer status&#160;information<br/>
●<br/>
lpq&#160;– Show&#160;printer queue&#160;status<br/>
●<br/>
lprm&#160;– Cancel&#160;print&#160;jobs<br/>
<b>A&#160;Brief&#160;History&#160;of&#160;Printing<br/></b>To&#160;fully&#160;understand&#160;the&#160;printing&#160;features&#160;found&#160;in&#160;Unix-like&#160;operating&#160;systems,&#160;we&#160;must<br/>first&#160;learn&#160;some&#160;history.&#160;Printing&#160;on&#160;Unix-like&#160;systems&#160;goes&#160;way&#160;back&#160;to&#160;the&#160;beginning&#160;of<br/>the&#160;operating&#160;system.&#160;In&#160;those&#160;days,&#160;printers&#160;and&#160;how&#160;they&#160;were&#160;used&#160;were&#160;much&#160;different<br/>from&#160;today.<br/>
Printing&#160;in&#160;the&#160;Dim&#160;Times<br/>Like&#160;computers,&#160;printers&#160;in&#160;the&#160;pre-PC&#160;era&#160;tended&#160;to&#160;be&#160;large,&#160;expensive,&#160;and&#160;centralized.<br/>The&#160;typical&#160;computer&#160;user&#160;of&#160;1980&#160;worked&#160;at&#160;a&#160;terminal&#160;connected&#160;to&#160;a&#160;computer&#160;some<br/>distance&#160;away.&#160;The&#160;printer&#160;was&#160;located&#160;near&#160;the&#160;computer&#160;and&#160;was&#160;under&#160;the&#160;watchful<br/>eyes&#160;of the&#160;computer’s&#160;operators.<br/>When&#160;printers&#160;were&#160;expensive&#160;and&#160;centralized,&#160;as&#160;they&#160;often&#160;were&#160;in&#160;the&#160;early&#160;days&#160;of<br/>Unix,&#160;it&#160;was&#160;common&#160;practice&#160;for&#160;many&#160;users&#160;to&#160;share&#160;a&#160;printer.&#160;To&#160;identify&#160;print&#160;jobs&#160;be-<br/>
337<br/>
<hr/>
<a name=362></a>22 – Printing<br/>
longing&#160;to&#160;a&#160;particular&#160;user,&#160;a&#160;&#160;<i>banner&#160;page</i>&#160;&#160;displaying&#160;the&#160;name&#160;of&#160;the&#160;user&#160;was&#160;often<br/>printed&#160;at&#160;the&#160;beginning&#160;of&#160;each&#160;print&#160;job.&#160;The&#160;computer&#160;support&#160;staff&#160;would&#160;then&#160;load&#160;up<br/>a&#160;cart&#160;containing the&#160;day’s&#160;print&#160;jobs&#160;and deliver them&#160;to&#160;the&#160;individual&#160;users.<br/>
Character-Based&#160;Printers<br/>The&#160;printer&#160;technology&#160;of&#160;the&#160;80s&#160;was&#160;very&#160;different&#160;from&#160;today&#160;in&#160;two&#160;respects.&#160;First,<br/>printers&#160;of&#160;that&#160;period&#160;were&#160;almost&#160;always&#160;<i>impact&#160;printers</i>.&#160;Impact&#160;printers&#160;use&#160;a&#160;mechan-<br/>ical&#160;mechanism&#160;that&#160;strikes&#160;a&#160;ribbon&#160;against&#160;the&#160;paper&#160;to&#160;form&#160;character&#160;impressions&#160;on<br/>the&#160;page.&#160;Two&#160;of the&#160;popular&#160;technologies&#160;of&#160;that&#160;time&#160;were&#160;<i>daisy-wheel</i>&#160;printing&#160;and&#160;<i>dot-<br/>matrix</i>&#160;printing.<br/>The&#160;second,&#160;and&#160;more&#160;important&#160;characteristic&#160;of&#160;early&#160;printers&#160;was&#160;that&#160;printers&#160;used&#160;a<br/>fixed&#160;set&#160;&#160;of&#160;characters&#160;that&#160;&#160;were&#160;intrinsic&#160;to&#160;&#160;the&#160;device.&#160;For&#160;example,&#160;a&#160;&#160;daisy-wheel<br/>printer&#160;could&#160;only&#160;print&#160;the&#160;characters&#160;actually&#160;molded&#160;into&#160;the&#160;petals&#160;of&#160;the&#160;daisy&#160;wheel.<br/>This&#160;made&#160;the&#160;printers&#160;much&#160;like&#160;high-speed&#160;typewriters.&#160;As&#160;with&#160;most&#160;typewriters,&#160;they<br/>printed&#160;using&#160;&#160;monospaced&#160;(fixed&#160;width)&#160;fonts.&#160;This&#160;means&#160;that&#160;each&#160;character&#160;has&#160;the<br/>same&#160;width.&#160;Printing&#160;was&#160;done&#160;at&#160;fixed&#160;positions&#160;on&#160;the&#160;page,&#160;and&#160;the&#160;printable&#160;area&#160;of&#160;a<br/>page&#160;contained&#160;a&#160;fixed&#160;number&#160;of characters.&#160;Most&#160;printers&#160;printed&#160;ten&#160;characters&#160;per&#160;inch<br/>(CPI)&#160;horizontally&#160;and&#160;six&#160;lines&#160;per&#160;inch&#160;(LPI)&#160;vertically.&#160;Using&#160;this&#160;scheme,&#160;a&#160;US-letter<br/>sheet&#160;of paper&#160;is&#160;85 characters&#160;wide&#160;and&#160;66 lines&#160;high.&#160;Taking&#160;into account&#160;a&#160;small&#160;margin<br/>on&#160;each&#160;side,&#160;80&#160;characters&#160;was&#160;considered&#160;the&#160;maximum&#160;width&#160;of&#160;a&#160;print&#160;line.&#160;This&#160;ex-<br/>plains&#160;why&#160;&#160;terminal&#160;displays&#160;(and&#160;our&#160;terminal&#160;emulators)&#160;are&#160;normally&#160;80&#160;characters<br/>wide.&#160;Using&#160;a&#160;monospaced&#160;font&#160;and&#160;and&#160;an&#160;80&#160;character&#160;wide&#160;terminal&#160;provides&#160;a&#160;<i>What<br/>You See&#160;Is&#160;What&#160;You Get</i>&#160;(<i>WYSIWYG</i>) view&#160;of printed output.<br/>Data&#160;is&#160;sent&#160;to&#160;a&#160;typewriter-like&#160;printer&#160;in&#160;a&#160;simple&#160;stream&#160;of&#160;bytes&#160;containing&#160;the&#160;charac-<br/>ters&#160;to be&#160;printed.&#160;For example,&#160;to print&#160;an “a”,&#160;the&#160;ASCII character&#160;code&#160;97 is&#160;sent. In ad-<br/>dition,&#160;the&#160;low-numbered&#160;ASCII&#160;control&#160;codes&#160;provided&#160;a&#160;means&#160;of&#160;moving&#160;the&#160;printer’s<br/>carriage&#160;and&#160;paper,&#160;using&#160;codes&#160;for&#160;carriage&#160;return,&#160;line&#160;feed,&#160;form&#160;feed,&#160;and&#160;so&#160;on.&#160;Using<br/>the&#160;control&#160;codes,&#160;it’s&#160;possible&#160;to&#160;achieve&#160;some&#160;limited&#160;font&#160;effects,&#160;such&#160;as&#160;boldface,&#160;by<br/>having&#160;the&#160;printer&#160;print&#160;a&#160;character,&#160;backspace,&#160;and&#160;print&#160;the&#160;character&#160;again&#160;to&#160;get&#160;a<br/>darker print&#160;impression&#160;on the&#160;page.&#160;We&#160;can&#160;actually&#160;witness&#160;this&#160;if we&#160;use&#160;nroff&#160;to&#160;ren-<br/>der a&#160;man&#160;page&#160;and&#160;examine&#160;the&#160;output&#160;using&#160;cat -A.<br/>
[me@linuxbox ~]$&#160;<b>zcat /usr/share/man/man1/ls.1.gz | nroff -man | cat&#160;<br/>-A | head&#160;<br/></b>LS(1) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; User Commands &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;LS(1)<br/>$&#160;<br/>$&#160;<br/>$&#160;<br/>N^HNA^HAM^HME^HE$&#160;<br/>&#160; &#160; &#160; &#160;ls - list directory contents$&#160;<br/>
338<br/>
<hr/>
<a name=363></a>A&#160;Brief History of Printing<br/>
$&#160;<br/>S^HSY^HYN^HNO^HOP^HPS^HSI^HIS^HS$&#160;<br/>&#160; &#160; &#160; &#160;l^Hls^Hs [_^HO_^HP_^HT_^HI_^HO_^HN]... [_^HF_^HI_^HL_^HE]...$<br/>
The&#160;&#160;^H&#160;(Ctrl-h)&#160;characters&#160;are&#160;the&#160;backspaces&#160;used&#160;to&#160;create&#160;the&#160;boldface&#160;effect.&#160;Like-<br/>wise,&#160;we&#160;can also see&#160;a&#160;backspace/underscore&#160;sequence&#160;used to produce&#160;underlining.<br/>
Graphical&#160;Printers<br/>The&#160;development&#160;of&#160;GUIs&#160;led&#160;to&#160;major&#160;changes&#160;in&#160;printer&#160;technology.&#160;As&#160;computers<br/>moved&#160;to&#160;more&#160;picture-based&#160;displays,&#160;printing&#160;moved&#160;from&#160;character-based&#160;to&#160;graphical<br/>techniques.&#160;This&#160;was&#160;facilitated&#160;by&#160;the&#160;advent&#160;of&#160;the&#160;low-cost&#160;laser&#160;printer&#160;which,&#160;instead<br/>of&#160;printing&#160;fixed&#160;characters,&#160;could&#160;print&#160;tiny&#160;dots&#160;anywhere&#160;in&#160;the&#160;printable&#160;area&#160;of&#160;the<br/>page.&#160;This&#160;made&#160;printing&#160;&#160;proportional&#160;fonts&#160;&#160;(like&#160;those&#160;used&#160;by&#160;&#160;typesetters),&#160;and&#160;even<br/>photographs&#160;and high-quality&#160;diagrams, possible.<br/>However,&#160;moving&#160;from&#160;a&#160;character-based&#160;scheme&#160;to&#160;a&#160;graphical&#160;scheme&#160;presented&#160;a&#160;for-<br/>midable&#160;technical&#160;challenge.&#160;Here’s&#160;why:&#160;the&#160;number&#160;of&#160;bytes&#160;needed&#160;to&#160;fill&#160;a&#160;page&#160;using<br/>a&#160;character-based&#160;printer&#160;can&#160;be&#160;calculated&#160;this&#160;way&#160;(assuming&#160;60&#160;lines&#160;per&#160;page&#160;each<br/>containing 80 characters):<br/>60 X&#160;80 =&#160;4,800 bytes<br/>In comparison,&#160;a&#160;300&#160;dot&#160;per inch&#160;(DPI)&#160;laser&#160;printer&#160;(assuming&#160;an&#160;8&#160;by 10&#160;inch&#160;print&#160;area<br/>per page)&#160;requires&#160;this&#160;many&#160;bytes:<br/>(8 X&#160;300) X&#160;(10 X&#160;300) /&#160;8 =&#160;900,000 bytes<br/>Many&#160;of&#160;the&#160;slow&#160;PC&#160;networks&#160;simply&#160;could&#160;not&#160;handle&#160;the&#160;nearly&#160;one&#160;megabyte&#160;of&#160;data<br/>required&#160;to&#160;print&#160;a&#160;full&#160;page&#160;on&#160;a&#160;laser&#160;printer,&#160;so&#160;it&#160;was&#160;clear&#160;that&#160;a&#160;clever&#160;invention&#160;was<br/>needed.<br/>That&#160;invention&#160;turned&#160;out&#160;to&#160;be&#160;the&#160;<i>page&#160;description&#160;language</i>&#160;(PDL).&#160;A&#160;page&#160;description<br/>language&#160;is&#160;a&#160;programming&#160;language&#160;that&#160;describes&#160;the&#160;contents&#160;of&#160;a&#160;page.&#160;Basically&#160;it<br/>says,&#160;“Go&#160;to&#160;this&#160;position,&#160;draw&#160;the&#160;character&#160;‘a’&#160;in&#160;10&#160;point&#160;Helvetica,&#160;go&#160;to&#160;this&#160;posi-<br/>tion...”&#160;until&#160;everything&#160;on&#160;the&#160;page&#160;is&#160;described.&#160;The&#160;first&#160;major&#160;PDL&#160;was&#160;&#160;<i>PostScript<br/></i>from&#160;Adobe&#160;Systems,&#160;which&#160;is&#160;still&#160;in&#160;wide&#160;use&#160;today.&#160;The&#160;PostScript&#160;language&#160;is&#160;a&#160;com-<br/>plete&#160;programming&#160;language&#160;tailored&#160;for&#160;typography&#160;and&#160;other&#160;kinds&#160;of&#160;graphics&#160;and<br/>imaging.&#160;It&#160;includes&#160;built-in&#160;support&#160;for&#160;35&#160;standard,&#160;high-quality&#160;fonts,&#160;plus&#160;the&#160;ability&#160;to<br/>accept&#160;additional&#160;font&#160;definitions&#160;at&#160;runtime.&#160;At&#160;first,&#160;support&#160;for&#160;PostScript&#160;was&#160;built&#160;into<br/>the&#160;printers&#160;themselves.&#160;This&#160;solved&#160;the&#160;data&#160;transmission&#160;problem.&#160;While&#160;the&#160;typical<br/>PostScript&#160;program&#160;was&#160;very&#160;verbose&#160;in&#160;comparison&#160;to&#160;the&#160;simple&#160;byte&#160;stream&#160;of&#160;charac-<br/>ter-based&#160;printers,&#160;it&#160;was&#160;much&#160;smaller&#160;than&#160;the&#160;number&#160;of&#160;bytes&#160;required&#160;to&#160;represent&#160;the<br/>entire&#160;printed&#160;page.<br/>
339<br/>
<hr/>
<a name=364></a>22 – Printing<br/>
A&#160;<i>PostScript&#160;printer</i>&#160;&#160;accepted&#160;a&#160;PostScript&#160;program&#160;as&#160;input.&#160;The&#160;printer&#160;contained&#160;its<br/>own&#160;processor&#160;and&#160;memory&#160;(oftentimes&#160;making&#160;the&#160;printer&#160;a&#160;more&#160;powerful&#160;computer<br/>than&#160;the&#160;computer&#160;to&#160;which&#160;it&#160;was&#160;attached)&#160;and&#160;executed&#160;a&#160;special&#160;program&#160;called&#160;a<br/><i>PostScript&#160;interpreter</i>,&#160;which&#160;read&#160;the&#160;incoming&#160;PostScript&#160;program&#160;and&#160;<i>rendered</i>&#160;the&#160;re-<br/>sults&#160;into&#160;the&#160;printer’s&#160;internal&#160;memory,&#160;thus&#160;forming&#160;the&#160;pattern&#160;of&#160;bits&#160;(dots)&#160;that&#160;would<br/>be&#160;transferred&#160;to&#160;the&#160;paper.&#160;The&#160;generic&#160;name&#160;for&#160;this&#160;process&#160;of&#160;rendering&#160;something&#160;into<br/>a&#160;large&#160;bit&#160;pattern&#160;(called&#160;a&#160;<i>bitmap</i>) is&#160;<i>raster&#160;image&#160;processor</i>&#160;(RIP).<br/>As&#160;the&#160;years&#160;went&#160;by, both&#160;computers&#160;and&#160;networks&#160;became&#160;much&#160;faster.&#160;This&#160;allowed the<br/>RIP&#160;to&#160;move&#160;from&#160;the&#160;printer&#160;to&#160;the&#160;host&#160;computer,&#160;which,&#160;in&#160;turn,&#160;permitted&#160;high-quality<br/>printers&#160;to&#160;be&#160;much&#160;less&#160;expensive.<br/>Many&#160;printers&#160;today&#160;still&#160;accept&#160;character-based&#160;streams,&#160;but&#160;many&#160;low-cost&#160;printers&#160;do<br/>not.&#160;They&#160;rely&#160;on&#160;the&#160;host&#160;computer’s&#160;RIP&#160;to&#160;provide&#160;a&#160;stream&#160;of&#160;bits&#160;to&#160;print&#160;as&#160;dots.<br/>There&#160;are&#160;still&#160;some&#160;PostScript&#160;printers, too.<br/>
<b>Printing&#160;with&#160;Linux<br/></b>Modern&#160;Linux&#160;systems&#160;employ&#160;two&#160;software&#160;suites&#160;to&#160;perform&#160;and&#160;manage&#160;printing.&#160;The<br/>first,&#160;Common&#160;Unix&#160;Printing&#160;System&#160;(CUPS)&#160;provides&#160;print&#160;&#160;drivers&#160;and&#160;print-job&#160;man-<br/>agement, and the&#160;second,&#160;Ghostscript, a&#160;PostScript&#160;interpreter, acts&#160;as&#160;a&#160;RIP.<br/>CUPS&#160;manages&#160;printers&#160;by&#160;creating&#160;and&#160;maintaining&#160;<i>print&#160;queues</i>.&#160;As&#160;we&#160;discussed&#160;in&#160;the<br/>earlier&#160;history&#160;lesson,&#160;Unix&#160;printing&#160;was&#160;originally&#160;designed&#160;to&#160;manage&#160;a&#160;centralized<br/>printer&#160;shared&#160;by&#160;multiple&#160;users.&#160;Since&#160;printers&#160;are&#160;slow&#160;by&#160;nature,&#160;compared&#160;to&#160;the&#160;com-<br/>puters&#160;that&#160;are&#160;feeding&#160;them,&#160;printing&#160;systems&#160;need&#160;a&#160;way&#160;to&#160;schedule&#160;multiple&#160;print&#160;jobs<br/>and&#160;keep&#160;things&#160;organized.&#160;CUPS&#160;also&#160;has&#160;the&#160;ability&#160;to&#160;recognize&#160;different&#160;types&#160;of&#160;data<br/>(within reason)&#160;and can convert&#160;files&#160;to a&#160;printable&#160;form.<br/>
<b>Preparing&#160;Files&#160;for&#160;Printing<br/></b>As&#160;command&#160;line&#160;users,&#160;we&#160;are&#160;mostly&#160;interested&#160;in&#160;printing&#160;text,&#160;though&#160;it&#160;is&#160;certainly<br/>possible&#160;to print&#160;other&#160;data&#160;formats&#160;as&#160;well.<br/>
pr&#160;–&#160;Convert&#160;Text&#160;Files&#160;for&#160;Printing<br/>We&#160;looked&#160;at&#160;pr&#160;a&#160;little&#160;in&#160;the&#160;previous&#160;chapter.&#160;Now&#160;we&#160;will&#160;examine&#160;some&#160;of&#160;its&#160;many<br/>options&#160;used&#160;in&#160;conjunction&#160;with&#160;printing.&#160;In&#160;our&#160;history&#160;of&#160;printing,&#160;we&#160;saw&#160;how&#160;charac-<br/>ter-based&#160;printers&#160;use&#160;monospaced&#160;fonts,&#160;resulting&#160;in&#160;fixed&#160;numbers&#160;of&#160;characters&#160;per&#160;line<br/>and&#160;lines&#160;per&#160;page.&#160;pr&#160;is&#160;used&#160;to&#160;adjust&#160;text&#160;to&#160;fit&#160;on&#160;a&#160;specific&#160;page&#160;size,&#160;with&#160;optional<br/>page&#160;headers&#160;and margins.&#160;Table&#160;22-1 summarizes&#160;its&#160;most&#160;commonly&#160;used options.<br/>
340<br/>
<hr/>
<a name=365></a>Preparing Files&#160;for Printing<br/>
<i>Table&#160;22-1: Common&#160;pr&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
+<i>first</i>[:<i>last</i>]<br/>
Output&#160;a&#160;range&#160;of pages&#160;starting with&#160;<i>first</i>&#160;and,&#160;optionally,&#160;<br/>ending&#160;with&#160;<i>last</i>.<br/>
-<i>columns</i><br/>
Organize&#160;the&#160;content&#160;of the&#160;page&#160;into the&#160;number&#160;of columns&#160;<br/>specified by&#160;<i>columns</i>.<br/>
-a<br/>
By default, multicolumn&#160;output&#160;is&#160;listed vertically.&#160;By adding&#160;<br/>the&#160;-a&#160;(across) option,&#160;content&#160;is&#160;listed&#160;horizontally.&#160;<br/>
-d<br/>
Double-space&#160;output.<br/>
-D “<i>format</i>”<br/>
Format&#160;the&#160;date&#160;displayed in&#160;page&#160;headers&#160;using&#160;<i>format</i>. See&#160;<br/>the&#160;man page&#160;for the&#160;date&#160;command&#160;for a&#160;description of the&#160;<br/>format&#160;string.<br/>
-f<br/>
Use&#160;form&#160;feeds&#160;rather than&#160;carriage&#160;returns&#160;to&#160;separate&#160;pages.<br/>
-h “<i>header</i>”<br/>
In the&#160;center&#160;portion&#160;of the&#160;page&#160;header,&#160;use&#160;<i>header</i>&#160;rather&#160;<br/>than&#160;the&#160;name&#160;of the&#160;file&#160;being processed.<br/>
-l&#160;<i>length</i><br/>
Set&#160;page&#160;length to&#160;<i>length</i>.&#160;The&#160;default&#160;is&#160;66 (US&#160;letter&#160;at&#160;six&#160;<br/>lines&#160;per inch)<br/>
-n<br/>
Number&#160;lines.<br/>
-o&#160;<i>offset</i><br/>
Create&#160;a&#160;left&#160;margin&#160;<i>offset</i>&#160;characters&#160;wide.<br/>
-w&#160;<i>width</i><br/>
Set&#160;the&#160;page&#160;width to&#160;<i>width</i>.&#160;The&#160;default&#160;is&#160;72.<br/>
pr&#160;is&#160;often&#160;used&#160;in&#160;pipelines&#160;as&#160;a&#160;filter.&#160;In&#160;this&#160;example,&#160;we&#160;will&#160;produce&#160;a&#160;directory&#160;list-<br/>ing of&#160;/usr/bin&#160;and&#160;format&#160;it&#160;into&#160;paginated, three-column&#160;output&#160;using&#160;pr:<br/>
[me@linuxbox ~]$ &#160;<b>ls /usr/bin | pr -3 -w 65 | head</b>&#160;<br/>
2016-02-18 14:00 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Page 1&#160;<br/>[<br/>
&#160; &#160; &#160; apturl<br/>
&#160; &#160; bsd-write&#160;<br/>
411toppm<br/>
&#160; &#160; &#160; ar<br/>
&#160; &#160; bsh&#160;<br/>
a2p<br/>
&#160; &#160; &#160; arecord<br/>
&#160; &#160; btcflash&#160;<br/>
a2ps<br/>
&#160; &#160; &#160; arecordmidi<br/>
&#160; &#160; bug-buddy&#160;<br/>
a2ps-lpr-wrapper &#160; ark<br/>
&#160; &#160; buildhash<br/>
341<br/>
<hr/>
<a name=366></a>22 – Printing<br/>
<b>Sending&#160;a&#160;Print&#160;Job&#160;to&#160;a&#160;Printer<br/></b>The&#160;CUPS&#160;printing&#160;suite&#160;supports&#160;two&#160;methods&#160;of&#160;printing&#160;historically&#160;used&#160;on&#160;Unix-like<br/>systems.&#160;One&#160;method,&#160;called&#160;Berkeley&#160;or&#160;LPD&#160;(used&#160;in&#160;the&#160;Berkeley&#160;Software&#160;Distribu-<br/>tion&#160;version&#160;of&#160;Unix),&#160;uses&#160;the&#160;lpr&#160;program,&#160;while&#160;the&#160;other&#160;method,&#160;called&#160;SysV&#160;(from<br/>the&#160;System&#160;V&#160;version&#160;of&#160;Unix),&#160;uses&#160;the&#160;lp&#160;program.&#160;Both&#160;programs&#160;do&#160;roughly&#160;the&#160;same<br/>thing. Choosing one&#160;over the&#160;other is&#160;a&#160;matter&#160;of personal&#160;taste.<br/>
lpr&#160;–&#160;Print&#160;Files&#160;(Berkeley&#160;Style)<br/>The&#160;lpr&#160;program&#160;can be&#160;used&#160;to send files&#160;to&#160;the&#160;printer.&#160;It&#160;may also be&#160;used in pipelines,<br/>as&#160;it&#160;accepts&#160;standard&#160;input.&#160;For&#160;example,&#160;to&#160;print&#160;the&#160;results&#160;of&#160;our&#160;previous&#160;multicolumn<br/>directory&#160;listing,&#160;we&#160;could do this:<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | pr -3 | lpr</b><br/>
The&#160;report&#160;would&#160;be&#160;sent&#160;to&#160;the&#160;system’s&#160;default&#160;printer.&#160;To&#160;send&#160;the&#160;file&#160;to&#160;a&#160;different<br/>printer,&#160;the&#160;-P&#160;option&#160;can be&#160;used&#160;like&#160;this:<br/>
<b>lpr -P&#160;<i>printer_name</i></b><br/>
Here,&#160;<i>printer_name</i>&#160;is&#160;the&#160;name&#160;of&#160;the&#160;desired&#160;printer.&#160;To&#160;see&#160;a&#160;list&#160;of&#160;printers&#160;known&#160;to<br/>the&#160;system,&#160;use&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>lpstat -a</b><br/>
<b>Tip:</b>&#160;Many&#160;Linux&#160;distributions&#160;allow&#160;you&#160;to&#160;define&#160;a&#160;“printer”&#160;that&#160;outputs&#160;files<br/>in&#160;Portable&#160;Document&#160;Format&#160;(PDF),&#160;rather&#160;than&#160;printing&#160;on&#160;the&#160;physical&#160;printer.<br/>This&#160;&#160;&#160;is&#160;&#160;&#160;very&#160;&#160;&#160;handy&#160;&#160;&#160;for&#160;&#160;&#160;experimenting&#160;&#160;&#160;with&#160;&#160;&#160;printing&#160;&#160;&#160;commands.&#160;&#160;&#160;Check&#160;&#160;&#160;your<br/>printer&#160;configuration&#160;program&#160;to&#160;see&#160;whether&#160;it&#160;supports&#160;this&#160;configuration.&#160;On<br/>some&#160;distributions,&#160;you&#160;may&#160;need&#160;to&#160;install&#160;additional&#160;packages&#160;(such&#160;as&#160;cups-<br/>pdf) to&#160;enable&#160;this&#160;capability.<br/>
Table&#160;22-2 describes&#160;the&#160;common options&#160;for&#160;lpr.<br/>
<i>Table&#160;22-2: Common&#160;lpr&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
342<br/>
<hr/>
<a name=367></a>Sending&#160;a&#160;Print&#160;Job to a&#160;Printer<br/>
-#&#160;<i>number</i><br/>
Set&#160;number&#160;of copies&#160;to&#160;<i>number</i>.<br/>
-p<br/>
Print&#160;each&#160;page&#160;with&#160;a&#160;shaded header&#160;with the&#160;date,&#160;time,&#160;job&#160;<br/>name,&#160;and page&#160;number.&#160;This&#160;so-called&#160;“pretty&#160;print”&#160;option&#160;<br/>can be&#160;used when printing text&#160;files.<br/>
-P&#160;<i>printer</i><br/>
Specify the&#160;name&#160;of the&#160;printer used for output.&#160;If no printer&#160;is&#160;<br/>specified,&#160;the&#160;system’s&#160;default&#160;printer&#160;is&#160;used.<br/>
-r<br/>
Delete&#160;files&#160;after printing.&#160;This&#160;would be&#160;useful&#160;for programs&#160;<br/>that&#160;produce&#160;temporary printer-output&#160;files.<br/>
lp&#160;–&#160;Print&#160;Files&#160;(System&#160;V&#160;Style)<br/>Like&#160;&#160;lpr,&#160;lp&#160;accepts&#160;either&#160;files&#160;or&#160;standard&#160;input&#160;for&#160;printing.&#160;It&#160;differs&#160;from&#160;lpr&#160;in<br/>that&#160;it&#160;supports&#160;a&#160;different&#160;(and&#160;slightly&#160;more&#160;sophisticated)&#160;option&#160;set.&#160;Table&#160;22-3&#160;de-<br/>scribes&#160;the&#160;common options.<br/>
<i>Table&#160;22-3: Common&#160;lp&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
-d&#160;<i>printer</i><br/>
Set&#160;the&#160;destination (printer) to&#160;<i>printer</i>. If no d&#160;<br/>option is&#160;specified,&#160;the&#160;system&#160;default&#160;printer is&#160;<br/>used.<br/>
-n&#160;<i>number</i><br/>
Set&#160;the&#160;number of copies&#160;to&#160;<i>number</i>.<br/>
-o&#160;landscape<br/>
Set&#160;output&#160;to landscape&#160;orientation.<br/>
-o fitplot<br/>
Scale&#160;the&#160;file&#160;to fit&#160;the&#160;page.&#160;This&#160;is&#160;useful&#160;when&#160;<br/>printing&#160;images,&#160;such&#160;as&#160;JPEG&#160;files.<br/>
-o scaling=<i>number</i><br/>
Scale&#160;file&#160;to&#160;<i>number</i>.&#160;The&#160;value&#160;of 100 fills&#160;the&#160;<br/>page.&#160;Values&#160;less&#160;than 100 are&#160;reduced,&#160;while&#160;<br/>values&#160;greater than&#160;100 cause&#160;the&#160;file&#160;to be&#160;printed<br/>across&#160;multiple&#160;pages.<br/>
-o cpi=<i>number</i><br/>
Set&#160;the&#160;output&#160;characters&#160;per inch to&#160;<i>number</i>.&#160;The&#160;<br/>default&#160;is&#160;10.<br/>
-o lpi=<i>number</i><br/>
Set&#160;the&#160;output&#160;lines&#160;per inch&#160;to&#160;<i>number</i>.&#160;The&#160;<br/>default&#160;is&#160;6.<br/>
-o page-bottom=<i>points</i><br/>
Set&#160;the&#160;page&#160;margins.&#160;Values&#160;are&#160;expressed in&#160;<br/>
-o page-left=<i>points</i><br/>
<i>points</i>, a&#160;unit&#160;of typographic&#160;measurement.&#160;There&#160;<br/>
-o page-right=<i>points</i><br/>
are&#160;72 points&#160;to an inch.<br/>
343<br/>
<hr/>
<a name=368></a>22 – Printing<br/>
-o page-top=<i>points<br/></i>-P&#160;<i>pages</i><br/>
Specify the&#160;list&#160;of pages.&#160;<i>pages</i>&#160;may be&#160;expressed&#160;<br/>as&#160;a&#160;comma-separated list&#160;and/or a&#160;range, for&#160;<br/>example,&#160;1,3,5,7-10<br/>
We’ll&#160;produce&#160;our&#160;directory&#160;listing&#160;again,&#160;this&#160;time&#160;printing&#160;12&#160;CPI&#160;and&#160;8&#160;LPI&#160;with&#160;a&#160;left<br/>margin&#160;of&#160;one&#160;half&#160;inch.&#160;Note&#160;that&#160;we&#160;have&#160;to&#160;adjust&#160;the&#160;pr&#160;options&#160;to&#160;account&#160;for&#160;the<br/>new&#160;page&#160;size:<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | pr -4 -w 90 -l 88 | lp -o page-left=36<br/>-o cpi=12 -o lpi=8</b><br/>
This&#160;pipeline&#160;produces&#160;a&#160;four-column&#160;listing&#160;using&#160;smaller&#160;type&#160;than&#160;the&#160;default.&#160;The&#160;in-<br/>creased number of characters&#160;per&#160;inch allows&#160;us&#160;to fit&#160;more&#160;columns&#160;on the&#160;page.<br/>
Another&#160;Option:&#160;a2ps<br/>The&#160;&#160;a2ps&#160;&#160;program&#160;(available&#160;in&#160;most&#160;repositories)&#160;is&#160;interesting.&#160;As&#160;we&#160;can&#160;surmise<br/>from&#160;its&#160;name,&#160;it’s&#160;a&#160;format&#160;conversion&#160;program,&#160;but&#160;it&#160;also&#160;much&#160;more.&#160;Its&#160;name&#160;origi-<br/>nally&#160;meant&#160;“ASCII&#160;to&#160;&#160;PostScript”&#160;and&#160;it&#160;was&#160;used&#160;to&#160;prepare&#160;text&#160;files&#160;for&#160;printing&#160;on<br/>PostScript&#160;printers.&#160;Over&#160;the&#160;years,&#160;however,&#160;the&#160;capabilities&#160;of&#160;the&#160;program&#160;have&#160;grown,<br/>and&#160;now&#160;its&#160;name&#160;means&#160;“Anything&#160;to&#160;PostScript.”&#160;&#160;While&#160;its&#160;name&#160;suggests&#160;a&#160;format-<br/>conversion&#160;program,&#160;it&#160;is&#160;actually&#160;a&#160;printing&#160;program.&#160;It&#160;sends&#160;its&#160;default&#160;output&#160;to&#160;the<br/>system’s&#160;default&#160;printer&#160;rather&#160;than&#160;standard&#160;output.&#160;The&#160;program’s&#160;default&#160;behavior&#160;is<br/>that&#160;of&#160;a&#160;“pretty&#160;printer,”&#160;meaning&#160;that&#160;it&#160;improves&#160;the&#160;appearance&#160;of&#160;output.&#160;We&#160;use&#160;the<br/>program&#160;to&#160;create&#160;a&#160;PostScript&#160;file&#160;on our desktop.<br/>
[me@linuxbox ~]$&#160;<b>ls /usr/bin | pr -3 -t | a2ps -o ~/Desktop/ls.ps -L&#160;<br/>66&#160;<br/></b>[stdin (plain): 11 pages on 6 sheets]&#160;<br/>[Total: 11 pages on 6 sheets] saved into the file `/home/me/Desktop/<br/>ls.ps'<br/>
Here&#160;we&#160;filter&#160;the&#160;stream&#160;with&#160;pr,&#160;using&#160;the&#160;-t&#160;option&#160;(omit&#160;headers&#160;and&#160;footers),&#160;and<br/>then&#160;with&#160;a2ps,&#160;specifying&#160;an&#160;output&#160;file&#160;(-o&#160;option)&#160;and&#160;66&#160;lines&#160;per&#160;page&#160;(-L&#160;option)<br/>to&#160;match&#160;the&#160;output&#160;pagination&#160;of&#160;&#160;pr.&#160;If&#160;we&#160;view&#160;the&#160;resulting&#160;file&#160;with&#160;a&#160;suitable&#160;file<br/>viewer, we&#160;will&#160;see&#160;the&#160;output&#160;in&#160;Figure&#160;7.<br/>
344<br/>
<hr/>
<a name=369></a><img src="linux-command-line-369_1.png"/><br/>
Sending&#160;a&#160;Print&#160;Job to a&#160;Printer<br/>
<i>Figure&#160;7: Viewing a2ps&#160;output</i><br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;default&#160;output&#160;layout&#160;is&#160;“two&#160;up”&#160;format.&#160;This&#160;causes&#160;the&#160;contents&#160;of<br/>two&#160;pages&#160;to&#160;be&#160;printed&#160;on&#160;each&#160;sheet&#160;of&#160;paper.&#160;a2ps&#160;applies&#160;nice&#160;page&#160;headers&#160;and&#160;foot-<br/>ers, too.<br/>
a2ps&#160;has&#160;a&#160;lot&#160;of options.&#160;Table&#160;22-4 provides&#160;a&#160;summary.<br/>
<i>Table&#160;22-4:&#160;a2ps&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
--center-title=<i>text</i><br/>
Set&#160;center&#160;page&#160;title&#160;to&#160;<i>text</i>.<br/>
--columns=<i>number</i><br/>
Arrange&#160;pages&#160;into&#160;<i>number</i>&#160;columns.&#160;The&#160;<br/>default&#160;is&#160;2.<br/>
--footer=<i>text</i><br/>
Set&#160;page&#160;footer&#160;to&#160;<i>text</i>.<br/>
--guess<br/>
Report&#160;the&#160;types&#160;of files&#160;given&#160;as&#160;arguments.&#160;<br/>
345<br/>
<hr/>
<a name=370></a>22 – Printing<br/>
Since&#160;a2ps&#160;tries&#160;to&#160;convert&#160;and format&#160;all&#160;<br/>types&#160;of data, this&#160;option can&#160;be&#160;useful&#160;for&#160;<br/>predicting&#160;what&#160;a2ps&#160;will&#160;do when given a&#160;<br/>particular file.<br/>
--left-footer=<i>text</i><br/>
Set&#160;the&#160;left-page&#160;footer to&#160;<i>text</i>.<br/>
--left-title=<i>text</i><br/>
Set&#160;the&#160;left-page&#160;title&#160;to&#160;<i>text</i>.<br/>
--line-numbers=<i>interval</i><br/>
Number&#160;lines&#160;of output&#160;every&#160;<i>interval</i>&#160;lines.<br/>
--list=defaults<br/>
Display&#160;default&#160;settings.<br/>
--pages=<i>range</i><br/>
Print&#160;pages&#160;in range.<br/>
--right-footer=<i>text</i><br/>
Set&#160;the&#160;right-page&#160;footer&#160;to&#160;<i>text</i>.<br/>
--right-title=<i>text</i><br/>
Set&#160;the&#160;right-page&#160;title&#160;to&#160;<i>text</i>.<br/>
--rows=<i>number</i><br/>
Arrange&#160;pages&#160;into&#160;<i>number</i>&#160;rows.&#160;The&#160;default&#160;<br/>is&#160;1.<br/>
-B<br/>
No page&#160;headers.<br/>
-b&#160;<i>text</i><br/>
Set&#160;the&#160;page&#160;header to&#160;<i>text</i>.<br/>
-f&#160;<i>size</i><br/>
Use&#160;<i>size</i>&#160;point&#160;font.<br/>
-l&#160;<i>number</i><br/>
Set&#160;characters&#160;per line&#160;to&#160;<i>number</i>.&#160;This&#160;and the&#160;<br/>-L&#160;option&#160;(see&#160;next&#160;entry) can&#160;be&#160;used to make<br/>files&#160;paginated with&#160;other programs, such as&#160;<br/>pr, fit&#160;correctly on the&#160;page.&#160;<br/>
-L&#160;<i>number</i><br/>
Set&#160;lines&#160;per page&#160;to&#160;<i>number</i>.<br/>
-M&#160;<i>name</i><br/>
Use&#160;media&#160;<i>name</i>. For example,&#160;A4.<br/>
-n&#160;<i>number</i><br/>
Output&#160;<i>number</i>&#160;copies&#160;of each&#160;page.<br/>
-o&#160;<i>file</i><br/>
Send output&#160;to&#160;<i>file</i>. If&#160;<i>file</i>&#160;is&#160;specified as&#160;-, use&#160;<br/>standard&#160;output.<br/>
-P&#160;<i>printer</i><br/>
Use&#160;<i>printer</i>. If a&#160;printer is&#160;not&#160;specified,&#160;the&#160;<br/>system&#160;default&#160;printer&#160;is&#160;used.<br/>
-R<br/>
Portrait&#160;orientation.<br/>
-r<br/>
Landscape&#160;orientation.<br/>
-T&#160;<i>number</i><br/>
Set&#160;tab stops&#160;to every&#160;<i>number</i>&#160;characters.<br/>
-u&#160;<i>text</i><br/>
Underlay&#160;(watermark)&#160;pages&#160;with&#160;<i>text</i>.<br/>
346<br/>
<hr/>
<a name=371></a>Sending&#160;a&#160;Print&#160;Job to a&#160;Printer<br/>
This&#160;is&#160;just&#160;a&#160;summary.&#160;a2ps&#160;has&#160;several&#160;more&#160;options.<br/>
<b>Note:</b>&#160;&#160;There&#160;is&#160;another&#160;output&#160;formatter&#160;that&#160;is&#160;useful&#160;for&#160;converting&#160;text&#160;into<br/>PostScript.&#160;Called&#160;enscript,&#160;it&#160;can&#160;perform&#160;many&#160;of&#160;the&#160;same&#160;kinds&#160;of&#160;format-<br/>ting&#160;and printing tricks, but&#160;unlike&#160;a2ps, it&#160;only accepts&#160;text&#160;input.<br/>
<b>Monitoring&#160;and&#160;Controlling&#160;Print&#160;Jobs<br/></b>As&#160;Unix&#160;printing&#160;systems&#160;are&#160;designed&#160;to&#160;handle&#160;multiple&#160;print&#160;jobs&#160;from&#160;multiple&#160;users,<br/>CUPS&#160;is&#160;designed&#160;to&#160;do&#160;the&#160;same.&#160;Each&#160;printer&#160;is&#160;given&#160;a&#160;&#160;<i>print&#160;queue</i>,&#160;&#160;where&#160;jobs&#160;are<br/>parked&#160;until&#160;they&#160;can&#160;be&#160;<i>spooled</i>&#160;to&#160;the&#160;printer.&#160;CUPS&#160;supplies&#160;several&#160;command&#160;line&#160;pro-<br/>grams&#160;that&#160;are&#160;used&#160;to&#160;manage&#160;printer&#160;status&#160;and&#160;print&#160;queues.&#160;Like&#160;the&#160;lpr&#160;and&#160;lp&#160;pro-<br/>grams,&#160;these&#160;management&#160;programs&#160;are&#160;modeled&#160;after&#160;the&#160;corresponding&#160;programs&#160;from<br/>the&#160;Berkeley and&#160;System&#160;V&#160;printing systems.<br/>
lpstat&#160;–&#160;Display&#160;Print&#160;System&#160;Status<br/>The&#160;lpstat&#160;program&#160;is&#160;useful&#160;for&#160;determining&#160;the&#160;names&#160;and&#160;availability&#160;of&#160;printers&#160;on<br/>the&#160;&#160;&#160;system.&#160;&#160;&#160;For&#160;&#160;&#160;example,&#160;&#160;&#160;if&#160;&#160;&#160;we&#160;&#160;&#160;had&#160;&#160;&#160;a&#160;&#160;&#160;system&#160;&#160;&#160;with&#160;&#160;&#160;both&#160;&#160;&#160;a&#160;&#160;&#160;physical&#160;&#160;&#160;printer&#160;&#160;&#160;(named<br/>“printer”) and a&#160;PDF&#160;virtual&#160;printer (named&#160;“PDF”),&#160;we&#160;could check&#160;their&#160;status&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>lpstat -a</b>&#160;<br/>PDF accepting requests since Mon 08 Dec 2017 03:05:59 PM EST&#160;<br/>printer accepting requests since Tue 24 Feb 2018 08:43:22 AM EST<br/>
Further,&#160;we&#160;could&#160;determine&#160;a&#160;more&#160;detailed&#160;description&#160;of&#160;the&#160;print&#160;system&#160;configuration<br/>this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>lpstat -s</b>&#160;<br/>system default destination: printer&#160;<br/>device for PDF: cups-pdf:/&#160;<br/>device for printer: ipp://print-server:631/printers/printer<br/>
In&#160;this&#160;example,&#160;we&#160;see&#160;that&#160;“printer”&#160;is&#160;the&#160;system’s&#160;default&#160;printer&#160;and&#160;that&#160;it&#160;is&#160;a&#160;net-<br/>work&#160;printer&#160;using&#160;Internet&#160;Printing&#160;Protocol&#160;(ipp://)&#160;attached&#160;to&#160;a&#160;system&#160;named&#160;“print-<br/>server”.<br/>Table&#160;22-5 lists&#160;the&#160;commonly&#160;useful&#160;options.<br/>
347<br/>
<hr/>
<a name=372></a>22 – Printing<br/>
<i>Table&#160;22-5: Common&#160;lpstat&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
-a [<i>printer</i>...]<br/>
Display the&#160;state&#160;of the&#160;printer&#160;queue&#160;for&#160;<i>printer</i>. Note&#160;that<br/>this&#160;is&#160;the&#160;status&#160;of the&#160;printer queue’s&#160;ability&#160;to accept&#160;<br/>jobs, not&#160;the&#160;status&#160;of the&#160;physical&#160;printers. If no printers&#160;<br/>are&#160;specified, all&#160;print&#160;queues&#160;are&#160;shown.<br/>
-d<br/>
Display the&#160;name&#160;of the&#160;system’s&#160;default&#160;printer.<br/>
-p [<i>printer</i>...]<br/>
Display the&#160;status&#160;of the&#160;specified&#160;<i>printer</i>. If no printers&#160;<br/>are&#160;specified, all&#160;printers&#160;are&#160;shown.<br/>
-r<br/>
Display the&#160;status&#160;of the&#160;print&#160;server.<br/>
-s<br/>
Display a&#160;status&#160;summary.<br/>
-t<br/>
Display a&#160;complete&#160;status&#160;report.<br/>
lpq&#160;–&#160;Display&#160;Printer&#160;Queue&#160;Status<br/>To&#160;see&#160;the&#160;status&#160;of&#160;a&#160;printer&#160;queue,&#160;the&#160;lpq&#160;program&#160;is&#160;used.&#160;This&#160;allows&#160;us&#160;to&#160;view&#160;the<br/>status&#160;of&#160;the&#160;queue&#160;and&#160;the&#160;print&#160;jobs&#160;it&#160;contains.&#160;Here&#160;is&#160;an&#160;example&#160;of&#160;an&#160;empty&#160;queue<br/>for a&#160;system&#160;default&#160;printer named “printer”:<br/>
[me@linuxbox ~]$&#160;<b>lpq</b>&#160;<br/>printer is ready&#160;<br/>no entries<br/>
If&#160;we&#160;do&#160;not&#160;specify&#160;a&#160;printer&#160;(using&#160;the&#160;-P&#160;option),&#160;the&#160;system’s&#160;default&#160;printer&#160;is&#160;shown.<br/>If we&#160;send a&#160;job to&#160;the&#160;printer and then&#160;look at&#160;the&#160;queue,&#160;we&#160;will&#160;see&#160;it&#160;listed.<br/>
[me@linuxbox ~]$&#160;<b>ls *.txt | pr -3 | lp</b>&#160;<br/>request id is printer-603 (1 file(s))<br/>[me@linuxbox ~]$&#160;<b>lpq&#160;<br/></b>printer is ready and printing&#160;<br/>Rank &#160; &#160;Owner &#160; Job &#160; &#160; File(s) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Total Size&#160;<br/>active &#160;me &#160; &#160; &#160;603 &#160; &#160; (stdin) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 1024 bytes<br/>
348<br/>
<hr/>
<a name=373></a>Monitoring&#160;and Controlling&#160;Print&#160;Jobs<br/>
lprm&#160;/&#160;cancel&#160;–&#160;Cancel&#160;Print&#160;Jobs<br/>CUPS&#160;supplies&#160;two programs&#160;used to&#160;terminate&#160;print&#160;jobs&#160;and remove&#160;them&#160;from&#160;the&#160;print<br/>queue.&#160;One&#160;is&#160;Berkeley&#160;style&#160;(lprm)&#160;and&#160;the&#160;other&#160;is&#160;System&#160;V&#160;(cancel).&#160;They&#160;differ<br/>slightly&#160;in&#160;the&#160;options&#160;they&#160;support,&#160;but&#160;do&#160;basically&#160;the&#160;same&#160;thing.&#160;Using&#160;our&#160;earlier<br/>print&#160;job&#160;as&#160;an example, we&#160;could&#160;stop the&#160;job&#160;and remove&#160;it&#160;this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>cancel 603<br/></b>[me@linuxbox ~]$&#160;<b>lpq</b>&#160;<br/>printer is ready&#160;<br/>no entries<br/>
Each&#160;command&#160;has&#160;options&#160;for&#160;removing&#160;all&#160;the&#160;jobs&#160;belonging&#160;to&#160;a&#160;particular&#160;user,&#160;par-<br/>ticular printer, and&#160;multiple&#160;job numbers.&#160;Their&#160;respective&#160;man&#160;pages&#160;have&#160;all&#160;the&#160;details.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;saw&#160;how&#160;the&#160;printers&#160;of&#160;the&#160;past&#160;influenced&#160;the&#160;design&#160;of&#160;the&#160;printing<br/>systems&#160;on&#160;Unix-like&#160;machines,&#160;and&#160;how&#160;much&#160;control&#160;is&#160;available&#160;on&#160;the&#160;command&#160;line<br/>to&#160;control&#160;not&#160;only&#160;the&#160;scheduling&#160;and&#160;execution&#160;of&#160;print&#160;jobs,&#160;but&#160;also&#160;the&#160;various&#160;output<br/>options.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
A&#160;good article&#160;on the&#160;PostScript&#160;page&#160;description language:<br/><a href="http://en.wikipedia.org/wiki/PostScript">http://en.wikipedia.org/wiki/PostScript</a><br/>
●<br/>
The&#160;Common&#160;Unix Printing&#160;System&#160;(CUPS):<br/><a href="http://en.wikipedia.org/wiki/Common_Unix_Printing_System">http://en.wikipedia.org/wiki/Common_Unix_Printing_System<br/></a><a href="http://www.cups.org/">http://www.cups.org/</a><br/>
●<br/>
The&#160;Berkeley and&#160;System&#160;V&#160;Printing Systems:<br/><a href="http://en.wikipedia.org/wiki/Berkeley_printing_system">http://en.wikipedia.org/wiki/Berkeley_printing_system<br/></a><a href="http://en.wikipedia.org/wiki/System_V_printing_system">http://en.wikipedia.org/wiki/System_V_printing_system</a><br/>
349<br/>
<hr/>
<a name=374></a>23 – Compiling Programs<br/>
<i><b>23&#160;–&#160;Compiling&#160;Programs</b></i><br/>
In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;how&#160;to&#160;build&#160;programs&#160;by&#160;compiling&#160;&#160;source&#160;code.&#160;The<br/>availability&#160;of&#160;source&#160;code&#160;is&#160;the&#160;essential&#160;freedom&#160;that&#160;makes&#160;Linux&#160;possible.&#160;The&#160;entire<br/>ecosystem&#160;of&#160;Linux&#160;development&#160;relies&#160;on&#160;free&#160;exchange&#160;between&#160;developers.&#160;For&#160;many<br/>desktop&#160;users,&#160;compiling&#160;is&#160;a&#160;lost&#160;art.&#160;It&#160;used&#160;to&#160;be&#160;quite&#160;common,&#160;but&#160;today,&#160;distribution<br/>providers&#160;maintain&#160;huge&#160;repositories&#160;of&#160;precompiled&#160;binaries,&#160;ready&#160;to&#160;download&#160;and&#160;use.<br/>At&#160;the&#160;time&#160;of&#160;this&#160;writing,&#160;the&#160;Debian&#160;repository&#160;(one&#160;of&#160;the&#160;largest&#160;of&#160;any&#160;of&#160;the&#160;distri-<br/>butions) contains&#160;more&#160;than 68,000 packages.<br/>So why compile&#160;software?&#160;There&#160;are&#160;two reasons:<br/>
1.&#160;<b>Availability</b>.&#160;Despite&#160;the&#160;number&#160;of&#160;precompiled&#160;programs&#160;in&#160;distribution&#160;reposi-<br/>
tories, some&#160;distributions&#160;may not&#160;include&#160;all&#160;the&#160;desired&#160;applications. In this&#160;case,<br/>the&#160;only&#160;way to get&#160;the&#160;desired&#160;program&#160;is&#160;to&#160;compile&#160;it&#160;from&#160;source.<br/>
2.&#160;<b>Timeliness</b>.&#160;While&#160;some&#160;distributions&#160;specialize&#160;in&#160;cutting-edge&#160;versions&#160;of&#160;pro-<br/>
grams,&#160;many&#160;do not.&#160;This&#160;means&#160;that&#160;to&#160;have&#160;the&#160;latest&#160;version of&#160;a&#160;program,&#160;com-<br/>piling&#160;is&#160;necessary.<br/>
Compiling&#160;software&#160;from&#160;source&#160;code&#160;can&#160;become&#160;quite&#160;complex&#160;and&#160;technical&#160;and&#160;well<br/>beyond&#160;the&#160;reach&#160;of&#160;many&#160;users.&#160;However,&#160;many&#160;compiling&#160;tasks&#160;are&#160;easy&#160;and&#160;involve<br/>only&#160;a&#160;few&#160;steps.&#160;It&#160;all&#160;depends&#160;on&#160;the&#160;package.&#160;We&#160;will&#160;look&#160;at&#160;a&#160;simple&#160;case&#160;to&#160;provide<br/>an&#160;overview&#160;of the&#160;process&#160;and&#160;as&#160;a&#160;starting&#160;point&#160;for those&#160;who want&#160;to&#160;undertake&#160;further<br/>study.<br/>We&#160;will&#160;introduce&#160;one&#160;new&#160;command:<br/>
●<br/>
make&#160;– Utility to maintain programs<br/>
<b>What&#160;is&#160;Compiling?<br/></b>Simply&#160;put,&#160;compiling&#160;is&#160;the&#160;process&#160;of&#160;translating&#160;<i>source&#160;code</i>&#160;(the&#160;human-readable&#160;de-<br/>scription&#160;of&#160;a&#160;program&#160;written&#160;by&#160;a&#160;programmer)&#160;into&#160;the&#160;native&#160;language&#160;of&#160;the&#160;com-<br/>puter’s&#160;processor.<br/>The&#160;computer’s&#160;processor&#160;(or&#160;<i>CPU</i>)&#160;works&#160;at&#160;an&#160;elemental&#160;level,&#160;executing&#160;programs&#160;in<br/>what&#160;is&#160;called&#160;<i>machine&#160;language</i>.&#160;This&#160;is&#160;a&#160;numeric&#160;code&#160;that&#160;describes&#160;extremely&#160;small<br/>operations,&#160;such&#160;as&#160;“add&#160;this&#160;byte,”&#160;“point&#160;to&#160;this&#160;location&#160;in&#160;memory,”&#160;or&#160;“copy&#160;this<br/>
350<br/>
<hr/>
<a name=375></a>What&#160;is&#160;Compiling?<br/>
byte.”&#160;Each&#160;of&#160;these&#160;instructions&#160;is&#160;expressed&#160;in&#160;&#160;binary&#160;&#160;(ones&#160;and&#160;zeros).&#160;The&#160;earliest<br/>computer&#160;programs&#160;were&#160;written&#160;using&#160;this&#160;numeric&#160;code,&#160;which&#160;may&#160;explain&#160;why&#160;pro-<br/>grammers&#160;who&#160;wrote&#160;it&#160;were&#160;said&#160;to&#160;smoke&#160;a&#160;lot,&#160;drink&#160;gallons&#160;of&#160;coffee,&#160;and&#160;wear&#160;thick<br/>glasses.<br/>This&#160;problem&#160;was&#160;overcome&#160;by&#160;the&#160;advent&#160;of&#160;<i>assembly&#160;language</i>,&#160;which&#160;replaced&#160;the&#160;nu-<br/>meric&#160;codes&#160;with&#160;(slightly)&#160;easier&#160;to&#160;use&#160;character&#160;<i>mnemonics</i>&#160;such&#160;as&#160;CPY&#160;(for&#160;copy) and<br/>MOV&#160;(for&#160;move).&#160;Programs&#160;written&#160;in&#160;assembly&#160;language&#160;are&#160;processed&#160;into&#160;machine<br/>language&#160;by&#160;a&#160;program&#160;called&#160;an&#160;&#160;<i>assembler</i>.&#160;Assembly&#160;language&#160;is&#160;still&#160;used&#160;today&#160;for<br/>certain specialized programming tasks, such as&#160;<i>device&#160;drivers</i>&#160;and&#160;<i>embedded systems</i>.<br/>We&#160;next&#160;come&#160;to&#160;what&#160;are&#160;called&#160;<i>high-level&#160;programming&#160;languages</i>.&#160;They&#160;are&#160;called&#160;this<br/>because&#160;they&#160;allow&#160;the&#160;programmer&#160;to&#160;be&#160;less&#160;concerned&#160;with&#160;the&#160;details&#160;of&#160;what&#160;the&#160;pro-<br/>cessor&#160;is&#160;doing&#160;and&#160;more&#160;with&#160;solving&#160;the&#160;problem&#160;at&#160;hand.&#160;The&#160;early&#160;ones&#160;(developed<br/>during&#160;the&#160;1950s)&#160;include&#160;&#160;<i>FORTRAN</i>&#160;&#160;(designed&#160;for&#160;scientific&#160;and&#160;technical&#160;tasks)&#160;and<br/><i>COBOL</i>&#160;(designed&#160;for business&#160;applications). Both are&#160;still&#160;in limited use&#160;today.<br/>While&#160;there&#160;are&#160;many&#160;popular&#160;programming&#160;languages,&#160;two&#160;predominate.&#160;Most&#160;programs<br/>written&#160;for&#160;modern&#160;systems&#160;are&#160;written&#160;in&#160;either&#160;<i>C</i>&#160;or&#160;<i>C++</i>.&#160;In&#160;the&#160;examples&#160;to&#160;follow,&#160;we<br/>will&#160;be&#160;compiling a&#160;C program.&#160;<br/>Programs&#160;written&#160;in&#160;high-level&#160;programming&#160;languages&#160;are&#160;converted&#160;into&#160;machine&#160;lan-<br/>guage&#160;by&#160;processing&#160;them&#160;with&#160;another&#160;program,&#160;called&#160;a&#160;&#160;<i>compiler</i>.&#160;Some&#160;compilers<br/>translate&#160;high-level&#160;instructions&#160;into&#160;assembly&#160;language&#160;and&#160;then&#160;use&#160;an&#160;assembler&#160;to&#160;per-<br/>form&#160;the&#160;final&#160;stage&#160;of translation&#160;into machine&#160;language.<br/>A&#160;process&#160;often&#160;used&#160;in&#160;conjunction&#160;with&#160;compiling&#160;is&#160;called&#160;&#160;<i>linking</i>.&#160;There&#160;are&#160;many<br/>common&#160;tasks&#160;performed&#160;by&#160;programs.&#160;Take,&#160;for&#160;instance,&#160;opening&#160;a&#160;file.&#160;Many&#160;programs<br/>perform&#160;this&#160;task,&#160;but&#160;it&#160;would&#160;be&#160;wasteful&#160;to&#160;have&#160;each&#160;program&#160;implement&#160;its&#160;own&#160;rou-<br/>tine&#160;to&#160;open&#160;files.&#160;It&#160;makes&#160;more&#160;sense&#160;to&#160;have&#160;a&#160;single&#160;piece&#160;of&#160;programming&#160;that&#160;knows<br/>how&#160;to&#160;open&#160;files&#160;and&#160;to&#160;allow&#160;all&#160;programs&#160;that&#160;need&#160;it&#160;to&#160;share&#160;it.&#160;Providing&#160;support&#160;for<br/>common&#160;tasks&#160;is&#160;accomplished&#160;by&#160;what&#160;are&#160;called&#160;<i>libraries</i>.&#160;They&#160;contain&#160;multiple&#160;<i>rou-<br/>tines</i>,&#160;each&#160;performing&#160;some&#160;common&#160;task that&#160;multiple&#160;programs&#160;can&#160;share.&#160;If we&#160;look in<br/>the&#160;/lib&#160;and&#160;/usr/lib&#160;directories,&#160;we&#160;can&#160;see&#160;where&#160;many&#160;of&#160;them&#160;live.&#160;A&#160;program<br/>called&#160;a&#160;<i>linker</i>&#160;is&#160;used&#160;to&#160;form&#160;the&#160;connections&#160;between&#160;the&#160;output&#160;of&#160;the&#160;compiler&#160;and&#160;the<br/>libraries&#160;that&#160;the&#160;compiled&#160;program&#160;requires.&#160;The&#160;final&#160;result&#160;of&#160;this&#160;process&#160;is&#160;the&#160;<i>exe-<br/>cutable&#160;program&#160;file</i>,&#160;ready for use.<br/>
Are&#160;Al&#160;&#160;Programs&#160;Compiled?<br/>No.&#160;As&#160;we&#160;have&#160;seen,&#160;there&#160;are&#160;programs&#160;such&#160;as&#160;shell&#160;scripts&#160;that&#160;do&#160;not&#160;require&#160;compil-<br/>ing.&#160;They&#160;are&#160;executed&#160;directly.&#160;These&#160;are&#160;written&#160;in&#160;what&#160;are&#160;known&#160;as&#160;<i>scripting</i>&#160;or&#160;<i>inter-<br/>preted</i>&#160;languages.&#160;These&#160;languages&#160;have&#160;grown&#160;in&#160;popularity&#160;in&#160;recent&#160;years&#160;and&#160;include<br/><i>Perl,&#160;Python,&#160;PHP,&#160;Ruby</i>, and many&#160;others.<br/>Scripted&#160;languages&#160;are&#160;executed&#160;by&#160;a&#160;special&#160;program&#160;called&#160;an&#160;<i>interpreter</i>.&#160;An interpreter<br/>
351<br/>
<hr/>
<a name=376></a>23 – Compiling Programs<br/>
inputs&#160;the&#160;program&#160;file&#160;and&#160;reads&#160;and&#160;executes&#160;each&#160;instruction&#160;contained&#160;within&#160;it.&#160;In<br/>general,&#160;interpreted&#160;programs&#160;execute&#160;much&#160;more&#160;slowly&#160;than&#160;compiled&#160;programs.&#160;This&#160;is<br/>because&#160;each&#160;source&#160;code&#160;instruction&#160;in&#160;an&#160;interpreted&#160;program&#160;is&#160;translated&#160;every&#160;time&#160;it<br/>is&#160;carried&#160;out,&#160;whereas&#160;with&#160;a&#160;compiled&#160;program,&#160;a&#160;source&#160;code&#160;instruction&#160;is&#160;only&#160;trans-<br/>lated&#160;once, and&#160;this&#160;translation&#160;is&#160;permanently recorded in the&#160;final&#160;executable&#160;file.<br/>Why&#160;are&#160;interpreted&#160;languages&#160;so&#160;popular?&#160;For&#160;many&#160;programming&#160;chores,&#160;the&#160;results&#160;are<br/>“fast&#160;enough,”&#160;but&#160;the&#160;real&#160;advantage&#160;is&#160;that&#160;it&#160;is&#160;generally&#160;faster&#160;and&#160;easier&#160;to&#160;develop&#160;in-<br/>terpreted&#160;programs&#160;than&#160;compiled&#160;programs.&#160;Programs&#160;are&#160;usually&#160;developed&#160;in&#160;a&#160;repeat-<br/>ing&#160;cycle&#160;of&#160;code,&#160;compile,&#160;test.&#160;As&#160;a&#160;program&#160;grows&#160;in&#160;size,&#160;the&#160;compilation&#160;phase&#160;of&#160;the<br/>cycle&#160;can&#160;become&#160;quite&#160;long.&#160;Interpreted&#160;languages&#160;remove&#160;the&#160;compilation&#160;step&#160;and&#160;thus<br/>speed&#160;up program&#160;development.<br/>
<b>Compiling&#160;a&#160;C&#160;Program<br/></b>Let’s&#160;compile&#160;something.&#160;Before&#160;we&#160;do&#160;that,&#160;however,&#160;we’re&#160;going&#160;to&#160;need&#160;some&#160;tools<br/>like&#160;the&#160;compiler,&#160;the&#160;linker,&#160;and&#160;make.&#160;The&#160;C&#160;compiler&#160;used&#160;almost&#160;universally&#160;in&#160;the<br/>Linux&#160;environment&#160;is&#160;called&#160;gcc&#160;(GNU&#160;C&#160;Compiler),&#160;originally&#160;written&#160;by&#160;Richard&#160;Stall-<br/>man.&#160;Most&#160;distributions&#160;do&#160;not&#160;install&#160;gcc&#160;by&#160;default.&#160;We&#160;can&#160;check&#160;to&#160;see&#160;whether&#160;the<br/>compiler is&#160;present&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>which gcc<br/></b>/usr/bin/gcc<br/>
The&#160;results&#160;in this&#160;example&#160;indicate&#160;that&#160;the&#160;compiler is&#160;installed.<br/>
<b>Tip</b>:&#160;Your&#160;distribution&#160;may&#160;have&#160;a&#160;meta-package&#160;(a&#160;collection&#160;of&#160;packages)&#160;for<br/>software&#160;development.&#160;If&#160;so,&#160;consider&#160;installing&#160;it&#160;if&#160;you&#160;intend&#160;to&#160;compile&#160;pro-<br/>grams&#160;on&#160;your&#160;system.&#160;If&#160;your&#160;system&#160;does&#160;not&#160;provide&#160;a&#160;meta-package,&#160;try&#160;in-<br/>stalling&#160;the&#160;gcc&#160;and&#160;make&#160;packages.&#160;On&#160;many&#160;distributions,&#160;this&#160;is&#160;sufficient&#160;to<br/>carry&#160;out&#160;the&#160;following exercise.<br/>
Obtaining&#160;the&#160;Source&#160;Code<br/>For&#160;our&#160;compiling&#160;exercise,&#160;we&#160;are&#160;going&#160;to&#160;compile&#160;a&#160;program&#160;from&#160;the&#160;GNU&#160;Project<br/>called&#160;diction.&#160;This&#160;handy&#160;little&#160;program&#160;checks&#160;text&#160;files&#160;for&#160;writing&#160;quality&#160;and&#160;style.<br/>As&#160;programs&#160;go, it&#160;is&#160;fairly&#160;small&#160;and easy to&#160;build.<br/>Following&#160;convention,&#160;we’re&#160;first&#160;going&#160;to&#160;create&#160;a&#160;directory&#160;for&#160;our&#160;source&#160;code&#160;named<br/>src&#160;and then&#160;download&#160;the&#160;source&#160;code&#160;into&#160;it&#160;using&#160;ftp.<br/>
352<br/>
<hr/>
<a name=377></a>Compiling&#160;a&#160;C Program<br/>
[me@linuxbox ~]$&#160;<b>mkdir src<br/></b>[me@linuxbox ~]$&#160;<b>cd src<br/></b>[me@linuxbox src]$&#160;<a href="ftp://ftp.gnu.org/"><b>ftp&#160;ftp.gnu.org</b></a>&#160;<br/><a href="ftp://ftp.gnu.org/">Connected to&#160;ftp.gnu.org</a>.&#160;<br/>220 GNU FTP server ready.&#160;<br/>Name (ftp.gnu.org:me):&#160;<b>anonymous</b>&#160;<br/>230 Login successful.&#160;<br/>Remote system type is UNIX.&#160;<br/>Using binary mode to transfer files.&#160;<br/>ftp&gt;&#160;<b>cd gnu/diction</b>&#160;<br/>250 Directory successfully changed.&#160;<br/>ftp&gt;&#160;<b>ls</b>&#160;<br/>200 PORT command successful. Consider using PASV.&#160;<br/>150 Here comes the directory listing.&#160;<br/>-rw-r--r-- &#160; &#160;1 1003 &#160;65534 &#160; 68940 Aug 28 &#160;1998 diction-0.7.tar.gz&#160;<br/>-rw-r--r-- &#160; &#160;1 1003 &#160;65534 &#160; 90957 Mar 04 &#160;2002 diction-1.02.tar.gz&#160;<br/>-rw-r--r-- &#160; &#160;1 1003 &#160;65534 &#160;141062 Sep 17 &#160;2007 diction-1.11.tar.gz&#160;<br/>226 Directory send OK.&#160;<br/>ftp&gt;&#160;<b>get diction-1.11.tar.gz&#160;<br/></b>local: diction-1.11.tar.gz remote: diction-1.11.tar.gz&#160;<br/>200 PORT command successful. Consider using PASV.&#160;<br/>150 Opening BINARY mode data connection for diction-1.11.tar.gz&#160;<br/>(141062 bytes).&#160;<br/>226 File send OK.&#160;<br/>141062 bytes received in 0.16 secs (847.4 kB/s)&#160;<br/>ftp&gt;&#160;<b>bye</b>&#160;<br/>221 Goodbye.&#160;<br/>[me@linuxbox src]$&#160;<b>ls<br/></b>diction-1.11.tar.gz<br/>
While&#160;we&#160;used&#160;ftp&#160;in&#160;the&#160;previous&#160;example,&#160;which&#160;is&#160;traditional,&#160;there&#160;are&#160;other&#160;ways&#160;of<br/>downloading&#160;source&#160;code.&#160;For&#160;example,&#160;the&#160;GNU&#160;Project&#160;also&#160;supports&#160;downloading&#160;us-<br/>ing HTTPS.&#160;We&#160;can download the&#160;diction&#160;source&#160;code&#160;using the&#160;wget&#160;program.<br/>
[me@linuxbox ~]$&#160;<b>wget https://ftp.gnu.org/gnu/diction/diction-<br/>1.11.tar.gz<br/></b>--2018-07-25 09:42:20-- &#160;https://ftp.gnu.org/gnu/diction/diction-<br/>1.11.tar.gz<br/>Resolving ftp.gnu.org (ftp.gnu.org)... 208.118.235.20,&#160;<br/>2001:4830:134:3::b<br/>Connecting to ftp.gnu.org (ftp.gnu.org)|208.118.235.20|:443...&#160;<br/>connected.<br/>
353<br/>
<hr/>
<a name=378></a>23 – Compiling Programs<br/>
HTTP request sent, awaiting response... 200 OK<br/>Length: 141062 (138K) [application/x-gzip]<br/>Saving to: ‘diction-1.11.tar.gz’<br/>
diction-1.11.tar.gz 100%[===================&gt;] 137.76K &#160;--.-KB/s &#160; &#160;<br/>in 0.09s &#160;&#160;<br/>
2018-07-25 09:42:20 (1.43 MB/s) - ‘diction-1.11.tar.gz.1’ saved&#160;<br/>[141062/141062]<br/>
<b>Note:</b>&#160;Since&#160;we&#160;are&#160;the&#160;“maintainer”&#160;of&#160;this&#160;source&#160;code&#160;while&#160;we&#160;compile&#160;it,&#160;we<br/>will&#160;keep&#160;it&#160;in&#160;&#160;~/src.&#160;Source&#160;code&#160;installed&#160;by&#160;your&#160;distribution&#160;will&#160;be&#160;in-<br/>stalled&#160;in&#160;/usr/src,&#160;while&#160;source&#160;code&#160;we&#160;maintain&#160;that's&#160;intended&#160;for&#160;use&#160;by<br/>multiple&#160;users&#160;is&#160;usually installed&#160;in&#160;/usr/local/src.<br/>
As&#160;we&#160;can&#160;see,&#160;source&#160;code&#160;is&#160;usually&#160;supplied&#160;in&#160;the&#160;form&#160;of&#160;a&#160;compressed&#160;tar&#160;file.<br/>Sometimes&#160;called&#160;a&#160;<i>tarball</i>,&#160;this&#160;file&#160;contains&#160;the&#160;<i>source&#160;tree</i>,&#160;or&#160;hierarchy&#160;of&#160;directories<br/>and&#160;files&#160;that&#160;comprise&#160;the&#160;source&#160;code.&#160;After&#160;arriving&#160;at&#160;the&#160;ftp&#160;site,&#160;we&#160;examine&#160;the&#160;list<br/>of&#160;tar&#160;files&#160;available&#160;and&#160;select&#160;the&#160;newest&#160;version&#160;for&#160;download.&#160;Using&#160;the&#160;&#160;get&#160;&#160;com-<br/>mand within&#160;ftp, we&#160;copy the&#160;file&#160;from&#160;the&#160;ftp server to&#160;the&#160;local&#160;machine.<br/>Once&#160;the&#160;tar file&#160;is&#160;downloaded,&#160;it&#160;must&#160;be&#160;unpacked.&#160;This&#160;is&#160;done&#160;with the&#160;tar&#160;program.<br/>
[me@linuxbox src]$&#160;<b>tar xzf diction-1.11.tar.gz<br/></b>[me@linuxbox src]$&#160;<b>ls<br/></b>diction-1.11 &#160; &#160; &#160; &#160;diction-1.11.tar.gz<br/>
<b>Tip:</b>&#160;&#160;The&#160;&#160;diction&#160;&#160;program,&#160;like&#160;all&#160;&#160;GNU&#160;Project&#160;&#160;software,&#160;follows&#160;certain<br/>standards&#160;for&#160;source&#160;code&#160;packaging.&#160;Most&#160;other&#160;source&#160;code&#160;available&#160;in&#160;the<br/>Linux&#160;ecosystem&#160;also&#160;follows&#160;this&#160;standard.&#160;One&#160;element&#160;of&#160;the&#160;standard&#160;is&#160;that<br/>when&#160;the&#160;source&#160;code&#160;tar&#160;file&#160;is&#160;unpacked,&#160;a&#160;directory&#160;will&#160;be&#160;created&#160;that&#160;con-<br/>tains&#160;the&#160;source&#160;tree,&#160;and&#160;this&#160;directory&#160;will&#160;be&#160;named&#160;<i>project-x.xx</i>,&#160;thus&#160;contain-<br/>ing&#160;both&#160;the&#160;project’s&#160;name&#160;and&#160;its&#160;version&#160;number.&#160;This&#160;scheme&#160;allows&#160;easy&#160;in-<br/>stallation&#160;of&#160;multiple&#160;versions&#160;of&#160;the&#160;same&#160;program.&#160;However,&#160;it&#160;is&#160;often&#160;a&#160;good<br/>idea&#160;to&#160;examine&#160;the&#160;layout&#160;of&#160;the&#160;tree&#160;before&#160;unpacking&#160;it.&#160;Some&#160;projects&#160;will&#160;not<br/>create&#160;the&#160;directory&#160;but&#160;instead&#160;will&#160;deliver&#160;the&#160;files&#160;directly&#160;into&#160;the&#160;current&#160;di-<br/>rectory.&#160;This&#160;will&#160;make&#160;a&#160;mess&#160;in&#160;our&#160;otherwise&#160;well-organized&#160;src&#160;directory.&#160;To<br/>
354<br/>
<hr/>
<a name=379></a>Compiling&#160;a&#160;C Program<br/>
avoid&#160;this, use&#160;the&#160;following command&#160;to examine&#160;the&#160;contents&#160;of the&#160;tar&#160;file:<br/>
tar tzvf&#160;<i>tarfile</i>&#160;| head&#160;<br/>
Examining&#160;the&#160;Source&#160;Tree<br/>Unpacking&#160;the&#160;tar&#160;file&#160;results&#160;in&#160;the&#160;creation&#160;of a&#160;new&#160;directory,&#160;named&#160;diction-1.11.<br/>This&#160;directory contains&#160;the&#160;source&#160;tree.&#160;Let’s&#160;look inside.<br/>
[me@linuxbox src]$&#160;<b>cd diction-1.11<br/></b>[me@linuxbox diction-1.11]$&#160;<b>ls<br/></b>config.guess &#160;diction.c &#160; &#160; &#160; &#160;getopt.c &#160; &#160; &#160;nl&#160;<br/>config.h.in &#160; diction.pot &#160; &#160; &#160;getopt.h &#160; &#160; &#160;nl.po&#160;<br/>config.sub &#160; &#160;diction.spec &#160; &#160; getopt_int.h &#160;README&#160;<br/>configure &#160; &#160; diction.spec.in &#160;INSTALL &#160; &#160; &#160; sentence.c&#160;<br/>configure.in &#160;diction.texi.in &#160;install-sh &#160; &#160;sentence.h&#160;<br/>COPYING &#160; &#160; &#160; en &#160; &#160; &#160; &#160; &#160; &#160; &#160; Makefile.in &#160; style.1.in&#160;<br/>de &#160; &#160; &#160; &#160; &#160; &#160;en_GB &#160; &#160; &#160; &#160; &#160; &#160;misc.c &#160; &#160; &#160; &#160;style.c&#160;<br/>de.po &#160; &#160; &#160; &#160; en_GB.po &#160; &#160; &#160; &#160; misc.h &#160; &#160; &#160; &#160;test&#160;<br/>diction.1.in &#160;getopt1.c &#160; &#160; &#160; &#160;NEWS<br/>
In&#160;it,&#160;we&#160;see&#160;a&#160;number&#160;of&#160;files.&#160;Programs&#160;belonging&#160;to&#160;the&#160;GNU&#160;Project,&#160;as&#160;well&#160;as&#160;many<br/>others,&#160;will&#160;supply&#160;the&#160;documentation&#160;files&#160;README,&#160;INSTALL,&#160;NEWS,&#160;and&#160;COPYING.<br/>These&#160;files&#160;contain&#160;the&#160;description&#160;of&#160;the&#160;program,&#160;information&#160;on&#160;how&#160;to&#160;build&#160;and&#160;in-<br/>stall&#160;it,&#160;and&#160;its&#160;licensing&#160;terms.&#160;It&#160;is&#160;always&#160;a&#160;good&#160;idea&#160;to&#160;carefully&#160;read&#160;the&#160;README&#160;and<br/>INSTALL&#160;files&#160;before&#160;attempting to build the&#160;program.<br/>The&#160;other&#160;interesting files&#160;in this&#160;directory&#160;are&#160;the&#160;ones&#160;ending with&#160;.c&#160;and&#160;.h.<br/>
[me@linuxbox diction-1.11]$&#160;<b>ls *.c<br/></b>diction.c &#160;getopt1.c &#160;getopt.c &#160;misc.c &#160;sentence.c &#160;style.c<br/>[me@linuxbox diction-1.11]$&#160;<b>ls *.h<br/></b>getopt.h &#160;getopt_int.h &#160;misc.h &#160;sentence.h<br/>
The&#160;&#160;.c&#160;&#160;files&#160;contain&#160;the&#160;two&#160;C&#160;programs&#160;supplied&#160;by&#160;the&#160;package&#160;(style&#160;&#160;and&#160;&#160;dic-<br/>tion),&#160;divided&#160;into&#160;modules.&#160;It&#160;is&#160;common&#160;practice&#160;for&#160;large&#160;programs&#160;to&#160;be&#160;broken&#160;into<br/>smaller,&#160;easier-to-manage&#160;pieces.&#160;The&#160;source&#160;code&#160;files&#160;are&#160;ordinary&#160;text&#160;and&#160;can&#160;be&#160;ex-<br/>amined&#160;with&#160;less.<br/>
355<br/>
<hr/>
<a name=380></a>23 – Compiling Programs<br/>
[me@linuxbox diction-1.11]$&#160;<b>less diction.c</b><br/>
The&#160;.h&#160;files&#160;are&#160;known&#160;as&#160;<i>header&#160;files</i>.&#160;These,&#160;too,&#160;are&#160;ordinary&#160;text.&#160;Header&#160;files&#160;contain<br/>descriptions&#160;of&#160;the&#160;routines&#160;included&#160;in&#160;a&#160;source&#160;code&#160;file&#160;or&#160;library.&#160;For&#160;the&#160;compiler&#160;to<br/>connect&#160;the&#160;modules,&#160;it&#160;must&#160;receive&#160;a&#160;description&#160;of&#160;all&#160;the&#160;modules&#160;needed&#160;to&#160;complete<br/>the&#160;entire&#160;program. Near the&#160;beginning&#160;of the&#160;diction.c&#160;file, we&#160;see&#160;this&#160;line:<br/>
#include &#34;getopt.h&#34;<br/>
This&#160;instructs&#160;the&#160;compiler&#160;to&#160;read&#160;the&#160;file&#160;&#160;getopt.h&#160;&#160;as&#160;it&#160;reads&#160;the&#160;source&#160;code&#160;in<br/>diction.c&#160;&#160;to&#160;“know”&#160;what’s&#160;in&#160;&#160;getopt.c.&#160;The&#160;&#160;getopt.c&#160;&#160;file&#160;supplies&#160;routines<br/>that&#160;are&#160;shared by both&#160;the&#160;style&#160;and&#160;diction&#160;programs.<br/>Before&#160;the&#160;include&#160;statement&#160;for&#160;getopt.h, we&#160;see&#160;some&#160;other&#160;include&#160;statements<br/>such&#160;as&#160;these:<br/>
#include &lt;regex.h&gt;&#160;<br/>#include &lt;stdio.h&gt;&#160;<br/>#include &lt;stdlib.h&gt;&#160;<br/>#include &lt;string.h&gt;&#160;<br/>#include &lt;unistd.h&gt;<br/>
These&#160;also&#160;refer&#160;to&#160;header&#160;files,&#160;but&#160;they&#160;refer&#160;to&#160;header&#160;files&#160;that&#160;live&#160;outside&#160;the&#160;current<br/>source&#160;tree.&#160;They are&#160;supplied by the&#160;system&#160;to support&#160;the&#160;compilation of every&#160;program.<br/>If we&#160;look in&#160;/usr/include, we&#160;can&#160;see&#160;them.<br/>
[me@linuxbox diction-1.11]$&#160;<b>ls /usr/include</b><br/>
The&#160;header files&#160;in this&#160;directory&#160;were&#160;installed when we&#160;installed&#160;the&#160;compiler.<br/>
Building&#160;the&#160;Program<br/>Most&#160;programs&#160;build with&#160;a&#160;simple,&#160;two-command sequence.<br/>
./configure<br/>make<br/>
356<br/>
<hr/>
<a name=381></a>Compiling&#160;a&#160;C Program<br/>
The&#160;configure&#160;program&#160;is&#160;a&#160;shell&#160;script&#160;that&#160;is&#160;supplied&#160;with&#160;the&#160;source&#160;tree.&#160;Its&#160;job&#160;is<br/>to&#160;analyze&#160;the&#160;<i>build&#160;environment</i>.&#160;Most&#160;source&#160;code&#160;is&#160;designed&#160;to&#160;be&#160;<i>portable</i>.&#160;That&#160;is,&#160;it<br/>is&#160;designed&#160;to&#160;build&#160;on&#160;more&#160;than&#160;one&#160;kind&#160;of&#160;Unix-like&#160;system.&#160;But&#160;to&#160;do&#160;that,&#160;the&#160;source<br/>code&#160;may&#160;need&#160;to&#160;undergo&#160;slight&#160;adjustments&#160;during&#160;the&#160;build&#160;to&#160;accommodate&#160;differ-<br/>ences&#160;between&#160;systems.&#160;configure&#160;also&#160;checks&#160;to&#160;see&#160;that&#160;necessary&#160;external&#160;tools&#160;and<br/>components&#160;&#160;&#160;are&#160;&#160;&#160;installed.&#160;&#160;&#160;Let’s&#160;&#160;&#160;run&#160;&#160;configure.&#160;&#160;Since&#160;&#160;configure&#160;&#160;is&#160;&#160;not&#160;&#160;located<br/>where&#160;the&#160;shell&#160;normally&#160;expects&#160;programs&#160;to&#160;be&#160;located,&#160;we&#160;must&#160;explicitly&#160;tell&#160;the&#160;shell<br/>its&#160;location&#160;by&#160;prefixing&#160;the&#160;command&#160;with&#160;./&#160;to&#160;indicate&#160;that&#160;the&#160;program&#160;is&#160;located&#160;in<br/>the&#160;current&#160;working directory.<br/>
[me@linuxbox diction-1.11]$&#160;<b>./configure</b><br/>
configure&#160;will&#160;output&#160;a&#160;lot&#160;of&#160;messages&#160;as&#160;it&#160;tests&#160;and&#160;configures&#160;the&#160;build.&#160;When&#160;it<br/>finishes, it&#160;will&#160;look&#160;something&#160;like&#160;this:<br/>
checking libintl.h presence... yes&#160;<br/>checking for libintl.h... yes&#160;<br/>checking for library containing gettext... none required&#160;<br/>configure: creating ./config.status&#160;<br/>config.status: creating Makefile&#160;<br/>config.status: creating diction.1&#160;<br/>config.status: creating diction.texi&#160;<br/>config.status: creating diction.spec&#160;<br/>config.status: creating style.1&#160;<br/>config.status: creating test/rundiction&#160;<br/>config.status: creating config.h<br/>[me@linuxbox diction-1.11]$&#160;<br/>
What’s&#160;important&#160;here&#160;is&#160;that&#160;there&#160;are&#160;no&#160;error&#160;messages.&#160;If&#160;there&#160;were,&#160;the&#160;configuration<br/>failed,&#160;and the&#160;program&#160;will&#160;not&#160;build until&#160;the&#160;errors&#160;are&#160;corrected.<br/>We&#160;see&#160;configure&#160;created&#160;several&#160;new&#160;files&#160;in&#160;our&#160;source&#160;directory.&#160;The&#160;most&#160;impor-<br/>tant&#160;one&#160;is&#160;the&#160;<i>makefile</i>.&#160;The&#160;makefile&#160;is&#160;a&#160;configuration&#160;file&#160;that&#160;instructs&#160;the&#160;make&#160;pro-<br/>gram&#160;exactly&#160;how&#160;to&#160;build&#160;the&#160;program.&#160;Without&#160;it,&#160;make&#160;will&#160;refuse&#160;to&#160;run.&#160;The&#160;makefile<br/>is&#160;an ordinary&#160;text&#160;file, so we&#160;can&#160;view&#160;it:<br/>
[me@linuxbox diction-1.11]$&#160;<b>less Makefile</b><br/>
The&#160;&#160;make&#160;&#160;program&#160;takes&#160;as&#160;input&#160;a&#160;&#160;<i>makefile</i>&#160;&#160;(which&#160;is&#160;normally&#160;named&#160;&#160;Makefile),<br/>
357<br/>
<hr/>
<a name=382></a>23 – Compiling Programs<br/>
which&#160;describes&#160;the&#160;relationships&#160;and&#160;dependencies&#160;among&#160;the&#160;components&#160;that&#160;comprise<br/>the&#160;finished program.<br/>The&#160;first&#160;part&#160;of&#160;the&#160;makefile&#160;defines&#160;variables&#160;that&#160;are&#160;substituted&#160;in&#160;later&#160;sections&#160;of&#160;the<br/>makefile.&#160;For example&#160;we&#160;see&#160;the&#160;following line:<br/>
CC= &#160; &#160; &#160; &#160; &#160; &#160; gcc<br/>
That&#160;defines&#160;the&#160;C&#160;compiler&#160;to&#160;be&#160;gcc.&#160;Later&#160;in&#160;the&#160;makefile,&#160;we&#160;see&#160;one&#160;instance&#160;where<br/>it&#160;gets&#160;used.<br/>
diction: &#160; &#160; &#160; &#160;diction.o sentence.o misc.o getopt.o getopt1.o&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(CC) -o $@ $(LDFLAGS) diction.o sentence.o misc.o \&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; getopt.o getopt1.o $(LIBS)<br/>
A&#160;substitution&#160;is&#160;performed&#160;here, and the&#160;value&#160;$(CC)&#160;is&#160;replaced by&#160;gcc&#160;at&#160;runtime.<br/>Most&#160;of&#160;the&#160;makefile&#160;consists&#160;of&#160;lines,&#160;which&#160;define&#160;a&#160;<i>target</i>,&#160;in&#160;this&#160;case&#160;the&#160;executable<br/>file&#160;&#160;diction&#160;and&#160;the&#160;files&#160;on&#160;which&#160;it&#160;is&#160;dependent.&#160;The&#160;remaining&#160;lines&#160;describe&#160;the<br/>commands&#160;needed&#160;to&#160;create&#160;the&#160;target&#160;from&#160;its&#160;components.&#160;We&#160;see&#160;in&#160;this&#160;example&#160;that<br/>the&#160;executable&#160;file&#160;&#160;diction&#160;&#160;(one&#160;of&#160;the&#160;end&#160;products)&#160;depends&#160;on&#160;the&#160;existence&#160;of<br/>diction.o,&#160;&#160;sentence.o,&#160;&#160;misc.o,&#160;&#160;getopt.o,&#160;&#160;and&#160;&#160;getopt1.o.&#160;&#160;Later,&#160;&#160;in&#160;the<br/>makefile,&#160;we&#160;see&#160;definitions&#160;of each&#160;of these&#160;as&#160;targets.<br/>
diction.o: &#160; &#160; &#160;diction.c config.h getopt.h misc.h sentence.h&#160;<br/>getopt.o: &#160; &#160; &#160; getopt.c getopt.h getopt_int.h&#160;<br/>getopt1.o: &#160; &#160; &#160;getopt1.c getopt.h getopt_int.h&#160;<br/>misc.o: &#160; &#160; &#160; &#160; misc.c config.h misc.h&#160;<br/>sentence.o: &#160; &#160; sentence.c config.h misc.h sentence.h&#160;<br/>style.o: &#160; &#160; &#160; &#160;style.c config.h getopt.h misc.h sentence.h<br/>
However,&#160;we&#160;don’t&#160;see&#160;any&#160;command&#160;specified&#160;for&#160;them.&#160;This&#160;is&#160;handled&#160;by&#160;a&#160;general&#160;tar-<br/>get,&#160;earlier&#160;in&#160;the&#160;file,&#160;that&#160;describes&#160;the&#160;command&#160;used&#160;to&#160;compile&#160;any&#160;.c&#160;file&#160;into&#160;a&#160;.o<br/>file.<br/>
.c.o:&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(CC) -c $(CPPFLAGS) $(CFLAGS) $&lt;<br/>
This&#160;all&#160;seems&#160;very&#160;complicated.&#160;Why&#160;not&#160;simply&#160;list&#160;all&#160;the&#160;steps&#160;to&#160;compile&#160;the&#160;parts<br/>
358<br/>
<hr/>
<a name=383></a>Compiling&#160;a&#160;C Program<br/>
and&#160;be&#160;done&#160;with&#160;it?&#160;The&#160;answer&#160;to&#160;this&#160;will&#160;become&#160;clear&#160;in&#160;a&#160;moment.&#160;In&#160;the&#160;meantime,<br/>let’s&#160;run&#160;make&#160;and build&#160;our programs.<br/>
[me@linuxbox diction-1.11]$&#160;<b>make</b><br/>
The&#160;make&#160;program&#160;will&#160;run,&#160;using&#160;the&#160;contents&#160;of&#160;Makefile&#160;to&#160;guide&#160;its&#160;actions.&#160;It&#160;will<br/>produce&#160;a&#160;lot&#160;of messages.<br/>When it&#160;finishes, we&#160;will&#160;see&#160;that&#160;all&#160;the&#160;targets&#160;are&#160;now&#160;present&#160;in our directory.<br/>
[me@linuxbox diction-1.11]$&#160;<b>ls</b>&#160;<br/>config.guess &#160; de.po &#160; &#160; &#160; &#160; &#160; &#160;en &#160; &#160; &#160; &#160; &#160; &#160;install-sh &#160; sentence.c<br/>config.h &#160; &#160; &#160; diction &#160; &#160; &#160; &#160; &#160;en_GB &#160; &#160; &#160; &#160; Makefile &#160; &#160; sentence.h<br/>config.h.in &#160; &#160;diction.1 &#160; &#160; &#160; &#160;en_GB.mo &#160; &#160; &#160;Makefile.in &#160;sentence.o<br/>config.log &#160; &#160; diction.1.in &#160; &#160; en_GB.po &#160; &#160; &#160;misc.c &#160; &#160; &#160; style&#160;<br/>config.status &#160;diction.c &#160; &#160; &#160; &#160;getopt1.c &#160; &#160; misc.h &#160; &#160; &#160; style.1&#160;<br/>config.sub &#160; &#160; diction.o &#160; &#160; &#160; &#160;getopt1.o &#160; &#160; misc.o &#160; &#160; &#160; style.1.in<br/>configure &#160; &#160; &#160;diction.pot &#160; &#160; &#160;getopt.c &#160; &#160; &#160;NEWS &#160; &#160; &#160; &#160; style.c&#160;<br/>configure.in &#160; diction.spec &#160; &#160; getopt.h &#160; &#160; &#160;nl &#160; &#160; &#160; &#160; &#160; style.o&#160;<br/>COPYING &#160; &#160; &#160; &#160;diction.spec.in &#160;getopt_int.h &#160;nl.mo &#160; &#160; &#160; &#160;test&#160;<br/>de &#160; &#160; &#160; &#160; &#160; &#160; diction.texi &#160; &#160; getopt.o &#160; &#160; &#160;nl.po&#160;<br/>de.mo &#160; &#160; &#160; &#160; &#160;diction.texi.in &#160;INSTALL &#160; &#160; &#160; README<br/>
Among&#160;the&#160;files,&#160;we&#160;see&#160;diction&#160;and&#160;style,&#160;the&#160;programs&#160;that&#160;we&#160;set&#160;out&#160;to&#160;build.<br/>Congratulations&#160;are&#160;in order!&#160;We&#160;just&#160;compiled&#160;our first&#160;programs&#160;from&#160;source&#160;code!<br/>But&#160;just&#160;out&#160;of curiosity,&#160;let’s&#160;run&#160;make&#160;again.<br/>
[me@linuxbox diction-1.11]$&#160;<b>make<br/></b>make: Nothing to be done for `all'.<br/>
It&#160;only&#160;produces&#160;this&#160;strange&#160;message.&#160;What’s&#160;going&#160;on?&#160;Why&#160;didn’t&#160;it&#160;build&#160;the&#160;program<br/>again?&#160;Ah,&#160;this&#160;is&#160;the&#160;magic&#160;of&#160;&#160;make.&#160;Rather&#160;than&#160;simply&#160;building&#160;everything&#160;again,<br/>make&#160;only&#160;builds&#160;what&#160;needs&#160;building.&#160;With&#160;all&#160;of&#160;the&#160;targets&#160;present,&#160;make&#160;determined<br/>that&#160;there&#160;was&#160;nothing&#160;to&#160;do.&#160;We&#160;can&#160;demonstrate&#160;this&#160;by&#160;deleting&#160;one&#160;of&#160;the&#160;targets&#160;and<br/>running make&#160;again&#160;to see&#160;what&#160;it&#160;does. Let’s&#160;get&#160;rid of one&#160;of the&#160;intermediate&#160;targets.<br/>
[me@linuxbox diction-1.11]$&#160;<b>rm getopt.o<br/></b>[me@linuxbox diction-1.11]$&#160;<b>make</b><br/>
359<br/>
<hr/>
<a name=384></a>23 – Compiling Programs<br/>
We&#160;see&#160;that&#160;make&#160;rebuilds&#160;it&#160;and&#160;re-links&#160;the&#160;diction&#160;and&#160;style&#160;programs,&#160;since&#160;they<br/>depend&#160;on&#160;the&#160;missing&#160;module.&#160;This&#160;behavior&#160;also&#160;points&#160;out&#160;another&#160;important&#160;feature&#160;of<br/>make:&#160;it&#160;keeps&#160;targets&#160;up-to-date.&#160;make&#160;insists&#160;that&#160;targets&#160;be&#160;newer than&#160;their&#160;dependen-<br/>cies.&#160;This&#160;makes&#160;perfect&#160;sense,&#160;because&#160;a&#160;programmer&#160;will&#160;often&#160;update&#160;a&#160;bit&#160;of&#160;source<br/>code&#160;and&#160;then&#160;use&#160;make&#160;to&#160;build&#160;a&#160;new&#160;version&#160;of&#160;the&#160;finished&#160;product.&#160;make&#160;ensures<br/>that&#160;everything&#160;that&#160;needs&#160;building&#160;based&#160;on&#160;the&#160;updated&#160;code&#160;is&#160;built.&#160;If&#160;we&#160;use&#160;the<br/>touch&#160;program&#160;to&#160;“update”&#160;one&#160;of the&#160;source&#160;code&#160;files, we&#160;can&#160;see&#160;this&#160;happen:<br/>
[me@linuxbox diction-1.11]$&#160;<b>ls -l diction getopt.c</b>&#160;<br/>-rwxr-xr-x 1 me &#160; &#160; &#160;me &#160; &#160; &#160;37164 2009-03-05 06:14 diction&#160;<br/>-rw-r--r-- 1 me &#160; &#160; &#160;me &#160; &#160; &#160;33125 2007-03-30 17:45 getopt.c<br/>[me@linuxbox diction-1.11]$&#160;<b>touch getopt.c<br/></b>[me@linuxbox diction-1.11]$&#160;<b>ls -l diction getopt.c<br/></b>-rwxr-xr-x 1 me &#160; &#160; &#160;me &#160; &#160; &#160;37164 2009-03-05 06:14 diction&#160;<br/>-rw-r--r-- 1 me &#160; &#160; &#160;me &#160; &#160; &#160;33125 2009-03-05 06:23 getopt.c<br/>[me@linuxbox diction-1.11]$&#160;<b>make</b><br/>
After&#160;&#160;make&#160;runs,&#160;we&#160;see&#160;that&#160;it&#160;has&#160;restored&#160;the&#160;target&#160;to&#160;being&#160;newer&#160;than&#160;the&#160;depen-<br/>dency:<br/>
[me@linuxbox diction-1.11]$&#160;<b>ls -l diction getopt.c&#160;<br/></b>-rwxr-xr-x 1 me &#160; &#160; &#160;me &#160; &#160; &#160;37164 2009-03-05 06:24 diction&#160;<br/>-rw-r--r-- 1 me &#160; &#160; &#160;me &#160; &#160; &#160;33125 2009-03-05 06:23 getopt.c<br/>
The&#160;ability&#160;of&#160;make&#160;to&#160;intelligently&#160;build&#160;only&#160;what&#160;needs&#160;building&#160;is&#160;a&#160;great&#160;benefit&#160;to<br/>programmers.&#160;While&#160;the&#160;time&#160;savings&#160;may&#160;not&#160;be&#160;apparent&#160;with&#160;our&#160;small&#160;project,&#160;it&#160;is<br/>very&#160;significant&#160;with&#160;larger&#160;projects.&#160;Remember,&#160;the&#160;Linux&#160;kernel&#160;(a&#160;program&#160;that&#160;under-<br/>goes&#160;continuous&#160;modification and&#160;improvement)&#160;contains&#160;several&#160;<i>million</i>&#160;lines&#160;of code.<br/>
Installing&#160;the&#160;Program<br/>Well-packaged&#160;source&#160;code&#160;will&#160;often&#160;include&#160;a&#160;special&#160;&#160;make&#160;&#160;target&#160;called&#160;&#160;install.<br/>This&#160;target&#160;will&#160;install&#160;the&#160;final&#160;product&#160;in&#160;a&#160;system&#160;directory&#160;for&#160;use.&#160;Usually,&#160;this&#160;direc-<br/>tory&#160;is&#160;/usr/local/bin,&#160;the&#160;traditional&#160;location&#160;for&#160;locally&#160;built&#160;software.&#160;However,<br/>this&#160;directory&#160;is&#160;not&#160;normally&#160;writable&#160;by&#160;ordinary&#160;users,&#160;so&#160;we&#160;must&#160;become&#160;the&#160;supe-<br/>ruser&#160;to perform&#160;the&#160;installation.<br/>
[me@linuxbox diction-1.11]$&#160;<b>sudo make install</b><br/>
360<br/>
<hr/>
<a name=385></a>Compiling&#160;a&#160;C Program<br/>
After we&#160;perform&#160;the&#160;installation, we&#160;can&#160;check that&#160;the&#160;program&#160;is&#160;ready to go.<br/>
[me@linuxbox diction-1.11]$&#160;<b>which diction<br/></b>/usr/local/bin/diction<br/>[me@linuxbox diction-1.11]$&#160;<b>man diction</b><br/>
There&#160;we&#160;have&#160;it!<br/>
<b>Summing&#160;Up<br/></b>In this&#160;chapter, we&#160;saw&#160;how&#160;three&#160;simple&#160;commands:<br/>./configure<br/>
make<br/>
make install<br/>
can&#160;be&#160;used&#160;to&#160;build&#160;many&#160;source&#160;code&#160;packages.&#160;We&#160;also&#160;saw&#160;the&#160;important&#160;role&#160;that<br/>make&#160;plays&#160;in&#160;the&#160;maintenance&#160;of programs.&#160;The&#160;make&#160;program&#160;can&#160;be&#160;used&#160;for&#160;any task<br/>that&#160;needs&#160;to&#160;maintain&#160;a&#160;target/dependency&#160;relationship,&#160;not&#160;just&#160;for&#160;compiling&#160;source<br/>code.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;Wikipedia&#160;has&#160;good articles&#160;on compilers&#160;and the&#160;make&#160;program:<br/><a href="http://en.wikipedia.org/wiki/Compiler">http://en.wikipedia.org/wiki/Compiler<br/></a><a href="http://en.wikipedia.org/wiki/Make_(software)">http://en.wikipedia.org/wiki/Make_(software)</a><br/>
●<br/>
<i>The&#160;GNU&#160;Make&#160;Manual</i>:<br/><a href="http://www.gnu.org/software/make/manual/html_node/index.html">http://www.gnu.org/software/make/manual/html_node/index.html</a>&#160;<br/>
361<br/>
<hr/>
<a name=386></a><hr/>
<a name=387></a>Part&#160;4 –&#160;Writing Shell&#160;Scripts<br/>
Part&#160;4&#160;–&#160;Writing&#160;Shell&#160;Scripts<br/>
363<br/>
<hr/>
<a name=388></a>24 –&#160;Writing&#160;Your First&#160;Script<br/>
<i><b>24&#160;–&#160;Writing&#160;Your&#160;First&#160;Script</b></i><br/>
In&#160;the&#160;preceding&#160;chapters,&#160;we&#160;have&#160;assembled&#160;an&#160;arsenal&#160;of&#160;command&#160;line&#160;tools.&#160;While<br/>these&#160;tools&#160;can&#160;solve&#160;many&#160;kinds&#160;of&#160;computing&#160;problems,&#160;we&#160;are&#160;still&#160;limited&#160;to&#160;manually<br/>using&#160;them&#160;one&#160;by&#160;one&#160;on&#160;the&#160;command&#160;line.&#160;Wouldn’t&#160;it&#160;be&#160;great&#160;if&#160;we&#160;could&#160;get&#160;the<br/>shell&#160;to&#160;do&#160;more&#160;of&#160;the&#160;work?&#160;We&#160;can.&#160;By&#160;joining&#160;our&#160;tools&#160;together&#160;into&#160;programs&#160;of&#160;our<br/>own&#160;design,&#160;the&#160;shell&#160;can&#160;carry&#160;out&#160;complex&#160;sequences&#160;of&#160;tasks&#160;all&#160;by&#160;itself.&#160;We&#160;can&#160;en-<br/>able&#160;it&#160;to&#160;do this&#160;by writing&#160;<i>shell&#160;scripts</i>.<br/>
<b>What&#160;are&#160;Shell&#160;Scripts?<br/></b>In&#160;the&#160;simplest&#160;terms,&#160;a&#160;shell&#160;script&#160;is&#160;a&#160;file&#160;containing&#160;a&#160;series&#160;of&#160;commands.&#160;The&#160;shell<br/>reads&#160;this&#160;file&#160;and&#160;carries&#160;out&#160;the&#160;commands&#160;as&#160;though&#160;they&#160;have&#160;been&#160;entered&#160;directly&#160;on<br/>the&#160;command&#160;line.<br/>The&#160;shell&#160;is&#160;somewhat&#160;unique,&#160;in&#160;that&#160;it&#160;is&#160;both&#160;a&#160;powerful&#160;command&#160;line&#160;interface&#160;to&#160;the<br/>system&#160;and&#160;a&#160;scripting&#160;language&#160;interpreter.&#160;As&#160;we&#160;will&#160;see,&#160;most&#160;of&#160;the&#160;things&#160;that&#160;can&#160;be<br/>done&#160;on&#160;the&#160;command&#160;line&#160;can&#160;be&#160;done&#160;in&#160;scripts,&#160;and&#160;most&#160;of&#160;the&#160;things&#160;that&#160;can&#160;be&#160;done<br/>in scripts&#160;can&#160;be&#160;done&#160;on the&#160;command line.<br/>We&#160;have&#160;covered&#160;many&#160;shell&#160;features,&#160;but&#160;we&#160;have&#160;focused&#160;on&#160;those&#160;features&#160;most&#160;often<br/>used&#160;directly&#160;on&#160;the&#160;command&#160;line.&#160;The&#160;shell&#160;also&#160;provides&#160;a&#160;set&#160;of&#160;features&#160;usually&#160;(but<br/>not&#160;always) used when writing&#160;programs.<br/>
<b>How&#160;to&#160;Write&#160;a&#160;Shell&#160;Script<br/></b>To successfully create&#160;and&#160;run a&#160;shell&#160;script, we&#160;need&#160;to do three&#160;things.<br/>
1.&#160;<b>Write&#160;a&#160;script.</b>&#160;Shell&#160;scripts&#160;are&#160;ordinary&#160;text&#160;files.&#160;So,&#160;we&#160;need&#160;a&#160;text&#160;editor&#160;to<br/>
write&#160;them.&#160;The&#160;best&#160;text&#160;editors&#160;will&#160;provide&#160;<i>syntax&#160;highlighting</i>,&#160;allowing&#160;us&#160;to<br/>see&#160;a&#160;color-coded&#160;view&#160;of&#160;the&#160;elements&#160;of&#160;the&#160;script.&#160;Syntax&#160;highlighting&#160;will&#160;help<br/>us&#160;spot&#160;certain&#160;kinds&#160;of&#160;common&#160;errors.&#160;vim,&#160;gedit,&#160;kate,&#160;and&#160;many&#160;other&#160;edi-<br/>tors&#160;are&#160;good candidates&#160;for writing scripts.<br/>
2.&#160;<b>Make&#160;the&#160;script&#160;executable.</b>&#160;The&#160;system&#160;is&#160;rather&#160;fussy&#160;about&#160;not&#160;letting&#160;any&#160;old<br/>
text&#160;file&#160;be&#160;treated&#160;as&#160;a&#160;program,&#160;and&#160;for&#160;good&#160;reason!&#160;We&#160;need&#160;to&#160;set&#160;the&#160;script<br/>file’s&#160;permissions&#160;to&#160;allow&#160;execution.<br/>
364<br/>
<hr/>
<a name=389></a>How&#160;to&#160;Write&#160;a&#160;Shell&#160;Script<br/>
3.&#160;<b>Put&#160;the&#160;script&#160;somewhere&#160;the&#160;shell&#160;can&#160;find&#160;it.</b>&#160;The&#160;shell&#160;automatically&#160;searches<br/>
certain&#160;directories&#160;for&#160;executable&#160;files&#160;when&#160;no&#160;explicit&#160;pathname&#160;is&#160;specified.&#160;For<br/>maximum&#160;convenience,&#160;we&#160;will&#160;place&#160;our scripts&#160;in these&#160;directories.<br/>
<b>Script&#160;File&#160;Format<br/></b>In&#160;keeping&#160;with&#160;programming&#160;tradition,&#160;we’ll&#160;create&#160;a&#160;“Hello&#160;World”&#160;program&#160;to&#160;demon-<br/>strate&#160;an&#160;extremely&#160;simple&#160;script.&#160;Let’s&#160;fire&#160;up&#160;our&#160;text&#160;editors&#160;and&#160;enter&#160;the&#160;following<br/>script:<br/>
<b>#!/bin/bash</b><br/>
<b># This is our first script.</b><br/>
<b>echo 'Hello World!'</b><br/>
The&#160;last&#160;line&#160;of&#160;our&#160;script&#160;is&#160;pretty&#160;familiar;&#160;it’s&#160;just&#160;an&#160;echo&#160;command&#160;with&#160;a&#160;string&#160;ar-<br/>gument.&#160;The&#160;second&#160;line&#160;is&#160;also&#160;familiar.&#160;It&#160;looks&#160;like&#160;a&#160;comment&#160;that&#160;we&#160;have&#160;seen&#160;used<br/>in&#160;many&#160;of&#160;the&#160;configuration&#160;files&#160;we&#160;have&#160;examined&#160;and&#160;edited.&#160;One&#160;thing&#160;about&#160;com-<br/>ments&#160;in&#160;shell&#160;scripts&#160;is&#160;that&#160;they&#160;may&#160;also&#160;appear&#160;at&#160;the&#160;ends&#160;of&#160;lines,&#160;provided&#160;they&#160;are<br/>preceded&#160;with at&#160;least&#160;one&#160;whitespace&#160;character,&#160;like&#160;so:<br/>
echo 'Hello World!' # This is a comment too<br/>
Everything from&#160;the&#160;#&#160;symbol&#160;onward on the&#160;line&#160;is&#160;ignored.<br/>Like&#160;many things,&#160;this&#160;works&#160;on the&#160;command line,&#160;too:<br/>
[me@linuxbox ~]$&#160;<b>echo 'Hello World!' # This is a comment too</b>&#160;<br/>Hello World!<br/>
Though comments&#160;are&#160;of little&#160;use&#160;on the&#160;command line, they&#160;will&#160;work.<br/>The&#160;first&#160;line&#160;of our script&#160;is&#160;a&#160;little&#160;mysterious. It&#160;looks&#160;as&#160;if&#160;it&#160;should be&#160;a&#160;comment&#160;since<br/>it&#160;starts&#160;with&#160;#,&#160;but&#160;it&#160;looks&#160;too&#160;purposeful&#160;to&#160;be&#160;just&#160;that.&#160;The&#160;#!&#160;character&#160;sequence&#160;is,<br/>in&#160;fact,&#160;a&#160;special&#160;construct&#160;called&#160;a&#160;&#160;<i>shebang</i>.&#160;The&#160;shebang&#160;is&#160;used&#160;to&#160;tell&#160;the&#160;kernel&#160;the<br/>name&#160;of&#160;the&#160;interpreter&#160;that&#160;should&#160;be&#160;used&#160;to&#160;execute&#160;the&#160;script&#160;that&#160;follows.&#160;Every&#160;shell<br/>script&#160;should include&#160;this&#160;as&#160;its&#160;first&#160;line.<br/>Let’s&#160;save&#160;our script&#160;file&#160;as&#160;hello_world.<br/>
365<br/>
<hr/>
<a name=390></a>24 –&#160;Writing&#160;Your First&#160;Script<br/>
<b>Executable&#160;Permissions<br/></b>The&#160;next&#160;thing&#160;we&#160;have&#160;to&#160;do&#160;is&#160;make&#160;our&#160;script&#160;executable.&#160;This&#160;is&#160;easily&#160;done&#160;using<br/>chmod.<br/>
[me@linuxbox ~]$&#160;<b>ls -l hello_world<br/></b>-rw-r--r-- 1 me &#160; &#160; &#160;me &#160; &#160; &#160;63 2009-03-07 10:10 hello_world<br/>[me@linuxbox ~]$&#160;<b>chmod 755 hello_world<br/></b>[me@linuxbox ~]$&#160;<b>ls -l hello_world&#160;<br/></b>-rwxr-xr-x 1 me &#160; &#160; &#160;me &#160; &#160; &#160;63 2009-03-07 10:10 hello_world<br/>
There&#160;are&#160;two&#160;common&#160;permission&#160;settings&#160;for&#160;scripts:&#160;755&#160;for&#160;scripts&#160;that&#160;everyone&#160;can<br/>execute,&#160;and&#160;700&#160;for&#160;scripts&#160;that&#160;only&#160;the&#160;owner&#160;can&#160;execute.&#160;Note&#160;that&#160;scripts&#160;must&#160;be<br/>readable&#160;to be&#160;executed.<br/>
<b>Script&#160;File&#160;Location<br/></b>With&#160;the&#160;permissions&#160;set, we&#160;can now&#160;execute&#160;our script:<br/>
[me@linuxbox ~]$&#160;<b>./hello_world<br/></b>Hello World!<br/>
For&#160;the&#160;script&#160;to&#160;run,&#160;we&#160;must&#160;precede&#160;the&#160;script&#160;name&#160;with&#160;an&#160;explicit&#160;path.&#160;If&#160;we&#160;don’t,<br/>we&#160;get&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>hello_world<br/></b>bash: hello_world: command not found<br/>
Why&#160;is&#160;this?&#160;What&#160;makes&#160;our&#160;script&#160;different&#160;from&#160;other&#160;programs?&#160;As&#160;it&#160;turns&#160;out,&#160;noth-<br/>ing.&#160;Our&#160;script&#160;is&#160;fine.&#160;Its&#160;location&#160;is&#160;the&#160;problem.&#160;In&#160;Chapter&#160;11,&#160;we&#160;discussed&#160;the&#160;PATH<br/>environment&#160;variable&#160;and&#160;its&#160;effect&#160;on&#160;how&#160;the&#160;system&#160;searches&#160;for&#160;executable&#160;programs.<br/>To&#160;recap,&#160;the&#160;system&#160;searches&#160;a&#160;list&#160;of&#160;directories&#160;each&#160;time&#160;it&#160;needs&#160;to&#160;find&#160;an&#160;executable<br/>program,&#160;if&#160;no&#160;explicit&#160;path&#160;is&#160;specified.&#160;This&#160;is&#160;how&#160;the&#160;system&#160;knows&#160;to&#160;execute&#160;/bin/<br/>ls&#160;when&#160;we&#160;type&#160;ls&#160;at&#160;the&#160;command&#160;line.&#160;The&#160;/bin&#160;directory&#160;is&#160;one&#160;of&#160;the&#160;directories<br/>that&#160;the&#160;system&#160;automatically&#160;searches.&#160;The&#160;list&#160;of&#160;directories&#160;is&#160;held&#160;within&#160;an&#160;environ-<br/>ment&#160;variable&#160;named&#160;PATH.&#160;The&#160;PATH&#160;variable&#160;contains&#160;a&#160;colon-separated&#160;list&#160;of directo-<br/>ries&#160;to be&#160;searched.&#160;We&#160;can&#160;view&#160;the&#160;contents&#160;of&#160;PATH.<br/>
366<br/>
<hr/>
<a name=391></a>Script&#160;File&#160;Location<br/>
[me@linuxbox ~]$&#160;<b>echo $PATH</b>&#160;<br/>/home/me/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:<br/>/bin:/usr/games<br/>
Here&#160;we&#160;see&#160;our&#160;list&#160;of&#160;directories.&#160;If&#160;our&#160;script&#160;were&#160;located&#160;in&#160;any&#160;of&#160;the&#160;directories&#160;in<br/>the&#160;list,&#160;our&#160;problem&#160;would&#160;be&#160;solved.&#160;Notice&#160;the&#160;first&#160;directory&#160;in&#160;the&#160;list,&#160;/home/me/<br/>bin.&#160;Most&#160;Linux&#160;distributions&#160;configure&#160;the&#160;PATH&#160;variable&#160;to&#160;contain&#160;a&#160;bin&#160;directory&#160;in<br/>the&#160;user’s&#160;home&#160;directory&#160;to&#160;allow&#160;users&#160;to&#160;execute&#160;their&#160;own&#160;programs.&#160;So,&#160;if&#160;we&#160;create<br/>the&#160;&#160;bin&#160;directory&#160;and&#160;place&#160;our&#160;script&#160;within&#160;it,&#160;it&#160;should&#160;start&#160;to&#160;work&#160;like&#160;other&#160;pro-<br/>grams.<br/>
[me@linuxbox ~]$&#160;<b>mkdir bin<br/></b>[me@linuxbox ~]$&#160;<b>mv hello_world bin<br/></b>[me@linuxbox ~]$&#160;<b>hello_world<br/></b>Hello World!<br/>
And so it&#160;does.<br/>If&#160;the&#160;PATH&#160;variable&#160;does&#160;not&#160;contain&#160;the&#160;directory,&#160;we&#160;can&#160;easily&#160;add&#160;it&#160;by&#160;including&#160;this<br/>line&#160;in our&#160;.bashrc&#160;file:<br/>
<b>export PATH=~/bin:&#34;$PATH&#34;</b><br/>
After&#160;this&#160;change&#160;is&#160;made,&#160;it&#160;will&#160;take&#160;effect&#160;in&#160;each&#160;new&#160;terminal&#160;session.&#160;To&#160;apply&#160;the<br/>change&#160;to&#160;the&#160;current&#160;terminal&#160;session,&#160;we&#160;must&#160;have&#160;the&#160;shell&#160;re-read&#160;the&#160;.bashrc&#160;file.<br/>This&#160;can&#160;be&#160;done&#160;by “sourcing”&#160;it.<br/>
[me@linuxbox ~]$&#160;<b>. .bashrc</b><br/>
The&#160;dot&#160;(.) command&#160;is&#160;a&#160;synonym&#160;for the&#160;source&#160;command, a&#160;shell&#160;builtin&#160;that&#160;reads&#160;a<br/>specified&#160;file&#160;of shell&#160;commands&#160;and treats&#160;it&#160;like&#160;input&#160;from&#160;the&#160;keyboard.<br/>
<b>Note:</b>&#160;&#160;Ubuntu&#160;&#160;(and&#160;most&#160;other&#160;Debian-based&#160;distributions)&#160;automatically&#160;adds<br/>the&#160;&#160;~/bin&#160;directory&#160;to&#160;the&#160;PATH&#160;variable&#160;if&#160;the&#160;~/bin&#160;directory&#160;exists&#160;when<br/>the&#160;user’s&#160;.bashrc&#160;file&#160;is&#160;executed.&#160;So,&#160;on&#160;Ubuntu&#160;systems,&#160;if&#160;we&#160;create&#160;the&#160;~/<br/>bin&#160;directory and&#160;then log&#160;out&#160;and log&#160;in again,&#160;everything&#160;works.&#160;<br/>
367<br/>
<hr/>
<a name=392></a>24 –&#160;Writing&#160;Your First&#160;Script<br/>
Good&#160;Locations&#160;for&#160;Scripts<br/>The&#160;~/bin&#160;directory&#160;is&#160;a&#160;good&#160;place&#160;to&#160;put&#160;scripts&#160;intended&#160;for&#160;personal&#160;use.&#160;If&#160;we&#160;write<br/>a&#160;script&#160;that&#160;everyone&#160;on&#160;a&#160;system&#160;is&#160;allowed&#160;to&#160;use,&#160;the&#160;traditional&#160;location&#160;is&#160;&#160;/usr/<br/>local/bin.&#160;Scripts&#160;intended&#160;for&#160;use&#160;by&#160;the&#160;system&#160;administrator&#160;are&#160;often&#160;located&#160;in&#160;/<br/>usr/local/sbin.&#160;In&#160;most&#160;cases,&#160;locally&#160;supplied&#160;software,&#160;whether&#160;scripts&#160;or&#160;com-<br/>piled&#160;programs,&#160;should&#160;be&#160;placed&#160;in&#160;the&#160;/usr/local&#160;hierarchy&#160;and&#160;not&#160;in&#160;/bin&#160;or&#160;/<br/>usr/bin.&#160;These&#160;directories&#160;are&#160;specified&#160;by&#160;the&#160;Linux&#160;Filesystem&#160;Hierarchy&#160;Standard<br/>to contain only&#160;files&#160;supplied&#160;and maintained by the&#160;Linux distributor.<br/>
<b>More&#160;Formatting&#160;Tricks<br/></b>One&#160;of&#160;the&#160;key&#160;goals&#160;of&#160;serious&#160;script&#160;writing&#160;is&#160;ease&#160;of&#160;&#160;<i>maintenance</i>,&#160;&#160;that&#160;is,&#160;the&#160;ease<br/>with&#160;which&#160;a&#160;script&#160;may&#160;be&#160;modified&#160;by&#160;its&#160;author&#160;or&#160;others&#160;to&#160;adapt&#160;it&#160;to&#160;changing&#160;needs.<br/>Making a&#160;script&#160;easy to read&#160;and understand&#160;is&#160;one&#160;way to facilitate&#160;easy maintenance.<br/>
Long&#160;Option&#160;Names<br/>Many&#160;of&#160;the&#160;commands&#160;we&#160;have&#160;studied&#160;feature&#160;both&#160;short&#160;and&#160;long&#160;option&#160;names.&#160;For<br/>instance,&#160;the&#160;ls&#160;command&#160;has&#160;many&#160;options&#160;that&#160;can&#160;be&#160;expressed&#160;in&#160;either&#160;short&#160;or&#160;long<br/>form. For example, the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>ls -ad</b><br/>
is&#160;equivalent&#160;to this:<br/>
[me@linuxbox ~]$&#160;<b>ls --all --directory</b>&#160;<br/>
In&#160;the&#160;interests&#160;of&#160;reduced&#160;typing,&#160;short&#160;options&#160;are&#160;preferred&#160;when&#160;entering&#160;options&#160;on<br/>the&#160;command&#160;line,&#160;but&#160;when&#160;writing&#160;scripts,&#160;long&#160;options&#160;can&#160;provide&#160;improved&#160;readabil-<br/>ity.<br/>
Indentation&#160;and&#160;Line-Continuation<br/>When&#160;employing&#160;long&#160;commands,&#160;readability&#160;can&#160;be&#160;enhanced&#160;by&#160;spreading&#160;the&#160;com-<br/>mand&#160;over&#160;several&#160;lines.&#160;In&#160;Chapter&#160;17,&#160;we&#160;looked&#160;at&#160;a&#160;particularly&#160;long&#160;example&#160;of&#160;the<br/>find&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>find playground \( -type f -not -perm 0600 -exec</b><br/>
368<br/>
<hr/>
<a name=393></a>More&#160;Formatting&#160;Tricks<br/>
<b>chmod 0600 ‘{}’ ‘;’ \) -or \( -type d -not -perm 0700 -exec chmod&#160;<br/>0700 ‘{}’ ‘;’ \)&#160;</b><br/>
Obviously,&#160;this&#160;command&#160;is&#160;a&#160;little&#160;hard&#160;to&#160;figure&#160;out&#160;at&#160;first&#160;glance.&#160;In&#160;a&#160;script,&#160;this&#160;com-<br/>mand might&#160;be&#160;easier to&#160;understand if&#160;written this&#160;way:<br/>
find playground \<br/>
\( \<br/>
-type f \<br/>-not -perm 0600 \<br/>-exec chmod 0600 ‘{}’ ‘;’ \<br/>
\) \<br/>-or \<br/>\( \<br/>
-type d \<br/>-not -perm 0700 \<br/>-exec chmod 0700 ‘{}’ ‘;’ \<br/>
\)<br/>
By&#160;using&#160;line&#160;continuations&#160;(backslash-linefeed&#160;sequences)&#160;and&#160;indentation,&#160;the&#160;logic&#160;of<br/>this&#160;complex&#160;command&#160;is&#160;more&#160;clearly&#160;described&#160;to&#160;the&#160;reader.&#160;This&#160;technique&#160;works&#160;on<br/>the&#160;command&#160;line,&#160;too,&#160;though&#160;it&#160;is&#160;seldom&#160;used,&#160;as&#160;it&#160;is&#160;awkward&#160;to&#160;type&#160;and&#160;edit.&#160;One<br/>difference&#160;between&#160;a&#160;script&#160;and&#160;a&#160;command&#160;line&#160;is&#160;that&#160;the&#160;script&#160;may&#160;employ&#160;tab&#160;charac-<br/>ters&#160;to&#160;achieve&#160;indentation,&#160;whereas&#160;the&#160;command&#160;line&#160;cannot&#160;since&#160;tabs&#160;are&#160;used&#160;to&#160;acti-<br/>vate&#160;completion.<br/>
<b>Configuring&#160;vim&#160;For&#160;Script&#160;Writing</b><br/>
The&#160;&#160;vim&#160;&#160;text&#160;editor&#160;has&#160;many,&#160;many&#160;configuration&#160;settings.&#160;There&#160;are&#160;several<br/>common&#160;options&#160;that&#160;can facilitate&#160;script&#160;writing.<br/>The&#160;following turns&#160;on&#160;syntax&#160;highlighting:<br/><b>:syntax on<br/></b>With&#160;this&#160;setting,&#160;different&#160;elements&#160;of&#160;shell&#160;syntax&#160;will&#160;be&#160;displayed&#160;in&#160;different<br/>colors&#160;when&#160;viewing&#160;a&#160;script.&#160;This&#160;is&#160;helpful&#160;for&#160;identifying&#160;certain&#160;kinds&#160;of&#160;pro-<br/>gramming&#160;errors.&#160;It&#160;looks&#160;cool,&#160;too.&#160;Note&#160;that&#160;for&#160;this&#160;feature&#160;to&#160;work,&#160;you&#160;must<br/>have&#160;a&#160;complete&#160;version&#160;of&#160;vim&#160;installed,&#160;and&#160;the&#160;file&#160;you&#160;are&#160;editing&#160;must&#160;have&#160;a<br/>
369<br/>
<hr/>
<a name=394></a>24 –&#160;Writing&#160;Your First&#160;Script<br/>
shebang&#160;indicating&#160;the&#160;file&#160;is&#160;a&#160;shell&#160;script.&#160;If&#160;you&#160;have&#160;difficulty&#160;with&#160;the&#160;previ-<br/>ous&#160;command,&#160;try&#160;<b>:set syntax=sh</b>&#160;instead.&#160;<br/>The&#160;following turns&#160;on the&#160;option to&#160;highlight&#160;search results.<br/><b>:set hlsearch<br/></b>Say&#160;we&#160;search&#160;for&#160;the&#160;word&#160;echo.&#160;With&#160;this&#160;option&#160;on,&#160;each&#160;instance&#160;of&#160;the&#160;word<br/>will&#160;be&#160;highlighted.<br/>The&#160;following sets&#160;the&#160;number of columns&#160;occupied&#160;by a&#160;tab&#160;character.:<br/><b>:set tabstop=4<br/></b>The&#160;default&#160;is&#160;eight&#160;columns.&#160;Setting&#160;the&#160;value&#160;to&#160;4&#160;(which&#160;is&#160;a&#160;common&#160;practice)<br/>allows&#160;long lines&#160;to fit&#160;more&#160;easily on the&#160;screen.<br/>The&#160;following turns&#160;on the&#160;“auto indent”&#160;feature:<br/><b>:set autoindent<br/></b>This&#160;causes&#160;vim&#160;to&#160;indent&#160;a&#160;new&#160;line&#160;the&#160;same&#160;amount&#160;as&#160;the&#160;line&#160;just&#160;typed.&#160;This<br/>speeds&#160;up&#160;typing&#160;on&#160;many&#160;kinds&#160;of&#160;programming&#160;constructs.&#160;To&#160;stop&#160;indentation,<br/>press&#160;Ctrl-d.<br/>These&#160;changes&#160;can&#160;be&#160;made&#160;permanent&#160;by&#160;adding&#160;these&#160;commands&#160;(without&#160;the<br/>leading&#160;colon&#160;characters) to your&#160;~/.vimrc&#160;file.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;first&#160;chapter&#160;of&#160;scripting,&#160;we&#160;looked&#160;at&#160;how&#160;scripts&#160;are&#160;written&#160;and&#160;made&#160;to&#160;easily<br/>execute&#160;on&#160;our&#160;system.&#160;We&#160;also&#160;saw&#160;how&#160;we&#160;can&#160;use&#160;various&#160;formatting&#160;techniques&#160;to&#160;im-<br/>prove&#160;the&#160;readability&#160;(and&#160;thus&#160;the&#160;maintainability)&#160;of&#160;our&#160;scripts.&#160;In&#160;future&#160;chapters,&#160;ease<br/>of maintenance&#160;will&#160;come&#160;up again and&#160;again as&#160;a&#160;central&#160;principle&#160;in good script&#160;writing.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
For “Hello&#160;World”&#160;programs&#160;and examples&#160;in various&#160;programming&#160;languages,&#160;<br/>see:&#160;<br/><a href="http://en.wikipedia.org/wiki/Hello_world">http://en.wikipedia.org/wiki/Hello_world</a><br/>
●<br/>
This&#160;Wikipedia&#160;article&#160;talks&#160;more&#160;about&#160;the&#160;shebang&#160;mechanism:<br/><a href="http://en.wikipedia.org/wiki/Shebang_(Unix)">http://en.wikipedia.org/wiki/Shebang_(Unix)</a><br/>
370<br/>
<hr/>
<a name=395></a>25 – Starting a&#160;Project<br/>
<i><b>25&#160;–&#160;Starting&#160;a&#160;Project</b></i><br/>
Starting&#160;with&#160;this&#160;chapter,&#160;we&#160;will&#160;begin&#160;to&#160;build&#160;a&#160;program.&#160;The&#160;purpose&#160;of&#160;this&#160;project&#160;is<br/>to&#160;see&#160;how&#160;various&#160;shell&#160;features&#160;are&#160;used&#160;to&#160;create&#160;programs&#160;and,&#160;more&#160;importantly,&#160;cre-<br/>ate&#160;<i>good</i>&#160;programs.&#160;<br/>The&#160;program&#160;we&#160;will&#160;write&#160;is&#160;a&#160;<i>report&#160;generator</i>.&#160;It&#160;will&#160;present&#160;various&#160;statistics&#160;about<br/>our&#160;system&#160;and&#160;its&#160;status&#160;and&#160;will&#160;produce&#160;this&#160;report&#160;in&#160;HTML&#160;format,&#160;so&#160;we&#160;can&#160;view&#160;it<br/>with a&#160;web browser such as&#160;Firefox&#160;or&#160;Chrome.<br/>Programs&#160;are&#160;usually&#160;built&#160;up&#160;in&#160;a&#160;series&#160;of&#160;stages,&#160;with&#160;each&#160;stage&#160;adding&#160;features&#160;and<br/>capabilities.&#160;The&#160;first&#160;stage&#160;of&#160;our&#160;program&#160;will&#160;produce&#160;a&#160;minimal&#160;HTML&#160;document&#160;that<br/>contains&#160;no system&#160;information.&#160;That&#160;will&#160;come&#160;later.<br/>
<b>First&#160;Stage:&#160;Minimal&#160;Document<br/></b>The&#160;first&#160;thing&#160;we&#160;need&#160;to&#160;know&#160;is&#160;the&#160;format&#160;of&#160;a&#160;well-formed&#160;HTML&#160;document.&#160;It&#160;looks<br/>like&#160;this:<br/>
&lt;html&gt;<br/>
&lt;head&gt;<br/>
&lt;title&gt;Page Title&lt;/title&gt;<br/>
&lt;/head&gt;<br/>&lt;body&gt;<br/>
Page body.<br/>
&lt;/body&gt;<br/>
&lt;/html&gt;<br/>
If&#160;we&#160;enter&#160;this&#160;into&#160;our&#160;text&#160;editor&#160;and&#160;save&#160;the&#160;file&#160;as&#160;foo.html,&#160;we&#160;can&#160;use&#160;the&#160;fol-<br/>lowing URL&#160;in Firefox to&#160;view&#160;the&#160;file:<br/>file:///home/<i>username</i>/foo.html<br/>The&#160;first&#160;stage&#160;of&#160;our&#160;program&#160;will&#160;be&#160;able&#160;to&#160;output&#160;this&#160;HTML&#160;file&#160;to&#160;standard&#160;output.<br/>We&#160;can write&#160;a&#160;program&#160;to do this&#160;pretty easily. Let’s&#160;start&#160;our text&#160;editor&#160;and create&#160;a&#160;new<br/>file&#160;named&#160;~/bin/sys_info_page.<br/>
371<br/>
<hr/>
<a name=396></a>25 – Starting&#160;a&#160;Project<br/>
[me@linuxbox ~]$&#160;<b>vim ~/bin/sys_info_page</b><br/>
Enter&#160;the&#160;following&#160;program:<br/>
<b>#!/bin/bash&#160;</b><br/>
<b># Program to output a system information page&#160;</b><br/>
<b>echo &#34;&lt;html&gt;&#34;&#160;<br/>echo &#34;</b><br/>
<b>&lt;head&gt;&#34;&#160;</b><br/>
<b>echo &#34;</b><br/>
<b>&lt;title&gt;Page Title&lt;/title&gt;&#34;&#160;</b><br/>
<b>echo &#34;</b><br/>
<b>&lt;/head&gt;&#34;&#160;</b><br/>
<b>echo &#34;</b><br/>
<b>&lt;body&gt;&#34;&#160;</b><br/>
<b>echo &#34;</b><br/>
<b>Page body.&#34;&#160;</b><br/>
<b>echo &#34;</b><br/>
<b>&lt;/body&gt;&#34;&#160;</b><br/>
<b>echo &#34;&lt;/html&gt;&#34;</b><br/>
Our&#160;first&#160;attempt&#160;at&#160;this&#160;problem&#160;contains&#160;a&#160;shebang,&#160;a&#160;comment&#160;(always&#160;a&#160;good&#160;idea),<br/>and&#160;a&#160;sequence&#160;of&#160;&#160;echo&#160;&#160;commands,&#160;one&#160;for&#160;each&#160;line&#160;of&#160;output.&#160;After&#160;saving&#160;the&#160;file,<br/>we’ll&#160;make&#160;it&#160;executable&#160;and attempt&#160;to run it.<br/>
[me@linuxbox ~]$&#160;<b>chmod 755 ~/bin/sys_info_page<br/></b>[me@linuxbox ~]$&#160;<b>sys_info_page</b><br/>
When&#160;the&#160;program&#160;runs,&#160;we&#160;should&#160;see&#160;the&#160;text&#160;of&#160;the&#160;HTML&#160;document&#160;displayed&#160;on&#160;the<br/>screen,&#160;since&#160;the&#160;echo&#160;commands&#160;in the&#160;script&#160;send their&#160;output&#160;to standard&#160;output.&#160;We’ll<br/>run&#160;&#160;&#160;the&#160;&#160;&#160;program&#160;&#160;&#160;again&#160;&#160;&#160;and&#160;&#160;&#160;redirect&#160;&#160;&#160;the&#160;&#160;&#160;output&#160;&#160;&#160;of&#160;&#160;&#160;the&#160;&#160;&#160;program&#160;&#160;&#160;to&#160;&#160;&#160;the&#160;&#160;&#160;file<br/>sys_info_page.html&#160;so that&#160;we&#160;can&#160;view&#160;the&#160;result&#160;with&#160;a&#160;web browser.<br/>
[me@linuxbox ~]$&#160;<b>sys_info_page &gt; sys_info_page.html<br/></b>[me@linuxbox ~]$<b>&#160;firefox sys_info_page.html</b><br/>
So far, so good.<br/>When&#160;writing&#160;programs,&#160;it’s&#160;always&#160;a&#160;good&#160;idea&#160;to&#160;strive&#160;for&#160;simplicity&#160;and&#160;clarity.&#160;Main-<br/>tenance&#160;is&#160;easier&#160;when&#160;a&#160;program&#160;is&#160;easy&#160;to&#160;read&#160;and&#160;understand,&#160;not&#160;to&#160;mention&#160;that&#160;it<br/>can&#160;make&#160;the&#160;program&#160;easier&#160;to&#160;write&#160;by&#160;reducing&#160;the&#160;amount&#160;of&#160;typing.&#160;Our&#160;current&#160;ver-<br/>sion of&#160;the&#160;program&#160;works&#160;fine,&#160;but&#160;it&#160;could&#160;be&#160;simpler.&#160;We&#160;could&#160;actually&#160;combine&#160;all&#160;the<br/>echo&#160;commands&#160;into&#160;one,&#160;which&#160;will&#160;certainly&#160;make&#160;it&#160;easier&#160;to&#160;add&#160;more&#160;lines&#160;to&#160;the&#160;pro-<br/>
372<br/>
<hr/>
<a name=397></a>First&#160;Stage:&#160;Minimal&#160;Document<br/>
gram’s&#160;output. So, let’s&#160;change&#160;our program&#160;to this:<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
<b>echo &#34;&lt;html&gt;&#160;</b><br/>
<b>&lt;head&gt;&#160;</b><br/>
<b>&lt;title&gt;Page Title&lt;/title&gt;&#160;</b><br/>
<b>&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;</b><br/>
<b>Page body.&#160;</b><br/>
<b>&lt;/body&gt;&#160;</b><br/>
<b>&lt;/html&gt;&#34;</b><br/>
A&#160;quoted&#160;string&#160;may&#160;include&#160;newlines,&#160;and&#160;therefore&#160;contain&#160;multiple&#160;lines&#160;of&#160;text.&#160;The<br/>shell&#160;will&#160;keep&#160;reading&#160;the&#160;text&#160;until&#160;it&#160;encounters&#160;the&#160;closing&#160;quotation&#160;mark.&#160;It&#160;works<br/>this&#160;way on the&#160;command&#160;line,&#160;too:&#160;<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;&lt;html&gt;&#160;<br/></b>&gt; &#160; &#160; &#160; &#160;&#160;<b>&lt;head&gt;</b>&#160;<br/>&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;<b>&lt;title&gt;Page Title&lt;/title&gt;</b>&#160;<br/>&gt; &#160; &#160; &#160; &#160;&#160;<b>&lt;/head&gt;&#160;<br/></b>&gt; &#160; &#160; &#160; &#160;&#160;<b>&lt;body&gt;&#160;<br/></b>&gt; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;<b>Page body.</b>&#160;<br/>&gt; &#160; &#160; &#160; &#160;&#160;<b>&lt;/body&gt;&#160;<br/></b>&gt;&#160;<b>&lt;/html&gt;&#34;</b><br/>
The&#160;leading&#160;“&gt;”&#160;character&#160;is&#160;the&#160;shell&#160;prompt&#160;contained&#160;in&#160;the&#160;PS2&#160;shell&#160;variable.&#160;It&#160;ap-<br/>pears&#160;whenever&#160;we&#160;type&#160;a&#160;multiline&#160;statement&#160;into&#160;the&#160;shell.&#160;This&#160;feature&#160;is&#160;a&#160;little&#160;ob-<br/>scure&#160;right&#160;now,&#160;but&#160;later,&#160;when&#160;we&#160;cover&#160;multiline&#160;programming&#160;statements,&#160;it&#160;will&#160;turn<br/>out&#160;to be&#160;quite&#160;handy.<br/>
<b>Second&#160;Stage:&#160;Adding&#160;a&#160;Little&#160;Data<br/></b>Now&#160;that&#160;our&#160;program&#160;can&#160;generate&#160;a&#160;minimal&#160;document,&#160;let’s&#160;put&#160;some&#160;data&#160;in&#160;the&#160;re-<br/>port.&#160;To do this, we&#160;will&#160;make&#160;the&#160;following&#160;changes:<br/>
#!/bin/bash&#160;<br/>
373<br/>
<hr/>
<a name=398></a>25 – Starting&#160;a&#160;Project<br/>
# Program to output a system information page&#160;<br/>
echo &#34;&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;<b>System Information Report</b>&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;<b>System Information Report</b>&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#34;<br/>
We&#160;added a&#160;page&#160;title&#160;and a&#160;heading&#160;to the&#160;body of the&#160;report.<br/>
<b>Variables&#160;and&#160;Constants<br/></b>There&#160;is&#160;an&#160;issue&#160;with&#160;our&#160;script,&#160;however.&#160;Notice&#160;how&#160;the&#160;string&#160;“System&#160;Information<br/>Report”&#160;is&#160;repeated?&#160;With&#160;our&#160;tiny&#160;script&#160;it’s&#160;not&#160;a&#160;problem,&#160;but&#160;let’s&#160;imagine&#160;that&#160;our<br/>script&#160;was&#160;really&#160;long&#160;and&#160;we&#160;had&#160;multiple&#160;instances&#160;of&#160;this&#160;string.&#160;If&#160;we&#160;wanted&#160;to<br/>change&#160;the&#160;title&#160;to&#160;something&#160;else,&#160;we&#160;would&#160;have&#160;to&#160;change&#160;it&#160;in&#160;multiple&#160;places,&#160;which<br/>could&#160;be&#160;a&#160;lot&#160;of&#160;work.&#160;What&#160;if&#160;we&#160;could&#160;arrange&#160;the&#160;script&#160;so&#160;that&#160;the&#160;string&#160;appeared<br/>only&#160;once&#160;and&#160;not&#160;multiple&#160;times?&#160;That&#160;would&#160;make&#160;future&#160;&#160;maintenance&#160;&#160;of&#160;the&#160;script<br/>much easier. Here’s&#160;how&#160;we&#160;could&#160;do that:<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
<b>title=&#34;System Information Report&#34;&#160;</b><br/>
echo &#34;&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;<b>$title</b>&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;<b>$title</b>&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#34;<br/>
By&#160;creating&#160;a&#160;<i>variable</i>&#160;named&#160;title&#160;and&#160;assigning&#160;it&#160;the&#160;value&#160;System&#160;Informa-<br/>tion&#160;Report,&#160;we&#160;can&#160;take&#160;advantage&#160;of&#160;parameter&#160;expansion&#160;and&#160;place&#160;the&#160;string&#160;in<br/>multiple&#160;locations.<br/>
374<br/>
<hr/>
<a name=399></a>Variables&#160;and Constants<br/>
So, how&#160;do&#160;we&#160;create&#160;a&#160;variable?&#160;Simple,&#160;we&#160;just&#160;use&#160;it.&#160;When&#160;the&#160;shell&#160;encounters&#160;a&#160;vari-<br/>able,&#160;it&#160;automatically&#160;creates&#160;it.&#160;This&#160;differs&#160;from&#160;many&#160;programming&#160;languages&#160;in&#160;which<br/>variables&#160;must&#160;be&#160;explicitly&#160;<i>declared</i>&#160;or&#160;defined&#160;before&#160;use.&#160;The&#160;shell&#160;is&#160;very&#160;lax&#160;about<br/>this,&#160;which&#160;can&#160;lead&#160;to&#160;some&#160;problems.&#160;For&#160;example,&#160;consider&#160;this&#160;scenario&#160;played&#160;out&#160;on<br/>the&#160;command&#160;line:<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;yes&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>yes<br/>[me@linuxbox ~]$&#160;<b>echo $fool</b><br/>
[me@linuxbox ~]$&#160;<br/>
We&#160;first&#160;assign&#160;the&#160;value&#160;&#160;yes&#160;&#160;to&#160;the&#160;variable&#160;&#160;foo,&#160;and&#160;then&#160;we&#160;display&#160;its&#160;value&#160;with<br/>echo.&#160;Next&#160;we&#160;display&#160;the&#160;value&#160;of&#160;the&#160;variable&#160;name&#160;misspelled&#160;as&#160;&#160;fool&#160;&#160;and&#160;get&#160;a<br/>blank&#160;result.&#160;This&#160;is&#160;because&#160;the&#160;shell&#160;happily&#160;created&#160;the&#160;variable&#160;fool&#160;when&#160;it&#160;encoun-<br/>tered&#160;it&#160;and&#160;gave&#160;it&#160;the&#160;default&#160;value&#160;of&#160;nothing,&#160;or&#160;empty.&#160;From&#160;this,&#160;we&#160;learn&#160;that&#160;we<br/>must&#160;pay close&#160;attention&#160;to our spelling!&#160;It’s&#160;also&#160;important&#160;to understand&#160;what&#160;really hap-<br/>pened&#160;in&#160;this&#160;example.&#160;From&#160;our&#160;previous&#160;look&#160;at&#160;how&#160;the&#160;shell&#160;performs&#160;expansions,&#160;we<br/>know&#160;that&#160;the&#160;following&#160;command:<br/>
[me@linuxbox ~]$ echo $foo<br/>
undergoes&#160;parameter expansion&#160;and results&#160;in&#160;the&#160;following:<br/>
[me@linuxbox ~]$ echo yes<br/>
By contrast,&#160;the&#160;following&#160;command:<br/>
[me@linuxbox ~]$ echo $fool<br/>
expands&#160;into&#160;this:<br/>
[me@linuxbox ~]$ echo<br/>
The&#160;empty&#160;variable&#160;expands&#160;into&#160;nothing!&#160;This&#160;can&#160;play&#160;havoc&#160;with&#160;commands&#160;that&#160;re-<br/>quire&#160;arguments. Here’s&#160;an example:<br/>
375<br/>
<hr/>
<a name=400></a>25 – Starting&#160;a&#160;Project<br/>
[me@linuxbox ~]$&#160;<b>foo=foo.txt<br/></b>[me@linuxbox ~]$&#160;<b>foo1=foo1.txt<br/></b>[me@linuxbox ~]$&#160;<b>cp $foo $fool<br/></b>cp: missing destination file operand after `foo.txt'&#160;<br/>Try `cp --help' for more information.<br/>
We&#160;assign&#160;values&#160;to&#160;two&#160;variables,&#160;foo&#160;and&#160;foo1.&#160;We&#160;then&#160;perform&#160;a&#160;cp&#160;but&#160;misspell<br/>the&#160;name&#160;of&#160;the&#160;second&#160;argument.&#160;After&#160;expansion,&#160;the&#160;cp&#160;command&#160;is&#160;sent&#160;only&#160;one&#160;ar-<br/>gument,&#160;though it&#160;requires&#160;two.<br/>There&#160;are&#160;some&#160;rules&#160;about&#160;variable&#160;names:<br/>
1.&#160;Variable&#160;names&#160;may&#160;consist&#160;of&#160;alphanumeric&#160;characters&#160;(letters&#160;and&#160;numbers)&#160;and<br/>
underscore&#160;characters.<br/>
2.&#160;The&#160;first&#160;character of a&#160;variable&#160;name&#160;must&#160;be&#160;either&#160;a&#160;letter or an&#160;underscore.<br/>3.&#160;Spaces&#160;and punctuation&#160;symbols&#160;are&#160;not&#160;allowed.<br/>
The&#160;word&#160;“variable”&#160;implies&#160;a&#160;value&#160;that&#160;changes,&#160;and&#160;in&#160;many&#160;applications,&#160;variables&#160;are<br/>used&#160;this&#160;way.&#160;However,&#160;the&#160;variable&#160;in&#160;our&#160;application,&#160;title,&#160;is&#160;used&#160;as&#160;a&#160;<i>constant</i>.&#160;A<br/>constant&#160;is&#160;just&#160;like&#160;a&#160;variable&#160;in&#160;that&#160;it&#160;has&#160;a&#160;name&#160;and&#160;contains&#160;a&#160;value.&#160;The&#160;difference&#160;is<br/>that&#160;the&#160;value&#160;of&#160;a&#160;constant&#160;does&#160;not&#160;change.&#160;In&#160;an&#160;application&#160;that&#160;performs&#160;geometric<br/>calculations, we&#160;might&#160;define&#160;PI&#160;as&#160;a&#160;constant&#160;and&#160;assign it&#160;the&#160;value&#160;of&#160;3.1415, instead<br/>of&#160;using&#160;the&#160;number&#160;literally&#160;throughout&#160;our&#160;program.&#160;The&#160;shell&#160;makes&#160;no&#160;distinction&#160;be-<br/>tween&#160;variables&#160;and&#160;constants;&#160;they&#160;are&#160;mostly&#160;for&#160;the&#160;programmer’s&#160;convenience.&#160;A<br/>common&#160;convention&#160;is&#160;to&#160;use&#160;uppercase&#160;letters&#160;to&#160;designate&#160;constants&#160;and&#160;lowercase&#160;let-<br/>ters&#160;for true&#160;variables.&#160;We&#160;will&#160;modify&#160;our script&#160;to&#160;comply&#160;with this&#160;convention:&#160;<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
<b>TITLE</b>=&#34;System Information Report&#160;<b>For $HOSTNAME</b>&#34;&#160;<br/>
echo &#34;&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;$<b>TITLE</b>&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;$<b>TITLE</b>&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#34;<br/>
376<br/>
<hr/>
<a name=401></a>Variables&#160;and Constants<br/>
We&#160;also&#160;took&#160;the&#160;opportunity&#160;to&#160;jazz&#160;up&#160;our&#160;title&#160;by&#160;adding&#160;the&#160;value&#160;of&#160;the&#160;shell&#160;variable<br/>HOSTNAME.&#160;This&#160;is&#160;the&#160;network name&#160;of the&#160;machine.<br/>
<b>Note</b>:&#160;The&#160;shell&#160;actually&#160;does&#160;provide&#160;a&#160;way&#160;to&#160;enforce&#160;the&#160;immutability&#160;of&#160;con-<br/>stants,&#160;through&#160;the&#160;use&#160;of&#160;the&#160;&#160;declare&#160;&#160;builtin&#160;command&#160;with&#160;the&#160;&#160;-r&#160;&#160;(read-<br/>only)&#160;option. Had we&#160;assigned&#160;TITLE&#160;this&#160;way:<br/>
declare -r TITLE=&#34;Page Title&#34;<br/>
the&#160;shell&#160;would&#160;prevent&#160;any&#160;subsequent&#160;assignment&#160;to&#160;&#160;TITLE.&#160;This&#160;feature&#160;is<br/>rarely used, but&#160;it&#160;exists&#160;for very&#160;formal&#160;scripts.<br/>
Assigning&#160;Values&#160;to&#160;Variables&#160;and&#160;Constants<br/>Here&#160;is&#160;where&#160;our&#160;knowledge&#160;of&#160;expansion&#160;really&#160;starts&#160;to&#160;pay&#160;off.&#160;As&#160;we&#160;have&#160;seen,&#160;vari-<br/>ables&#160;are&#160;assigned&#160;values&#160;this&#160;way:<br/><i>variable</i>=<i>value<br/></i>where&#160;<i>variable</i>&#160;is&#160;the&#160;name&#160;of&#160;the&#160;variable&#160;and&#160;<i>value</i>&#160;is&#160;a&#160;string.&#160;Unlike&#160;some&#160;other&#160;pro-<br/>gramming&#160;languages,&#160;the&#160;shell&#160;does&#160;not&#160;care&#160;about&#160;the&#160;type&#160;of&#160;data&#160;assigned&#160;to&#160;a&#160;variable;<br/>it&#160;treats&#160;them&#160;all&#160;as&#160;strings.&#160;You&#160;can&#160;force&#160;the&#160;shell&#160;to&#160;restrict&#160;the&#160;assignment&#160;to&#160;integers<br/>by&#160;using&#160;the&#160;declare&#160;command&#160;with&#160;the&#160;-i&#160;option,&#160;but,&#160;like&#160;setting&#160;variables&#160;as&#160;read-<br/>only, this&#160;is&#160;rarely done.<br/>Note&#160;that&#160;in&#160;an&#160;assignment,&#160;there&#160;must&#160;be&#160;no&#160;spaces&#160;between&#160;the&#160;variable&#160;name,&#160;the&#160;equal<br/>sign,&#160;and&#160;the&#160;value.&#160;So&#160;what&#160;can&#160;the&#160;value&#160;consist&#160;of?&#160;I&#160;can&#160;have&#160;anything&#160;that&#160;we&#160;can&#160;ex-<br/>pand into&#160;a&#160;string.<br/>
a=z<br/>
# Assign the string &#34;z&#34; to variable a.&#160;<br/>
b=&#34;a string&#34;<br/>
# Embedded spaces must be within quotes.&#160;<br/>
c=&#34;a string and $b&#34;<br/>
# Other expansions such as variables can be &#160;<br/># expanded into the assignment.&#160;<br/>
d=&#34;$(ls -l foo.txt)&#34;<br/>
# Results of a command.&#160;<br/>
e=$((5 * 7))<br/>
#&#160;Arithmetic expansion.<br/>
f=&#34;\t\ta string\n&#34;<br/>
# Escape sequences such as tabs and newlines.<br/>
Multiple&#160;variable&#160;assignments&#160;may&#160;be&#160;done&#160;on a&#160;single&#160;line.<br/>
a=5 b=&#34;a string&#34;<br/>
377<br/>
<hr/>
<a name=402></a>25 – Starting&#160;a&#160;Project<br/>
During&#160;expansion,&#160;variable&#160;names&#160;may&#160;be&#160;surrounded&#160;by&#160;optional&#160;curly&#160;braces,&#160;{}.&#160;This<br/>is&#160;useful&#160;in&#160;cases&#160;where&#160;a&#160;variable&#160;name&#160;becomes&#160;ambiguous&#160;because&#160;of&#160;its&#160;surrounding<br/>context.&#160;Here,&#160;we&#160;try&#160;to&#160;change&#160;the&#160;name&#160;of&#160;a&#160;file&#160;from&#160;myfile&#160;to&#160;myfile1,&#160;using&#160;a<br/>variable:<br/>
[me@linuxbox ~]$&#160;<b>filename=&#34;myfile&#34;<br/></b>[me@linuxbox ~]$&#160;<b>touch &#34;$filename&#34;<br/></b>[me@linuxbox ~]$&#160;<b>mv &#34;$filename&#34; &#34;$filename1&#34;<br/></b>mv: missing destination file operand after `myfile'&#160;<br/>Try `mv --help' for more information.<br/>
This&#160;attempt&#160;fails&#160;because&#160;the&#160;shell&#160;interprets&#160;the&#160;second&#160;argument&#160;of&#160;the&#160;mv&#160;command&#160;as<br/>a&#160;new&#160;(and empty) variable.&#160;The&#160;problem&#160;can be&#160;overcome&#160;this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>mv &#34;$filename&#34; &#34;${filename}1&#34;</b><br/>
By&#160;adding&#160;the&#160;surrounding&#160;braces,&#160;the&#160;shell&#160;no&#160;longer&#160;interprets&#160;the&#160;trailing&#160;1&#160;as&#160;part&#160;of<br/>the&#160;variable&#160;name.<br/>
<b>Note:</b>&#160;&#160;It's&#160;good&#160;practice&#160;is&#160;to&#160;enclose&#160;variables&#160;and&#160;command&#160;substitutions&#160;in<br/>double&#160;quotes&#160;to&#160;limit&#160;the&#160;effects&#160;of&#160;word-splitting&#160;by&#160;the&#160;shell.&#160;Quoting&#160;is&#160;espe-<br/>cially&#160;important&#160;when a&#160;variable&#160;might&#160;contain a&#160;filename.<br/>
We’ll&#160;take&#160;this&#160;opportunity&#160;to&#160;add&#160;some&#160;data&#160;to&#160;our&#160;report,&#160;namely&#160;the&#160;date&#160;and&#160;time&#160;the<br/>report&#160;was&#160;created and&#160;the&#160;username&#160;of the&#160;creator.<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
TITLE=&#34;System Information Report For $HOSTNAME&#34;&#160;<br/><b>CURRENT_TIME=&#34;$(date +&#34;%x %r %Z&#34;)&#34;</b>&#160;<br/><b>TIMESTAMP=&#34;Generated $CURRENT_TIME, by $USER&#34;</b>&#160;<br/>
echo &#34;&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;$TITLE&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>
378<br/>
<hr/>
<a name=403></a>Variables&#160;and Constants<br/>
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;<b>&lt;p&gt;$TIMESTAMP&lt;/p&gt;&#160;<br/></b>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#34;&#160;<br/>
<b>Here&#160;Documents<br/></b>We’ve&#160;looked&#160;at&#160;two&#160;different&#160;methods&#160;of&#160;outputting&#160;our&#160;text,&#160;both&#160;using&#160;the&#160;echo&#160;com-<br/>mand.&#160;There&#160;is&#160;a&#160;third&#160;way&#160;called&#160;a&#160;<i>here&#160;document</i>&#160;or&#160;<i>here&#160;script</i>.&#160;A&#160;here&#160;document&#160;is&#160;an<br/>additional&#160;form&#160;of&#160;I/O&#160;redirection&#160;in&#160;which&#160;we&#160;embed&#160;a&#160;body&#160;of&#160;text&#160;into&#160;our&#160;script&#160;and<br/>feed it&#160;into&#160;the&#160;standard&#160;input&#160;of a&#160;command.&#160;It&#160;works&#160;like&#160;this:<br/><i>command</i>&#160;&lt;&lt;&#160;<i>token<br/></i>text<br/><i>token<br/></i>where&#160;<i>command</i>&#160;is&#160;the&#160;name&#160;of&#160;command&#160;that&#160;accepts&#160;standard&#160;input&#160;and&#160;<i>token</i>&#160;is&#160;a&#160;string<br/>used&#160;to&#160;indicate&#160;the&#160;end&#160;of&#160;the&#160;embedded&#160;text.&#160;Here&#160;we’ll&#160;modify&#160;our&#160;script&#160;to&#160;use&#160;a&#160;here<br/>document:<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
TITLE=&#34;System Information Report For $HOSTNAME&#34;&#160;<br/>CURRENT_TIME=&#34;$(date +&#34;%x %r %Z&#34;)&#34;&#160;<br/>TIMESTAMP=&#34;Generated $CURRENT_TIME, by $USER&#34;<br/>
<b>cat &lt;&lt; _EOF_&#160;<br/></b>&lt;html&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;$TITLE&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;p&gt;$TIMESTAMP&lt;/p&gt;<br/>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#160;<br/><b>_EOF_</b><br/>
Instead&#160;of&#160;using&#160;echo,&#160;our&#160;script&#160;now&#160;uses&#160;cat&#160;and&#160;a&#160;here&#160;document.&#160;The&#160;string&#160;_EOF_<br/>
379<br/>
<hr/>
<a name=404></a>25 – Starting&#160;a&#160;Project<br/>
(meaning&#160;<i>End&#160;Of&#160;File</i>,&#160;a&#160;common&#160;convention)&#160;was&#160;selected&#160;as&#160;the&#160;token&#160;and&#160;marks&#160;the<br/>end&#160;of&#160;the&#160;embedded&#160;text.&#160;Note&#160;that&#160;the&#160;token&#160;must&#160;appear&#160;alone&#160;and&#160;that&#160;there&#160;must&#160;not<br/>be&#160;trailing&#160;spaces&#160;on the&#160;line.<br/>So,&#160;what’s&#160;the&#160;advantage&#160;of&#160;using&#160;a&#160;here&#160;document?&#160;It’s&#160;mostly&#160;the&#160;same&#160;as&#160;echo,&#160;except<br/>that,&#160;by&#160;default,&#160;single&#160;and&#160;double&#160;quotes&#160;within&#160;here&#160;documents&#160;lose&#160;their&#160;special&#160;mean-<br/>ing to the&#160;shell.&#160;Here&#160;is&#160;a&#160;command line&#160;example:<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;some text&#34;<br/></b>[me@linuxbox ~]$&#160;<b>cat &lt;&lt; _EOF_</b>&#160;<br/>&gt;&#160;<b>$foo</b>&#160;<br/>&gt;&#160;<b>&#34;$foo&#34;</b>&#160;<br/>&gt;&#160;<b>'$foo'</b>&#160;<br/>&gt;&#160;<b>\$foo</b>&#160;<br/>&gt;&#160;<b>_EOF_&#160;<br/></b>some text&#160;<br/>&#34;some text&#34;&#160;<br/>'some text'&#160;<br/>$foo<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;shell&#160;pays&#160;no&#160;attention&#160;to&#160;the&#160;quotation&#160;marks.&#160;It&#160;treats&#160;them&#160;as&#160;ordi-<br/>nary&#160;characters.&#160;This&#160;allows&#160;us&#160;to&#160;embed&#160;quotes&#160;freely&#160;within&#160;a&#160;here&#160;document.&#160;This<br/>could turn&#160;out&#160;to be&#160;handy for our report&#160;program.<br/>Here&#160;documents&#160;can&#160;be&#160;used&#160;with&#160;any&#160;command&#160;that&#160;accepts&#160;standard&#160;input.&#160;In&#160;this&#160;ex-<br/>ample,&#160;we&#160;use&#160;a&#160;here&#160;document&#160;to&#160;pass&#160;a&#160;series&#160;of&#160;commands&#160;to&#160;the&#160;ftp&#160;program&#160;to&#160;re-<br/>trieve&#160;a&#160;file&#160;from&#160;a&#160;remote&#160;FTP&#160;server:<br/>
#!/bin/bash&#160;<br/>
# Script to retrieve a file via FTP&#160;<br/>
FTP_SERVER=ftp.nl.debian.org&#160;<br/>FTP_PATH=/debian/dists/stretch/main/installer-amd64/current/images/<br/>cdrom REMOTE_FILE=debian-cd_info.tar.gz&#160;<br/>
ftp -n &lt;&lt; _EOF_&#160;<br/>open $FTP_SERVER&#160;<br/>user anonymous me@linuxbox&#160;<br/>cd $FTP_PATH&#160;<br/>hash&#160;<br/>get $REMOTE_FILE&#160;<br/>
380<br/>
<hr/>
<a name=405></a>Here&#160;Documents<br/>
bye&#160;<br/>_EOF_<br/>ls -l &#34;$REMOTE_FILE&#34;<br/>
If&#160;we&#160;change&#160;the&#160;redirection&#160;operator&#160;from&#160;&lt;&lt;&#160;to&#160;&lt;&lt;-,&#160;the&#160;shell&#160;will&#160;ignore&#160;leading&#160;tab<br/>characters&#160;(but&#160;not&#160;spaces)&#160;in&#160;the&#160;here&#160;document.&#160;This&#160;allows&#160;a&#160;here&#160;document&#160;to&#160;be&#160;in-<br/>dented,&#160;which&#160;can improve&#160;readability.<br/>
#!/bin/bash&#160;<br/>
# Script to retrieve a file via FTP&#160;<br/>
FTP_SERVER=ftp.nl.debian.org&#160;<br/>FTP_PATH=/debian/dists/stretch/main/installer-amd64/current/images/<br/>cdrom REMOTE_FILE=debian-cd_info.tar.gz&#160;<br/>
ftp -n &lt;&lt;- _EOF_&#160;<br/>
open $FTP_SERVER&#160;<br/>user anonymous me@linuxbox&#160;<br/>cd $FTP_PATH&#160;<br/>hash&#160;<br/>get $REMOTE_FILE&#160;<br/>bye&#160;<br/>_EOF_&#160;<br/>
ls -l &#34;$REMOTE_FILE&#34;<br/>
This&#160;feature&#160;can&#160;be&#160;somewhat&#160;problematic,&#160;because&#160;many&#160;text&#160;editors&#160;(and&#160;programmers<br/>themselves)&#160;&#160;&#160;will&#160;&#160;&#160;prefer&#160;&#160;&#160;to&#160;&#160;&#160;use&#160;&#160;&#160;spaces&#160;&#160;&#160;instead&#160;&#160;&#160;of&#160;&#160;&#160;tabs&#160;&#160;&#160;to&#160;&#160;&#160;achieve&#160;&#160;&#160;indentation&#160;&#160;&#160;in&#160;&#160;&#160;their<br/>scripts.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;started&#160;a&#160;project&#160;that&#160;will&#160;carry&#160;us&#160;through&#160;the&#160;process&#160;of&#160;building&#160;a<br/>successful&#160;script.&#160;We&#160;introduced&#160;the&#160;concept&#160;of&#160;variables&#160;and&#160;constants&#160;and&#160;how&#160;they&#160;can<br/>be&#160;employed.&#160;They&#160;are&#160;the&#160;first&#160;of&#160;many&#160;applications&#160;we&#160;will&#160;find&#160;for&#160;parameter&#160;expan-<br/>sion.&#160;We&#160;also&#160;looked&#160;at&#160;how&#160;to&#160;produce&#160;output&#160;from&#160;our&#160;script&#160;and&#160;various&#160;methods&#160;for<br/>embedding&#160;blocks&#160;of text.<br/>
381<br/>
<hr/>
<a name=406></a>25 – Starting&#160;a&#160;Project<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
For more&#160;information&#160;about&#160;HTML, see&#160;the&#160;following&#160;articles&#160;and tutorials:<br/><a href="http://en.wikipedia.org/wiki/Html">http://en.wikipedia.org/wiki/Html<br/></a><a href="http://en.wikibooks.org/wiki/HTML_Programming">http://en.wikibooks.org/wiki/HTML_Programming<br/></a><a href="http://html.net/tutorials/html/">http://html.net/tutorials/html/</a><br/>
●<br/>
The&#160;bash&#160;man&#160;page&#160;includes&#160;a&#160;section entitled “HERE&#160;DOCUMENTS,”&#160;which&#160;<br/>has&#160;a&#160;full&#160;description&#160;of this&#160;feature.&#160;<br/>
382<br/>
<hr/>
<a name=407></a>26 –&#160;Top-Down Design<br/>
<i><b>26&#160;–&#160;Top-Down&#160;Design</b></i><br/>
As&#160;programs&#160;get&#160;larger&#160;and&#160;more&#160;complex,&#160;they&#160;become&#160;more&#160;difficult&#160;to&#160;design,&#160;code,<br/>and&#160;maintain.&#160;As&#160;with&#160;any&#160;large&#160;project,&#160;it&#160;is&#160;often&#160;a&#160;good&#160;idea&#160;to&#160;break&#160;large,&#160;complex<br/>tasks&#160;into&#160;a&#160;series&#160;of&#160;small,&#160;simple&#160;tasks.&#160;Let’s&#160;imagine&#160;that&#160;we&#160;are&#160;trying&#160;to&#160;describe&#160;a<br/>common,&#160;everyday&#160;task,&#160;going&#160;to&#160;the&#160;market&#160;to&#160;buy&#160;food,&#160;to&#160;a&#160;person&#160;from&#160;Mars.&#160;We<br/>might&#160;describe&#160;the&#160;overall&#160;process&#160;as&#160;the&#160;following series&#160;of steps:<br/>
1.&#160;Get&#160;in car.<br/>2.&#160;Drive&#160;to market.<br/>3.&#160;Park car.<br/>4.&#160;Enter&#160;market.<br/>5.&#160;Purchase&#160;food.<br/>6.&#160;Return to&#160;car.<br/>7.&#160;Drive&#160;home.<br/>8.&#160;Park car.<br/>9.&#160;Enter&#160;house.<br/>
However,&#160;a&#160;person&#160;from&#160;Mars&#160;is&#160;likely&#160;to&#160;need&#160;more&#160;detail.&#160;We&#160;could&#160;further&#160;break&#160;down<br/>the&#160;subtask “Park&#160;car”&#160;into&#160;this&#160;series&#160;of steps:<br/>
1.&#160;Find parking space.<br/>2.&#160;Drive&#160;car&#160;into space.<br/>3.&#160;Turn off motor.<br/>4.&#160;Set&#160;parking&#160;brake.<br/>5.&#160;Exit&#160;car.<br/>6.&#160;Lock car.<br/>
The&#160;“Turn&#160;off&#160;motor”&#160;subtask&#160;could&#160;further&#160;be&#160;broken&#160;down&#160;into&#160;steps&#160;including&#160;“Turn<br/>off&#160;ignition,”&#160;“Remove&#160;ignition&#160;key,”&#160;and&#160;so&#160;on,&#160;until&#160;every&#160;step&#160;of&#160;the&#160;entire&#160;process&#160;of<br/>going to the&#160;market&#160;has&#160;been&#160;fully defined.<br/>This&#160;process&#160;of&#160;identifying&#160;the&#160;top-level&#160;steps&#160;and&#160;developing&#160;increasingly&#160;detailed&#160;views<br/>of&#160;those&#160;steps&#160;is&#160;called&#160;<i>top-down&#160;design</i>.&#160;This&#160;technique&#160;allows&#160;us&#160;to&#160;break&#160;large&#160;complex<br/>tasks&#160;into&#160;many&#160;small,&#160;simple&#160;tasks.&#160;Top-down&#160;design&#160;is&#160;a&#160;common&#160;method&#160;of&#160;designing<br/>
383<br/>
<hr/>
<a name=408></a>26 –&#160;Top-Down Design<br/>
programs&#160;and one&#160;that&#160;is&#160;well&#160;suited&#160;to shell&#160;programming&#160;in particular.<br/>In&#160;this&#160;chapter,&#160;we&#160;will&#160;use&#160;top-down&#160;design&#160;to&#160;further&#160;develop&#160;our&#160;report-generator<br/>script.<br/>
<b>Shell&#160;Functions<br/></b>Our script&#160;currently performs&#160;the&#160;following&#160;steps&#160;to generate&#160;the&#160;HTML&#160;document:<br/>
1.&#160;Open&#160;page.<br/>2.&#160;Open&#160;page&#160;header.<br/>3.&#160;Set&#160;page&#160;title.<br/>4.&#160;Close&#160;page&#160;header.<br/>5.&#160;Open&#160;page&#160;body.<br/>6.&#160;Output&#160;page&#160;heading.<br/>7.&#160;Output&#160;timestamp.<br/>8.&#160;Close&#160;page&#160;body.<br/>9.&#160;Close&#160;page.<br/>
For&#160;our&#160;next&#160;stage&#160;of&#160;development,&#160;we&#160;will&#160;add&#160;some&#160;tasks&#160;between&#160;steps&#160;7&#160;and&#160;8.&#160;These<br/>will&#160;includethe&#160;following:<br/>
●<br/>
System&#160;uptime&#160;and&#160;load.&#160;This&#160;is&#160;the&#160;amount&#160;of&#160;time&#160;since&#160;the&#160;last&#160;shutdown&#160;or&#160;re-<br/>boot&#160;and the&#160;average&#160;number&#160;of&#160;tasks&#160;currently&#160;running on&#160;the&#160;processor over&#160;sev-<br/>eral&#160;time&#160;intervals.<br/>
●<br/>
Disk space.&#160;This&#160;is&#160;the&#160;overall&#160;use&#160;of space&#160;on the&#160;system’s&#160;storage&#160;devices.<br/>
●<br/>
Home&#160;space.&#160;This&#160;is&#160;the&#160;amount&#160;of storage&#160;space&#160;being&#160;used&#160;by each user.<br/>
If&#160;we&#160;had&#160;a&#160;command&#160;for&#160;each&#160;of&#160;these&#160;tasks,&#160;we&#160;could&#160;add&#160;them&#160;to&#160;our&#160;script&#160;simply<br/>through command substitution.<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
TITLE=&#34;System Information Report For $HOSTNAME&#34;&#160;<br/>CURRENT_TIME=&#34;$(date +&#34;%x %r %Z&#34;)&#34;&#160;<br/>TIMESTAMP=&#34;Generated $CURRENT_TIME, by $USER&#34;&#160;<br/>
cat &lt;&lt; _EOF_&#160;<br/>&lt;html&gt;&#160;<br/>
384<br/>
<hr/>
<a name=409></a>Shell&#160;Functions<br/>
&#160; &#160; &#160; &#160; &lt;head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;title&gt;$TITLE&lt;/title&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;/head&gt;&#160;<br/>&#160; &#160; &#160; &#160; &lt;body&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;p&gt;$TIMESTAMP&lt;/p&gt;&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;&#160;<b>$(report_uptime)&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(report_disk_space)&#160;<br/>&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; $(report_home_space)&#160;<br/></b>&#160; &#160; &#160; &#160; &lt;/body&gt;&#160;<br/>&lt;/html&gt;&#160;<br/>_EOF_<br/>
We&#160;could&#160;create&#160;these&#160;additional&#160;commands&#160;in&#160;two&#160;ways.&#160;We&#160;could&#160;write&#160;three&#160;separate<br/>scripts&#160;and&#160;place&#160;them&#160;in&#160;a&#160;directory&#160;listed&#160;in&#160;our&#160;PATH,&#160;or&#160;we&#160;could&#160;embed&#160;the&#160;scripts<br/>within&#160;our&#160;program&#160;as&#160;<i>shell&#160;functions</i>.&#160;As&#160;we&#160;have&#160;mentioned,&#160;shell&#160;functions&#160;are&#160;“mini-<br/>scripts”&#160;that&#160;are&#160;located&#160;inside&#160;other&#160;scripts&#160;and&#160;can&#160;act&#160;as&#160;autonomous&#160;programs.&#160;Shell<br/>functions&#160;have&#160;two syntactic&#160;forms. First, here&#160;is&#160;the&#160;more&#160;formal&#160;form:<br/>function&#160;<i>name</i>&#160;{<br/>
<i>commands<br/></i>return<br/>
}<br/>Here&#160;is&#160;a&#160; simpler (and generally&#160;preferred)&#160;form:<br/><i>name</i>&#160;() {<br/>
<i>commands<br/></i>return<br/>
}<br/>where&#160;<i>name</i>&#160;is&#160;the&#160;name&#160;of the&#160;function&#160;and&#160;<i>commands</i>&#160;is&#160;a&#160;series&#160;of commands&#160;contained<br/>within&#160;the&#160;function.&#160;Both&#160;forms&#160;are&#160;equivalent&#160;and&#160;may&#160;be&#160;used&#160;interchangeably.&#160;The&#160;fol-<br/>lowing is&#160;a&#160;script&#160;that&#160;demonstrates&#160;the&#160;use&#160;of a&#160;shell&#160;function:<br/>
&#160;1&#160;#!/bin/bash&#160;<br/>&#160;2&#160;&#160;<br/>&#160;3&#160;# Shell function demo&#160;<br/>&#160;4&#160;&#160;<br/>&#160;5&#160;function step2 {&#160;<br/>&#160;6<br/>
echo &#34;Step 2&#34;&#160;<br/>
&#160;7<br/>
return&#160;<br/>
&#160;8&#160;}&#160;<br/>&#160;9&#160;&#160;<br/>
385<br/>
<hr/>
<a name=410></a>26 –&#160;Top-Down Design<br/>
10&#160;# Main program starts here&#160;<br/>11&#160;&#160;<br/>12&#160;echo &#34;Step 1&#34;&#160;<br/>13&#160;step2&#160;<br/>14&#160;echo &#34;Step 3&#34;<br/>
As&#160;the&#160;shell&#160;reads&#160;the&#160;script,&#160;it&#160;passes&#160;over&#160;lines&#160;1&#160;through&#160;11&#160;because&#160;those&#160;lines&#160;consist<br/>of comments&#160;and&#160;the&#160;function&#160;definition.&#160;Execution&#160;begins&#160;at&#160;line&#160;12, with&#160;an&#160;echo&#160;com-<br/>mand.&#160;Line&#160;13&#160;<i>calls</i>&#160;the&#160;shell&#160;function&#160;step2&#160;and&#160;the&#160;shell&#160;executes&#160;the&#160;function&#160;just&#160;as<br/>it&#160;would any&#160;other command. Program&#160;control&#160;then moves&#160;to line&#160;6, and the&#160;second&#160;echo<br/>command&#160;is&#160;executed.&#160;Line&#160;7&#160;is&#160;executed&#160;next.&#160;Its&#160;&#160;return&#160;&#160;command&#160;&#160;terminates&#160;the<br/>function&#160;and&#160;returns&#160;control&#160;to&#160;the&#160;program&#160;at&#160;the&#160;line&#160;following&#160;the&#160;function&#160;call&#160;(line<br/>14),&#160;and&#160;the&#160;final&#160;echo&#160;command&#160;is&#160;executed.&#160;Note&#160;that&#160;for&#160;function&#160;calls&#160;to&#160;be&#160;recog-<br/>nized&#160;as&#160;shell&#160;functions&#160;and&#160;not&#160;interpreted&#160;as&#160;the&#160;names&#160;of&#160;external&#160;programs,&#160;shell&#160;func-<br/>tion definitions&#160;must&#160;appear&#160;in the&#160;script&#160;before&#160;they are&#160;called.<br/>We’ll&#160;add&#160;minimal&#160;shell&#160;function definitions&#160;to&#160;our script, shown here:<br/>
#!/bin/bash&#160;<br/>
# Program to output a system information page&#160;<br/>
TITLE=&#34;System Information Report For $HOSTNAME&#34;&#160;<br/>CURRENT_TIME=&#34;$(date +&#34;%x %r %Z&#34;)&#34;&#160;<br/>TIMESTAMP=&#34;Generated $CURRENT_TIME, by $USER&#34;&#160;<br/>
<b>report_uptime () {&#160;</b><br/>
<b>return&#160;</b><br/>
<b>}<br/>&#160;<br/>report_disk_space () {&#160;</b><br/>
<b>return&#160;</b><br/>
<b>}&#160;</b><br/>
<b>report_home_space () {&#160;</b><br/>
<b>return&#160;</b><br/>
<b>}&#160;</b><br/>
cat &lt;&lt; _EOF_&#160;<br/>&lt;html&gt;&#160;<br/>
&lt;head&gt;&#160;<br/>
&lt;title&gt;$TITLE&lt;/title&gt;&#160;<br/>
386<br/>
<hr/>
<a name=411></a>Shell&#160;Functions<br/>
&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;<br/>
&lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&lt;p&gt;$TIMESTAMP&lt;/p&gt;&#160;<br/>$(report_uptime)&#160;<br/>$(report_disk_space)&#160;<br/>$(report_home_space)&#160;<br/>
&lt;/body&gt;&#160;<br/>
&lt;/html&gt;&#160;<br/>_EOF_&#160;<br/>
Shell&#160;function&#160;names&#160;follow&#160;the&#160;same&#160;rules&#160;as&#160;variables.&#160;A&#160;function&#160;must&#160;contain&#160;at&#160;least<br/>one&#160;command.&#160;The&#160;return&#160;command&#160;(which is&#160;optional) satisfies&#160;the&#160;requirement.<br/>
<b>Local&#160;Variables<br/></b>In&#160;the&#160;scripts&#160;we&#160;have&#160;written&#160;so&#160;far,&#160;all&#160;the&#160;variables&#160;(including&#160;constants)&#160;have&#160;been<br/><i>global&#160;variables</i>.&#160;Global&#160;variables&#160;maintain&#160;their&#160;existence&#160;throughout&#160;the&#160;program.&#160;This<br/>is&#160;fine&#160;for&#160;many&#160;things,&#160;but&#160;it&#160;can&#160;sometimes&#160;complicate&#160;the&#160;use&#160;of&#160;shell&#160;functions.&#160;Inside<br/>shell&#160;functions,&#160;it&#160;is&#160;often&#160;desirable&#160;to&#160;have&#160;<i>local&#160;variables</i>.&#160;Local&#160;variables&#160;are&#160;only&#160;ac-<br/>cessible&#160;within&#160;the&#160;shell&#160;function&#160;in&#160;which&#160;they&#160;are&#160;defined&#160;and&#160;cease&#160;to&#160;exist&#160;once&#160;the<br/>shell&#160;function terminates.<br/>Having&#160;local&#160;variables&#160;allows&#160;the&#160;programmer&#160;to&#160;use&#160;variables&#160;with&#160;names&#160;that&#160;may&#160;al-<br/>ready&#160;exist,&#160;either&#160;in&#160;the&#160;script&#160;globally&#160;or&#160;in&#160;other&#160;shell&#160;functions,&#160;without&#160;having&#160;to<br/>worry about&#160;potential&#160;name&#160;conflicts.<br/>Here&#160;is&#160;an example&#160;script&#160;that&#160;demonstrates&#160;how&#160;local&#160;variables&#160;are&#160;defined and&#160;used:<br/>
#!/bin/bash&#160;<br/>
# local-vars: script to demonstrate local variables&#160;<br/>
foo=0<br/>
# global variable foo&#160;<br/>
funct_1 () {&#160;<br/>
local foo&#160;# variable foo local to funct_1&#160;<br/>
foo=1<br/>echo &#34;funct_1: foo = $foo&#34;<br/>
}&#160;<br/>
387<br/>
<hr/>
<a name=412></a>26 –&#160;Top-Down Design<br/>
funct_2 () {&#160;<br/>
local foo&#160;# variable foo local to funct_2&#160;<br/>
foo=2<br/>echo &#34;funct_2: foo = $foo&#34;&#160;<br/>
}&#160;<br/>
echo &#34;global: &#160;foo = $foo&#34;&#160;<br/>funct_1&#160;<br/>echo &#34;global: &#160;foo = $foo&#34;&#160;<br/>funct_2&#160;<br/>echo &#34;global: &#160;foo = $foo&#34;<br/>
As&#160;we&#160;can&#160;see,&#160;local&#160;variables&#160;are&#160;defined&#160;by&#160;preceding&#160;the&#160;variable&#160;name&#160;with&#160;the&#160;word<br/>local.&#160;This&#160;creates&#160;a&#160;variable&#160;that&#160;is&#160;local&#160;to&#160;the&#160;shell&#160;function&#160;in&#160;which&#160;it&#160;is&#160;defined.<br/>Once&#160;outside&#160;the&#160;shell&#160;function,&#160;the&#160;variable&#160;no&#160;longer&#160;exists.&#160;When&#160;we&#160;run this&#160;script,&#160;we<br/>see&#160;these&#160;results:<br/>
[me@linuxbox ~]$&#160;<b>local-vars&#160;<br/></b>global: &#160;foo = 0&#160;<br/>funct_1: foo = 1&#160;<br/>global: &#160;foo = 0&#160;<br/>funct_2: foo = 2&#160;<br/>global: &#160;foo = 0<br/>
We&#160;see&#160;that&#160;the&#160;assignment&#160;of&#160;values&#160;to&#160;the&#160;local&#160;variable&#160;foo&#160;within&#160;both&#160;shell&#160;functions<br/>has&#160;no effect&#160;on the&#160;value&#160;of&#160;foo&#160;defined outside&#160;the&#160;functions.<br/>This&#160;feature&#160;allows&#160;shell&#160;functions&#160;to&#160;be&#160;written&#160;so&#160;that&#160;they&#160;remain&#160;independent&#160;of&#160;each<br/>other&#160;and&#160;of the&#160;script&#160;in&#160;which&#160;they&#160;appear.&#160;This&#160;is&#160;valuable,&#160;because&#160;it&#160;helps&#160;prevent&#160;one<br/>part&#160;of&#160;a&#160;program&#160;from&#160;interfering&#160;with&#160;another.&#160;It&#160;also&#160;allows&#160;shell&#160;functions&#160;to&#160;be&#160;writ-<br/>ten&#160;so&#160;that&#160;they&#160;can&#160;be&#160;portable.&#160;That&#160;is,&#160;they&#160;may&#160;be&#160;cut&#160;and&#160;pasted&#160;from&#160;script&#160;to&#160;script,<br/>as&#160;needed.<br/>
<b>Keep&#160;Scripts&#160;Running<br/></b>While&#160;developing&#160;our&#160;program,&#160;it&#160;is&#160;useful&#160;to&#160;keep&#160;the&#160;program&#160;in&#160;a&#160;runnable&#160;state.&#160;By<br/>doing&#160;this,&#160;and&#160;testing&#160;frequently,&#160;we&#160;can&#160;detect&#160;errors&#160;early&#160;in&#160;the&#160;development&#160;process.<br/>This&#160;will&#160;make&#160;&#160;debugging&#160;&#160;problems&#160;much&#160;easier.&#160;For&#160;example,&#160;if&#160;we&#160;run&#160;the&#160;program,<br/>make&#160;a&#160;small&#160;change,&#160;then&#160;run&#160;the&#160;program&#160;again&#160;and&#160;find&#160;a&#160;problem,&#160;it’s&#160;likely&#160;that&#160;the<br/>most&#160;recent&#160;change&#160;is&#160;the&#160;source&#160;of&#160;the&#160;problem.&#160;By&#160;adding&#160;the&#160;empty&#160;functions,&#160;called<br/>
388<br/>
<hr/>
<a name=413></a>Keep Scripts&#160;Running<br/>
<i>stubs</i>&#160;&#160;in&#160;programmer-speak,&#160;we&#160;can&#160;verify&#160;the&#160;logical&#160;flow&#160;of&#160;our&#160;program&#160;at&#160;an&#160;early<br/>stage.&#160;When&#160;constructing&#160;a&#160;stub,&#160;it’s&#160;a&#160;good&#160;idea&#160;to&#160;include&#160;something&#160;that&#160;provides&#160;feed-<br/>back&#160;to&#160;the&#160;programmer,&#160;which&#160;shows&#160;the&#160;logical&#160;flow&#160;is&#160;being&#160;carried&#160;out.&#160;If&#160;we&#160;look&#160;at<br/>the&#160;output&#160;of our script&#160;now:<br/>
[me@linuxbox ~]$&#160;<b>sys_info_page&#160;<br/></b>&lt;html&gt;&#160;<br/>
&lt;head&gt;&#160;<br/>
&lt;title&gt;System Information Report For twin2&lt;/title&gt;&#160;<br/>
&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;<br/>
&lt;h1&gt;System Information Report For linuxbox&lt;/h1&gt;&#160;<br/>&lt;p&gt;Generated 03/19/2009 04:02:10 PM EDT, by me&lt;/p&gt;<br/>
&#160;<br/>
&lt;/body&gt;&#160;<br/>
&lt;/html&gt;<br/>
we&#160;see&#160;that&#160;there&#160;are&#160;some&#160;blank&#160;lines&#160;in&#160;our&#160;output&#160;after&#160;the&#160;timestamp,&#160;but&#160;we&#160;can’t&#160;be<br/>sure&#160;of the&#160;cause.&#160;If we&#160;change&#160;the&#160;functions&#160;to include&#160;some&#160;feedback:<br/>
report_uptime () {&#160;<br/>&#160; &#160; &#160; &#160;&#160;<b>echo &#34;Function report_uptime executed.&#34;&#160;<br/></b>&#160; &#160; &#160; &#160; return&#160;<br/>}&#160;<br/>
report_disk_space () {&#160;<br/>&#160; &#160; &#160; &#160;&#160;<b>echo &#34;Function report_disk_space executed.&#34;</b>&#160;<br/>&#160; &#160; &#160; &#160; return&#160;<br/>}&#160;<br/>
report_home_space () {&#160;<br/>&#160; &#160; &#160; &#160;&#160;<b>echo &#34;Function report_home_space executed.&#34;</b>&#160;<br/>&#160; &#160; &#160; &#160; return&#160;<br/>}&#160;<br/>
and run the&#160;script&#160;again:<br/>
[me@linuxbox ~]$&#160;<b>sys_info_page</b>&#160;<br/>
389<br/>
<hr/>
<a name=414></a>26 –&#160;Top-Down Design<br/>
&lt;html&gt;&#160;<br/>
&lt;head&gt;&#160;<br/>
&lt;title&gt;System Information Report For linuxbox&lt;/title&gt;<br/>
&#160;<br/>
&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;<br/>
&lt;h1&gt;System Information Report For linuxbox&lt;/h1&gt;&#160;<br/>&lt;p&gt;Generated 03/20/2009 05:17:26 AM EDT, by me&lt;/p&gt;&#160;<br/>Function report_uptime executed.&#160;<br/>Function report_disk_space executed.&#160;<br/>Function report_home_space executed.&#160;<br/>
&lt;/body&gt;&#160;<br/>
&lt;/html&gt;<br/>
we&#160;now&#160;see&#160;that, in&#160;fact,&#160;our three&#160;functions&#160;are&#160;being executed.<br/>With&#160;our&#160;function&#160;framework&#160;in&#160;place&#160;and&#160;working,&#160;it’s&#160;time&#160;to&#160;flesh&#160;out&#160;some&#160;of&#160;the<br/>function&#160;code. First, here’s&#160;the&#160;report_uptime&#160;function:<br/>
report_uptime () {&#160;<br/>
<b>cat &lt;&lt;- _EOF_&#160;</b><br/>
<b>&#160; &#160; &#160; &#160;&#160;&#160;&lt;h2&gt;System Uptime&lt;/h2&gt;&#160;<br/>&#160; &#160; &#160; &#160;&#160;&#160;&lt;pre&gt;$(uptime)&lt;/pre&gt;&#160;<br/>&#160; &#160; &#160; &#160;&#160;&#160;_EOF_</b>&#160;<br/>
return&#160;<br/>
}<br/>
It’s&#160;pretty&#160;straightforward.&#160;We&#160;use&#160;a&#160;here&#160;document&#160;to&#160;output&#160;a&#160;section&#160;header&#160;and&#160;the<br/>output&#160;of&#160;the&#160;uptime&#160;command,&#160;surrounded&#160;by&#160;&lt;pre&gt;&#160;tags&#160;to&#160;preserve&#160;the&#160;formatting<br/>of the&#160;command.&#160;The&#160;report_disk_space&#160;function&#160;is&#160;similar.<br/>
report_disk_space () {&#160;<br/>
<b>cat &lt;&lt;- _EOF_&#160;</b><br/>
<b>&lt;h2&gt;Disk Space Utilization&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(df -h)&lt;/pre&gt;&#160;<br/>_EOF_&#160;</b><br/>
return&#160;<br/>
}<br/>
This&#160;function&#160;uses&#160;the&#160;df&#160;-h&#160;command&#160;to&#160;determine&#160;the&#160;amount&#160;of&#160;disk&#160;space.&#160;Lastly,<br/>we’ll&#160;build the&#160;report_home_space&#160;function.<br/>
390<br/>
<hr/>
<a name=415></a>Keep Scripts&#160;Running<br/>
report_home_space () {&#160;<br/>
<b>cat &lt;&lt;- _EOF_&#160;</b><br/>
<b>&lt;h2&gt;Home Space Utilization&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh /home/*)&lt;/pre&gt;&#160;<br/>_EOF_&#160;</b><br/>
return&#160;<br/>
}<br/>
We&#160;use&#160;the&#160;du&#160;command&#160;with&#160;the&#160;-sh&#160;options&#160;to&#160;perform&#160;this&#160;task.&#160;This,&#160;however,&#160;is&#160;not<br/>a&#160;complete&#160;solution&#160;to&#160;the&#160;problem.&#160;While&#160;it&#160;will&#160;work&#160;on&#160;some&#160;systems&#160;(Ubuntu,&#160;for&#160;ex-<br/>ample),&#160;it&#160;will&#160;not&#160;work&#160;on&#160;others.&#160;The&#160;reason&#160;is&#160;that&#160;many&#160;systems&#160;set&#160;the&#160;permissions&#160;of<br/>home&#160;directories&#160;to&#160;prevent&#160;them&#160;from&#160;being&#160;world-readable,&#160;which&#160;is&#160;a&#160;reasonable&#160;secu-<br/>rity&#160;measure.&#160;On&#160;these&#160;systems,&#160;the&#160;&#160;report_home_space&#160;&#160;function,&#160;as&#160;written,&#160;will<br/>work&#160;only&#160;if&#160;our&#160;script&#160;is&#160;run&#160;with&#160;superuser&#160;privileges.&#160;A&#160;better&#160;solution&#160;would&#160;be&#160;to<br/>have&#160;the&#160;script&#160;adjust&#160;its&#160;behavior&#160;according&#160;to&#160;the&#160;privileges&#160;of&#160;the&#160;user.&#160;We&#160;will&#160;take&#160;this<br/>up in the&#160;next&#160;chapter.<br/>
<b>Shell&#160;Functions&#160;In&#160;Your&#160;.bashrc&#160;File</b><br/>
Shell&#160;functions&#160;make&#160;excellent&#160;replacements&#160;for&#160;aliases,&#160;and&#160;are&#160;actually&#160;the&#160;pre-<br/>ferred&#160;method&#160;of&#160;creating&#160;small&#160;commands&#160;for&#160;personal&#160;use.&#160;Aliases&#160;are&#160;limited&#160;in<br/>the&#160;kind&#160;of&#160;commands&#160;and&#160;shell&#160;features&#160;they&#160;support,&#160;whereas&#160;shell&#160;functions&#160;al-<br/>low&#160;&#160;&#160;anything&#160;&#160;&#160;that&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;scripted.&#160;&#160;&#160;For&#160;&#160;&#160;example,&#160;&#160;&#160;if&#160;&#160;&#160;we&#160;&#160;&#160;liked&#160;&#160;&#160;the<br/>report_disk_space&#160;&#160;shell&#160;&#160;&#160;function&#160;&#160;&#160;that&#160;&#160;&#160;we&#160;&#160;&#160;developed&#160;&#160;&#160;for&#160;&#160;&#160;our&#160;&#160;&#160;script,&#160;&#160;&#160;we<br/>could create&#160;a&#160;similar function named&#160;ds&#160;for our&#160;.bashrc&#160;file:<br/>ds () {<br/>
echo “Disk Space Utilization For $HOSTNAME”<br/>df -h<br/>
}<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;have&#160;introduced&#160;a&#160;common&#160;method&#160;of&#160;program&#160;design&#160;called&#160;top-<br/>down&#160;design,&#160;and&#160;we&#160;saw&#160;how&#160;shell&#160;functions&#160;are&#160;used&#160;to&#160;build&#160;the&#160;stepwise&#160;refinement<br/>that&#160;it&#160;requires.&#160;We&#160;also&#160;saw&#160;how&#160;local&#160;variables&#160;can&#160;be&#160;used&#160;to&#160;make&#160;shell&#160;functions&#160;in-<br/>dependent&#160;from&#160;one&#160;another&#160;and&#160;from&#160;the&#160;program&#160;in&#160;which&#160;they&#160;are&#160;placed.&#160;This&#160;makes<br/>it&#160;possible&#160;for&#160;shell&#160;functions&#160;to&#160;be&#160;written&#160;in&#160;a&#160;portable&#160;manner&#160;and&#160;to&#160;be&#160;<i>reusable</i>&#160;by&#160;al-<br/>lowing them&#160;to be&#160;placed&#160;in multiple&#160;programs;&#160;this&#160;is&#160;a&#160;great&#160;time&#160;saver.<br/>
391<br/>
<hr/>
<a name=416></a>26 –&#160;Top-Down Design<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;Wikipedia&#160;has&#160;many&#160;articles&#160;on software&#160;design philosophy. Here&#160;are&#160;a&#160;cou-<br/>ple&#160;of good ones:<br/><a href="http://en.wikipedia.org/wiki/Top-down_design">http://en.wikipedia.org/wiki/Top-down_design<br/></a><a href="http://en.wikipedia.org/wiki/Subroutines">http://en.wikipedia.org/wiki/Subroutines</a><br/>
392<br/>
<hr/>
<a name=417></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
<i><b>27&#160;–&#160;Flow&#160;Control:&#160;Branching&#160;with&#160;if</b></i><br/>
In&#160;the&#160;previous&#160;chapter,&#160;we&#160;were&#160;presented&#160;with&#160;a&#160;problem.&#160;How&#160;can&#160;we&#160;make&#160;our&#160;report-<br/>generator&#160;script&#160;adapt&#160;to&#160;the&#160;privileges&#160;of&#160;the&#160;user&#160;running&#160;the&#160;script?&#160;The&#160;solution&#160;to&#160;this<br/>problem&#160;will&#160;require&#160;us&#160;to&#160;find&#160;a&#160;way&#160;to&#160;“change&#160;directions”&#160;within&#160;our&#160;script,&#160;based&#160;on<br/>the&#160;results&#160;of a&#160;test. In programming&#160;terms, we&#160;need&#160;the&#160;program&#160;to&#160;<i>branch</i>.<br/>Let’s&#160;consider&#160;a&#160;simple&#160;example&#160;of&#160;logic&#160;expressed&#160;in&#160;<i>pseudocode</i>,&#160;a&#160;simulation&#160;of a&#160;com-<br/>puter language&#160;intended&#160;for human consumption.<br/>X&#160;=&#160;5<br/>If X&#160;=&#160;5, then:<br/>
Say “X&#160;equals&#160;5.”<br/>
Otherwise:<br/>
Say “X&#160;is&#160;not&#160;equal&#160;to&#160;5.”<br/>
This&#160;is&#160;an&#160;example&#160;of&#160;a&#160;branch.&#160;Based&#160;on&#160;the&#160;condition,&#160;“Does&#160;X&#160;=&#160;5?”&#160;do&#160;one&#160;thing,<br/>“Say X&#160;equals&#160;5,”&#160;and&#160;otherwise&#160;do another thing,&#160;“Say X&#160;is&#160;not&#160;equal&#160;to 5.”&#160;<br/>
<b>if<br/></b>Using the&#160;shell,&#160;we&#160;can code&#160;the&#160;previous&#160;logic&#160;as&#160;follows:<br/>
x=5&#160;<br/>
if&#160;[ &#34;$x&#34; -eq 5 ]; then&#160;<br/>
echo &#34;x equals 5.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;x does not equal 5.&#34;&#160;<br/>
fi<br/>
Or we&#160;can&#160;enter&#160;it&#160;directly&#160;at&#160;the&#160;command line&#160;(slightly shortened).<br/>
393<br/>
<hr/>
<a name=418></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
[me@linuxbox ~]$&#160;<b>x=5<br/></b>[me@linuxbox ~]$&#160;<b>if [ “$x” -eq 5 ]; then echo &#34;equals 5&#34;; else echo&#160;<br/>&#34;does not equal 5&#34;; fi<br/></b>equals 5<br/>[me@linuxbox ~]$&#160;<b>x=0<br/></b>[me@linuxbox ~]$&#160;<b>if [ “$x” -eq 5 ]; then echo &#34;equals 5&#34;; else echo&#160;<br/>&#34;does not equal 5&#34;; fi<br/></b>does not equal 5<br/>
In&#160;this&#160;example,&#160;we&#160;execute&#160;the&#160;command&#160;twice;&#160;once,&#160;with&#160;the&#160;value&#160;of&#160;x&#160;set&#160;to&#160;5,&#160;which<br/>results&#160;in&#160;the&#160;string&#160;“equals&#160;5”&#160;being&#160;output,&#160;and&#160;the&#160;second&#160;time&#160;with&#160;the&#160;value&#160;of&#160;x&#160;set<br/>to 0, which results&#160;in the&#160;string “does&#160;not&#160;equal&#160;5”&#160;being output.<br/>The&#160;if&#160;statement&#160;has&#160;the&#160;following syntax:<br/>if&#160;<i>commands</i>; then<br/>
<i>commands</i><br/>
[elif&#160;<i>commands</i>; then<br/>
<i>commands</i>...]<br/>
[else<br/>
<i>commands</i>]<br/>
fi<br/>where&#160;<i>commands</i>&#160;is&#160;a&#160;list&#160;of&#160;commands.&#160;This&#160;is&#160;a&#160;little&#160;confusing&#160;at&#160;first&#160;glance.&#160;But&#160;be-<br/>fore&#160;we&#160;can&#160;clear&#160;this&#160;up,&#160;we&#160;have&#160;to&#160;look&#160;at&#160;how&#160;the&#160;shell&#160;evaluates&#160;the&#160;success&#160;or&#160;failure<br/>of a&#160;command.<br/>
<b>Exit&#160;Status<br/></b>Commands&#160;(including&#160;the&#160;scripts&#160;and&#160;shell&#160;functions&#160;we&#160;write) issue&#160;a&#160;value&#160;to&#160;the&#160;system<br/>when&#160;they&#160;terminate,&#160;called&#160;an&#160;<i>exit&#160;status</i>.&#160;This&#160;value,&#160;which&#160;is&#160;an&#160;integer&#160;in&#160;the&#160;range&#160;of<br/>0&#160;to&#160;255,&#160;indicates&#160;the&#160;success&#160;or&#160;failure&#160;of&#160;the&#160;command’s&#160;execution.&#160;By&#160;convention,&#160;a<br/>value&#160;of&#160;zero&#160;indicates&#160;success&#160;and&#160;any&#160;other&#160;value&#160;indicates&#160;failure.&#160;The&#160;shell&#160;provides&#160;a<br/>parameter that&#160;we&#160;can&#160;use&#160;to examine&#160;the&#160;exit&#160;status. Here&#160;we&#160;see&#160;it&#160;in action:<br/>
[me@linuxbox ~]$&#160;<b>ls -d /usr/bin<br/></b>/usr/bin<br/>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>0<br/>[me@linuxbox ~]$&#160;<b>ls -d /bin/usr<br/></b>ls: cannot access /bin/usr: No such file or directory<br/>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>2<br/>
394<br/>
<hr/>
<a name=419></a>Exit&#160;Status<br/>
In&#160;this&#160;example,&#160;we&#160;execute&#160;the&#160;ls&#160;command&#160;twice.&#160;The&#160;first&#160;time,&#160;the&#160;command&#160;exe-<br/>cutes&#160;successfully.&#160;If&#160;we&#160;display&#160;the&#160;value&#160;of&#160;the&#160;parameter&#160;$?,&#160;we&#160;see&#160;that&#160;it&#160;is&#160;zero.&#160;We<br/>execute&#160;the&#160;ls&#160;command&#160;a&#160;second&#160;time&#160;(specifying&#160;a&#160;nonexistent&#160;directory),&#160;producing<br/>an&#160;error,&#160;and&#160;examine&#160;the&#160;parameter&#160;$?&#160;again.&#160;This&#160;time&#160;it&#160;contains&#160;a&#160;2,&#160;indicating&#160;that<br/>the&#160;command&#160;encountered&#160;an&#160;error.&#160;Some&#160;commands&#160;use&#160;different&#160;exit&#160;status&#160;values&#160;to<br/>provide&#160;diagnostics&#160;for&#160;errors,&#160;while&#160;many&#160;commands&#160;simply&#160;exit&#160;with&#160;a&#160;value&#160;of&#160;1&#160;when<br/>they&#160;fail.&#160;Man&#160;pages&#160;often&#160;include&#160;a&#160;section&#160;entitled&#160;“Exit&#160;Status,”&#160;describing&#160;what&#160;codes<br/>are&#160;used. However, a&#160;zero&#160;always&#160;indicates&#160;success.<br/>The&#160;shell&#160;provides&#160;two&#160;extremely&#160;simple&#160;builtin&#160;commands&#160;that&#160;do&#160;nothing&#160;except&#160;termi-<br/>nate&#160;with&#160;either&#160;a&#160;0&#160;or&#160;1&#160;exit&#160;status.&#160;The&#160;true&#160;command&#160;always&#160;executes&#160;successfully<br/>and the&#160;false&#160;command&#160;always&#160;executes&#160;unsuccessfully.<br/>
[me@linuxbox ~]$&#160;<b>true<br/></b>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>0<br/>[me@linuxbox ~]$&#160;<b>false<br/></b>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>1&#160;<br/>
We&#160;can&#160;use&#160;these&#160;commands&#160;to&#160;see&#160;how&#160;the&#160;if&#160;statement&#160;works.&#160;What&#160;the&#160;if&#160;statement<br/>really&#160;does&#160;is&#160;evaluate&#160;the&#160;success&#160;or failure&#160;of commands.<br/>
[me@linuxbox ~]$&#160;<b>if true; then echo &#34;It's true.&#34;; fi<br/></b>It's true.<br/>[me@linuxbox ~]$&#160;<b>if false; then echo &#34;It's true.&#34;; fi<br/></b>[me@linuxbox ~]$&#160;<br/>
The&#160;command&#160;echo&#160;&#34;It's&#160;true.&#34;&#160;is&#160;executed&#160;when&#160;the&#160;command&#160;following&#160;if&#160;exe-<br/>cutes&#160;successfully&#160;and&#160;is&#160;not&#160;executed&#160;when&#160;the&#160;command&#160;following&#160;if&#160;does&#160;not&#160;execute<br/>successfully. If a&#160;list&#160;of commands&#160;follows&#160;if, the&#160;last&#160;command&#160;in the&#160;list&#160;is&#160;evaluated:<br/>
[me@linuxbox ~]$ if false; true; then echo &#34;It's true.&#34;; fi<br/>It's true.<br/>[me@linuxbox ~]$ if true; false; then echo &#34;It's true.&#34;; fi<br/>[me@linuxbox ~]$&#160;<br/>
395<br/>
<hr/>
<a name=420></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
<b>test<br/></b>By&#160;far,&#160;the&#160;command&#160;used&#160;most&#160;frequently&#160;with&#160;if&#160;is&#160;test.&#160;The&#160;test&#160;command&#160;per-<br/>forms&#160;a&#160;variety&#160;of&#160;checks&#160;and&#160;comparisons.&#160;It&#160;has&#160;two&#160;equivalent&#160;forms.&#160;The&#160;first,&#160;shown<br/>here:<br/>test&#160;<i>expression<br/></i>And the&#160;second, more&#160;popular form,&#160;shown here:<br/>[&#160;<i>expression</i>&#160;]<br/>where&#160;<i>expression</i>&#160;is&#160;an&#160;expression&#160;that&#160;is&#160;evaluated&#160;as&#160;either&#160;true&#160;or&#160;false.&#160;The&#160;test&#160;com-<br/>mand&#160;returns&#160;an exit&#160;status&#160;of 0&#160;when&#160;the&#160;expression&#160;is&#160;true&#160;and&#160;a&#160;status&#160;of 1&#160;when&#160;the&#160;ex-<br/>pression&#160;is&#160;false.<br/>It&#160;is&#160;interesting&#160;to&#160;note&#160;that&#160;both&#160;test&#160;and&#160;[&#160;are&#160;actually&#160;commands.&#160;In&#160;bash&#160;they&#160;are<br/>builtins,&#160;but&#160;they&#160;also&#160;exist&#160;as&#160;programs&#160;in&#160;/usr/bin&#160;for&#160;use&#160;with&#160;other&#160;shells.&#160;The&#160;ex-<br/>pression&#160;is&#160;actually&#160;just&#160;its&#160;arguments&#160;with&#160;the&#160;[&#160;command&#160;requiring&#160;that&#160;the&#160;]&#160;character<br/>be&#160;provided&#160;as&#160;its&#160;final&#160;argument.<br/>The&#160;test&#160;and&#160;[&#160;commands&#160;support&#160;a&#160;wide&#160;range&#160;of useful&#160;expressions&#160;and tests.<br/>
File&#160;Expressions<br/>Table&#160;27-1 lists&#160;the&#160;expressions&#160; used to&#160;evaluate&#160;the&#160;status&#160;of files.<br/>
<i>Table&#160;27-1:&#160;test&#160;File&#160;Expressions</i><br/>
<b>Expression</b><br/>
<b>Is&#160;True&#160;If:</b><br/>
<i>file1</i>&#160;-ef&#160;<i>file2</i><br/>
<i>file1</i>&#160;and&#160;<i>file2</i>&#160;have&#160;the&#160;same&#160;inode&#160;numbers&#160;(the&#160;two&#160;<br/>filenames&#160;refer&#160;to the&#160;same&#160;file&#160;by hard linking).<br/>
<i>file1</i>&#160;-nt&#160;<i>file2</i><br/>
<i>file1</i>&#160;is&#160;newer than&#160;<i>file2</i>.<br/>
<i>file1</i>&#160;-ot&#160;<i>file2</i><br/>
<i>file1</i>&#160;is&#160;older&#160;than&#160;<i>file2</i>.<br/>
-b&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;block-special&#160;(device)&#160;file.<br/>
-c&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;character-special&#160;(device) file.<br/>
-d&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;directory.<br/>
-e&#160;<i>file</i><br/>
<i>file</i>&#160;exists.<br/>
-f&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;regular&#160;file.<br/>
-g&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;set-group-ID.<br/>
-G&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;owned&#160;by the&#160;effective&#160;group ID.<br/>
396<br/>
<hr/>
<a name=421></a>test<br/>
-k&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and has&#160;its&#160;“sticky&#160;bit”&#160;set.<br/>
-L&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;symbolic&#160;link.<br/>
-O&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;owned&#160;by the&#160;effective&#160;user&#160;ID.<br/>
-p&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;named&#160;pipe.<br/>
-r&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;readable&#160;(has&#160;readable&#160;permission for&#160;<br/>the&#160;effective&#160;user).<br/>
-s&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and has&#160;a&#160;length&#160;greater&#160;than&#160;zero.<br/>
-S&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;a&#160;network socket.<br/>
-t&#160;<i>fd</i><br/>
<i>fd</i>&#160;is&#160;a&#160;file&#160;descriptor directed&#160;to/from&#160;the&#160;terminal.&#160;This&#160;<br/>can be&#160;used to&#160;determine&#160;whether standard&#160;input/output/<br/>error is&#160;being&#160;redirected.<br/>
-u&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;setuid.<br/>
-w&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;writable&#160;(has&#160;write&#160;permission for the&#160;<br/>effective&#160;user).<br/>
-x&#160;<i>file</i><br/>
<i>file</i>&#160;exists&#160;and is&#160;executable&#160;(has&#160;execute/search&#160;<br/>permission for the&#160;effective&#160;user).<br/>
Here&#160;we&#160;have&#160;a&#160;script&#160;that&#160;demonstrates&#160;some&#160;of the&#160;file&#160;expressions:<br/>
#!/bin/bash&#160;<br/>
# test-file: Evaluate the status of a file&#160;<br/>
FILE=~/.bashrc&#160;<br/>
if [ -e &#34;$FILE&#34; ]; then&#160;<br/>
if [ -f &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is a regular file.&#34;&#160;<br/>
fi&#160;<br/>if [ -d &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is a directory.&#34;&#160;<br/>
fi&#160;<br/>if [ -r &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is readable.&#34;&#160;<br/>
fi&#160;<br/>if [ -w &#34;$FILE&#34; ]; then&#160;<br/>
397<br/>
<hr/>
<a name=422></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
echo &#34;$FILE is writable.&#34;&#160;<br/>
fi&#160;<br/>if [ -x &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is executable/searchable.&#34;&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;$FILE does not exist&#34;&#160;<br/>exit 1&#160;<br/>
fi&#160;<br/>
exit<br/>
The&#160;script&#160;evaluates&#160;the&#160;file&#160;assigned&#160;to&#160;the&#160;constant&#160;FILE&#160;and&#160;displays&#160;its&#160;results&#160;as&#160;the<br/>evaluation&#160;is&#160;performed.&#160;There&#160;are&#160;two&#160;interesting&#160;things&#160;to&#160;note&#160;about&#160;this&#160;script.&#160;First,<br/>notice&#160;how&#160;the&#160;parameter&#160;$FILE&#160;is&#160;quoted&#160;within&#160;the&#160;expressions.&#160;This&#160;is&#160;not&#160;required&#160;to<br/>syntactically&#160;complete&#160;the&#160;expression;&#160;rather&#160;it&#160;is&#160;a&#160;defense&#160;against&#160;the&#160;parameter&#160;being<br/>empty&#160;or containing only&#160;whitespace.&#160;If the&#160;parameter&#160;expansion of&#160;$FILE&#160;were&#160;to result<br/>in&#160;an&#160;empty&#160;value,&#160;it&#160;would&#160;cause&#160;an&#160;error&#160;(the&#160;operators&#160;would&#160;be&#160;interpreted&#160;as&#160;non-null<br/>strings&#160;rather&#160;than&#160;operators).&#160;Using&#160;the&#160;quotes&#160;around&#160;the&#160;parameter&#160;ensures&#160;that&#160;the&#160;op-<br/>erator&#160;is&#160;always&#160;followed&#160;by&#160;a&#160;string,&#160;even&#160;if&#160;the&#160;string&#160;is&#160;empty.&#160;Second,&#160;notice&#160;the&#160;pres-<br/>ence&#160;of&#160;the&#160;exit&#160;command&#160;near&#160;the&#160;end&#160;of&#160;the&#160;script.&#160;The&#160;exit&#160;command&#160;accepts&#160;a&#160;sin-<br/>gle,&#160;optional&#160;argument,&#160;which&#160;becomes&#160;the&#160;script’s&#160;exit&#160;status.&#160;When&#160;no&#160;argument&#160;is<br/>passed,&#160;the&#160;exit&#160;status&#160;defaults&#160;to&#160;the&#160;exit&#160;status&#160;of&#160;the&#160;last&#160;command&#160;executed.&#160;Using<br/>exit&#160;in&#160;this&#160;way&#160;allows&#160;the&#160;script&#160;to&#160;indicate&#160;failure&#160;if&#160;$FILE&#160;expands&#160;to&#160;the&#160;name&#160;of&#160;a<br/>nonexistent&#160;file.&#160;The&#160;exit&#160;command&#160;appearing&#160;on&#160;the&#160;last&#160;line&#160;of&#160;the&#160;script&#160;is&#160;there&#160;as&#160;a<br/>formality.&#160;When&#160;a&#160;script&#160;“runs&#160;off&#160;the&#160;end”&#160;(reaches&#160;end&#160;of&#160;file),&#160;it&#160;terminates&#160;with&#160;an&#160;exit<br/>status&#160;of the&#160;last&#160;command executed.<br/>Similarly,&#160;shell&#160;functions&#160;can&#160;return&#160;an&#160;exit&#160;status&#160;by&#160;including&#160;an&#160;integer&#160;argument&#160;to&#160;the<br/>return&#160;command.&#160;If&#160;we&#160;were&#160;to&#160;convert&#160;the&#160;previous&#160;script&#160;to&#160;a&#160;shell&#160;function&#160;to&#160;in-<br/>clude&#160;it&#160;in&#160;a&#160;larger&#160;program,&#160;we&#160;could&#160;replace&#160;the&#160;exit&#160;commands&#160;with&#160;return&#160;state-<br/>ments&#160;and&#160;get&#160;the&#160;desired behavior.<br/>
test_file () {<br/>
# test-file: Evaluate the status of a file&#160;<br/>
FILE=~/.bashrc&#160;<br/>
if [ -e &#34;$FILE&#34; ]; then&#160;<br/>
if [ -f &#34;$FILE&#34; ]; then&#160;<br/>
398<br/>
<hr/>
<a name=423></a>test<br/>
echo &#34;$FILE is a regular file.&#34;&#160;<br/>
fi&#160;<br/>if [ -d &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is a directory.&#34;&#160;<br/>
fi&#160;<br/>if [ -r &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is readable.&#34;&#160;<br/>
fi&#160;<br/>if [ -w &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is writable.&#34;&#160;<br/>
fi&#160;<br/>if [ -x &#34;$FILE&#34; ]; then&#160;<br/>
echo &#34;$FILE is executable/searchable.&#34;&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;$FILE does not exist&#34;&#160;<br/>return 1&#160;<br/>
fi&#160;<br/>
}<br/>
String&#160;Expressions<br/>Table&#160;27-2 lists&#160;the&#160;expressions&#160;used to&#160;evaluate&#160;strings:<br/>
<i>Table&#160;27-2:&#160;test&#160;String&#160;Expressions</i><br/>
<b>Expression</b><br/>
<b>Is&#160;True&#160;If...</b><br/>
<i>string</i><br/>
<i>string</i>&#160;is&#160;not&#160;null.<br/>
-n&#160;<i>string</i><br/>
The&#160;length of&#160;<i>string</i>&#160;is&#160;greater than&#160;zero.<br/>
-z&#160;<i>string</i><br/>
The&#160;length of&#160;<i>string</i>&#160;is&#160;zero.<br/>
<i>string1</i>&#160;=&#160;<i>string2</i><br/>
<i>string1</i>&#160;and&#160;<i>string2</i>&#160;are&#160;equal.&#160;Single&#160;or double&#160;<br/>
<i>string1 == string2</i><br/>
equal&#160;signs&#160;may&#160;be&#160;used.&#160;The&#160;use&#160;of double&#160;equal<br/>signs&#160;is&#160;supported&#160;by&#160;bash&#160;and is&#160;generally&#160;<br/>preferred,&#160;but&#160;it&#160;is&#160;not&#160;POSIX&#160;compliant.<br/>
<i>string1</i>&#160;!=&#160;<i>string2</i><br/>
<i>string1</i>&#160;and&#160;<i>string2</i>&#160;are&#160;not&#160;equal.<br/>
<i>string1</i>&#160;&gt;&#160;<i>string2</i><br/>
<i>string1</i>&#160;sorts&#160;after&#160;<i>string2</i>.<br/>
<i>string1</i>&#160;&lt;&#160;<i>string2</i><br/>
<i>string1</i>&#160;sorts&#160;before&#160;<i>string2</i>.<br/>
399<br/>
<hr/>
<a name=424></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
<b>Warning</b>:&#160;the&#160;&gt;&#160;and&#160;&lt;&#160;expression&#160;operators&#160;must&#160;be&#160;quoted&#160;(or&#160;escaped&#160;with&#160;a<br/>backslash)&#160;when&#160;used&#160;with&#160;test.&#160;If&#160;they&#160;are&#160;not,&#160;they&#160;will&#160;be&#160;interpreted&#160;by&#160;the<br/>shell&#160;as&#160;redirection&#160;operators,&#160;with&#160;potentially&#160;destructive&#160;results.&#160;Also&#160;note&#160;that<br/>while&#160;the&#160;bash&#160;documentation&#160;states&#160;that&#160;the&#160;sorting&#160;order&#160;conforms&#160;to&#160;the&#160;col-<br/>lation&#160;order&#160;&#160;of&#160;the&#160;current&#160;&#160;locale,&#160;it&#160;does&#160;not.&#160;&#160;ASCII&#160;&#160;(POSIX)&#160;order&#160;is&#160;used&#160;in<br/>versions&#160;of&#160;bash&#160;up to&#160;and including 4.0.&#160;This&#160;problem&#160;was&#160;fixed in&#160;version 4.1.<br/>
Here&#160;is&#160;a&#160;script&#160;that&#160;incorporates&#160;string expressions:<br/>
#!/bin/bash&#160;<br/>
# test-string: evaluate the value of a string&#160;<br/>
ANSWER=maybe&#160;<br/>
if [ -z &#34;$ANSWER&#34; ]; then&#160;<br/>
echo &#34;There is no answer.&#34; &gt;&amp;2<br/>exit 1&#160;<br/>
fi&#160;<br/>
if [ &#34;$ANSWER&#34; = &#34;yes&#34; ]; then&#160;<br/>
echo &#34;The answer is YES.&#34;&#160;<br/>
elif [ &#34;$ANSWER&#34; = &#34;no&#34; ]; then&#160;<br/>
echo &#34;The answer is NO.&#34;&#160;<br/>
elif [ &#34;$ANSWER&#34; = &#34;maybe&#34; ]; then&#160;<br/>
echo &#34;The answer is MAYBE.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;The answer is UNKNOWN.&#34;&#160;<br/>
fi<br/>
In&#160;this&#160;script,&#160;we&#160;evaluate&#160;the&#160;constant&#160;ANSWER.&#160;We&#160;first&#160;determine&#160;whether&#160;the&#160;string&#160;is<br/>empty.&#160;If&#160;it&#160;is,&#160;we&#160;terminate&#160;the&#160;script&#160;and&#160;set&#160;the&#160;exit&#160;status&#160;to&#160;1.&#160;Notice&#160;the&#160;redirection<br/>that&#160;is&#160;applied&#160;to&#160;the&#160;echo&#160;command.&#160;This&#160;redirects&#160;the&#160;error&#160;message&#160;“There&#160;is&#160;no&#160;an-<br/>swer.”&#160;to&#160;standard&#160;error,&#160;which&#160;is&#160;the&#160;proper&#160;thing&#160;to&#160;do&#160;with&#160;error&#160;messages.&#160;If&#160;the&#160;string<br/>is&#160;not&#160;empty,&#160;we&#160;evaluate&#160;the&#160;value&#160;of&#160;the&#160;string&#160;to&#160;see&#160;whether&#160;it&#160;is&#160;equal&#160;to&#160;either&#160;“yes,”<br/>“no,”&#160;or&#160;“maybe.”&#160;We&#160;do&#160;this&#160;by&#160;using&#160;&#160;elif,&#160;which&#160;is&#160;short&#160;for&#160;“else&#160;if.”&#160;By&#160;using<br/>elif, we&#160;are&#160;able&#160;to construct&#160;a&#160;more&#160;complex logical&#160;test.<br/>
Integer&#160;Expressions<br/>To&#160;compare&#160;values&#160;as&#160;integers&#160;rather&#160;than&#160;as&#160;strings,&#160;we&#160;can&#160;use&#160;the&#160;expressions&#160;listed&#160;in<br/>
400<br/>
<hr/>
<a name=425></a>test<br/>
Table&#160;27-3.<br/>
<i>Table&#160;27-3:&#160;test&#160;Integer&#160;Expressions</i><br/>
<b>Expression</b><br/>
<b>Is&#160;True&#160;If...</b><br/>
<i>integer1</i>&#160;-eq&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;equal&#160;to&#160;<i>integer2</i>.<br/>
<i>integer1</i>&#160;-ne&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;not&#160;equal&#160;to&#160;<i>integer2</i>.<br/>
<i>integer1</i>&#160;-le&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;less&#160;than or equal&#160;to&#160;<i>integer2</i>.<br/>
<i>integer1</i>&#160;-lt&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;less&#160;than&#160;<i>integer2</i>.<br/>
<i>integer1</i>&#160;-ge&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;greater&#160;than or equal&#160;to&#160;<i>integer2</i>.<br/>
<i>integer1</i>&#160;-gt&#160;<i>integer2</i><br/>
<i>integer1</i>&#160;is&#160;greater&#160;than&#160;<i>integer2</i>.<br/>
Here&#160;is&#160;a&#160;script&#160;that&#160;demonstrates&#160;them:<br/>
#!/bin/bash&#160;<br/>
# test-integer: evaluate the value of an integer.&#160;<br/>
INT=-5&#160;<br/>
if [ -z &#34;$INT&#34; ]; then&#160;<br/>
echo &#34;INT is empty.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi&#160;<br/>
if [ &#34;$INT&#34; -eq 0 ]; then&#160;<br/>
echo &#34;INT is zero.&#34;&#160;<br/>
else&#160;<br/>
if [ &#34;$INT&#34; -lt 0 ]; then&#160;<br/>
echo &#34;INT is negative.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is positive.&#34;&#160;<br/>
fi&#160;<br/>if [ $((INT % 2)) -eq 0 ]; then&#160;<br/>
echo &#34;INT is even.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is odd.&#34;&#160;<br/>
fi&#160;<br/>
fi<br/>
401<br/>
<hr/>
<a name=426></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
The&#160;interesting&#160;part&#160;of&#160;the&#160;script&#160;is&#160;how&#160;it&#160;determines&#160;whether&#160;an&#160;integer&#160;is&#160;even&#160;or&#160;odd.<br/>By&#160;performing&#160;a&#160;modulo&#160;2&#160;operation&#160;on&#160;the&#160;number,&#160;which&#160;divides&#160;the&#160;number&#160;by&#160;two<br/>and returns&#160;the&#160;remainder, it&#160;can&#160;tell&#160;whether the&#160;number&#160;is&#160;odd or even.<br/>
<b>A&#160;More&#160;Modern&#160;Version&#160;of&#160;test<br/></b>Modern&#160;versions&#160;of&#160;&#160;bash&#160;&#160;include&#160;a&#160;compound&#160;command&#160;that&#160;acts&#160;as&#160;an&#160;enhanced&#160;re-<br/>placement&#160;for&#160;test. It&#160;uses&#160;the&#160;following&#160;syntax:<br/>[[&#160;<i>expression</i>&#160;]]<br/>where,&#160;like&#160;test,&#160;<i>expression</i>&#160;is&#160;an&#160;expression&#160;that&#160;evaluates&#160;to&#160;either&#160;a&#160;true&#160;or&#160;false&#160;re-<br/>sult.&#160;The&#160;[[ ]]&#160;command is&#160;similar&#160;to&#160;test&#160;(it&#160;supports&#160;all&#160;of its&#160;expressions), but&#160;adds<br/>an important&#160;new&#160;string expression.<br/><i>string1</i>&#160;=~&#160;<i>regex<br/></i>This&#160;returns&#160;true&#160;if&#160;&#160;<i>string1</i>&#160;&#160;is&#160;matched&#160;by&#160;the&#160;extended&#160;&#160;regular&#160;expression&#160;&#160;<i>regex</i>.&#160;This<br/>opens&#160;up&#160;a&#160;lot&#160;of&#160;possibilities&#160;for&#160;performing&#160;such&#160;tasks&#160;as&#160;data&#160;validation.&#160;In&#160;our&#160;earlier<br/>example&#160;of&#160;the&#160;integer&#160;expressions,&#160;the&#160;script&#160;would&#160;fail&#160;if&#160;the&#160;constant&#160;&#160;INT&#160;contained<br/>anything&#160;except&#160;an&#160;integer.&#160;The&#160;script&#160;needs&#160;a&#160;way&#160;to&#160;verify&#160;that&#160;the&#160;constant&#160;contains&#160;an<br/>integer.&#160;Using&#160;&#160;[[&#160;]]&#160;&#160;with&#160;the&#160;&#160;=~&#160;&#160;string&#160;expression&#160;operator,&#160;we&#160;could&#160;improve&#160;the<br/>script&#160;this&#160;way:<br/>
#!/bin/bash&#160;<br/>
# test-integer2: evaluate the value of an integer.&#160;<br/>
INT=-5&#160;<br/>
<b>if [[ &#34;$INT&#34; =~ ^-?[0-9]+$ ]]; then</b>&#160;<br/>
if [ &#34;$INT&#34; -eq 0 ]; then&#160;<br/>
echo &#34;INT is zero.&#34;&#160;<br/>
else&#160;<br/>
if [ &#34;$INT&#34; -lt 0 ]; then&#160;<br/>
echo &#34;INT is negative.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is positive.&#34;&#160;<br/>
fi&#160;<br/>if [ $((INT % 2)) -eq 0 ]; then&#160;<br/>
echo &#34;INT is even.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is odd.&#34;&#160;<br/>
fi&#160;<br/>
402<br/>
<hr/>
<a name=427></a>A&#160;More&#160;Modern&#160;Version&#160;of test<br/>
fi&#160;<br/>
<b>else&#160;</b><br/>
<b>echo &#34;INT is not an integer.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;</b><br/>
<b>fi</b><br/>
By&#160;applying&#160;the&#160;regular&#160;expression,&#160;we&#160;are&#160;able&#160;to&#160;limit&#160;the&#160;value&#160;of&#160;INT&#160;to&#160;only&#160;strings<br/>that&#160;begin&#160;with&#160;an&#160;optional&#160;minus&#160;sign,&#160;followed&#160;by&#160;one&#160;or&#160;more&#160;numerals.&#160;This&#160;expres-<br/>sion also eliminates&#160;the&#160;possibility&#160;of empty&#160;values.<br/>Another&#160;added&#160;feature&#160;of&#160;[[&#160;]]&#160;is&#160;that&#160;the&#160;==&#160;operator&#160;supports&#160;pattern&#160;matching&#160;the<br/>same&#160;way pathname&#160;expansion does. Here’s&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>FILE=foo.bar</b>&#160;<br/>[me@linuxbox ~]$&#160;<b>if [[ $FILE == foo.* ]]; then</b>&#160;<br/>&gt;&#160;<b>echo &#34;$FILE matches pattern 'foo.*'&#34;&#160;<br/></b>&gt;&#160;<b>fi&#160;<br/></b>foo.bar matches pattern 'foo.*'<br/>
This&#160;makes&#160;[[ ]]&#160;useful&#160;for evaluating&#160;file&#160;and pathnames.<br/>
<b>(( ))&#160;-&#160;Designed&#160;for&#160;Integers<br/></b>In&#160;addition&#160;to&#160;the&#160;&#160;[[&#160;]]&#160;&#160;compound&#160;command,&#160;&#160;bash&#160;&#160;also&#160;provides&#160;the&#160;&#160;((&#160;))&#160;&#160;com-<br/>pound&#160;command,&#160;which&#160;is&#160;useful&#160;for&#160;operating&#160;on&#160;integers.&#160;It&#160;supports&#160;a&#160;full&#160;set&#160;of&#160;arith-<br/>metic&#160;evaluations, a&#160;subject&#160;we&#160;will&#160;cover&#160;fully&#160;in Chapter&#160;34, “Strings&#160;and Numbers.”<br/>
((&#160;))&#160;is&#160;used&#160;to&#160;perform&#160;<i>arithmetic&#160;truth&#160;tests</i>.&#160;An&#160;arithmetic&#160;truth&#160;test&#160;results&#160;in&#160;true&#160;if<br/>the&#160;result&#160;of the&#160;arithmetic&#160;evaluation&#160;is&#160;non-zero.<br/>
[me@linuxbox ~]$&#160;<b>if ((1)); then echo &#34;It is true.&#34;; fi&#160;<br/></b>It is true.<br/>[me@linuxbox ~]$&#160;<b>if ((0)); then echo &#34;It is true.&#34;; fi<br/></b>[me@linuxbox ~]$&#160;<br/>
Using&#160;(( )), we&#160;can&#160;slightly&#160;simplify&#160;the&#160;test-integer2&#160;script&#160;like&#160;this:<br/>
#!/bin/bash&#160;<br/>
403<br/>
<hr/>
<a name=428></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
# test-integer2a: evaluate the value of an integer.&#160;<br/>
INT=-5&#160;<br/>
if [[ &#34;$INT&#34; =~ ^-?[0-9]+$ ]]; then&#160;<br/>
if&#160;<b>((INT == 0))</b>; then&#160;<br/>
echo &#34;INT is zero.&#34;&#160;<br/>
else&#160;<br/>
if&#160;<b>((INT &lt; 0))</b>; then&#160;<br/>
echo &#34;INT is negative.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is positive.&#34;&#160;<br/>
fi&#160;<br/>if&#160;<b>(( ((INT % 2)) == 0))</b>; then&#160;<br/>
echo &#34;INT is even.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is odd.&#34;&#160;<br/>
fi&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;INT is not an integer.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
Notice&#160;that&#160;we&#160;use&#160;less-than&#160;and&#160;greater-than&#160;signs&#160;and&#160;that&#160;==&#160;is&#160;used&#160;to&#160;test&#160;for&#160;equiva-<br/>lence.&#160;This&#160;is&#160;a&#160;more&#160;natural-looking&#160;syntax&#160;for&#160;working&#160;with&#160;integers.&#160;Notice&#160;too,&#160;that<br/>because&#160;the&#160;compound&#160;command&#160;((&#160;))&#160;is&#160;part&#160;of&#160;the&#160;shell&#160;syntax&#160;rather&#160;than&#160;an&#160;ordi-<br/>nary&#160;command,&#160;and&#160;it&#160;deals&#160;only&#160;with&#160;integers,&#160;it&#160;is&#160;able&#160;to&#160;recognize&#160;variables&#160;by&#160;name<br/>and&#160;does&#160;not&#160;require&#160;expansion&#160;to&#160;be&#160;performed.&#160;We’ll&#160;discuss&#160;&#160;((&#160;))&#160;&#160;and&#160;the&#160;related<br/>arithmetic&#160;expansion&#160;further in&#160;Chapter 34.<br/>
<b>Combining&#160;Expressions<br/></b>It’s&#160;also&#160;possible&#160;to&#160;combine&#160;expressions&#160;to&#160;create&#160;more&#160;complex&#160;evaluations.&#160;Expres-<br/>sions&#160;are&#160;combined&#160;by&#160;using&#160;logical&#160;operators.&#160;We&#160;saw&#160;these&#160;in&#160;Chapter&#160;17,&#160;“Searching<br/>for&#160;Files,”&#160;when&#160;we&#160;learned&#160;about&#160;the&#160;find&#160;command.&#160;There&#160;are&#160;three&#160;logical&#160;operations<br/>for&#160;test&#160;and&#160;[[&#160;]].&#160;They&#160;are&#160;AND,&#160;OR&#160;and&#160;NOT.&#160;test&#160;and&#160;[[&#160;]]&#160;use&#160;different&#160;op-<br/>erators&#160;to&#160;represent&#160;these&#160;operations&#160;:<br/>
<i>Table&#160;27-4: Logical&#160;Operators</i><br/>
<b>Operation</b><br/>
<b>test</b><br/>
<b>[[ ]]&#160;and&#160;(( ))</b><br/>
404<br/>
<hr/>
<a name=429></a>Combining Expressions<br/>
AND<br/>
-a<br/>
&amp;&amp;<br/>
OR<br/>
-o<br/>
||<br/>
NOT<br/>
!<br/>
!<br/>
Here’s&#160;an&#160;example&#160;of&#160;an&#160;AND&#160;operation.&#160;The&#160;following&#160;script&#160;determines&#160;whether&#160;an&#160;in-<br/>teger&#160;is&#160;within a&#160;range&#160;of values:<br/>
#!/bin/bash&#160;<br/>
# test-integer3: determine if an integer is within a&#160;<br/># specified range of values.&#160;<br/>
MIN_VAL=1<br/>MAX_VAL=100&#160;<br/>
INT=50&#160;<br/>
if [[ &#34;$INT&#34; =~ ^-?[0-9]+$ ]]; then&#160;<br/>
if [[ &#34;$INT&#34; -ge &#34;$MIN_VAL&#34; &amp;&amp; &#34;$INT&#34; -le &#34;$MAX_VAL&#34; ]]; then&#160;<br/>
echo &#34;$INT is within $MIN_VAL to $MAX_VAL.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$INT is out of range.&#34;&#160;<br/>
fi&#160;<br/>
else&#160;<br/>&#160; &#160; &#160; &#160; echo &#34;INT is not an integer.&#34; &gt;&amp;2&#160;<br/>&#160; &#160; &#160; &#160; exit 1&#160;<br/>fi<br/>
In&#160;this&#160;script,&#160;we&#160;determine&#160;whether&#160;the&#160;value&#160;of&#160;integer&#160;INT&#160;lies&#160;between&#160;the&#160;values&#160;of<br/>MIN_VAL&#160;and&#160;MAX_VAL.&#160;This&#160;is&#160;performed&#160;by&#160;a&#160;single&#160;use&#160;of&#160;[[&#160;]],&#160;which&#160;includes<br/>two&#160;expressions&#160;separated&#160;&#160;by&#160;the&#160;&#160;&amp;&amp;&#160;&#160;operator.&#160;We&#160;could&#160;have&#160;also&#160;coded&#160;this&#160;using<br/>test:<br/>
&#160;<br/>
if&#160;<b>[</b>&#160;&#34;$INT&#34; -ge &#34;$MIN_VAL&#34;&#160;<b>-a</b>&#160;&#34;$INT&#34; -le &#34;$MAX_VAL&#34;&#160;<b>]</b>; then&#160;<br/>
echo &#34;$INT is within $MIN_VAL to $MAX_VAL.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$INT is out of range.&#34;&#160;<br/>
fi<br/>
405<br/>
<hr/>
<a name=430></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
The&#160;!&#160;negation&#160;operator&#160;reverses&#160;the&#160;outcome&#160;of&#160;an&#160;expression.&#160;It&#160;returns&#160;true&#160;if&#160;an&#160;ex-<br/>pression&#160;is&#160;false,&#160;and&#160;it&#160;returns&#160;false&#160;if&#160;an&#160;expression&#160;is&#160;true.&#160;In&#160;the&#160;following&#160;script,&#160;we<br/>modify&#160;the&#160;logic&#160;of&#160;our&#160;evaluation&#160;to&#160;find&#160;values&#160;of&#160;&#160;INT&#160;that&#160;are&#160;outside&#160;the&#160;specified<br/>range:<br/>
#!/bin/bash&#160;<br/>
# test-integer4: determine if an integer is outside a&#160;<br/># specified range of values.&#160;<br/>
MIN_VAL=1&#160;<br/>MAX_VAL=100&#160;<br/>
INT=50&#160;<br/>
if [[ &#34;$INT&#34; =~ ^-?[0-9]+$ ]]; then&#160;<br/>
if [[ ! (&#34;$INT&#34; -ge &#34;$MIN_VAL&#34; &amp;&amp; &#34;$INT&#34; -le &#34;$MAX_VAL&#34;) ]]; then<br/>
echo &#34;$INT is outside $MIN_VAL to $MAX_VAL.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$INT is in range.&#34;&#160;<br/>
fi&#160;<br/>
else&#160;<br/>&#160; &#160; &#160; &#160; echo &#34;INT is not an integer.&#34; &gt;&amp;2&#160;<br/>&#160; &#160; &#160; &#160; exit 1&#160;<br/>fi<br/>
We&#160;also&#160;include&#160;parentheses&#160;around&#160;the&#160;expression,&#160;for&#160;grouping.&#160;If&#160;these&#160;were&#160;not&#160;in-<br/>cluded,&#160;the&#160;negation&#160;would&#160;only&#160;apply&#160;to&#160;the&#160;first&#160;expression&#160;and&#160;not&#160;the&#160;combination&#160;of<br/>the&#160;two. Coding&#160;this&#160;with&#160;test&#160;would be&#160;done&#160;this&#160;way:<br/>
if [ ! \( &#34;$INT&#34; -ge &#34;$MIN_VAL&#34; -a &#34;$INT&#34; -le &#34;$MAX_VAL&#34; \) ];&#160;<br/>
then&#160;<br/>
echo &#34;$INT is outside $MIN_VAL to $MAX_VAL.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$INT is in range.&#34;&#160;<br/>
fi<br/>
Since&#160;all&#160;expressions&#160;and&#160;operators&#160;used&#160;by&#160;test&#160;are&#160;treated&#160;as&#160;command&#160;arguments&#160;by<br/>the&#160;shell&#160;(unlike&#160;&#160;[[&#160;]]&#160;and&#160;((&#160;))&#160;),&#160;characters&#160;that&#160;have&#160;special&#160;meaning&#160;to&#160;bash,<br/>such&#160;as&#160;&lt;,&#160;&gt;,&#160;(, and&#160;), must&#160;be&#160;quoted or escaped.<br/>
406<br/>
<hr/>
<a name=431></a>Combining Expressions<br/>
Seeing&#160;that&#160;test&#160;and&#160;[[&#160;]]&#160;do&#160;roughly&#160;the&#160;same&#160;thing,&#160;which&#160;is&#160;preferable?&#160;test&#160;is<br/>traditional&#160;(and&#160;part&#160;of&#160;the&#160;POSIX&#160;specification&#160;for&#160;standard&#160;shells,&#160;which&#160;are&#160;often&#160;used<br/>to&#160;run&#160;system&#160;startup&#160;scripts),&#160;whereas&#160;[[&#160;]]&#160;is&#160;specific&#160;to&#160;bash&#160;(and&#160;a&#160;few&#160;other&#160;mod-<br/>ern&#160;shells).&#160;It’s&#160;important&#160;to&#160;know&#160;how&#160;to&#160;use&#160;test&#160;since&#160;it&#160;is&#160;widely&#160;used,&#160;but&#160;[[&#160;]]&#160;is<br/>clearly more&#160;useful&#160;and is&#160;easier to code,&#160;so it&#160;is&#160;preferred&#160;for modern&#160;scripts.<br/>
<b>Portability&#160;is&#160;the&#160;Hobgoblin&#160;of&#160;Little&#160;Minds</b><br/>
If&#160;you&#160;talk&#160;to&#160;“real”&#160;Unix&#160;people,&#160;you&#160;quickly&#160;discover&#160;that&#160;many&#160;of&#160;them&#160;don’t<br/>like&#160;Linux&#160;very&#160;much.&#160;They&#160;regard&#160;it&#160;as&#160;impure&#160;and&#160;unclean.&#160;One&#160;tenet&#160;of&#160;Unix<br/>users&#160;is&#160;that&#160;everything&#160;should&#160;be&#160;“portable.”&#160;This&#160;means&#160;that&#160;any&#160;script&#160;you&#160;write<br/>should&#160;be&#160;able&#160;to run, unchanged,&#160;on any Unix-like&#160;system.<br/>Unix&#160;people&#160;have&#160;good&#160;reason&#160;to&#160;believe&#160;this.&#160;Having&#160;seen&#160;what&#160;proprietary&#160;ex-<br/>tensions&#160;to&#160;commands&#160;and&#160;shells&#160;did&#160;to&#160;the&#160;Unix&#160;world&#160;before&#160;POSIX,&#160;they&#160;are<br/>naturally wary of the&#160;effect&#160;of Linux on their beloved OS.<br/>But&#160;portability&#160;has&#160;a&#160;serious&#160;downside.&#160;It&#160;prevents&#160;progress.&#160;It&#160;requires&#160;that&#160;things<br/>are&#160;always&#160;done&#160;using&#160;“lowest&#160;common&#160;denominator”&#160;techniques.&#160;In&#160;the&#160;case&#160;of<br/>shell&#160;programming,&#160;it&#160;means&#160;making&#160;everything&#160;compatible&#160;with&#160;sh,&#160;the&#160;original<br/>Bourne&#160;shell.<br/>This&#160;downside&#160;is&#160;the&#160;excuse&#160;that&#160;proprietary&#160;software&#160;vendors&#160;use&#160;to&#160;justify&#160;their<br/>proprietary&#160;extensions,&#160;only&#160;they&#160;call&#160;them&#160;“innovations.”&#160;But&#160;they&#160;are&#160;really&#160;just<br/>lock-in&#160;devices&#160;for their customers.<br/>The&#160;GNU&#160;tools,&#160;such&#160;as&#160;bash,&#160;have&#160;no&#160;such&#160;restrictions.&#160;They&#160;encourage&#160;porta-<br/>bility&#160;by&#160;supporting&#160;standards&#160;and&#160;by&#160;being&#160;universally&#160;available.&#160;You&#160;can&#160;install<br/>bash&#160;&#160;and&#160;the&#160;other&#160;GNU&#160;tools&#160;on&#160;almost&#160;any&#160;kind&#160;of&#160;system,&#160;even&#160;Windows,<br/>without&#160;cost.&#160;So feel&#160;free&#160;to use&#160;all&#160;the&#160;features&#160;of&#160;bash. It’s&#160;<i>really</i>&#160;portable.<br/>
<b>Control&#160;Operators:&#160;Another&#160;Way&#160;to&#160;Branch<br/></b>bash&#160;provides&#160;two&#160;control&#160;operators&#160;that&#160;can&#160;perform&#160;branching.&#160;The&#160;&amp;&amp;&#160;(AND)&#160;and&#160;||<br/>(OR)&#160;operators&#160;work&#160;like&#160;the&#160;logical&#160;operators&#160;in&#160;the&#160;[[&#160;]]&#160;compound&#160;command.&#160;Here<br/>is&#160;the&#160;syntax&#160;for&#160;&amp;&amp;:<br/><i>command1</i>&#160;&amp;&amp;&#160;<i>command2<br/></i>and here&#160;is&#160;the&#160;syntax for&#160;||:<br/><i>command1</i>&#160;||&#160;<i>command2<br/></i>It&#160;is&#160;important&#160;to&#160;understand&#160;the&#160;behavior&#160;of&#160;these.&#160;With&#160;the&#160;&amp;&amp;&#160;operator,&#160;<i>command1</i>&#160;is<br/>
407<br/>
<hr/>
<a name=432></a>27 – Flow&#160;Control:&#160;Branching with&#160;if<br/>
executed&#160;and&#160;<i>command2</i>&#160;is&#160;executed&#160;if,&#160;<i>and&#160;only&#160;if</i>,&#160;<i>command1</i>&#160;is&#160;successful.&#160;With&#160;the&#160;||<br/>operator,&#160;<i>command1</i>&#160;is&#160;executed&#160;and&#160;<i>command2</i>&#160;is&#160;executed&#160;if,&#160;<i>and&#160;only&#160;if</i>,&#160;<i>command1</i>&#160;is<br/>unsuccessful.<br/>In practical&#160;terms, it&#160;means&#160;that&#160;we&#160;can&#160;do something&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>mkdir temp &amp;&amp; cd temp</b><br/>
This&#160;will&#160;create&#160;a&#160;directory&#160;named&#160;temp, and&#160;if it&#160;succeeds, the&#160;current&#160;working directory<br/>will&#160;be&#160;changed&#160;to&#160;&#160;temp.&#160;The&#160;second&#160;command&#160;is&#160;attempted&#160;only&#160;if&#160;the&#160;&#160;mkdir&#160;&#160;com-<br/>mand is&#160;successful. Likewise, a&#160;command&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>[[ -d temp ]] || mkdir temp</b><br/>
will&#160;test&#160;for&#160;the&#160;existence&#160;of&#160;the&#160;directory&#160;temp,&#160;and&#160;only&#160;if&#160;the&#160;test&#160;fails&#160;will&#160;the&#160;direc-<br/>tory&#160;be&#160;created.&#160;This&#160;type&#160;of&#160;construct&#160;is&#160;handy&#160;for&#160;handling&#160;errors&#160;in&#160;scripts,&#160;a&#160;subject&#160;we<br/>will&#160;discuss&#160;more&#160;in later chapters. For example, we&#160;could&#160;do this&#160;in a&#160;script:<br/>
[ -d temp ] || exit 1<br/>
If&#160;the&#160;script&#160;requires&#160;the&#160;directory&#160;temp&#160;and&#160;it&#160;does&#160;not&#160;exist,&#160;then&#160;the&#160;script&#160;will&#160;termi-<br/>nate&#160;with an exit&#160;status&#160;of 1.<br/>
<b>Summing&#160;Up<br/></b>We&#160;started&#160;this&#160;chapter&#160;with&#160;a&#160;question.&#160;How&#160;could&#160;we&#160;make&#160;our&#160;&#160;sys_info_page<br/>script&#160;detect&#160;whether&#160;the&#160;user&#160;had&#160;permission&#160;to&#160;read&#160;all&#160;the&#160;home&#160;directories?&#160;With&#160;our<br/>knowledge&#160;&#160;&#160;of&#160;&#160;if,&#160;&#160;&#160;we&#160;&#160;&#160;can&#160;&#160;&#160;solve&#160;&#160;&#160;the&#160;&#160;&#160;problem&#160;&#160;&#160;by&#160;&#160;&#160;adding&#160;&#160;&#160;this&#160;&#160;&#160;code&#160;&#160;&#160;to&#160;&#160;&#160;the<br/>report_home_space&#160;function:<br/>
report_home_space () {&#160;<br/>
<b>if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;</b><br/>
<b>cat &lt;&lt;- _EOF_&#160;</b><br/>
<b>&lt;h2&gt;Home Space Utilization (All Users)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh /home/*)&lt;/pre&gt;&#160;<br/>_EOF_&#160;</b><br/>
<b>else&#160;</b><br/>
<b>cat &lt;&lt;- _EOF_&#160;</b><br/>
408<br/>
<hr/>
<a name=433></a>Summing&#160;Up<br/>
<b>&lt;h2&gt;Home Space Utilization ($USER)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh $HOME)&lt;/pre&gt;&#160;<br/>_EOF_&#160;</b><br/>
<b>fi&#160;<br/>return</b>&#160;<br/>
}<br/>
We&#160;evaluate&#160;the&#160;output&#160;of&#160;the&#160;id&#160;command.&#160;With&#160;the&#160;-u&#160;option,&#160;id&#160;outputs&#160;the&#160;numeric<br/>user&#160;ID&#160;number&#160;of&#160;the&#160;effective&#160;user.&#160;The&#160;superuser&#160;is&#160;always&#160;ID&#160;zero&#160;and&#160;every&#160;other<br/>user&#160;is&#160;a&#160;number&#160;greater&#160;than&#160;zero.&#160;Knowing&#160;this,&#160;we&#160;can&#160;construct&#160;two&#160;different&#160;here<br/>documents,&#160;one&#160;taking&#160;advantage&#160;of&#160;superuser&#160;privileges,&#160;and&#160;the&#160;other&#160;restricted&#160;to&#160;the<br/>user’s&#160;own home&#160;directory.<br/>We&#160;are&#160;going&#160;to&#160;take&#160;a&#160;break&#160;from&#160;the&#160;sys_info_page&#160;program,&#160;but&#160;don’t&#160;worry.&#160;It<br/>will&#160;be&#160;back.&#160;In&#160;the&#160;meantime,&#160;we’ll&#160;cover&#160;some&#160;topics&#160;that&#160;we’ll&#160;need&#160;when&#160;we&#160;resume<br/>our work.<br/>
<b>Further&#160;Reading<br/></b>There&#160;are&#160;several&#160;sections&#160;of&#160;the&#160;bash&#160;man&#160;page&#160;that&#160;provide&#160;further&#160;detail&#160;on&#160;the&#160;topics<br/>covered&#160;in this&#160;chapter:<br/>
●<br/>
Lists&#160;(covers&#160;the&#160;control&#160;operators&#160;||&#160;and&#160;&amp;&amp;)<br/>
●<br/>
Compound Commands&#160;(covers&#160;[[ ]],&#160;(( ))&#160;and&#160;if)<br/>
●<br/>
CONDITIONAL&#160;EXPRESSIONS<br/>
●<br/>
SHELL&#160;BUILTIN&#160;COMMANDS&#160;(covers&#160;test)<br/>
Further, the&#160;Wikipedia&#160;has&#160;a&#160;good article&#160;on the&#160;concept&#160;of pseudocode:<br/><a href="http://en.wikipedia.org/wiki/Pseudocode">http://en.wikipedia.org/wiki/Pseudocode</a><br/>
409<br/>
<hr/>
<a name=434></a>28 – Reading&#160;Keyboard Input<br/>
<i><b>28&#160;–&#160;Reading&#160;Keyboard&#160;Input</b></i><br/>
The&#160;scripts&#160;we&#160;have&#160;written&#160;so&#160;far&#160;lack&#160;a&#160;feature&#160;common&#160;in&#160;most&#160;computer&#160;programs — <br/><i>interactivity,&#160;t</i>hat&#160;is,&#160;the&#160;ability&#160;of&#160;the&#160;program&#160;to&#160;interact&#160;with&#160;the&#160;user.&#160;While&#160;many&#160;pro-<br/>grams&#160;don’t&#160;need&#160;to be&#160;interactive,&#160;some&#160;programs&#160;benefit&#160;from&#160;being able&#160;to accept&#160;input<br/>directly from&#160;the&#160;user.&#160;Take,&#160;for example, this&#160;script&#160;from&#160;the&#160;previous&#160;chapter:<br/>
#!/bin/bash&#160;<br/>
# test-integer2: evaluate the value of an integer.&#160;<br/>
INT=-5&#160;<br/>
if [[ &#34;$INT&#34; =~ ^-?[0-9]+$ ]]; then&#160;<br/>
if [ &#34;$INT&#34; -eq 0 ]; then&#160;<br/>
echo &#34;INT is zero.&#34;&#160;<br/>
else&#160;<br/>
if [ &#34;$INT&#34; -lt 0 ]; then&#160;<br/>
echo &#34;INT is negative.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is positive.&#34;&#160;<br/>
fi&#160;<br/>if [ $((INT % 2)) -eq 0 ]; then&#160;<br/>
echo &#34;INT is even.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;INT is odd.&#34;&#160;<br/>
fi&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;INT is not an integer.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
Each&#160;time&#160;we&#160;want&#160;to&#160;change&#160;the&#160;value&#160;of&#160;INT,&#160;we&#160;have&#160;to&#160;edit&#160;the&#160;script.&#160;It&#160;would&#160;be<br/>much&#160;more&#160;useful&#160;if&#160;the&#160;script&#160;could&#160;ask&#160;the&#160;user&#160;for&#160;a&#160;value.&#160;In&#160;this&#160;chapter,&#160;we&#160;will&#160;be-<br/>
410<br/>
<hr/>
<a name=435></a>28 – Reading&#160;Keyboard Input<br/>
gin to look&#160;at&#160;how&#160;we&#160;can add&#160;interactivity to&#160;our programs.<br/>
<b>read&#160;–&#160;Read&#160;Values&#160;from&#160;Standard&#160;Input<br/></b>The&#160;read&#160;builtin&#160;command&#160;is&#160;used&#160;to&#160;read&#160;a&#160;single&#160;line&#160;of&#160;standard&#160;input.&#160;This&#160;command<br/>can&#160;be&#160;used&#160;to&#160;read&#160;keyboard&#160;input&#160;or,&#160;when&#160;redirection&#160;is&#160;employed,&#160;a&#160;line&#160;of data&#160;from&#160;a<br/>file.&#160;The&#160;command has&#160;the&#160;following syntax:<br/>read [-<i>options</i>] [<i>variable</i>...]<br/>where&#160;<i>options</i>&#160;is&#160;one&#160;or&#160;more&#160;of&#160;the&#160;available&#160;options&#160;listed&#160;later&#160;in&#160;Table&#160;28-1&#160;and&#160;<i>vari-<br/>able</i>&#160;&#160;is&#160;the&#160;name&#160;of&#160;one&#160;or&#160;more&#160;variables&#160;used&#160;to&#160;hold&#160;the&#160;input&#160;value.&#160;If&#160;no&#160;variable<br/>name&#160;is&#160;supplied, the&#160;shell&#160;variable&#160;REPLY&#160;contains&#160;the&#160;line&#160;of data.<br/>Basically,&#160;read&#160;assigns&#160;fields&#160;from&#160;standard&#160;input&#160;to&#160;the&#160;specified&#160;variables.&#160;If&#160;we&#160;mod-<br/>ify our integer evaluation script&#160;to use&#160;read, it&#160;might&#160;look&#160;like&#160;this:<br/>
#!/bin/bash&#160;<br/>
# read-integer: evaluate the value of an integer.&#160;<br/>
<b>echo -n &#34;Please enter an integer -&gt; &#34;&#160;<br/>read int</b>&#160;<br/>
if [[ &#34;$int&#34; =~ ^-?[0-9]+$ ]]; then&#160;<br/>
if [ &#34;$int&#34; -eq 0 ]; then&#160;<br/>
echo &#34;$int is zero.&#34;&#160;<br/>
else&#160;<br/>
if [ &#34;$int&#34; -lt 0 ]; then&#160;<br/>
echo &#34;$int is negative.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$int is positive.&#34;&#160;<br/>
fi&#160;<br/>if [ $((int % 2)) -eq 0 ]; then&#160;<br/>
echo &#34;$int is even.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$int is odd.&#34;&#160;<br/>
fi&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;Input value is not an integer.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
411<br/>
<hr/>
<a name=436></a>28 – Reading&#160;Keyboard Input<br/>
We&#160;use&#160;&#160;echo&#160;with&#160;the&#160;&#160;-n&#160;option&#160;(which&#160;suppresses&#160;the&#160;trailing&#160;newline&#160;on&#160;output)&#160;to<br/>display&#160;a&#160;prompt,&#160;and&#160;then&#160;we&#160;use&#160;read&#160;to&#160;input&#160;a&#160;value&#160;for&#160;the&#160;variable&#160;int.&#160;Running<br/>this&#160;script&#160;results&#160;in this:<br/>
[me@linuxbox ~]$&#160;<b>read-integer&#160;<br/></b>Please enter an integer -&gt;&#160;<b>5</b>&#160;<br/>5 is positive.&#160;<br/>5 is odd.<br/>
read&#160;can assign input&#160;to multiple&#160;variables, as&#160;shown in&#160;this&#160;script:<br/>
#!/bin/bash&#160;<br/>
# read-multiple: read multiple values from keyboard&#160;<br/>
echo -n &#34;Enter one or more values &gt; &#34;&#160;<br/>read var1 var2 var3 var4 var5&#160;<br/>
echo &#34;var1 = '$var1'&#34;&#160;<br/>echo &#34;var2 = '$var2'&#34;&#160;<br/>echo &#34;var3 = '$var3'&#34;&#160;<br/>echo &#34;var4 = '$var4'&#34;&#160;<br/>echo &#34;var5 = '$var5'&#34;<br/>
In&#160;this&#160;script,&#160;we&#160;assign&#160;and&#160;display&#160;up&#160;to&#160;five&#160;values.&#160;Notice&#160;how&#160;read&#160;behaves&#160;when<br/>given different&#160;numbers&#160;of values, shown here:<br/>
[me@linuxbox ~]$&#160;<b>read-multiple</b>&#160;<br/>Enter one or more values &gt;&#160;<b>a b c d e</b>&#160;<br/>var1 = 'a'&#160;<br/>var2 = 'b'&#160;<br/>var3 = 'c'&#160;<br/>var4 = 'd'&#160;<br/>var5 = 'e'&#160;<br/>[me@linuxbox ~]$&#160;<b>read-multiple</b>&#160;<br/>Enter one or more values &gt;&#160;<b>a</b>&#160;<br/>var1 = 'a'&#160;<br/>var2 = ''&#160;<br/>var3 = ''&#160;<br/>var4 = ''&#160;<br/>
412<br/>
<hr/>
<a name=437></a>read&#160;– Read&#160;Values&#160;from&#160;Standard&#160;Input<br/>
var5 = ''&#160;<br/>[me@linuxbox ~]$&#160;<b>read-multiple</b>&#160;<br/>Enter one or more values &gt;&#160;<b>a b c d e f g</b>&#160;<br/>var1 = 'a'&#160;<br/>var2 = 'b'&#160;<br/>var3 = 'c'&#160;<br/>var4 = 'd'&#160;<br/>var5 = 'e f g'<br/>
If&#160;read&#160;receives&#160;fewer&#160;than&#160;the&#160;expected&#160;number,&#160;the&#160;extra&#160;variables&#160;are&#160;empty,&#160;while&#160;an<br/>excessive&#160;amount&#160;of input&#160;results&#160;in&#160;the&#160;final&#160;variable&#160;containing all&#160;of the&#160;extra&#160;input.<br/>If&#160;no&#160;variables&#160;are&#160;listed&#160;after&#160;the&#160;read&#160;command,&#160;a&#160;shell&#160;variable,&#160;REPLY,&#160;will&#160;be&#160;as-<br/>signed all&#160;the&#160;input.<br/>
#!/bin/bash&#160;<br/>
# read-single: read multiple values into default variable<br/>
echo -n &#34;Enter one or more values &gt; &#34;&#160;<br/>read&#160;<br/>
echo &#34;REPLY = '$REPLY'&#34;<br/>
Running this&#160;script&#160;results&#160;in&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>read-single&#160;<br/></b>Enter one or more values &gt;&#160;<b>a b c d&#160;<br/></b>REPLY = 'a b c d'<br/>
Options<br/>read&#160;supports&#160;the&#160;options&#160;described in&#160;Table&#160;28-1.<br/>
<i>Table&#160;28-1:&#160;read&#160;Options</i><br/>
<b>Option</b><br/>
<b>Description</b><br/>
-a&#160;<i>array</i><br/>
Assign&#160;the&#160;input&#160;to&#160;<i>array</i>, starting&#160;with index&#160;zero.&#160;We&#160;<br/>will&#160;cover&#160;arrays&#160;in&#160;Chapter&#160;35.<br/>
413<br/>
<hr/>
<a name=438></a>28 – Reading&#160;Keyboard Input<br/>
-d&#160;<i>delimiter</i><br/>
The&#160;first&#160;character&#160;in the&#160;string&#160;<i>delimiter</i>&#160;is&#160;used to&#160;<br/>indicate&#160;the&#160;end of input,&#160;rather than&#160;a&#160;newline&#160;character.<br/>
-e<br/>
Use&#160;Readline&#160;to&#160;handle&#160;input.&#160;This&#160;permits&#160;input&#160;editing&#160;<br/>in&#160;the&#160;same&#160;manner&#160;as&#160;the&#160;command line.<br/>
-i&#160;<i>string</i><br/>
Use&#160;<i>string</i>&#160;as&#160;a&#160;default&#160;reply&#160;if the&#160;user&#160;simply presses&#160;<br/>Enter.&#160;Requires&#160;the&#160;-e&#160;option.<br/>
-n&#160;<i>num</i><br/>
Read&#160;<i>num</i>&#160;characters&#160;of input, rather than&#160;an entire&#160;line.<br/>
-p&#160;<i>prompt</i><br/>
Display&#160;a&#160;prompt&#160;for input&#160;using the&#160;string&#160;<i>prompt</i>.<br/>
-r<br/>
Raw&#160;mode.&#160;Do not&#160;interpret&#160;backslash characters&#160;as&#160;<br/>escapes.<br/>
-s<br/>
Silent&#160;mode.&#160;Do not&#160;echo characters&#160;to the&#160;display as&#160;<br/>they&#160;are&#160;typed.&#160;This&#160;is&#160;useful&#160;when inputting&#160;passwords&#160;<br/>and&#160;other confidential&#160;information.<br/>
-t&#160;<i>seconds</i><br/>
Timeout.&#160;Terminate&#160;input&#160;after&#160;<i>seconds</i>.&#160;read&#160;returns&#160;a&#160;<br/>non-zero&#160;exit&#160;status&#160;if an&#160;input&#160;times&#160;out.<br/>
-u&#160;<i>fd</i><br/>
Use&#160;input&#160;from&#160;file&#160;descriptor&#160;<i>fd</i>, rather than&#160;standard&#160;<br/>input.<br/>
Using&#160;the&#160;various&#160;options,&#160;we&#160;can&#160;do&#160;interesting&#160;things&#160;with&#160;read.&#160;For example,&#160;with&#160;the<br/>-p&#160;option, we&#160;can&#160;provide&#160;a&#160;prompt&#160;string.<br/>
#!/bin/bash&#160;<br/>
# read-single: read multiple values into default variable<br/>
read -p &#34;Enter one or more values &gt; &#34;&#160;<br/>
echo &#34;REPLY = '$REPLY'&#34;<br/>
With&#160;the&#160;-t&#160;and&#160;-s&#160;options,&#160;we&#160;can&#160;write&#160;a&#160;script&#160;that&#160;reads&#160;“secret”&#160;input&#160;and&#160;times&#160;out<br/>if the&#160;input&#160;is&#160;not&#160;completed in&#160;a&#160;specified time.<br/>
#!/bin/bash&#160;<br/>
# read-secret: input a secret passphrase&#160;<br/>
414<br/>
<hr/>
<a name=439></a>read&#160;– Read&#160;Values&#160;from&#160;Standard&#160;Input<br/>
if read -t 10 -sp &#34;Enter secret passphrase &gt; &#34; secret_pass; then&#160;<br/>
echo -e &#34;\nSecret passphrase = '$secret_pass'&#34;&#160;<br/>
else&#160;<br/>
echo -e &#34;\nInput timed out&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
The&#160;script&#160;prompts&#160;the&#160;user&#160;for&#160;a&#160;secret&#160;passphrase&#160;and&#160;waits&#160;ten&#160;seconds&#160;for&#160;input.&#160;If&#160;the<br/>entry&#160;is&#160;not&#160;completed&#160;within&#160;the&#160;specified&#160;time,&#160;the&#160;script&#160;exits&#160;with&#160;an&#160;error.&#160;Since&#160;the&#160;-<br/>s&#160;option is&#160;included,&#160;the&#160;characters&#160;of the&#160;passphrase&#160;are&#160;not&#160;echoed to&#160;the&#160;display&#160;as&#160;they<br/>are&#160;typed.<br/>It's&#160;possible&#160;to&#160;supply&#160;the&#160;user&#160;with&#160;a&#160;default&#160;response&#160;using&#160;the&#160;-e&#160;and&#160;-i&#160;options&#160;to-<br/>gether.<br/>
#!/bin/bash<br/>
# read-default: supply a default value if user presses Enter key.<br/>
read -e -p &#34;What is your user name? &#34; -i $USER<br/>echo &#34;You answered: '$REPLY'&#34;<br/>
In&#160;this&#160;script,&#160;we&#160;prompt&#160;the&#160;user&#160;to&#160;enter&#160;a&#160;username&#160;and&#160;use&#160;the&#160;environment&#160;variable<br/>USER&#160;to&#160;provide&#160;a&#160;default&#160;value.&#160;When&#160;the&#160;script&#160;is&#160;run,&#160;it&#160;displays&#160;the&#160;default&#160;string&#160;and<br/>if&#160;the&#160;user&#160;simply&#160;presses&#160;the&#160;Enter&#160;key,&#160;read&#160;will&#160;assign&#160;the&#160;default&#160;string&#160;to&#160;the&#160;REPLY<br/>variable.<br/>
[me@linuxbox ~]$&#160;<b>read-default<br/></b>What is your user name? me<br/>You answered: 'me'<br/>
IFS<br/>Normally,&#160;the&#160;shell&#160;performs&#160;word&#160;splitting&#160;on&#160;the&#160;input&#160;provided&#160;to&#160;read.&#160;As&#160;we&#160;have<br/>seen,&#160;this&#160;means&#160;that&#160;multiple&#160;words&#160;separated&#160;by&#160;one&#160;or&#160;more&#160;spaces&#160;become&#160;separate<br/>items&#160;on&#160;the&#160;input&#160;line&#160;and&#160;are&#160;assigned&#160;to&#160;separate&#160;variables&#160;by&#160;read.&#160;This&#160;behavior&#160;is<br/>configured&#160;by&#160;a&#160;shell&#160;variable&#160;named&#160;&#160;IFS&#160;&#160;(for&#160;&#160;Internal&#160;Field&#160;Separator).&#160;The&#160;default<br/>value&#160;of&#160;IFS&#160;contains&#160;a&#160;space,&#160;a&#160;tab,&#160;and&#160;a&#160;newline&#160;character,&#160;each&#160;of&#160;which&#160;will&#160;separate<br/>
415<br/>
<hr/>
<a name=440></a>28 – Reading&#160;Keyboard Input<br/>
items&#160;from&#160;one&#160;another.<br/>We&#160;can&#160;adjust&#160;the&#160;value&#160;of&#160;IFS&#160;to&#160;control&#160;the&#160;separation&#160;of&#160;fields&#160;input&#160;to&#160;read.&#160;For&#160;ex-<br/>ample,&#160;the&#160;&#160;/etc/passwd&#160;&#160;file&#160;contains&#160;lines&#160;of&#160;data&#160;that&#160;use&#160;the&#160;colon&#160;character&#160;as&#160;a<br/>field&#160;separator.&#160;By changing&#160;the&#160;value&#160;of&#160;IFS&#160;to&#160;a&#160;single&#160;colon, we&#160;can use&#160;read&#160;to&#160;input<br/>the&#160;contents&#160;of&#160;/etc/passwd&#160;and&#160;successfully&#160;separate&#160;fields&#160;into&#160;different&#160;variables.<br/>Here&#160;we&#160;have&#160;a&#160;script&#160;that&#160;does&#160;just&#160;that:<br/>
#!/bin/bash&#160;<br/>
# read-ifs: read fields from a file&#160;<br/>
FILE=/etc/passwd&#160;<br/>
read -p &#34;Enter a username &gt; &#34; user_name&#160;<br/>
file_info=&#34;$(grep &#34;^$user_name:&#34; $FILE)&#34;&#160;<br/>
if [ -n &#34;$file_info&#34; ]; then&#160;<br/>
IFS=&#34;:&#34; read user pw uid gid name home shell &lt;&lt;&lt; &#34;$file_info&#34;&#160;<br/>echo &#34;User = &#160; &#160; &#160;'$user'&#34;&#160;<br/>echo &#34;UID = &#160; &#160; &#160; '$uid'&#34;&#160;<br/>echo &#34;GID = &#160; &#160; &#160; '$gid'&#34;&#160;<br/>echo &#34;Full Name = '$name'&#34;&#160;<br/>echo &#34;Home Dir. = '$home'&#34;&#160;<br/>echo &#34;Shell = &#160; &#160; '$shell'&#34;&#160;<br/>
else&#160;<br/>
echo &#34;No such user '$user_name'&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
This&#160;script&#160;prompts&#160;the&#160;user&#160;to&#160;enter&#160;the&#160;username&#160;of&#160;an&#160;account&#160;on&#160;the&#160;system&#160;and&#160;then<br/>displays&#160;the&#160;different&#160;fields&#160;found&#160;in&#160;the&#160;user’s&#160;record&#160;in&#160;the&#160;&#160;/etc/passwd&#160;&#160;file.&#160;The<br/>script&#160;contains&#160;two interesting&#160;lines.&#160;The&#160;first&#160;is&#160;as&#160;follows:<br/>file_info=$(grep &#34;^$user_name:&#34; $FILE)&#160;<br/>
This&#160;line&#160;assigns&#160;the&#160;results&#160;of&#160;a&#160;grep&#160;command&#160;to&#160;the&#160;variable&#160;file_info.&#160;The&#160;regu-<br/>lar&#160;expression&#160;used&#160;by&#160;grep&#160;assures&#160;that&#160;the&#160;username&#160;will&#160;match&#160;only&#160;a&#160;single&#160;line&#160;in<br/>the&#160;/etc/passwd&#160;file.<br/>The&#160;second&#160;interesting line&#160;is&#160;this&#160;one:<br/>IFS=&#34;:&#34; read user pw uid gid name home shell &lt;&lt;&lt; &#34;$file_info&#34;<br/>
416<br/>
<hr/>
<a name=441></a>read&#160;– Read&#160;Values&#160;from&#160;Standard&#160;Input<br/>
The&#160;line&#160;consists&#160;of&#160;three&#160;parts:&#160;a&#160;variable&#160;assignment,&#160;a&#160;read&#160;command&#160;with&#160;a&#160;list&#160;of<br/>variable&#160;names&#160;as&#160;arguments,&#160;and&#160;a&#160;strange&#160;new&#160;redirection&#160;operator.&#160;We’ll&#160;look&#160;at&#160;the<br/>variable&#160;assignment&#160;first.<br/>The&#160;shell&#160;allows&#160;one&#160;or&#160;more&#160;variable&#160;assignments&#160;to&#160;take&#160;place&#160;immediately&#160;before&#160;a<br/>command.&#160;These&#160;assignments&#160;alter&#160;the&#160;environment&#160;for&#160;the&#160;command&#160;that&#160;follows.&#160;The<br/>effect&#160;of&#160;the&#160;assignment&#160;is&#160;temporary&#160;changing&#160;only&#160;the&#160;environment&#160;for&#160;the&#160;duration&#160;of<br/>the&#160;command.&#160;In&#160;our&#160;case,&#160;the&#160;value&#160;of&#160;IFS&#160;is&#160;changed&#160;to&#160;a&#160;colon&#160;character.&#160;Alternately,<br/>we&#160;could have&#160;coded it&#160;this&#160;way:<br/>OLD_IFS=&#34;$IFS&#34;<br/>
IFS=&#34;:&#34;<br/>read user pw uid gid name home shell &lt;&lt;&lt; &#34;$file_info&#34;<br/>
IFS=&#34;$OLD_IFS&#34;<br/>
where&#160;we&#160;store&#160;the&#160;value&#160;of&#160;IFS,&#160;assign&#160;a&#160;new&#160;value,&#160;perform&#160;the&#160;read&#160;command,&#160;and<br/>then&#160;restore&#160;IFS&#160;to&#160;its&#160;original&#160;value.&#160;Clearly,&#160;placing&#160;the&#160;variable&#160;assignment&#160;in&#160;front&#160;of<br/>the&#160;command&#160;is&#160;a&#160;more&#160;concise&#160;way of doing the&#160;same&#160;thing.<br/>The&#160;&#160;&lt;&lt;&lt;&#160;&#160;operator&#160;indicates&#160;a&#160;&#160;<i>here&#160;string</i>.&#160;A&#160;here&#160;string&#160;is&#160;like&#160;a&#160;here&#160;document,&#160;only<br/>shorter,&#160;consisting&#160;of&#160;a&#160;single&#160;string.&#160;In&#160;our&#160;example,&#160;the&#160;line&#160;of&#160;data&#160;from&#160;the&#160;&#160;/etc/<br/>passwd&#160;file&#160;is&#160;fed&#160;to&#160;the&#160;standard&#160;input&#160;of&#160;the&#160;read&#160;command.&#160;We&#160;might&#160;wonder&#160;why<br/>this&#160;rather&#160;oblique&#160;method&#160;was&#160;chosen&#160;rather than&#160;thsi:<br/>echo &#34;$file_info&#34; | IFS=&#34;:&#34; read user pw uid gid name home shell<br/>
Well, there’s&#160;a&#160;reason...<br/>
<b>You&#160;Can’t&#160;Pipe&#160;read</b><br/>
While&#160;the&#160;read&#160;command&#160;normally&#160;takes&#160;input&#160;from&#160;standard&#160;input,&#160;you&#160;cannot<br/>do this:<br/>echo &#34;foo&#34; | read<br/>
We&#160;would&#160;expect&#160;this&#160;to&#160;work,&#160;but&#160;it&#160;does&#160;not.&#160;The&#160;command&#160;will&#160;appear&#160;to&#160;suc-<br/>ceed,&#160;but&#160;the&#160;REPLY&#160;variable&#160;will&#160;always&#160;be&#160;empty.&#160;Why is&#160;this?<br/>The&#160;explanation&#160;has&#160;to&#160;do&#160;with&#160;the&#160;way&#160;the&#160;shell&#160;handles&#160;pipelines.&#160;In&#160;bash&#160;(and<br/>other&#160;shells&#160;such&#160;as&#160;sh),&#160;pipelines&#160;create&#160;<i>subshells</i>.&#160;These&#160;are&#160;copies&#160;of&#160;the&#160;shell<br/>and&#160;its&#160;environment&#160;that&#160;are&#160;used&#160;to&#160;execute&#160;the&#160;command&#160;in&#160;the&#160;pipeline.&#160;In&#160;our<br/>previous&#160;example,&#160;read&#160;is&#160;executed&#160;in a&#160;subshell.<br/>Subshells&#160;in&#160;Unix-like&#160;systems&#160;create&#160;copies&#160;of&#160;the&#160;environment&#160;for&#160;the&#160;processes<br/>to&#160;use&#160;while&#160;they&#160;execute.&#160;When&#160;the&#160;processes&#160;finishes,&#160;the&#160;copy&#160;of&#160;the&#160;environ-<br/>
417<br/>
<hr/>
<a name=442></a>28 – Reading&#160;Keyboard Input<br/>
ment&#160;is&#160;destroyed.&#160;This&#160;means&#160;that&#160;<i>a&#160;subshell&#160;can&#160;never&#160;alter&#160;the&#160;environment&#160;of<br/>its&#160;parent&#160;process</i>.&#160;read&#160;assigns&#160;variables,&#160;which&#160;then&#160;become&#160;part&#160;of&#160;the&#160;envi-<br/>ronment.&#160;In&#160;the&#160;previous&#160;example,&#160;&#160;read&#160;&#160;assigns&#160;the&#160;value&#160;&#160;foo&#160;&#160;to&#160;the&#160;variable<br/>REPLY&#160;in&#160;its&#160;subshell’s&#160;environment,&#160;but&#160;when&#160;the&#160;command&#160;exits,&#160;the&#160;subshell<br/>and its&#160;environment&#160;are&#160;destroyed,&#160;and the&#160;effect&#160;of the&#160;assignment&#160;is&#160;lost.<br/>Using&#160;here&#160;strings&#160;is&#160;one&#160;way&#160;to&#160;work&#160;around&#160;this&#160;behavior.&#160;Another&#160;method&#160;is<br/>discussed&#160;in Chapter&#160;36.<br/>
<b>Validating&#160;Input<br/></b>With&#160;our new&#160;ability to&#160;have&#160;keyboard&#160;input&#160;comes&#160;an additional&#160;programming challenge,<br/>validating&#160;input.&#160;Often&#160;the&#160;difference&#160;between&#160;a&#160;well-written&#160;program&#160;and&#160;a&#160;poorly&#160;writ-<br/>ten&#160;one&#160;lies&#160;in&#160;the&#160;program’s&#160;ability&#160;to&#160;deal&#160;with&#160;the&#160;unexpected.&#160;Frequently,&#160;the&#160;unex-<br/>pected&#160;appears&#160;in&#160;the&#160;form&#160;of&#160;bad&#160;input.&#160;We’ve&#160;done&#160;a&#160;little&#160;of&#160;this&#160;with&#160;our&#160;evaluation<br/>programs&#160;in&#160;the&#160;previous&#160;chapter,&#160;where&#160;we&#160;checked&#160;the&#160;values&#160;of&#160;integers&#160;and&#160;screened<br/>out&#160;empty&#160;values&#160;and&#160;non-numeric&#160;characters.&#160;It&#160;is&#160;important&#160;to&#160;perform&#160;these&#160;kinds&#160;of<br/>programming&#160;checks&#160;every&#160;time&#160;a&#160;program&#160;receives&#160;input&#160;to&#160;guard&#160;against&#160;invalid&#160;data.<br/>This&#160;is&#160;especially&#160;important&#160;for&#160;programs&#160;that&#160;are&#160;shared&#160;by&#160;multiple&#160;users.&#160;Omitting<br/>these&#160;safeguards&#160;in&#160;the&#160;interests&#160;of&#160;economy&#160;might&#160;be&#160;excused&#160;if&#160;a&#160;program&#160;is&#160;to&#160;be&#160;used<br/>once&#160;and&#160;only&#160;by&#160;the&#160;author&#160;to&#160;perform&#160;some&#160;special&#160;task.&#160;Even&#160;then,&#160;if&#160;the&#160;program&#160;per-<br/>forms&#160;dangerous&#160;tasks&#160;such&#160;as&#160;deleting&#160;files,&#160;it&#160;would&#160;be&#160;wise&#160;to&#160;include&#160;data&#160;validation,<br/>just&#160;in case.<br/>Here&#160;we&#160;have&#160;an&#160;example&#160;program&#160;that&#160;validates&#160;various&#160;kinds&#160;of input:<br/>
#!/bin/bash&#160;<br/>
# read-validate: validate input&#160;<br/>
invalid_input () {&#160;<br/>
echo &#34;Invalid input '$REPLY'&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
}&#160;<br/>
read -p &#34;Enter a single item &gt; &#34;&#160;<br/>
# input is empty (invalid)&#160;<br/>[[ -z &#34;$REPLY&#34; ]] &amp;&amp; invalid_input&#160;<br/>
418<br/>
<hr/>
<a name=443></a>Validating&#160;Input<br/>
# input is multiple items (invalid)&#160;<br/>(( &#34;$(echo &#34;$REPLY&#34; | wc -w)&#34; &gt; 1 )) &amp;&amp; invalid_input&#160;<br/>
# is input a valid filename?&#160;<br/>if [[ &#34;$REPLY&#34; =~ ^[-[:alnum:]\._]+$ ]]; then&#160;<br/>
echo &#34;'$REPLY' is a valid filename.&#34;&#160;<br/>if [[ -e &#34;$REPLY&#34; ]]; then&#160;<br/>
echo &#34;And file '$REPLY' exists.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;However, file '$REPLY' does not exist.&#34;&#160;<br/>
fi&#160;<br/>
# is input a floating point number?&#160;<br/>if [[ &#34;$REPLY&#34; =~ ^-?[[:digit:]]*\.[[:digit:]]+$ ]]; then&#160;<br/>
echo &#34;'$REPLY' is a floating point number.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;'$REPLY' is not a floating point number.&#34;&#160;<br/>
fi&#160;<br/>
# is input an integer?&#160;<br/>if [[ &#34;$REPLY&#34; =~ ^-?[[:digit:]]+$ ]]; then&#160;<br/>
echo &#34;'$REPLY' is an integer.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;'$REPLY' is not an integer.&#34;&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;The string '$REPLY' is not a valid filename.&#34;&#160;<br/>
fi<br/>
This&#160;script&#160;prompts&#160;the&#160;user&#160;to&#160;enter&#160;an&#160;item.&#160;The&#160;item&#160;is&#160;subsequently&#160;analyzed&#160;to&#160;deter-<br/>mine&#160;its&#160;contents.&#160;As&#160;we&#160;can&#160;see,&#160;the&#160;script&#160;makes&#160;use&#160;of&#160;many&#160;of&#160;the&#160;concepts&#160;that&#160;we<br/>have&#160;covered&#160;thus&#160;far,&#160;including&#160;shell&#160;functions,&#160;&#160;[[&#160;]],&#160;&#160;((&#160;)),&#160;the&#160;control&#160;operator<br/>&amp;&amp;, and&#160;if, as&#160;well&#160;as&#160;a&#160;healthy dose&#160;of regular&#160;expressions.<br/>
<b>Menus<br/></b>A&#160;common&#160;type&#160;of&#160;interactivity&#160;is&#160;called&#160;<i>menu-driven</i>.&#160;In&#160;menu-driven&#160;programs,&#160;the&#160;user<br/>is&#160;presented&#160;with&#160;a&#160;list&#160;of&#160;choices&#160;and&#160;is&#160;asked&#160;to&#160;choose&#160;one.&#160;For&#160;example,&#160;we&#160;could<br/>imagine&#160;a&#160;program&#160;that&#160;presented&#160;the&#160;following:<br/>
Please Select:<br/>
419<br/>
<hr/>
<a name=444></a>28 – Reading&#160;Keyboard Input<br/>
1. Display System Information<br/>2. Display Disk Space<br/>3. Display Home Space Utilization<br/>0. Quit<br/>
Enter selection [0-3] &gt;<br/>
Using&#160;what&#160;we&#160;learned&#160;from&#160;writing&#160;our&#160;sys_info_page&#160;program,&#160;we&#160;can&#160;construct&#160;a<br/>menu-driven&#160;program&#160;to perform&#160;the&#160;tasks&#160;on the&#160;previous&#160;menu:<br/>
#!/bin/bash&#160;<br/>
# read-menu: a menu driven system information program&#160;<br/>
clear&#160;<br/>echo &#34;&#160;<br/>Please Select:&#160;<br/>
1. Display System Information&#160;<br/>2. Display Disk Space&#160;<br/>3. Display Home Space Utilization&#160;<br/>0. Quit&#160;<br/>&#34;&#160;<br/>read -p &#34;Enter selection [0-3] &gt; &#34;&#160;<br/>
if [[ &#34;$REPLY&#34; =~ ^[0-3]$ ]]; then&#160;<br/>
if [[ &#34;$REPLY&#34; == 0 ]]; then&#160;<br/>
echo &#34;Program terminated.&#34;&#160;<br/>exit&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 1 ]]; then&#160;<br/>
echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>uptime&#160;<br/>exit&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 2 ]]; then&#160;<br/>
df -h&#160;<br/>exit&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 3 ]]; then&#160;<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>
420<br/>
<hr/>
<a name=445></a>Menus<br/>
du -sh /home/*&#160;<br/>
else&#160;<br/>
echo &#34;Home Space Utilization ($USER)&#34;&#160;<br/>du -sh &#34;$HOME&#34;&#160;<br/>
fi&#160;<br/>exit&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;Invalid entry.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
This&#160;script&#160;is&#160;logically&#160;divided&#160;into&#160;two&#160;parts.&#160;The&#160;first&#160;part&#160;displays&#160;the&#160;menu&#160;and&#160;inputs<br/>the&#160;response&#160;from&#160;the&#160;user.&#160;The&#160;second&#160;part&#160;identifies&#160;the&#160;response&#160;and&#160;carries&#160;out&#160;the&#160;se-<br/>lected&#160;action.&#160;Notice&#160;the&#160;use&#160;of&#160;the&#160;exit&#160;command&#160;in&#160;this&#160;script.&#160;It&#160;is&#160;used&#160;here&#160;to&#160;pre-<br/>vent&#160;the&#160;script&#160;from&#160;executing&#160;unnecessary&#160;code&#160;after&#160;an&#160;action&#160;has&#160;been&#160;carried&#160;out.&#160;The<br/>presence&#160;of&#160;multiple&#160;exit&#160;points&#160;in&#160;a&#160;program&#160;is&#160;generally&#160;a&#160;bad&#160;idea&#160;(it&#160;makes&#160;program<br/>logic&#160;harder to&#160;understand), but&#160;it&#160;works&#160;in&#160;this&#160;script.&#160;<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;took&#160;our&#160;first&#160;steps&#160;toward&#160;interactivity,&#160;allowing&#160;users&#160;to&#160;input&#160;data<br/>into&#160;our&#160;programs&#160;via&#160;the&#160;keyboard.&#160;Using&#160;the&#160;techniques&#160;presented&#160;thus&#160;far,&#160;it&#160;is&#160;possible<br/>to&#160;write&#160;many&#160;useful&#160;programs,&#160;such&#160;as&#160;specialized&#160;calculation&#160;programs&#160;and&#160;easy-to-use<br/>front&#160;ends&#160;for&#160;arcane&#160;command&#160;line&#160;tools.&#160;In&#160;the&#160;next&#160;chapter,&#160;we&#160;will&#160;build&#160;on&#160;the&#160;menu-<br/>driven program&#160;concept&#160;to make&#160;it&#160;even better.<br/>
Extra&#160;Credit<br/>It&#160;is&#160;important&#160;to&#160;study&#160;the&#160;programs&#160;in&#160;this&#160;chapter&#160;carefully&#160;and&#160;have&#160;a&#160;complete&#160;under-<br/>standing of the&#160;way they are&#160;logically&#160;structured,&#160;as&#160;the&#160;programs&#160;to&#160;come&#160;will&#160;be&#160;increas-<br/>ingly&#160;complex.&#160;As&#160;an&#160;exercise,&#160;rewrite&#160;the&#160;programs&#160;in&#160;this&#160;chapter&#160;using&#160;the&#160;test&#160;com-<br/>mand&#160;rather&#160;than&#160;the&#160;[[&#160;]]&#160;compound&#160;command.&#160;Hint:&#160;Use&#160;grep&#160;to&#160;evaluate&#160;the&#160;regu-<br/>lar expressions&#160;and evaluate&#160;the&#160;exit&#160;status.&#160;This&#160;will&#160;be&#160;good practice.&#160;<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;contains&#160;a&#160;chapter&#160;on builtins, which includes&#160;the&#160;<br/>read&#160;command:<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html#Bash-Builtins">http://www.gnu.org/software/bash/manual/bashref.html#Bash-Builtins</a><br/>
421<br/>
<hr/>
<a name=446></a>28 – Reading&#160;Keyboard Input<br/>
422<br/>
<hr/>
<a name=447></a>29 – Flow&#160;Control:&#160;Looping with&#160;while&#160;/&#160;until<br/>
<i><b>29&#160;–&#160;Flow&#160;Control:&#160;Looping&#160;with&#160;while&#160;/&#160;</b></i><br/>
<i><b>until</b></i><br/>
In&#160;the&#160;previous&#160;chapter,&#160;we&#160;developed&#160;a&#160;menu-driven&#160;program&#160;to&#160;produce&#160;various&#160;kinds<br/>of&#160;system&#160;information.&#160;The&#160;program&#160;works,&#160;but&#160;it&#160;still&#160;has&#160;a&#160;significant&#160;usability&#160;problem.<br/>It&#160;executes&#160;only&#160;a&#160;single&#160;choice&#160;and&#160;then&#160;terminates.&#160;Even&#160;worse,&#160;if&#160;an&#160;invalid&#160;selection&#160;is<br/>made,&#160;the&#160;program&#160;terminates&#160;with&#160;an&#160;error,&#160;without&#160;giving&#160;the&#160;user&#160;an&#160;opportunity&#160;to&#160;try<br/>again.&#160;It&#160;would&#160;be&#160;better&#160;if&#160;we&#160;could&#160;somehow&#160;construct&#160;the&#160;program&#160;so&#160;that&#160;it&#160;could&#160;re-<br/>peat&#160;the&#160;menu&#160;display&#160;and&#160;selection&#160;over&#160;and&#160;over,&#160;until&#160;the&#160;user&#160;chooses&#160;to&#160;exit&#160;the&#160;pro-<br/>gram.<br/>In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;a&#160;programming&#160;concept&#160;called&#160;<i>looping</i>,&#160;which&#160;can&#160;be&#160;used<br/>to&#160;make&#160;portions&#160;of&#160;programs&#160;repeat.&#160;The&#160;shell&#160;provides&#160;three&#160;compound&#160;commands&#160;for<br/>looping.&#160;We&#160;will&#160;look at&#160;two of them&#160;in this&#160;chapter,&#160;and the&#160;third in a&#160;later&#160;chapter.<br/>
<b>Looping<br/></b>Daily&#160;life&#160;is&#160;full&#160;of&#160;repeated&#160;activities.&#160;Going&#160;to&#160;work&#160;each&#160;day,&#160;walking&#160;the&#160;dog,&#160;and&#160;slic-<br/>ing&#160;a&#160;carrot&#160;are&#160;all&#160;tasks&#160;that&#160;involve&#160;repeating&#160;a&#160;series&#160;of&#160;steps.&#160;Let’s&#160;consider&#160;slicing&#160;a<br/>carrot.&#160;If we&#160;express&#160;this&#160;activity&#160;in&#160;pseudocode, it&#160;might&#160;look something like&#160;this:<br/>
1.&#160;get&#160;cutting&#160;board<br/>2.&#160;get&#160;knife<br/>3.&#160;place&#160;carrot&#160;on cutting&#160;board<br/>4.&#160;lift&#160;knife<br/>5.&#160;advance&#160;carrot<br/>6.&#160;slice&#160;carrot<br/>7.&#160;if entire&#160;carrot&#160;sliced,&#160;then&#160;quit;&#160;else&#160;go to step&#160;4<br/>
Steps&#160;4&#160;through&#160;7&#160;form&#160;a&#160;<i>loop</i>.&#160;The&#160;actions&#160;within&#160;the&#160;loop&#160;are&#160;repeated&#160;until&#160;the&#160;condi-<br/>tion, “entire&#160;carrot&#160;sliced,”&#160;is&#160;reached.<br/>
423<br/>
<hr/>
<a name=448></a>29 – Flow&#160;Control:&#160;Looping with&#160;while&#160;/&#160;until<br/>
while<br/>bash&#160;can&#160;express&#160;a&#160;similar&#160;idea.&#160;Let’s&#160;say&#160;we&#160;wanted&#160;to&#160;display&#160;five&#160;numbers&#160;in&#160;sequen-<br/>tial&#160;order from&#160;1 to 5. a&#160;bash&#160;script&#160;could be&#160;constructed&#160;as&#160;follows:<br/>
#!/bin/bash&#160;<br/>
# while-count: display a series of numbers&#160;<br/>
count=1&#160;<br/>
while [[ &#34;$count&#34; -le 5 ]]; do&#160;<br/>
echo &#34;$count&#34;&#160;<br/>count=$((count + 1))&#160;<br/>
done<br/>echo &#34;Finished.&#34;<br/>
When executed,&#160;this&#160;script&#160;displays&#160;the&#160;following:<br/>
[me@linuxbox ~]$&#160;<b>while-count<br/></b>1<br/>2<br/>3<br/>4<br/>5<br/>Finished.<br/>
The&#160;syntax&#160;of the&#160;while&#160;command is&#160;as&#160;follows:<br/>while&#160;<i>commands</i>; do&#160;<i>commands</i>; done<br/>Like&#160;if,&#160;while&#160;evaluates&#160;the&#160;exit&#160;status&#160;of&#160;a&#160;list&#160;of&#160;commands.&#160;As&#160;long&#160;as&#160;the&#160;exit&#160;status<br/>is&#160;zero,&#160;it&#160;performs&#160;the&#160;commands&#160;inside&#160;the&#160;loop.&#160;In&#160;the&#160;previous&#160;script,&#160;the&#160;variable<br/>count&#160;is&#160;created&#160;and&#160;assigned&#160;an&#160;initial&#160;value&#160;of&#160;1.&#160;The&#160;while&#160;command&#160;evaluates&#160;the<br/>exit&#160;status&#160;of&#160;the&#160;[[]]&#160;compound&#160;command.&#160;As&#160;long&#160;as&#160;the&#160;[[]]&#160;command&#160;returns&#160;an<br/>exit&#160;status&#160;of&#160;zero,&#160;the&#160;commands&#160;within&#160;the&#160;loop&#160;are&#160;executed.&#160;At&#160;the&#160;end&#160;of&#160;each&#160;cycle,<br/>the&#160;[[]]&#160;command&#160;is&#160;repeated.&#160;After&#160;five&#160;iterations&#160;of&#160;the&#160;loop,&#160;the&#160;value&#160;of&#160;count&#160;has<br/>increased&#160;to&#160;6,&#160;the&#160;[[]]&#160;command&#160;no&#160;longer&#160;returns&#160;an&#160;exit&#160;status&#160;of&#160;zero,&#160;and&#160;the&#160;loop<br/>terminates.&#160;The&#160;program&#160;continues&#160;with&#160;the&#160;next&#160;statement&#160;following the&#160;loop.<br/>We&#160;can use&#160;a&#160;<i>while&#160;loop</i>&#160;to improve&#160;the&#160;read-menu&#160;program&#160;from&#160;the&#160;previous&#160;chapter.<br/>
424<br/>
<hr/>
<a name=449></a>Looping<br/>
#!/bin/bash&#160;<br/>
# while-menu: a menu driven system information program&#160;<br/>
<b>DELAY=3</b>&#160;# Number of seconds to display results&#160;<br/>
<b>while [[ &#34;$REPLY&#34; != 0 ]]; do</b>&#160;<br/>
clear&#160;<br/>cat &lt;&lt;- _EOF_&#160;<br/>
Please Select:&#160;<br/>
&#160;<br/>
1. Display System Information&#160;<br/>2. Display Disk Space&#160;<br/>3. Display Home Space Utilization&#160;<br/>0. Quit&#160;<br/>
_EOF_&#160;<br/>read -p &#34;Enter selection [0-3] &gt; &#34;&#160;<br/>
if [[ &#34;$REPLY&#34; =~ ^[0-3]$ ]]; then&#160;<br/>
if [[ $REPLY == 1 ]]; then&#160;<br/>
echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>uptime&#160;<br/><b>sleep &#34;$DELAY&#34;</b>&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 2 ]]; then&#160;<br/>
df -h&#160;<br/><b>sleep &#34;$DELAY&#34;</b>&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 3 ]]; then&#160;<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>du -sh /home/*&#160;<br/>
else&#160;<br/>
echo &#34;Home Space Utilization ($USER)&#34;&#160;<br/>du -sh &#34;$HOME&#34;&#160;<br/>
fi&#160;<br/><b>sleep &#34;$DELAY&#34;</b><br/>
fi&#160;<br/>
else&#160;<br/>
echo &#34;Invalid entry.&#34;&#160;<br/><b>sleep &#34;$DELAY&#34;&#160;</b><br/>
fi&#160;<br/>
<b>done</b>&#160;<br/>
425<br/>
<hr/>
<a name=450></a>29 – Flow&#160;Control:&#160;Looping with&#160;while&#160;/&#160;until<br/>
echo &#34;Program terminated.&#34;<br/>
By&#160;enclosing&#160;the&#160;menu&#160;in&#160;a&#160;while&#160;loop,&#160;we&#160;are&#160;able&#160;to&#160;have&#160;the&#160;program&#160;repeat&#160;the&#160;menu<br/>display&#160;after&#160;each&#160;selection.&#160;The&#160;loop&#160;continues&#160;as&#160;long&#160;as&#160;REPLY&#160;is&#160;not&#160;equal&#160;to&#160;0&#160;and<br/>the&#160;menu&#160;is&#160;displayed&#160;again,&#160;giving&#160;the&#160;user&#160;the&#160;opportunity&#160;to&#160;make&#160;another&#160;selection.&#160;At<br/>the&#160;end&#160;of&#160;each&#160;action,&#160;a&#160;sleep&#160;command&#160;is&#160;executed&#160;so&#160;the&#160;program&#160;will&#160;pause&#160;for&#160;a<br/>few&#160;seconds&#160;to&#160;allow&#160;the&#160;results&#160;of&#160;the&#160;selection&#160;to&#160;be&#160;seen&#160;before&#160;the&#160;screen&#160;is&#160;cleared<br/>and&#160;the&#160;menu&#160;is&#160;redisplayed.&#160;Once&#160;REPLY&#160;is&#160;equal&#160;to&#160;0,&#160;indicating&#160;the&#160;“quit”&#160;selection,<br/>the&#160;loop&#160;terminates&#160;and&#160;execution continues&#160;with the&#160;line&#160;following&#160;done.<br/>
<b>Breaking&#160;Out&#160;of&#160;a&#160;Loop<br/></b>bash&#160;&#160;provides&#160;two&#160;builtin&#160;commands&#160;that&#160;can&#160;be&#160;used&#160;to&#160;control&#160;program&#160;flow&#160;inside<br/>loops.&#160;The&#160;&#160;break&#160;&#160;command&#160;&#160;immediately&#160;&#160;terminates&#160;a&#160;loop,&#160;and&#160;program&#160;control&#160;re-<br/>sumes&#160;with&#160;the&#160;next&#160;statement&#160;following&#160;the&#160;loop.&#160;The&#160;continue&#160;command&#160;causes&#160;the<br/>remainder&#160;of&#160;the&#160;loop&#160;to&#160;be&#160;skipped,&#160;and&#160;program&#160;control&#160;resumes&#160;with&#160;the&#160;next&#160;iteration<br/>of&#160;the&#160;loop.&#160;Here&#160;we&#160;see&#160;a&#160;version&#160;of&#160;the&#160;&#160;while-menu&#160;&#160;program&#160;incorporating&#160;both<br/>break&#160;and&#160;continue:&#160;<br/>
#!/bin/bash&#160;<br/>
# while-menu2: a menu driven system information program&#160;<br/>
DELAY=3 # Number of seconds to display results&#160;<br/>
<b>while true; do</b>&#160;<br/>
clear&#160;<br/>cat &lt;&lt;- _EOF_&#160;<br/>
Please Select:&#160;<br/>
1. Display System Information&#160;<br/>2. Display Disk Space&#160;<br/>3. Display Home Space Utilization&#160;<br/>0. Quit&#160;<br/>
_EOF_&#160;<br/>read -p &#34;Enter selection [0-3] &gt; &#34;&#160;<br/>
if [[ &#34;$REPLY&#34; =~ ^[0-3]$ ]]; then&#160;<br/>
if [[ &#34;$REPLY&#34; == 1 ]]; then&#160;<br/>
echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>
426<br/>
<hr/>
<a name=451></a>Breaking&#160;Out&#160;of a&#160;Loop<br/>
uptime&#160;<br/>sleep &#34;$DELAY&#34;&#160;<br/><b>continue</b>&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 2 ]]; then&#160;<br/>
df -h&#160;<br/>sleep &#34;$DELAY&#34;&#160;<br/><b>continue</b>&#160;<br/>
fi&#160;<br/>if [[ &#34;$REPLY&#34; == 3 ]]; then&#160;<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>du -sh /home/*&#160;<br/>
else&#160;<br/>
echo &#34;Home Space Utilization ($USER)&#34;<br/>du -sh &#34;$HOME&#34;&#160;<br/>
fi&#160;<br/>sleep &#34;$DELAY&#34;<br/><b>continue</b>&#160;<br/>
fi&#160;<br/><b>if [[ &#34;$REPLY&#34; == 0 ]]; then&#160;</b><br/>
<b>break&#160;</b><br/>
<b>fi&#160;</b><br/>
else&#160;<br/>
echo &#34;Invalid entry.&#34;&#160;<br/>sleep &#34;$DELAY&#34;<br/>
fi&#160;<br/>
done&#160;<br/>echo &#34;Program terminated.&#34;<br/>
In&#160;this&#160;version&#160;of&#160;the&#160;script,&#160;we&#160;set&#160;up&#160;an&#160;<i>endless&#160;loop</i>&#160;(one&#160;that&#160;never&#160;terminates&#160;on&#160;its<br/>own)&#160;by&#160;using&#160;the&#160;true&#160;command&#160;to&#160;supply&#160;an&#160;exit&#160;status&#160;to&#160;while.&#160;Since&#160;true&#160;will<br/>always&#160;exit&#160;with an exit&#160;status&#160;of zero, the&#160;loop will&#160;never end.&#160;This&#160;is&#160;a&#160;surprisingly com-<br/>mon&#160;scripting&#160;technique.&#160;Since&#160;the&#160;loop&#160;will&#160;never&#160;end&#160;on&#160;its&#160;own,&#160;it’s&#160;up&#160;to&#160;the&#160;program-<br/>mer to&#160;provide&#160;some&#160;way to&#160;break out&#160;of the&#160;loop&#160;when the&#160;time&#160;is&#160;right.&#160;In this&#160;script,&#160;the<br/>break&#160;&#160;command&#160;is&#160;used&#160;to&#160;exit&#160;the&#160;loop&#160;when&#160;the&#160;&#160;0&#160;&#160;selection&#160;is&#160;chosen.&#160;The&#160;&#160;con-<br/>tinue&#160;&#160;command&#160;has&#160;been&#160;included&#160;at&#160;the&#160;end&#160;of&#160;the&#160;other&#160;script&#160;choices&#160;to&#160;allow&#160;for<br/>more&#160;efficient&#160;execution.&#160;By&#160;using&#160;continue,&#160;the&#160;script&#160;will&#160;skip&#160;over&#160;code&#160;that&#160;is&#160;not<br/>needed&#160;when&#160;a&#160;selection&#160;is&#160;identified.&#160;For&#160;example,&#160;if&#160;the&#160;1&#160;selection&#160;is&#160;chosen&#160;and&#160;iden-<br/>tified, there&#160;is&#160;no reason to test&#160;for the&#160;other selections.<br/>
427<br/>
<hr/>
<a name=452></a>29 – Flow&#160;Control:&#160;Looping with&#160;while&#160;/&#160;until<br/>
until<br/>The&#160;until&#160;command&#160;is&#160;much&#160;like&#160;while,&#160;except&#160;instead&#160;of&#160;exiting&#160;a&#160;loop&#160;when&#160;a&#160;non-<br/>zero&#160;exit&#160;status&#160;is&#160;encountered,&#160;it&#160;does&#160;the&#160;opposite.&#160;An&#160;<i>until&#160;loop</i>&#160;continues&#160;until&#160;it&#160;re-<br/>ceives&#160;a&#160;zero&#160;exit&#160;status.&#160;In&#160;our&#160;while-count&#160;script,&#160;we&#160;continued&#160;the&#160;loop&#160;as&#160;long&#160;as<br/>the&#160;value&#160;of&#160;the&#160;count&#160;variable&#160;was&#160;less&#160;than&#160;or&#160;equal&#160;to&#160;5.&#160;We&#160;could&#160;get&#160;the&#160;same&#160;result<br/>by coding the&#160;script&#160;with&#160;until.<br/>
#!/bin/bash&#160;<br/>
# until-count: display a series of numbers&#160;<br/>
count=1&#160;<br/>
<b>until [[ &#34;$count&#34; -gt 5 ]]</b>; do&#160;<br/>
echo &#34;$count&#34;<br/>count=$((count + 1))&#160;<br/>
done<br/>echo &#34;Finished.&#34;<br/>
By&#160;changing&#160;the&#160;test&#160;expression&#160;to&#160;$count&#160;-gt&#160;5,&#160;until&#160;will&#160;terminate&#160;the&#160;loop&#160;at<br/>the&#160;correct&#160;time.&#160;The&#160;decision&#160;of&#160;whether&#160;to&#160;use&#160;the&#160;while&#160;or&#160;until&#160;loop&#160;is&#160;usually&#160;a<br/>matter of choosing&#160;the&#160;one&#160;that&#160;allows&#160;the&#160;clearest&#160;test&#160;to be&#160;written.<br/>
<b>Reading&#160;Files&#160;with&#160;Loops<br/></b>while&#160;&#160;and&#160;&#160;until&#160;&#160;can&#160;process&#160;standard&#160;input.&#160;This&#160;allows&#160;files&#160;to&#160;be&#160;processed&#160;with<br/>while&#160;and&#160;until&#160;loops.&#160;In&#160;the&#160;following&#160;example,&#160;we&#160;will&#160;display&#160;the&#160;contents&#160;of&#160;the&#160;dis-<br/>tros.txt&#160;file&#160;used&#160;in earlier chapters:<br/>
#!/bin/bash&#160;<br/>
# while-read: read lines from a file&#160;<br/>
while read distro version release; do&#160;<br/>
printf &#34;Distro: %s\tVersion: %s\tReleased: %s\n&#34; \&#160;<br/>
&#34;$distro&#34; \&#160;<br/>&#34;$version&#34; \&#160;<br/>&#34;$release&#34;<br/>
done&#160;<b>&lt; distros.txt</b><br/>
428<br/>
<hr/>
<a name=453></a>Reading&#160;Files&#160;with Loops<br/>
To&#160;redirect&#160;a&#160;file&#160;to&#160;the&#160;loop,&#160;we&#160;place&#160;the&#160;redirection&#160;operator&#160;after&#160;the&#160;done&#160;statement.<br/>The&#160;loop&#160;will&#160;use&#160;read&#160;to&#160;input&#160;the&#160;fields&#160;from&#160;the&#160;redirected&#160;file.&#160;The&#160;read&#160;command<br/>will&#160;exit&#160;after&#160;each&#160;line&#160;is&#160;read,&#160;with&#160;a&#160;zero&#160;exit&#160;status&#160;until&#160;the&#160;end-of-file&#160;is&#160;reached.&#160;At<br/>that&#160;point,&#160;it&#160;will&#160;exit&#160;with&#160;a&#160;non-zero&#160;exit&#160;status,&#160;thereby&#160;terminating&#160;the&#160;loop.&#160;It&#160;is&#160;also<br/>possible&#160;to pipe&#160;standard input&#160;into&#160;a&#160;loop.<br/>
#!/bin/bash&#160;<br/>
# while-read2: read lines from a file&#160;<br/>
<b>sort -k 1,1 -k 2n distros.txt |</b>&#160;while read distro version release; do<br/>
printf &#34;Distro: %s\tVersion: %s\tReleased: %s\n&#34; \&#160;<br/>
&#34;$distro&#34; \&#160;<br/>&#34;$version&#34; \&#160;<br/>&#34;$release&#34;<br/>
done<br/>
Here&#160;we&#160;take&#160;the&#160;output&#160;of&#160;the&#160;sort&#160;command&#160;and&#160;display&#160;the&#160;stream&#160;of&#160;text.&#160;However,<br/>it&#160;is&#160;important&#160;to&#160;remember&#160;that&#160;since&#160;a&#160;pipe&#160;will&#160;execute&#160;the&#160;loop&#160;in&#160;a&#160;subshell,&#160;any&#160;vari-<br/>ables&#160;created&#160;or assigned&#160;within the&#160;loop will&#160;be&#160;lost&#160;when&#160;the&#160;loop terminates.<br/>
<b>Summing&#160;Up<br/></b>With&#160;the&#160;introduction&#160;of&#160;loops&#160;and&#160;our&#160;previous&#160;encounters&#160;with&#160;branching,&#160;subroutines<br/>and&#160;sequences,&#160;we&#160;have&#160;covered&#160;the&#160;major&#160;types&#160;of&#160;flow&#160;control&#160;used&#160;in&#160;programs.&#160;bash<br/>has&#160;some&#160;more&#160;tricks&#160;up its&#160;sleeve, but&#160;they are&#160;refinements&#160;on these&#160;basic&#160;concepts.&#160;<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Guide&#160;for&#160;Beginners</i>&#160;from&#160;the&#160;Linux&#160;Documentation&#160;Project&#160;has&#160;some&#160;<br/>more&#160;examples&#160;of while&#160;loops:<br/><a href="http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_09_02.html">http://tldp.org/LDP/Bash-Beginners-Guide/html/sect_09_02.html</a><br/>
●<br/>
The&#160;Wikipedia&#160;has&#160;an article&#160;on loops, which is&#160;part&#160;of a&#160;larger&#160;article&#160;on flow&#160;<br/>control:<br/><a href="http://en.wikipedia.org/wiki/Control_flow#Loops">http://en.wikipedia.org/wiki/Control_flow#Loops</a><br/>
&#160;<br/>
429<br/>
<hr/>
<a name=454></a>30 –&#160;Troubleshooting<br/>
<i><b>30&#160;–&#160;Troubleshooting</b></i><br/>
Now&#160;that&#160;our&#160;scripts&#160;become&#160;more&#160;complex,&#160;it’s&#160;time&#160;to&#160;look&#160;at&#160;what&#160;happens&#160;when<br/>things&#160;go&#160;wrong.&#160;In&#160;this&#160;chapter,&#160;we’ll&#160;look&#160;at&#160;some&#160;of&#160;the&#160;common&#160;kinds&#160;of&#160;errors&#160;that<br/>occur&#160;in&#160;scripts&#160;and&#160;examine&#160;a&#160;few&#160;useful&#160;techniques&#160;that&#160;can&#160;be&#160;used&#160;to&#160;track&#160;down&#160;and<br/>eradicate&#160;problems.<br/>
<b>Syntactic&#160;Errors<br/></b>One&#160;general&#160;class&#160;of&#160;errors&#160;is&#160;<i>syntactic</i>.&#160;Syntactic&#160;errors&#160;involve&#160;mistyping&#160;some&#160;element<br/>of shell&#160;syntax.&#160;The&#160;shell&#160;will&#160;stop executing&#160;a&#160;script&#160;when it&#160;encounters&#160;this&#160;type&#160;of error.<br/>In&#160;the&#160;following&#160;discussions,&#160;we&#160;will&#160;use&#160;this&#160;script&#160;to&#160;demonstrate&#160;common&#160;types&#160;of&#160;er-<br/>rors:<br/>
#!/bin/bash&#160;<br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1&#160;<br/>
if [ $number = 1 ]; then&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>
As&#160;written, this&#160;script&#160;runs&#160;successfully.<br/>
[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>Number is equal to 1.<br/>
430<br/>
<hr/>
<a name=455></a>Syntactic&#160;Errors<br/>
Missing&#160;Quotes<br/>Let’s&#160;edit&#160;our&#160;script&#160;and&#160;remove&#160;the&#160;trailing&#160;quote&#160;from&#160;the&#160;argument&#160;following&#160;the&#160;first<br/>echo&#160;command.<br/>
#!/bin/bash&#160;<br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1&#160;<br/>
if [ $number = 1 ]; then&#160;<br/>
<b>echo &#34;Number is equal to 1.</b>&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>
Here&#160;is&#160;what&#160;happens:<br/>
[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>/home/me/bin/trouble: line 10: unexpected EOF while looking for&#160;<br/>matching `&#34;'&#160;<br/>/home/me/bin/trouble: line 13: syntax error: unexpected end of file<br/>
It&#160;generates&#160;two&#160;errors.&#160;Interestingly,&#160;the&#160;line&#160;numbers&#160;reported&#160;by&#160;the&#160;error&#160;messages&#160;are<br/>not&#160;where&#160;the&#160;missing&#160;quote&#160;was&#160;removed&#160;but&#160;rather&#160;much&#160;later&#160;in&#160;the&#160;program.&#160;If&#160;we&#160;fol-<br/>low&#160;the&#160;program&#160;after&#160;the&#160;missing&#160;quote,&#160;we&#160;can&#160;see&#160;why.&#160;bash&#160;will&#160;continue&#160;looking&#160;for<br/>the&#160;closing&#160;quote&#160;until&#160;it&#160;finds&#160;one,&#160;which&#160;it&#160;does,&#160;immediately&#160;after&#160;the&#160;second&#160;&#160;echo<br/>command.&#160;After&#160;that,&#160;&#160;bash&#160;&#160;becomes&#160;very&#160;confused.&#160;The&#160;syntax&#160;of&#160;the&#160;subsequent&#160;&#160;if<br/>command&#160;is&#160;broken because&#160;the&#160;fi&#160;statement&#160;is&#160;now&#160;inside&#160;a&#160;quoted (but&#160;open)&#160;string.<br/>In&#160;long&#160;scripts,&#160;this&#160;kind&#160;of&#160;error&#160;can&#160;be&#160;quite&#160;hard&#160;to&#160;find.&#160;Using&#160;an&#160;editor&#160;with&#160;syntax<br/>highlighting&#160;will&#160;help&#160;since,&#160;in&#160;most&#160;cases,&#160;it&#160;will&#160;display&#160;quoted&#160;strings&#160;in&#160;a&#160;distinctive<br/>manner&#160;from&#160;other&#160;kinds&#160;of&#160;shell&#160;syntax.&#160;If&#160;a&#160;complete&#160;version&#160;of&#160;vim&#160;is&#160;installed,&#160;syntax<br/>highlighting can&#160;be&#160;enabled by entering this&#160;command:<br/>
<b>:syntax on</b><br/>
431<br/>
<hr/>
<a name=456></a>30 –&#160;Troubleshooting<br/>
Missing&#160;or&#160;Unexpected&#160;Tokens<br/>Another&#160;common&#160;mistake&#160;is&#160;forgetting&#160;to&#160;complete&#160;a&#160;compound&#160;command,&#160;such&#160;as&#160;if&#160;or<br/>while.&#160;Let’s&#160;look&#160;at&#160;what&#160;happens&#160;if&#160;we&#160;remove&#160;the&#160;semicolon&#160;after&#160;&#160;test&#160;&#160;in&#160;the&#160;&#160;if<br/>command:<br/>
#!/bin/bash&#160;<br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1&#160;<br/>
<b>if [ $number = 1 ] then</b>&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>
The&#160;result&#160;is&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>/home/me/bin/trouble: line 9: syntax error near&#160;unexpected token&#160;<br/>`else'&#160;<br/>/home/me/bin/trouble: line 9: `else'<br/>
Again,&#160;the&#160;error&#160;message&#160;points&#160;to&#160;an&#160;error&#160;that&#160;occurs&#160;later&#160;than&#160;the&#160;actual&#160;problem.<br/>What&#160;happens&#160;is&#160;really&#160;pretty&#160;interesting.&#160;As&#160;we&#160;recall,&#160;&#160;if&#160;accepts&#160;a&#160;list&#160;of&#160;commands<br/>and&#160;evaluates&#160;the&#160;exit&#160;code&#160;of&#160;the&#160;last&#160;command&#160;in&#160;the&#160;list.&#160;In&#160;our&#160;program,&#160;we&#160;intend&#160;this<br/>list&#160;to&#160;consist&#160;of&#160;a&#160;single&#160;command,&#160;[,&#160;a&#160;synonym&#160;for&#160;test.&#160;The&#160;[&#160;command&#160;takes&#160;what<br/>follows&#160;it&#160;as&#160;a&#160;list&#160;of&#160;arguments;&#160;in&#160;our&#160;case,&#160;that’s&#160;four&#160;arguments:&#160;$number,&#160;1,&#160;=,&#160;and<br/>].&#160;With&#160;the&#160;semicolon&#160;removed,&#160;the&#160;word&#160;then&#160;is&#160;added&#160;to&#160;the&#160;list&#160;of&#160;arguments,&#160;which<br/>is&#160;syntactically&#160;legal.&#160;The&#160;following&#160;echo&#160;command&#160;is&#160;legal,&#160;too.&#160;It’s&#160;interpreted&#160;as&#160;an-<br/>other&#160;command&#160;in&#160;the&#160;list&#160;of&#160;commands&#160;that&#160;if&#160;will&#160;evaluate&#160;for&#160;an&#160;exit&#160;code.&#160;The&#160;else<br/>is&#160;encountered next,&#160;but&#160;it’s&#160;out&#160;of place&#160;since&#160;the&#160;shell&#160;recognizes&#160;it&#160;as&#160;a&#160;<i>reserved&#160;word</i>&#160;(a<br/>word&#160;that&#160;has&#160;special&#160;meaning&#160;to&#160;the&#160;shell)&#160;and&#160;not&#160;the&#160;name&#160;of&#160;a&#160;command,&#160;which&#160;is&#160;the<br/>reason for the&#160;error message.<br/>
Unanticipated&#160;Expansions<br/>It’s&#160;possible&#160;to&#160;have&#160;errors&#160;that&#160;occur&#160;only&#160;intermittently&#160;in&#160;a&#160;script.&#160;Sometimes&#160;the&#160;script<br/>will&#160;run&#160;fine&#160;and&#160;other&#160;times&#160;it&#160;will&#160;fail&#160;because&#160;of&#160;the&#160;results&#160;of&#160;an&#160;expansion.&#160;If&#160;we&#160;re-<br/>
432<br/>
<hr/>
<a name=457></a>Syntactic&#160;Errors<br/>
turn&#160;our&#160;missing&#160;semicolon&#160;and&#160;change&#160;the&#160;value&#160;of&#160;number&#160;to&#160;an&#160;empty&#160;variable,&#160;we<br/>can demonstrate.<br/>
#!/bin/bash&#160;<br/>
# trouble: script to demonstrate common errors&#160;<br/>
<b>number=&#160;</b><br/>
if [ $number = 1 ]; then&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>
Running the&#160;script&#160;with&#160;this&#160;change&#160;results&#160;in the&#160;following&#160;output:<br/>
[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>/home/me/bin/trouble: line 7: [: =:&#160;unary operator expected<br/>&#160;Number is not equal to 1.<br/>
We&#160;get&#160;this&#160;rather&#160;cryptic&#160;error&#160;message,&#160;followed&#160;by&#160;the&#160;output&#160;of&#160;the&#160;second&#160;&#160;echo<br/>command.&#160;The&#160;problem&#160;is&#160;the&#160;expansion&#160;of&#160;the&#160;number&#160;variable&#160;within&#160;the&#160;test&#160;com-<br/>mand.&#160;When&#160;the&#160;following&#160;command:<br/>
[ $number = 1 ]<br/>
undergoes&#160;expansion with&#160;number&#160;being empty, the&#160;result&#160;is&#160;this:<br/>
[ &#160;= 1 ]<br/>
which&#160;is&#160;invalid&#160;and&#160;the&#160;error is&#160;generated.&#160;The&#160;=&#160;operator&#160;is&#160;a&#160;binary&#160;operator&#160;(it&#160;requires<br/>a&#160;value&#160;on&#160;each&#160;side),&#160;but&#160;the&#160;first&#160;value&#160;is&#160;missing,&#160;so&#160;the&#160;&#160;test&#160;&#160;command&#160;&#160;expects&#160;a<br/>unary&#160;operator&#160;(such as&#160;-z) instead.&#160;Further,&#160;since&#160;the&#160;test&#160;failed&#160;(because&#160;of the&#160;error),<br/>the&#160;&#160;if&#160;&#160;command&#160;receives&#160;a&#160;non-zero&#160;exit&#160;code&#160;and&#160;acts&#160;accordingly,&#160;and&#160;the&#160;second<br/>echo&#160;command&#160;is&#160;executed.<br/>This&#160;problem&#160;can&#160;be&#160;corrected&#160;by&#160;adding&#160;quotes&#160;around&#160;the&#160;first&#160;argument&#160;in&#160;the&#160;test<br/>
433<br/>
<hr/>
<a name=458></a>30 –&#160;Troubleshooting<br/>
command.<br/>
[ &#34;$number&#34; = 1 ]<br/>
Then when expansion&#160;occurs, the&#160;result&#160;will&#160;be&#160;this:<br/>
[ &#34;&#34; = 1 ]<br/>
This&#160;yields&#160;the&#160;correct&#160;number&#160;of&#160;arguments.&#160;In&#160;addition&#160;to&#160;empty&#160;strings,&#160;quotes&#160;should<br/>be&#160;used&#160;in&#160;cases&#160;where&#160;a&#160;value&#160;could&#160;expand&#160;into&#160;multiword&#160;strings,&#160;as&#160;with&#160;filenames<br/>containing embedded spaces.<br/>
<b>Note:</b>&#160;Make&#160;it&#160;a&#160;rule&#160;to&#160;always&#160;enclose&#160;variables&#160;and&#160;command&#160;substitutions&#160;in<br/>double&#160;quotes&#160;unless&#160;word splitting is&#160;needed.<br/>
<b>Logical&#160;Errors&#160;<br/></b>Unlike&#160;syntactic&#160;errors,&#160;&#160;<i>logical&#160;errors</i>&#160;&#160;do&#160;not&#160;prevent&#160;a&#160;script&#160;from&#160;running.&#160;The&#160;script<br/>will&#160;run,&#160;but&#160;it&#160;will&#160;not&#160;produce&#160;the&#160;desired&#160;result,&#160;because&#160;of&#160;a&#160;problem&#160;with&#160;its&#160;logic.<br/>There&#160;are&#160;countless&#160;numbers&#160;of&#160;possible&#160;logical&#160;errors,&#160;but&#160;here&#160;are&#160;a&#160;few&#160;of&#160;the&#160;most<br/>common&#160;kinds&#160;found in scripts:<br/>
1.&#160;<b>Incorrect&#160;&#160;conditional&#160;&#160;expressions.</b>&#160;&#160;It’s&#160;easy&#160;to&#160;incorrectly&#160;code&#160;an&#160;if/then/else<br/>
and&#160;have&#160;the&#160;wrong&#160;logic&#160;carried&#160;out.&#160;Sometimes&#160;the&#160;logic&#160;will&#160;be&#160;reversed,&#160;or&#160;it<br/>will&#160;be&#160;incomplete.<br/>
2.&#160;<b>“Off&#160;by&#160;one”&#160;errors.</b>&#160;When&#160;coding&#160;loops&#160;that&#160;employ&#160;counters,&#160;it&#160;is&#160;possible&#160;to<br/>
overlook&#160;that&#160;the&#160;loop&#160;may&#160;require&#160;that&#160;the&#160;counting&#160;start&#160;with&#160;zero,&#160;rather&#160;than<br/>one,&#160;for&#160;the&#160;count&#160;to&#160;conclude&#160;at&#160;the&#160;correct&#160;point.&#160;These&#160;kinds&#160;of&#160;errors&#160;result&#160;in<br/>either&#160;a&#160;loop&#160;“going&#160;off&#160;the&#160;end”&#160;by&#160;counting&#160;too&#160;far&#160;or&#160;a&#160;loop&#160;missing&#160;the&#160;last&#160;it-<br/>eration&#160;by terminating one&#160;iteration too&#160;soon.<br/>
3.&#160;<b>Unanticipated&#160;situations.</b>&#160;Most&#160;logic&#160;errors&#160;result&#160;from&#160;a&#160;program&#160;encountering<br/>
data&#160;or&#160;situations&#160;that&#160;were&#160;unforeseen&#160;by&#160;the&#160;programmer.&#160;As&#160;we&#160;have&#160;seen,&#160;this<br/>can&#160;also&#160;include&#160;unanticipated&#160;expansions,&#160;such&#160;as&#160;a&#160;filename&#160;that&#160;contains&#160;em-<br/>bedded&#160;spaces&#160;that&#160;expands&#160;into&#160;multiple&#160;command&#160;arguments&#160;rather&#160;than&#160;a&#160;single<br/>filename.<br/>
434<br/>
<hr/>
<a name=459></a>Logical&#160;Errors&#160;<br/>
Defensive&#160;Programming<br/>It&#160;is&#160;important&#160;to&#160;verify&#160;assumptions&#160;when&#160;programming.&#160;This&#160;means&#160;a&#160;careful&#160;evaluation<br/>of&#160;the&#160;exit&#160;status&#160;of&#160;programs&#160;and&#160;commands&#160;that&#160;are&#160;used&#160;by&#160;a&#160;script.&#160;Here&#160;is&#160;an&#160;exam-<br/>ple, based&#160;on a&#160;true&#160;story.&#160;An unfortunate&#160;system&#160;administrator&#160;wrote&#160;a&#160;script&#160;to perform&#160;a<br/>maintenance&#160;task&#160;on&#160;an&#160;important&#160;server.&#160;The&#160;script&#160;contained&#160;the&#160;following&#160;two&#160;lines&#160;of<br/>code:<br/>
cd $dir_name<br/>rm *<br/>
There&#160;is&#160;nothing&#160;intrinsically&#160;wrong&#160;with&#160;these&#160;two&#160;lines,&#160;as&#160;long&#160;as&#160;the&#160;directory&#160;named<br/>in&#160;the&#160;variable,&#160;dir_name,&#160;exists.&#160;But&#160;what&#160;happens&#160;if&#160;it&#160;does&#160;not?&#160;In&#160;that&#160;case,&#160;the&#160;cd<br/>command&#160;fails,&#160;and&#160;the&#160;script&#160;continues&#160;to&#160;the&#160;next&#160;line&#160;and&#160;deletes&#160;the&#160;files&#160;in&#160;the&#160;current<br/>working&#160;directory.&#160;Not&#160;the&#160;desired&#160;outcome&#160;at&#160;all!&#160;The&#160;hapless&#160;administrator&#160;destroyed&#160;an<br/>important&#160;part&#160;of the&#160;server&#160;because&#160;of this&#160;design decision.<br/>Let’s&#160;look&#160;at&#160;some&#160;ways&#160;this&#160;design&#160;could&#160;be&#160;improved.&#160;First,&#160;it&#160;might&#160;be&#160;wise&#160;to&#160;ensure<br/>that&#160;the&#160;dir_name&#160;variable&#160;expands&#160;into&#160;only&#160;one&#160;word&#160;by&#160;quoting&#160;it&#160;and&#160;make&#160;the&#160;exe-<br/>cution&#160;of&#160;rm&#160;contingent&#160;on the&#160;success&#160;of&#160;cd.<br/>
cd &#34;$dir_name&#34; &amp;&amp; rm *<br/>
This&#160;way,&#160;if&#160;the&#160;cd&#160;command&#160;fails,&#160;the&#160;rm&#160;command&#160;is&#160;not&#160;carried&#160;out.&#160;This&#160;is&#160;better&#160;but<br/>still&#160;leaves&#160;open&#160;the&#160;possibility&#160;that&#160;the&#160;variable,&#160;dir_name,&#160;is&#160;unset&#160;or&#160;empty,&#160;which<br/>would&#160;result&#160;in&#160;the&#160;files&#160;in&#160;the&#160;user’s&#160;home&#160;directory&#160;being&#160;deleted.&#160;This&#160;could&#160;also&#160;be<br/>avoided&#160;by&#160;checking&#160;to&#160;see&#160;that&#160;dir_name&#160;actually&#160;contains&#160;the&#160;name&#160;of&#160;an&#160;existing&#160;di-<br/>rectory.<br/>
[[ -d &#34;$dir_name&#34; ]] &amp;&amp; cd &#34;$dir_name&#34; &amp;&amp; rm *<br/>
Often,&#160;it&#160;is&#160;best&#160;to&#160;include&#160;logic&#160;to&#160;terminate&#160;the&#160;script&#160;and&#160;report&#160;an&#160;error&#160;when&#160;an&#160;situa-<br/>tion such as&#160;the&#160;one&#160;shown previously occurs.<br/>
# Delete files in directory $dir_name<br/>if [[ ! -d &#34;$dir_name&#34; ]]; then<br/>
echo &#34;No such directory: '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>
435<br/>
<hr/>
<a name=460></a>30 –&#160;Troubleshooting<br/>
if ! cd &#34;$dir_name&#34;; then<br/>
echo &#34;Cannot cd to '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>if ! rm *; then<br/>
echo &#34;File deletion failed. Check results&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>
Here,&#160;we&#160;check&#160;both&#160;the&#160;name,&#160;to&#160;see&#160;that&#160;it&#160;is&#160;an&#160;existing&#160;directory,&#160;and&#160;the&#160;success&#160;of<br/>the&#160;cd&#160;command.&#160;If&#160;either&#160;fails,&#160;a&#160;descriptive&#160;error&#160;message&#160;is&#160;sent&#160;to&#160;standard&#160;error,&#160;and<br/>the&#160;script&#160;terminates&#160;with an exit&#160;status&#160;of one&#160;to indicate&#160;a&#160;failure.<br/>
Watch&#160;Out&#160;for&#160;Filenames<br/>There&#160;is&#160;another&#160;problem&#160;with&#160;this&#160;file&#160;deletion&#160;script&#160;that&#160;is&#160;more&#160;obscure&#160;but&#160;could&#160;be<br/>very&#160;dangerous.&#160;Unix&#160;(and&#160;Unix-like&#160;operating&#160;systems)&#160;has,&#160;in&#160;the&#160;opinion&#160;of&#160;many,&#160;a<br/>serious&#160;design&#160;flaw&#160;when&#160;it&#160;comes&#160;to&#160;&#160;filenames.&#160;Unix&#160;is&#160;extremely&#160;permissive&#160;about<br/>them.&#160;In&#160;fact,&#160;there&#160;are&#160;only&#160;two&#160;characters&#160;that&#160;cannot&#160;be&#160;included&#160;in&#160;a&#160;filename.&#160;The<br/>first&#160;is&#160;the&#160;/&#160;character&#160;since&#160;it&#160;is&#160;used&#160;to&#160;separate&#160;elements&#160;of&#160;a&#160;pathname,&#160;and&#160;the&#160;second<br/>is&#160;the&#160;null&#160;character&#160;(a&#160;zero&#160;byte),&#160;which&#160;is&#160;used&#160;internally&#160;to&#160;mark&#160;the&#160;ends&#160;of&#160;&#160;strings.<br/>Everything&#160;else&#160;is&#160;legal&#160;including&#160;spaces,&#160;tabs,&#160;line&#160;feeds,&#160;leading&#160;hyphens,&#160;carriage&#160;re-<br/>turns, and so on.<br/>Of&#160;particular&#160;concern&#160;are&#160;leading&#160;hyphens.&#160;For&#160;example,&#160;it's&#160;perfectly&#160;legal&#160;to&#160;have&#160;a&#160;file<br/>named&#160;&#34;-rf ~&#34;. Consider&#160;for a&#160;moment&#160;what&#160;happens&#160;when&#160;that&#160;filename&#160;is&#160;passed to&#160;rm.<br/>To&#160;defend&#160;against&#160;this&#160;problem,&#160;we&#160;want&#160;to&#160;change&#160;our&#160;rm&#160;command&#160;in&#160;the&#160;file&#160;deletion<br/>script&#160;from&#160;this:<br/>rm *<br/>to the&#160;following:<br/>rm ./*<br/>This&#160;will&#160;prevent&#160;a&#160;filename&#160;starting&#160;with&#160;a&#160;hyphen&#160;from&#160;being&#160;interpreted&#160;as&#160;a&#160;command<br/>option.&#160;As&#160;a&#160;general&#160;rule,&#160;always&#160;precede&#160;wildcards&#160;(such&#160;as&#160;*&#160;and&#160;?)&#160;with&#160;./&#160;to&#160;prevent<br/>misinterpretation&#160;by&#160;commands.&#160;This&#160;includes&#160;things&#160;like&#160;*.pdf&#160;and&#160;???.mp3,&#160;for&#160;ex-<br/>ample.<br/>
436<br/>
<hr/>
<a name=461></a>Logical&#160;Errors&#160;<br/>
<b>Portable&#160;Filenames</b><br/>
To&#160;ensure&#160;that&#160;a&#160;filename&#160;is&#160;portable&#160;between&#160;multiple&#160;platforms&#160;(i.e.,&#160;different<br/>types&#160;of&#160;computers&#160;and&#160;operating&#160;systems),&#160;care&#160;must&#160;be&#160;taken&#160;to&#160;limit&#160;which<br/>characters&#160;are&#160;included&#160;in&#160;a&#160;filename.&#160;There&#160;is&#160;a&#160;standard&#160;called&#160;the&#160;POSIX&#160;Porta-<br/>ble&#160;Filename&#160;Character&#160;Set&#160;that&#160;can&#160;be&#160;used&#160;to&#160;maximize&#160;the&#160;chances&#160;that&#160;a&#160;file-<br/>name&#160;will&#160;work&#160;across&#160;different&#160;systems.&#160;The&#160;standard&#160;is&#160;pretty&#160;simple.&#160;The&#160;only<br/>characters&#160;allowed&#160;are&#160;the&#160;uppercase&#160;letters&#160;A-Z,&#160;the&#160;lowercase&#160;letters&#160;a-z,&#160;the&#160;nu-<br/>merals&#160;0-9,&#160;period&#160;(.),&#160;hyphen&#160;(-),&#160;and&#160;underscore&#160;(_).&#160;The&#160;standard&#160;further&#160;sug-<br/>gests&#160;that&#160;filenames&#160;not&#160;begin&#160;with a&#160;hyphen.<br/>
Verifying&#160;Input<br/>A&#160;general&#160;rule&#160;of&#160;good&#160;programming&#160;is&#160;that&#160;if&#160;a&#160;program&#160;accepts&#160;input,&#160;it&#160;must&#160;be&#160;able&#160;to<br/>deal&#160;with anything&#160;it&#160;receives.&#160;This&#160;usually means&#160;that&#160;input&#160;must&#160;be&#160;carefully screened to<br/>ensure&#160;that&#160;only&#160;valid&#160;input&#160;is&#160;accepted&#160;for&#160;further&#160;processing.&#160;We&#160;saw&#160;an&#160;example&#160;of&#160;this<br/>in&#160;the&#160;previous&#160;chapter&#160;when&#160;we&#160;studied&#160;the&#160;read&#160;command.&#160;One&#160;script&#160;contained&#160;the<br/>following test&#160;to verify&#160;a&#160;menu&#160;selection:<br/>
[[ $REPLY =~ ^[0-3]$ ]]<br/>
This&#160;test&#160;is&#160;very&#160;specific.&#160;It&#160;will&#160;return&#160;a&#160;zero&#160;exit&#160;status&#160;only&#160;if&#160;the&#160;string&#160;entered&#160;by&#160;the<br/>user&#160;is&#160;a&#160;numeral&#160;in&#160;the&#160;range&#160;of&#160;zero&#160;to&#160;three.&#160;Nothing&#160;else&#160;will&#160;be&#160;accepted.&#160;Sometimes<br/>these&#160;kinds&#160;of&#160;tests&#160;can&#160;be&#160;challenging&#160;to&#160;write,&#160;but&#160;the&#160;effort&#160;is&#160;necessary&#160;to&#160;produce&#160;a<br/>high-quality script.&#160;<br/>
<b>Design&#160;is&#160;a&#160;Function&#160;of&#160;Time</b><br/>
When&#160;I&#160;was&#160;a&#160;college&#160;student&#160;studying&#160;industrial&#160;design,&#160;a&#160;wise&#160;professor&#160;stated<br/>that&#160;the&#160;amount&#160;of&#160;&#160;design&#160;&#160;on&#160;a&#160;project&#160;was&#160;determined&#160;by&#160;the&#160;amount&#160;of&#160;time<br/>given&#160;to&#160;the&#160;designer.&#160;If&#160;you&#160;were&#160;given&#160;five&#160;minutes&#160;to&#160;design&#160;a&#160;device&#160;“that&#160;kills<br/>flies,”&#160;you&#160;designed&#160;a&#160;flyswatter.&#160;If&#160;you&#160;were&#160;given&#160;five&#160;months,&#160;you&#160;might&#160;come<br/>up with a&#160;laser-guided “anti-fly&#160;system”&#160;instead.<br/>The&#160;&#160;&#160;same&#160;&#160;&#160;principle&#160;&#160;&#160;applies&#160;&#160;&#160;to&#160;&#160;&#160;programming.&#160;&#160;&#160;Sometimes&#160;&#160;&#160;a&#160;&#160;&#160;“quick-and-dirty”<br/>script&#160;will&#160;do&#160;if&#160;it’s&#160;going&#160;to&#160;be&#160;used&#160;once&#160;and&#160;only&#160;by&#160;the&#160;programmer.&#160;That&#160;kind<br/>of&#160;script&#160;is&#160;common&#160;and&#160;should&#160;be&#160;developed&#160;quickly&#160;to&#160;make&#160;the&#160;effort&#160;economi-<br/>
437<br/>
<hr/>
<a name=462></a>30 –&#160;Troubleshooting<br/>
cal.&#160;Such&#160;scripts&#160;don’t&#160;need&#160;a&#160;lot&#160;of&#160;comments&#160;and&#160;defensive&#160;checks.&#160;On&#160;the&#160;other<br/>hand,&#160;if&#160;a&#160;script&#160;is&#160;intended&#160;for&#160;<i>production&#160;use,</i>&#160;that&#160;is,&#160;a&#160;script&#160;that&#160;will&#160;be&#160;used<br/>over&#160;and&#160;over&#160;for&#160;an&#160;important&#160;task&#160;or&#160;by&#160;multiple&#160;users,&#160;it&#160;needs&#160;much&#160;more<br/>careful&#160;development.<br/>
<b>Testing<br/></b>Testing&#160;is&#160;an&#160;important&#160;step&#160;in&#160;every&#160;kind&#160;of&#160;software&#160;development,&#160;including&#160;scripts.<br/>There&#160;is&#160;a&#160;saying&#160;in&#160;the&#160;open-source&#160;world,&#160;“release&#160;early,&#160;release&#160;often,”&#160;that&#160;reflects&#160;this<br/>fact.&#160;By releasing&#160;early&#160;and often, software&#160;gets&#160;more&#160;exposure&#160;to use&#160;and testing.&#160;Experi-<br/>ence&#160;has&#160;shown&#160;that&#160;bugs&#160;are&#160;much&#160;easier&#160;to&#160;find,&#160;and&#160;much&#160;less&#160;expensive&#160;to&#160;fix,&#160;if&#160;they<br/>are&#160;found early in the&#160;development&#160;cycle.<br/>In&#160;Chapter&#160;26,&#160;“Top-Down&#160;Design,”&#160;we&#160;saw&#160;how&#160;&#160;stubs&#160;&#160;can&#160;be&#160;used&#160;to&#160;verify&#160;program<br/>flow.&#160;From&#160;the&#160;earliest&#160;stages&#160;of&#160;script&#160;development,&#160;they&#160;are&#160;a&#160;valuable&#160;technique&#160;to<br/>check&#160;the&#160;progress&#160;of our work.<br/>Let’s&#160;look&#160;at&#160;the&#160;file-deletion&#160;problem&#160;shown&#160;previously&#160;and&#160;see&#160;how&#160;this&#160;could&#160;be&#160;coded<br/>for&#160;easy&#160;testing.&#160;Testing&#160;the&#160;original&#160;fragment&#160;of&#160;code&#160;would&#160;be&#160;dangerous&#160;since&#160;its&#160;pur-<br/>pose&#160;is&#160;to delete&#160;files, but&#160;we&#160;could&#160;modify&#160;the&#160;code&#160;to make&#160;the&#160;test&#160;safe.<br/>
if [[ -d $dir_name ]]; then<br/>
if cd $dir_name; then<br/>
<b>echo</b>&#160;rm *&#160;<b># TESTING</b><br/>
else<br/>
echo &#34;cannot cd to '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>
else<br/>
echo &#34;no such directory: '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/><b>exit # TESTING</b><br/>
Since&#160;the&#160;error&#160;conditions&#160;already&#160;output&#160;useful&#160;messages,&#160;we&#160;don't&#160;have&#160;to&#160;add&#160;any.&#160;The<br/>most&#160;important&#160;change&#160;is&#160;placing&#160;an&#160;echo&#160;command&#160;just&#160;before&#160;the&#160;rm&#160;command&#160;to&#160;al-<br/>low&#160;the&#160;command&#160;and&#160;its&#160;expanded&#160;argument&#160;list&#160;to&#160;be&#160;displayed,&#160;rather&#160;than&#160;the&#160;com-<br/>mand&#160;actually&#160;being&#160;executed.&#160;This&#160;change&#160;allows&#160;safe&#160;execution&#160;of&#160;the&#160;code.&#160;At&#160;the&#160;end<br/>of&#160;the&#160;code&#160;fragment,&#160;we&#160;place&#160;an&#160;exit&#160;command&#160;to&#160;conclude&#160;the&#160;test&#160;and&#160;prevent&#160;any<br/>other&#160;part&#160;of the&#160;script&#160;from&#160;being&#160;carried&#160;out.&#160;The&#160;need&#160;for this&#160;will&#160;vary&#160;according&#160;to&#160;the<br/>
438<br/>
<hr/>
<a name=463></a>Testing<br/>
design of the&#160;script.<br/>We&#160;also&#160;include&#160;some&#160;comments&#160;that&#160;act&#160;as&#160;“markers”&#160;for&#160;our&#160;test-related&#160;changes.&#160;These<br/>can be&#160;used to&#160;help find&#160;and remove&#160;the&#160;changes&#160;when&#160;testing&#160;is&#160;complete.<br/>
Test&#160;Cases<br/>To&#160;perform&#160;useful&#160;testing,&#160;it's&#160;important&#160;to&#160;develop&#160;and&#160;apply&#160;good&#160;&#160;<i>test&#160;cases</i>.&#160;This&#160;is<br/>done&#160;by&#160;carefully&#160;choosing&#160;input&#160;data&#160;or&#160;operating&#160;conditions&#160;that&#160;reflect&#160;<i>edge</i>&#160;and&#160;<i>cor-<br/>ner</i>&#160;cases.&#160;In&#160;our&#160;code&#160;fragment&#160;(which&#160;is&#160;simple),&#160;we&#160;want&#160;to&#160;know&#160;how&#160;the&#160;code&#160;per-<br/>forms&#160;under three&#160;specific&#160;conditions:<br/>
1.&#160;dir_name&#160;contains&#160;the&#160;name&#160;of an existing directory.<br/>2.&#160;dir_name&#160;contains&#160;the&#160;name&#160;of a&#160;nonexistent&#160;directory.<br/>3.&#160;dir_name&#160;is&#160;empty.<br/>
By performing&#160;the&#160;test&#160;with each&#160;of these&#160;conditions, good&#160;<i>test&#160;coverage</i>&#160;is&#160;achieved.<br/>Just&#160;as&#160;with&#160;design,&#160;testing&#160;is&#160;a&#160;function&#160;of&#160;time,&#160;as&#160;well.&#160;Not&#160;every&#160;script&#160;feature&#160;needs&#160;to<br/>be&#160;extensively&#160;tested.&#160;It's&#160;really&#160;a&#160;matter&#160;of&#160;determining&#160;what&#160;is&#160;most&#160;important.&#160;Since&#160;it<br/>could be&#160;so potentially destructive&#160;if it&#160;malfunctioned,&#160;our code&#160;fragment&#160;deserves&#160;careful<br/>consideration during&#160;both its&#160;design and&#160;testing.<br/>
<b>Debugging<br/></b>If&#160;testing&#160;reveals&#160;a&#160;problem&#160;with&#160;a&#160;script,&#160;the&#160;next&#160;step&#160;is&#160;debugging.&#160;“A&#160;problem”&#160;usually<br/>means&#160;that&#160;the&#160;script&#160;is,&#160;in&#160;some&#160;way,&#160;not&#160;performing&#160;to&#160;the&#160;programmer's&#160;expectations.&#160;If<br/>this&#160;is&#160;the&#160;case,&#160;we&#160;need&#160;to&#160;carefully&#160;determine&#160;exactly&#160;what&#160;the&#160;script&#160;is&#160;actually&#160;doing<br/>and why. Finding&#160;bugs&#160;can sometimes&#160;involve&#160;a&#160;lot&#160;of detective&#160;work.&#160;<br/>A&#160;well-designed&#160;script&#160;will&#160;try to&#160;help. It&#160;should&#160;be&#160;programmed&#160;defensively, to detect&#160;ab-<br/>normal&#160;conditions&#160;and&#160;provide&#160;useful&#160;feedback&#160;to&#160;the&#160;user.&#160;Sometimes,&#160;however,&#160;prob-<br/>lems&#160;are&#160;quite&#160;strange&#160;and&#160;unexpected,&#160;and more&#160;involved&#160;techniques&#160;are&#160;required.<br/>
Finding&#160;the&#160;Problem&#160;Area<br/>In&#160;some&#160;scripts,&#160;particularly&#160;long&#160;ones,&#160;it&#160;is&#160;sometimes&#160;useful&#160;to&#160;isolate&#160;the&#160;area&#160;of&#160;the<br/>script&#160;that&#160;is&#160;related&#160;to&#160;the&#160;problem.&#160;This&#160;won’t&#160;always&#160;be&#160;the&#160;actual&#160;error,&#160;but&#160;isolation<br/>will&#160;often&#160;provide&#160;insights&#160;into&#160;the&#160;actual&#160;cause.&#160;One&#160;technique&#160;that&#160;can&#160;be&#160;used&#160;to&#160;isolate<br/>code&#160;is&#160;“commenting&#160;out”&#160;sections&#160;of&#160;a&#160;script.&#160;For&#160;example,&#160;our&#160;file&#160;deletion&#160;fragment<br/>could be&#160;modified&#160;to determine&#160;whether the&#160;removed&#160;section&#160;was&#160;related&#160;to an error.<br/>
if [[ -d $dir_name ]]; then<br/>
439<br/>
<hr/>
<a name=464></a>30 –&#160;Troubleshooting<br/>
if cd $dir_name; then<br/>
rm *<br/>
else<br/>
echo &#34;cannot cd to '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>
<b># else<br/>#</b><br/>
<b>echo &#34;no such directory: '$dir_name'&#34; &gt;&amp;2</b><br/>
<b>#</b><br/>
<b>exit 1</b><br/>
fi<br/>
By&#160;placing&#160;comment&#160;symbols&#160;at&#160;the&#160;beginning&#160;of&#160;each&#160;line&#160;in&#160;a&#160;logical&#160;section&#160;of&#160;a&#160;script,<br/>we&#160;prevent&#160;that&#160;section&#160;from&#160;being&#160;executed.&#160;Testing&#160;can&#160;then&#160;be&#160;performed&#160;again,&#160;to&#160;see<br/>whether the&#160;removal&#160;of the&#160;code&#160;has&#160;any impact&#160;on the&#160;behavior of the&#160;bug.&#160;<br/>
Tracing<br/>Bugs&#160;are&#160;often&#160;cases&#160;of&#160;unexpected&#160;logical&#160;flow&#160;within&#160;a&#160;script.&#160;That&#160;is,&#160;portions&#160;of&#160;the<br/>script&#160;either&#160;are&#160;never&#160;being&#160;executed&#160;or&#160;are&#160;being&#160;executed&#160;in&#160;the&#160;wrong&#160;order&#160;or&#160;at&#160;the<br/>wrong time.&#160;To view&#160;the&#160;actual&#160;flow&#160;of the&#160;program,&#160;we&#160;use&#160;a&#160;technique&#160;called&#160;<i>tracing</i>.<br/>One&#160;tracing&#160;method&#160;involves&#160;placing&#160;informative&#160;messages&#160;in&#160;a&#160;script&#160;that&#160;display&#160;the&#160;lo-<br/>cation&#160;of execution.&#160;We&#160;can&#160;add messages&#160;to our code&#160;fragment.<br/>
<b>echo &#34;preparing to delete files&#34; &gt;&amp;2<br/></b>if [[ -d $dir_name ]]; then<br/>
if cd $dir_name; then<br/>
<b>echo &#34;deleting files&#34; &gt;&amp;2</b><br/>
rm *<br/>
else<br/>
echo &#34;cannot cd to '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/>
else<br/>
echo &#34;no such directory: '$dir_name'&#34; &gt;&amp;2<br/>exit 1<br/>
fi<br/><b>echo &#34;file deletion complete&#34; &gt;&amp;2</b><br/>
We&#160;send&#160;the&#160;messages&#160;to&#160;standard&#160;error&#160;to&#160;separate&#160;them&#160;from&#160;normal&#160;output.&#160;We&#160;also&#160;do<br/>not&#160;indent&#160;the&#160;lines&#160;containing&#160;the&#160;messages,&#160;so&#160;it&#160;is&#160;easier&#160;to&#160;find&#160;when&#160;it’s&#160;time&#160;to&#160;re-<br/>move&#160;them.<br/>
440<br/>
<hr/>
<a name=465></a>Debugging<br/>
Now&#160;when&#160;the&#160;script&#160;is&#160;executed,&#160;it’s&#160;possible&#160;to&#160;see&#160;that&#160;the&#160;file&#160;deletion&#160;has&#160;been&#160;per-<br/>formed.<br/>
[me@linuxbox ~]$ deletion-script<br/>preparing to delete files<br/>deleting files<br/>file deletion complete<br/>[me@linuxbox ~]$&#160;<br/>
bash&#160;&#160;also&#160;provides&#160;a&#160;method&#160;of&#160;tracing,&#160;implemented&#160;by&#160;the&#160;&#160;-x&#160;&#160;option&#160;and&#160;the&#160;&#160;set<br/>command&#160;with&#160;the&#160;-x&#160;option.&#160;Using&#160;our&#160;earlier&#160;trouble&#160;script,&#160;we&#160;can&#160;activate&#160;tracing<br/>for the&#160;entire&#160;script&#160;by adding&#160;the&#160;-x&#160;option&#160;to the&#160;first&#160;line.<br/>
<b>#!/bin/bash -x</b><br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1&#160;<br/>
if [ $number = 1 ]; then&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>
When executed,&#160;the&#160;results&#160;look&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>+ number=1&#160;<br/>+ '[' 1 = 1 ']'&#160;<br/>+ echo 'Number is equal to 1.'&#160;<br/>Number is equal to 1.<br/>
With&#160;tracing&#160;enabled,&#160;we&#160;see&#160;the&#160;commands&#160;performed&#160;with&#160;expansions&#160;applied.&#160;The<br/>leading&#160;plus&#160;signs&#160;indicate&#160;the&#160;display&#160;of&#160;the&#160;trace&#160;to&#160;distinguish&#160;them&#160;from&#160;lines&#160;of&#160;regu-<br/>lar&#160;output.&#160;The&#160;plus&#160;sign&#160;is&#160;the&#160;default&#160;character&#160;for&#160;trace&#160;output.&#160;It&#160;is&#160;contained&#160;in&#160;the<br/>PS4&#160;&#160;(prompt&#160;string&#160;4)&#160;shell&#160;variable.&#160;The&#160;contents&#160;of&#160;this&#160;variable&#160;can&#160;be&#160;adjusted&#160;to<br/>make&#160;the&#160;prompt&#160;more&#160;useful.&#160;Here,&#160;we&#160;modify&#160;the&#160;contents&#160;of&#160;the&#160;variable&#160;to&#160;include&#160;the<br/>current&#160;line&#160;number&#160;in&#160;the&#160;script&#160;where&#160;the&#160;trace&#160;is&#160;performed.&#160;Note&#160;that&#160;single&#160;quotes&#160;are<br/>required&#160;to prevent&#160;expansion until&#160;the&#160;prompt&#160;is&#160;actually used.<br/>
441<br/>
<hr/>
<a name=466></a>30 –&#160;Troubleshooting<br/>
[me@linuxbox ~]$&#160;<b>export PS4='$LINENO + '<br/></b>[me@linuxbox ~]$&#160;<b>trouble</b>&#160;<br/>5 + number=1&#160;<br/>7 + '[' 1 = 1 ']'&#160;<br/>8 + echo 'Number is equal to 1.'&#160;<br/>Number is equal to 1.<br/>
To&#160;perform&#160;a&#160;trace&#160;on&#160;a&#160;selected&#160;portion&#160;of&#160;a&#160;script,&#160;rather&#160;than&#160;the&#160;entire&#160;script,&#160;we&#160;can<br/>use&#160;the&#160;set&#160;command with&#160;the&#160;-x&#160;option.<br/>
#!/bin/bash<br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1<br/>
<b>set -x # Turn on tracing<br/></b>if [ $number = 1 ]; then&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/><b>set +x # Turn off tracing</b><br/>
We&#160;use&#160;the&#160;set&#160;command&#160;with&#160;the&#160;-x&#160;option&#160;to&#160;activate&#160;tracing&#160;and&#160;the&#160;+x&#160;option&#160;to&#160;de-<br/>activate&#160;tracing.&#160;This&#160;technique&#160;can&#160;be&#160;used&#160;to&#160;examine&#160;multiple&#160;portions&#160;of&#160;a&#160;trouble-<br/>some&#160;script.<br/>
Examining&#160;Values&#160;During&#160;Execution<br/>It&#160;is&#160;often&#160;useful,&#160;along&#160;with&#160;tracing,&#160;to&#160;display&#160;the&#160;content&#160;of&#160;variables&#160;to&#160;see&#160;the&#160;internal<br/>workings&#160;of&#160;a&#160;script&#160;while&#160;it&#160;is&#160;being&#160;executed.&#160;Applying&#160;additional&#160;echo&#160;statements&#160;will<br/>usually do the&#160;trick.<br/>
#!/bin/bash<br/>
# trouble: script to demonstrate common errors&#160;<br/>
number=1<br/>
442<br/>
<hr/>
<a name=467></a>Debugging<br/>
<b>echo &#34;number=$number&#34; # DEBUG<br/></b>set -x # Turn on tracing<br/>if [ $number = 1 ]; then&#160;<br/>
echo &#34;Number is equal to 1.&#34;&#160;<br/>
else&#160;<br/>
echo &#34;Number is not equal to 1.&#34;&#160;<br/>
fi<br/>set +x # Turn off tracing<br/>
In&#160;this&#160;trivial&#160;example,&#160;we&#160;simply&#160;display&#160;the&#160;value&#160;of&#160;the&#160;variable&#160;number&#160;and&#160;mark&#160;the<br/>added&#160;line&#160;with&#160;a&#160;comment&#160;to&#160;facilitate&#160;its&#160;later&#160;identification&#160;and&#160;removal.&#160;This&#160;tech-<br/>nique&#160;is&#160;particularly&#160;useful&#160;when&#160;watching&#160;the&#160;behavior&#160;of&#160;loops&#160;and&#160;arithmetic&#160;within<br/>scripts.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;looked&#160;at&#160;just&#160;a&#160;few&#160;of&#160;the&#160;problems&#160;that&#160;can&#160;crop&#160;up&#160;during&#160;script&#160;de-<br/>velopment.&#160;Of&#160;course,&#160;there&#160;are&#160;many&#160;more.&#160;The&#160;techniques&#160;described&#160;here&#160;will&#160;enable<br/>finding&#160;most&#160;common&#160;bugs.&#160;Debugging&#160;is&#160;a&#160;fine&#160;art&#160;that&#160;is&#160;developed&#160;through&#160;experience,<br/>both&#160;in&#160;knowing&#160;how&#160;to&#160;avoid&#160;bugs&#160;(testing&#160;constantly&#160;throughout&#160;development)&#160;and&#160;in<br/>finding bugs&#160;(effective&#160;use&#160;of tracing).<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;Wikipedia&#160;has&#160;a&#160;couple&#160;of short&#160;articles&#160;on syntactic&#160;and logical&#160;errors:<br/><a href="http://en.wikipedia.org/wiki/Syntax_error">http://en.wikipedia.org/wiki/Syntax_error<br/></a><a href="http://en.wikipedia.org/wiki/Logic_error">http://en.wikipedia.org/wiki/Logic_error</a><br/>
●<br/>
There&#160;are&#160;many&#160;online&#160;resources&#160;for the&#160;technical&#160;aspects&#160;of&#160;bash&#160;programming:<br/><a href="http://mywiki.wooledge.org/BashPitfalls">http://mywiki.wooledge.org/BashPitfalls<br/></a><a href="http://tldp.org/LDP/abs/html/gotchas.html">http://tldp.org/LDP/abs/html/gotchas.html<br/></a><a href="http://www.gnu.org/software/bash/manual/html_node/Reserved-Word-Index.html">http://www.gnu.org/software/bash/manual/html_node/Reserved-Word-Index.html</a><br/>
●<br/>
David&#160;Wheeler has&#160;a&#160;excellent&#160;discussion of the&#160;Unix filename&#160;problem&#160;and how&#160;<br/>to code&#160;shell&#160;scripts&#160;to&#160;deal&#160;with it:<br/><a href="https://www.dwheeler.com/essays/filenames-in-shell.html">https://www.dwheeler.com/essays/filenames-in-shell.html</a><br/>
●<br/>
For really&#160;heavy-duty&#160;debugging, there&#160;is&#160;the&#160;Bash Debugger:<br/><a href="http://bashdb.sourceforge.net/">http://bashdb.sourceforge.net/</a><br/>
443<br/>
<hr/>
<a name=468></a>31 – Flow&#160;Control:&#160;Branching with&#160;case<br/>
<i><b>31&#160;–&#160;Flow&#160;Control:&#160;Branching&#160;with&#160;case</b></i><br/>
In&#160;this&#160;chapter,&#160;we&#160;will&#160;continue&#160;our&#160;look&#160;at&#160;flow&#160;control.&#160;In&#160;Chapter&#160;28,&#160;“Reading&#160;Key-<br/>board&#160;Input,”&#160;we&#160;constructed&#160;some&#160;simple&#160;menus&#160;and&#160;built&#160;the&#160;logic&#160;used&#160;to&#160;act&#160;on&#160;a<br/>user’s&#160;selection.&#160;To&#160;do&#160;this,&#160;we&#160;used&#160;a&#160;series&#160;of&#160;if&#160;commands&#160;to&#160;identify&#160;which&#160;of&#160;the<br/>possible&#160;choices&#160;had&#160;been&#160;selected.&#160;This&#160;type&#160;of&#160;logical&#160;construct&#160;appears&#160;frequently&#160;in<br/>programs,&#160;so&#160;much&#160;so&#160;that&#160;many&#160;programming&#160;languages&#160;(including&#160;the&#160;shell)&#160;provide&#160;a<br/>special&#160;flow&#160;control&#160;mechanism&#160;for&#160;multiple-choice&#160;decisions.<br/>
<b>case<br/></b>In&#160;bash,&#160;multiple-choice&#160;compound&#160;command&#160;is&#160;called&#160;case.&#160;It&#160;has&#160;the&#160;following&#160;syn-<br/>tax:<br/>case&#160;<i>word</i>&#160;in<br/>
[<i>pattern</i>&#160;[|&#160;<i>pattern</i>]...)&#160;<i>commands</i>&#160;;;]...<br/>
esac<br/>
If&#160;we&#160;look&#160;at&#160;the&#160;read-menu&#160;program&#160;from&#160;Chapter&#160;28,&#160;we&#160;see&#160;the&#160;logic&#160;used&#160;to&#160;act&#160;on<br/>a&#160;user’s&#160;selection.<br/>
#!/bin/bash&#160;<br/>
# read-menu: a menu driven system information program&#160;<br/>
clear&#160;<br/>echo &#34;&#160;<br/>Please Select:&#160;<br/>
1. Display System Information&#160;<br/>2. Display Disk Space&#160;<br/>3. Display Home Space Utilization&#160;<br/>0. Quit&#160;<br/>&#34;&#160;<br/>read -p &#34;Enter selection [0-3] &gt; &#34;&#160;<br/>
444<br/>
<hr/>
<a name=469></a>case<br/>
<b>if [[ &#34;$REPLY&#34; =~ ^[0-3]$ ]]; then&#160;</b><br/>
<b>if [[ &#34;$REPLY&#34; == 0 ]]; then&#160;</b><br/>
<b>echo &#34;Program terminated.&#34;&#160;<br/>exit&#160;</b><br/>
<b>fi&#160;<br/>if [[ &#34;$REPLY&#34; == 1 ]]; then&#160;</b><br/>
<b>echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>uptime&#160;<br/>exit&#160;</b><br/>
<b>fi&#160;<br/>if [[ &#34;$REPLY&#34; == 2 ]]; then&#160;</b><br/>
<b>df -h&#160;<br/>exit&#160;</b><br/>
<b>fi&#160;<br/>if [[ &#34;$REPLY&#34; == 3 ]]; then&#160;</b><br/>
<b>if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;</b><br/>
<b>echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>du -sh /home/*&#160;</b><br/>
<b>else&#160;</b><br/>
<b>echo &#34;Home Space Utilization ($USER)&#34;&#160;<br/>du -sh &#34;$HOME&#34;&#160;</b><br/>
<b>fi&#160;<br/>exit&#160;</b><br/>
<b>fi&#160;</b><br/>
<b>else&#160;</b><br/>
<b>echo &#34;Invalid entry.&#34; &gt;&amp;2&#160;<br/>exit 1&#160;</b><br/>
<b>fi</b><br/>
Using&#160;case, we&#160;can&#160;replace&#160;this&#160;logic&#160;with&#160;something&#160;simpler.<br/>
#!/bin/bash&#160;<br/>
# case-menu: a menu driven system information program&#160;<br/>
clear&#160;<br/>echo &#34;&#160;<br/>Please Select:&#160;<br/>
1. Display System Information&#160;<br/>2. Display Disk Space&#160;<br/>3. Display Home Space Utilization&#160;<br/>
445<br/>
<hr/>
<a name=470></a>31 – Flow&#160;Control:&#160;Branching with&#160;case<br/>
0. Quit&#160;<br/>&#34;&#160;<br/>read -p &#34;Enter selection [0-3] &gt; &#34;&#160;<br/>
<b>case &#34;$REPLY&#34; in&#160;</b><br/>
<b>0)</b><br/>
<b>echo &#34;Program terminated.&#34;&#160;<br/>exit&#160;<br/>;;&#160;</b><br/>
<b>1)</b><br/>
<b>echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>uptime&#160;<br/>;;&#160;</b><br/>
<b>2)</b><br/>
<b>df -h&#160;<br/>;;&#160;</b><br/>
<b>3)</b><br/>
<b>if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;</b><br/>
<b>echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>du -sh /home/*&#160;</b><br/>
<b>else&#160;</b><br/>
<b>echo &#34;Home Space Utilization ($USER)&#34;&#160;<br/>du -sh &#34;$HOME&#34;&#160;</b><br/>
<b>fi&#160;<br/>;;&#160;</b><br/>
<b>*)</b><br/>
<b>echo &#34;Invalid entry&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>;;&#160;</b><br/>
<b>esac</b><br/>
The&#160;case&#160;command&#160;looks&#160;at&#160;the&#160;value&#160;of&#160;<i>word</i>,&#160;which&#160;in&#160;our&#160;example,&#160;the&#160;value&#160;of&#160;the<br/>REPLY&#160;&#160;variable,&#160;and&#160;then&#160;attempts&#160;to&#160;match&#160;it&#160;against&#160;one&#160;of&#160;the&#160;specified&#160;&#160;<i>patterns</i>.<br/>When&#160;a&#160;match&#160;is&#160;found,&#160;the&#160;<i>commands</i>&#160;associated&#160;with&#160;the&#160;specified&#160;pattern&#160;are&#160;executed.<br/>After a&#160;match is&#160;found, no further matches&#160;are&#160;attempted.<br/>
Patterns<br/>The&#160;patterns&#160;used&#160;by&#160;case&#160;are&#160;the&#160;same&#160;as&#160;those&#160;used&#160;by&#160;pathname&#160;expansion.&#160;Patterns<br/>are&#160;terminated with&#160;a&#160;“)”&#160;character.&#160;Table&#160;31-1 lists&#160;examples&#160;of valid patterns.<br/>
<i>Table&#160;31-&#160;1:&#160;case&#160;Pattern Examples</i><br/>
<b>Pattern</b><br/>
<b>Description</b><br/>
a)<br/>
Matches&#160;if&#160;<i>word</i>&#160;equals&#160;“a”.<br/>
[[:alpha:]])<br/>
Matches&#160;if&#160;<i>word</i>&#160;is&#160;a&#160;single&#160;alphabetic&#160;character.<br/>
446<br/>
<hr/>
<a name=471></a>case<br/>
???)<br/>
Matches&#160;if&#160;<i>word</i>&#160;is&#160;exactly&#160;three&#160;characters&#160;long.<br/>
*.txt)<br/>
Matches&#160;if&#160;<i>word</i>&#160;ends&#160;with&#160;the&#160;characters&#160;“.txt”.<br/>
*)<br/>
Matches&#160;any value&#160;of&#160;<i>word</i>. It&#160;is&#160;good practice&#160;to include&#160;this&#160;<br/>as&#160;the&#160;last&#160;pattern in a&#160;case&#160;command,&#160;to catch any&#160;values&#160;of&#160;<br/><i>word</i>&#160;that&#160;did&#160;not&#160;match a&#160;previous&#160;pattern,&#160;that&#160;is, to catch any<br/>possible&#160;invalid values.&#160;<br/>
Here&#160;is&#160;an example&#160;of patterns&#160;at&#160;work:<br/>
#!/bin/bash&#160;<br/>
read -p &#34;enter word &gt; &#34;&#160;<br/>
case &#34;$REPLY&#34; in&#160;<br/>
[[:alpha:]])<br/>
echo &#34;is a single alphabetic character.&#34; ;;&#160;<br/>
[ABC][0-9])<br/>
echo &#34;is A, B, or C followed by a digit.&#34; ;;&#160;<br/>
???)<br/>
echo &#34;is three characters long.&#34; ;;&#160;<br/>
*.txt)<br/>
echo &#34;is a word ending in '.txt'&#34; ;;&#160;<br/>
*)<br/>
echo &#34;is something else.&#34; ;;&#160;<br/>
esac<br/>
It&#160;is&#160;also&#160;possible&#160;to&#160;combine&#160;multiple&#160;patterns&#160;using&#160;the&#160;vertical&#160;bar&#160;character&#160;as&#160;a&#160;sepa-<br/>rator.&#160;This&#160;creates&#160;an&#160;“or”&#160;conditional&#160;pattern.&#160;This&#160;is&#160;useful&#160;for&#160;such&#160;things&#160;as&#160;handling<br/>both uppercase&#160;and lowercase&#160;characters. Here’s&#160;an example:<br/>
#!/bin/bash&#160;<br/>
# case-menu: a menu driven system information program&#160;<br/>
clear&#160;<br/>echo &#34;&#160;<br/>Please Select:&#160;<br/>
<b>A.</b>&#160;Display System Information&#160;<br/><b>B.</b>&#160;Display Disk Space&#160;<br/><b>C.</b>&#160;Display Home Space Utilization&#160;<br/><b>Q.</b>&#160;Quit&#160;<br/>&#34;&#160;<br/>read -p &#34;Enter selection&#160;<b>[A, B, C or Q]</b>&#160;&gt; &#34;&#160;<br/>
447<br/>
<hr/>
<a name=472></a>31 – Flow&#160;Control:&#160;Branching with&#160;case<br/>
case &#34;$REPLY&#34; in&#160;<br/>
<b>q|Q)&#160;</b>echo &#34;Program terminated.&#34;&#160;<br/>
exit&#160;<br/>;;&#160;<br/>
<b>a|A)&#160;</b>echo &#34;Hostname: $HOSTNAME&#34;&#160;<br/>
uptime&#160;<br/>;;&#160;<br/>
<b>b|B)&#160;</b>df -h&#160;<br/>
;;&#160;<br/>
<b>c|C)&#160;</b>if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
echo &#34;Home Space Utilization (All Users)&#34;&#160;<br/>du -sh /home/*&#160;<br/>
else&#160;<br/>
echo &#34;Home Space Utilization ($USER)&#34;&#160;<br/>du -sh &#34;$HOME&#34;&#160;<br/>
fi&#160;<br/>;;&#160;<br/>
*)<br/>
echo &#34;Invalid entry&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>;;&#160;<br/>
esac<br/>
Here, we&#160;modify&#160;the&#160;case-menu&#160;program&#160;to&#160;use&#160;letters&#160;instead&#160;of digits&#160;for&#160;menu&#160;selec-<br/>tion. Notice&#160;how&#160;the&#160;new&#160;patterns&#160;allow&#160;for entry of both&#160;uppercase&#160;and&#160;lowercase&#160;letters.<br/>
Performing&#160;Multiple&#160;Actions<br/>In&#160;versions&#160;of&#160;bash&#160;prior&#160;to&#160;4.0,&#160;case&#160;allowed&#160;only&#160;one&#160;action&#160;to&#160;be&#160;performed&#160;on&#160;a<br/>successful&#160;match.&#160;&#160;After&#160;a&#160;successful&#160;match,&#160;the&#160;command&#160;would&#160;terminate.&#160;&#160;Here&#160;we&#160;see<br/>a&#160;script&#160;that&#160;tests&#160;a&#160;character:<br/>
#!/bin/bash<br/>
# case4-1: test a character<br/>
read -n 1 -p &#34;Type a character &gt; &#34;<br/>echo<br/>case &#34;$REPLY&#34; in<br/>&#160; &#160; [[:upper:]]) &#160; &#160;echo &#34;'$REPLY' is upper case.&#34; ;;<br/>&#160; &#160; [[:lower:]]) &#160; &#160;echo &#34;'$REPLY' is lower case.&#34; ;;<br/>&#160; &#160; [[:alpha:]]) &#160; &#160;echo &#34;'$REPLY' is alphabetic.&#34; ;;<br/>
448<br/>
<hr/>
<a name=473></a>case<br/>
&#160; &#160; [[:digit:]]) &#160; &#160;echo &#34;'$REPLY' is a digit.&#34; ;;<br/>&#160; &#160; [[:graph:]]) &#160; &#160;echo &#34;'$REPLY' is a visible character.&#34; ;;<br/>&#160; &#160; [[:punct:]]) &#160; &#160;echo &#34;'$REPLY' is a punctuation symbol.&#34; ;;<br/>&#160; &#160; [[:space:]]) &#160; &#160;echo &#34;'$REPLY' is a whitespace character.&#34; ;;<br/>&#160; &#160; [[:xdigit:]]) &#160; echo &#34;'$REPLY' is a hexadecimal digit.&#34; ;;&#160;<br/>esac<br/>
Running this&#160;script&#160;produces&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>case4-1<br/></b>Type a character &gt;&#160;<b>a<br/></b>'a' is lower case.<br/>
The&#160;script&#160;works&#160;for&#160;the&#160;most&#160;part&#160;but&#160;fails&#160;if&#160;a&#160;character&#160;matches&#160;more&#160;than&#160;one&#160;of&#160;the<br/>POSIX&#160;character&#160;classes.&#160;&#160;&#160;For&#160;example,&#160;the&#160;character&#160;&#34;a&#34;&#160;is&#160;both&#160;lowercase&#160;and&#160;alpha-<br/>betic,&#160;as&#160;well&#160;as&#160;a&#160;hexadecimal&#160;digit.&#160;In&#160;bash&#160;prior&#160;to&#160;version&#160;4.0&#160;there&#160;was&#160;no&#160;way&#160;for<br/>case&#160;to&#160;match&#160;more&#160;than&#160;one&#160;test.&#160;Modern&#160;versions&#160;of&#160;bash&#160;add&#160;the&#160;;;&amp;&#160;notation&#160;to<br/>terminate&#160;each&#160;action,&#160;so now&#160;we&#160;can&#160;do this:<br/>
#!/bin/bash<br/>
# case4-2: test a character<br/>
read -n 1 -p &#34;Type a character &gt; &#34;<br/>echo<br/>case &#34;$REPLY&#34; in<br/>&#160; &#160; [[:upper:]]) &#160; &#160;echo &#34;'$REPLY' is upper case.&#34; ;;&amp;<br/>&#160; &#160; [[:lower:]]) &#160; &#160;echo &#34;'$REPLY' is lower case.&#34; ;;&amp;<br/>&#160; &#160; [[:alpha:]]) &#160; &#160;echo &#34;'$REPLY' is alphabetic.&#34; ;;&amp;<br/>&#160; &#160; [[:digit:]]) &#160; &#160;echo &#34;'$REPLY' is a digit.&#34; ;;&amp;<br/>&#160; &#160; [[:graph:]]) &#160; &#160;echo &#34;'$REPLY' is a visible character.&#34; ;;&amp;<br/>&#160; &#160; [[:punct:]]) &#160; &#160;echo &#34;'$REPLY' is a punctuation symbol.&#34; ;;&amp;<br/>&#160; &#160; [[:space:]]) &#160; &#160;echo &#34;'$REPLY' is a whitespace character.&#34; ;;&amp;<br/>&#160; &#160; [[:xdigit:]]) &#160; echo &#34;'$REPLY' is a hexadecimal digit.&#34; ;;&amp;&#160;<br/>esac<br/>
When we&#160;run this&#160;script, we&#160;get&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>case4-2</b><br/>
449<br/>
<hr/>
<a name=474></a>31 – Flow&#160;Control:&#160;Branching with&#160;case<br/>
Type a character &gt;&#160;<b>a<br/></b>'a' is lower case.<br/>'a' is alphabetic.<br/>'a' is a visible character.<br/>'a' is a hexadecimal digit.<br/>
The&#160;addition&#160;of&#160;the&#160;;;&amp;&#160;syntax&#160;allows&#160;case&#160;to&#160;continue&#160;to&#160;the&#160;next&#160;test&#160;rather&#160;than&#160;sim-<br/>ply terminating.<br/>
<b>Summing&#160;Up<br/></b>The&#160;case&#160;command&#160;is&#160;a&#160;handy&#160;addition&#160;to&#160;our&#160;bag&#160;of&#160;programming&#160;tricks.&#160;As&#160;we&#160;will<br/>see&#160;in the&#160;next&#160;chapter,&#160;it’s&#160;the&#160;perfect&#160;tool&#160;for handling&#160;certain types&#160;of problems.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;section&#160;on Conditional&#160;Constructs&#160;describes&#160;the&#160;<br/>case&#160;command&#160;in detail:<br/><a href="http://tiswww.case.edu/php/chet/bash/bashref.html#SEC21">http://tiswww.case.edu/php/chet/bash/bashref.html#SEC21</a><br/>
●<br/>
The&#160;<i>Advanced Bash-Scripting Guide</i>&#160;provides&#160;further&#160;examples&#160;of&#160;case&#160;applica-<br/>tions:<br/><a href="http://tldp.org/LDP/abs/html/testbranch.html">http://tldp.org/LDP/abs/html/testbranch.html</a><br/>
450<br/>
<hr/>
<a name=475></a>32 – Positional&#160;Parameters<br/>
<i><b>32&#160;–&#160;Positional&#160;Parameters</b></i><br/>
One&#160;feature&#160;that&#160;has&#160;been&#160;missing&#160;from&#160;our&#160;programs&#160;so&#160;far&#160;is&#160;the&#160;ability&#160;to&#160;accept&#160;and<br/>process&#160;command&#160;line&#160;options&#160;and&#160;arguments.&#160;In&#160;this&#160;chapter,&#160;we&#160;will&#160;examine&#160;the&#160;shell<br/>features&#160;that&#160;allow&#160;our programs&#160;to&#160;get&#160;access&#160;to the&#160;contents&#160;of the&#160;command line.<br/>
<b>Accessing&#160;the&#160;Command&#160;Line<br/></b>The&#160;shell&#160;provides&#160;a&#160;set&#160;of&#160;variables&#160;called&#160;<i>positional&#160;parameters</i>&#160;that&#160;contain&#160;the&#160;individ-<br/>ual&#160;words&#160;on&#160;the&#160;command&#160;line.&#160;The&#160;variables&#160;are&#160;named&#160;&#160;0&#160;&#160;through&#160;&#160;9.&#160;They&#160;can&#160;be<br/>demonstrated this&#160;way:<br/>
#!/bin/bash&#160;<br/>
# posit-param: script to view command line parameters&#160;<br/>
echo &#34;&#160;<br/>\$0 = $0&#160;<br/>\$1 = $1&#160;<br/>\$2 = $2&#160;<br/>\$3 = $3&#160;<br/>\$4 = $4&#160;<br/>\$5 = $5&#160;<br/>\$6 = $6&#160;<br/>\$7 = $7&#160;<br/>\$8 = $8&#160;<br/>\$9 = $9&#160;<br/>&#34;<br/>
This&#160;is&#160;a&#160;simple&#160;script&#160;that&#160;displays&#160;the&#160;values&#160;of&#160;the&#160;variables&#160;$0-$9.&#160;When&#160;executed<br/>with no&#160;command line&#160;arguments, the&#160;result&#160;is&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>posit-param&#160;</b><br/>
451<br/>
<hr/>
<a name=476></a>32 – Positional&#160;Parameters<br/>
$0 = /home/me/bin/posit-param&#160;<br/>$1 =&#160;<br/>$2 =&#160;<br/>$3 =&#160;<br/>$4 =&#160;<br/>$5 =&#160;<br/>$6 =&#160;<br/>$7 =&#160;<br/>$8 =&#160;<br/>$9 =&#160;<br/>
Even&#160;when no&#160;arguments&#160;are&#160;provided,&#160;$0&#160;will&#160;always&#160;contain&#160;the&#160;first&#160;item&#160;appearing&#160;on<br/>the&#160;command&#160;line,&#160;which&#160;is&#160;the&#160;pathname&#160;of&#160;the&#160;program&#160;being&#160;executed.&#160;When&#160;argu-<br/>ments&#160;are&#160;provided, we&#160;see&#160;these&#160;results:<br/>
[me@linuxbox ~]$&#160;<b>posit-param a b c d&#160;</b><br/>
$0 = /home/me/bin/posit-param&#160;<br/>$1 = a&#160;<br/>$2 = b&#160;<br/>$3 = c&#160;<br/>$4 = d&#160;<br/>$5 =&#160;<br/>$6 =&#160;<br/>$7 =&#160;<br/>$8 =&#160;<br/>$9 =<br/>
<b>Note:</b>&#160;You&#160;can&#160;actually&#160;access&#160;more&#160;than&#160;nine&#160;parameters&#160;using&#160;parameter&#160;expan-<br/>sion.&#160;To&#160;specify&#160;a&#160;number&#160;greater&#160;than&#160;nine,&#160;surround&#160;the&#160;number&#160;in&#160;braces&#160;as&#160;in<br/>${10},&#160;${55},&#160;${211}, and&#160;so on.<br/>
Determining&#160;the&#160;Number&#160;of&#160;Arguments<br/>The&#160;shell&#160;also provides&#160;a&#160;variable,&#160;$#, that&#160;contains&#160;the&#160;number of arguments&#160;on the&#160;com-<br/>mand line:<br/>
452<br/>
<hr/>
<a name=477></a>Accessing the&#160;Command Line<br/>
#!/bin/bash&#160;<br/>
# posit-param: script to view command line parameters&#160;<br/>
echo &#34;&#160;<br/><b>Number of arguments: $#&#160;<br/></b>\$0 = $0&#160;<br/>\$1 = $1&#160;<br/>\$2 = $2&#160;<br/>\$3 = $3&#160;<br/>\$4 = $4&#160;<br/>\$5 = $5&#160;<br/>\$6 = $6&#160;<br/>\$7 = $7&#160;<br/>\$8 = $8&#160;<br/>\$9 = $9&#160;<br/>&#34;<br/>
This&#160;is&#160;the&#160;result:<br/>
[me@linuxbox ~]$&#160;<b>posit-param a b c d&#160;</b><br/>
Number of arguments: 4&#160;<br/>$0 = /home/me/bin/posit-param&#160;<br/>$1 = a&#160;<br/>$2 = b&#160;<br/>$3 = c&#160;<br/>$4 = d&#160;<br/>$5 =&#160;<br/>$6 =&#160;<br/>$7 =&#160;<br/>$8 =&#160;<br/>$9 =&#160;<br/>
shift&#160;–&#160;Getting&#160;Access&#160;to&#160;Many&#160;Arguments<br/>But&#160;what&#160;happens&#160;when&#160;we&#160;give&#160;the&#160;program&#160;a&#160;large&#160;number&#160;of&#160;arguments&#160;such&#160;as&#160;the<br/>following?<br/>
[me@linuxbox ~]$&#160;<b>posit-param *&#160;</b><br/>
453<br/>
<hr/>
<a name=478></a>32 – Positional&#160;Parameters<br/>
Number of arguments: 82&#160;<br/>$0 = /home/me/bin/posit-param&#160;<br/>$1 = addresses.ldif&#160;<br/>$2 = bin&#160;<br/>$3 = bookmarks.html&#160;<br/>$4 = debian-500-i386-netinst.iso&#160;<br/>$5 = debian-500-i386-netinst.jigdo&#160;<br/>$6 = debian-500-i386-netinst.template&#160;<br/>$7 = debian-cd_info.tar.gz&#160;<br/>$8 = Desktop&#160;<br/>$9 = dirlist-bin.txt<br/>
On&#160;this&#160;example&#160;system,&#160;the&#160;wildcard&#160;*&#160;expands&#160;into&#160;82&#160;arguments.&#160;How&#160;can&#160;we&#160;process<br/>that&#160;many?&#160;The&#160;shell&#160;provides&#160;a&#160;method,&#160;albeit&#160;a&#160;clumsy&#160;one,&#160;to&#160;do&#160;this.&#160;The&#160;&#160;shift<br/>command&#160;causes&#160;all&#160;the&#160;parameters&#160;to&#160;“move&#160;down&#160;one”&#160;each&#160;time&#160;it&#160;is&#160;executed.&#160;In&#160;fact,<br/>by&#160;using&#160;&#160;shift,&#160;it&#160;is&#160;possible&#160;to&#160;get&#160;by&#160;with&#160;only&#160;one&#160;parameter&#160;(in&#160;addition&#160;to&#160;&#160;$0,<br/>which never&#160;changes).<br/>
#!/bin/bash&#160;<br/>
# posit-param2: script to display all arguments&#160;<br/>
count=1&#160;<br/>
while [[ $# -gt 0 ]]; do&#160;<br/>
echo &#34;Argument $count = $1&#34;&#160;<br/>count=$((count + 1))&#160;<br/>shift&#160;<br/>
done<br/>
Each&#160;time&#160;shift&#160;is&#160;executed,&#160;the&#160;value&#160;of&#160;$2&#160;is&#160;moved&#160;to&#160;$1,&#160;the&#160;value&#160;of&#160;$3&#160;is&#160;moved<br/>to&#160;$2&#160;and&#160;so on.&#160;The&#160;value&#160;of&#160;$#&#160;is&#160;also&#160;reduced by one.<br/>In&#160;the&#160;&#160;posit-param2&#160;&#160;program,&#160;we&#160;create&#160;a&#160;loop&#160;that&#160;evaluates&#160;the&#160;number&#160;of&#160;argu-<br/>ments&#160;remaining&#160;and&#160;continues&#160;as&#160;long&#160;as&#160;there&#160;is&#160;at&#160;least&#160;one.&#160;We&#160;display&#160;the&#160;current&#160;ar-<br/>gument,&#160;increment&#160;the&#160;variable&#160;count&#160;with&#160;each&#160;iteration&#160;of&#160;the&#160;loop&#160;to&#160;provide&#160;a&#160;run-<br/>ning&#160;count&#160;of&#160;the&#160;number&#160;of&#160;arguments&#160;processed,&#160;and,&#160;finally,&#160;execute&#160;a&#160;shift&#160;to&#160;load<br/>$1&#160;with the&#160;next&#160;argument. Here&#160;is&#160;the&#160;program&#160;at&#160;work:<br/>
454<br/>
<hr/>
<a name=479></a>Accessing the&#160;Command Line<br/>
[me@linuxbox ~]$&#160;<b>posit-param2 a b c d</b>&#160;<br/>Argument 1 = a&#160;<br/>Argument 2 = b&#160;<br/>Argument 3 = c&#160;<br/>Argument 4 = d<br/>
Simple&#160;Applications<br/>Even&#160;without&#160;shift,&#160;it’s&#160;possible&#160;to&#160;write&#160;useful&#160;applications&#160;using&#160;positional&#160;parame-<br/>ters. By way of example, here&#160;is&#160;a&#160;simple&#160;file&#160;information&#160;program:<br/>
#!/bin/bash&#160;<br/>
# file-info: simple file information program&#160;<br/>
PROGNAME=&#34;$(basename &#34;$0&#34;)&#34;&#160;<br/>
if [[ -e &#34;$1&#34; ]]; then&#160;<br/>
echo -e &#34;\nFile Type:&#34;&#160;<br/>file &#34;$1&#34;&#160;<br/>echo -e &#34;\nFile Status:&#34;&#160;<br/>stat &#34;$1&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$PROGNAME: usage: $PROGNAME file&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi<br/>
This&#160;program&#160;displays&#160;the&#160;file&#160;type&#160;(determined&#160;by&#160;the&#160;file&#160;command)&#160;and&#160;the&#160;file&#160;sta-<br/>tus&#160;(from&#160;the&#160;stat&#160;command)&#160;of&#160;a&#160;specified&#160;file.&#160;One&#160;interesting&#160;feature&#160;of&#160;this&#160;program<br/>is&#160;the&#160;PROGNAME&#160;variable.&#160;It&#160;is&#160;given&#160;the&#160;value&#160;that&#160;results&#160;from&#160;the&#160;basename&#160;&#34;$0&#34;<br/>command.&#160;The&#160;basename&#160;command&#160;removes&#160;the&#160;leading&#160;portion&#160;of&#160;a&#160;pathname,&#160;leav-<br/>ing&#160;only&#160;the&#160;base&#160;name&#160;of&#160;a&#160;file.&#160;In&#160;our&#160;example,&#160;basename&#160;removes&#160;the&#160;leading&#160;portion<br/>of&#160;the&#160;pathname&#160;contained&#160;in&#160;the&#160;$0&#160;parameter,&#160;the&#160;full&#160;pathname&#160;of&#160;our&#160;example&#160;pro-<br/>gram.&#160;This&#160;value&#160;is&#160;useful&#160;when&#160;constructing&#160;messages&#160;such&#160;as&#160;the&#160;usage&#160;message&#160;at&#160;the<br/>end&#160;of the&#160;program.&#160;By&#160;coding&#160;it&#160;this&#160;way, the&#160;script&#160;can&#160;be&#160;renamed,&#160;and&#160;the&#160;message&#160;au-<br/>tomatically&#160;adjusts&#160;to contain the&#160;name&#160;of the&#160;program.<br/>
Using&#160;Positional&#160;Parameters&#160;with&#160;Shell&#160;Functions<br/>Just&#160;as&#160;positional&#160;parameters&#160;are&#160;used&#160;to&#160;pass&#160;arguments&#160;to&#160;shell&#160;scripts,&#160;they&#160;can&#160;also&#160;be<br/>
455<br/>
<hr/>
<a name=480></a>32 – Positional&#160;Parameters<br/>
used&#160;&#160;&#160;to&#160;&#160;&#160;pass&#160;&#160;&#160;arguments&#160;&#160;&#160;to&#160;&#160;shell&#160;&#160;&#160;functions.&#160;&#160;&#160;To&#160;&#160;&#160;demonstrate,&#160;&#160;&#160;we&#160;&#160;&#160;will&#160;&#160;&#160;convert&#160;&#160;&#160;the<br/>file_info&#160;script&#160;into a&#160;shell&#160;function.<br/>
file_info () {&#160;<br/>
# file_info: function to display file information&#160;<br/>
if [[ -e &#34;$1&#34; ]]; then&#160;<br/>
echo -e &#34;\nFile Type:&#34;&#160;<br/>file &#34;$1&#34;&#160;<br/>echo -e &#34;\nFile Status:&#34;&#160;<br/>stat &#34;$1&#34;<br/>
else&#160;<br/>
echo &#34;$FUNCNAME: usage: $FUNCNAME file&#34; &gt;&amp;2&#160;<br/>return 1&#160;<br/>
fi&#160;<br/>
}<br/>
Now,&#160;if&#160;a&#160;script&#160;that&#160;incorporates&#160;the&#160;file_info&#160;shell&#160;function&#160;calls&#160;the&#160;function&#160;with&#160;a<br/>filename&#160;argument,&#160;the&#160;argument&#160;will&#160;be&#160;passed to the&#160;function.<br/>With&#160;this&#160;capability,&#160;we&#160;can&#160;write&#160;many&#160;useful&#160;shell&#160;functions&#160;that&#160;not&#160;only&#160;can&#160;be&#160;used&#160;in<br/>scripts, but&#160;also&#160;can be&#160;used within&#160;our&#160;.bashrc&#160;files.<br/>Notice&#160;that&#160;the&#160;PROGNAME&#160;variable&#160;was&#160;changed&#160;to&#160;the&#160;shell&#160;variable&#160;FUNCNAME.&#160;The<br/>shell&#160;automatically&#160;updates&#160;this&#160;variable&#160;to&#160;keep&#160;track&#160;of&#160;the&#160;currently&#160;executed&#160;shell<br/>function.&#160;Note&#160;that&#160;&#160;$0&#160;always&#160;contains&#160;the&#160;full&#160;pathname&#160;of&#160;the&#160;first&#160;item&#160;on&#160;the&#160;com-<br/>mand&#160;line&#160;(i.e.,&#160;the&#160;name&#160;of the&#160;program)&#160;and&#160;does&#160;not&#160;contain&#160;the&#160;name&#160;of the&#160;shell&#160;func-<br/>tion as&#160;we&#160;might&#160;expect.<br/>
<b>Handling&#160;Positional&#160;Parameters&#160;e<i>n&#160;Masse<br/></i></b>It&#160;is&#160;sometimes&#160;useful&#160;to&#160;manage&#160;all&#160;the&#160;positional&#160;parameters&#160;as&#160;a&#160;group.&#160;For&#160;example,<br/>we&#160;might&#160;want&#160;to&#160;write&#160;a&#160;“wrapper”&#160;around&#160;another&#160;program.&#160;This&#160;means&#160;we&#160;create&#160;a<br/>script&#160;or&#160;shell&#160;function&#160;that&#160;simplifies&#160;the&#160;invocation&#160;of&#160;another&#160;program.&#160;The&#160;wrapper,&#160;in<br/>this&#160;case,&#160;supplies&#160;a&#160;list&#160;of&#160;arcane&#160;command&#160;line&#160;options&#160;and&#160;then&#160;passes&#160;a&#160;list&#160;of&#160;argu-<br/>ments&#160;to&#160;the&#160;lower-level&#160;program.<br/>The&#160;shell&#160;provides&#160;two&#160;&#160;special&#160;parameters&#160;&#160;for&#160;this&#160;purpose.&#160;They&#160;both&#160;expand&#160;into&#160;the<br/>complete&#160;list&#160;of&#160;positional&#160;parameters&#160;but&#160;differ&#160;in&#160;rather&#160;subtle&#160;ways.&#160;They&#160;are&#160;described<br/>in&#160;Table&#160;32-1.<br/>
456<br/>
<hr/>
<a name=481></a>Handling Positional&#160;Parameters&#160;en&#160;Masse<br/>
<i>Table&#160;32-1: The&#160;*&#160;and&#160;@&#160;Special&#160;Parameters</i><br/>
<b>Parameter</b><br/>
<b>Description</b><br/>
$*<br/>
Expands&#160;into&#160;the&#160;list&#160;of positional&#160;parameters,&#160;starting with&#160;1.&#160;<br/>When surrounded by double&#160;quotes, it&#160;expands&#160;into&#160;a&#160;double-<br/>quoted string&#160;containing all&#160;of the&#160;positional&#160;parameters, each&#160;<br/>separated&#160;by the&#160;first&#160;character of the&#160;IFS&#160;shell&#160;variable&#160;(by default<br/>a&#160;space&#160;character).<br/>
$@<br/>
Expands&#160;into&#160;the&#160;list&#160;of positional&#160;parameters,&#160;starting with&#160;1.&#160;<br/>When surrounded by double&#160;quotes, it&#160;expands&#160;each&#160;positional&#160;<br/>parameter into a&#160;separate&#160;word as&#160;if it&#160;was&#160;surrounded by double&#160;<br/>quotes.<br/>
Here&#160;is&#160;a&#160;script&#160;that&#160;shows&#160;these&#160;special&#160;parameters&#160;in action:<br/>
#!/bin/bash&#160;<br/>
# posit-params3: script to demonstrate $* and $@&#160;<br/>
print_params () {&#160;<br/>
echo &#34;\$1 = $1&#34;&#160;<br/>echo &#34;\$2 = $2&#34;&#160;<br/>echo &#34;\$3 = $3&#34;&#160;<br/>echo &#34;\$4 = $4&#34;&#160;<br/>
}&#160;<br/>
pass_params () {&#160;<br/>
echo -e &#34;\n&#34; '$* :'; &#160; print_params $*&#160;<br/>echo -e &#34;\n&#34; '&#34;$*&#34; :'; print_params &#34;$*&#34;&#160;<br/>echo -e &#34;\n&#34; '$@ :'; &#160; print_params $@&#160;<br/>echo -e &#34;\n&#34; '&#34;$@&#34; :'; print_params &#34;$@&#34;&#160;<br/>
}&#160;<br/>
pass_params &#34;word&#34; &#34;words with spaces&#34;<br/>
In&#160;this&#160;rather&#160;convoluted&#160;program,&#160;we&#160;create&#160;two&#160;arguments:&#160;word&#160;and&#160;words&#160;with<br/>spaces,&#160;and&#160;pass&#160;them&#160;to&#160;the&#160;pass_params&#160;function.&#160;That&#160;function,&#160;in&#160;turn,&#160;passes<br/>them&#160;on&#160;to&#160;the&#160;print_params&#160;function,&#160;using&#160;each&#160;of&#160;the&#160;four&#160;methods&#160;available&#160;with<br/>the&#160;special&#160;parameters&#160;$*&#160;and&#160;$@.&#160;When&#160;executed,&#160;the&#160;script&#160;reveals&#160;the&#160;differences.<br/>
457<br/>
<hr/>
<a name=482></a>32 – Positional&#160;Parameters<br/>
[me@linuxbox ~]$&#160;<b>posit-param3&#160;</b><br/>
&#160;$* :&#160;<br/>$1 = word&#160;<br/>$2 = words&#160;<br/>$3 = with&#160;<br/>$4 = spaces&#160;<br/>
&#160;&#34;$*&#34; :&#160;<br/>$1 = word words with spaces&#160;<br/>$2 =&#160;<br/>$3 =&#160;<br/>$4 =&#160;<br/>
&#160;$@ :&#160;<br/>$1 = word&#160;<br/>$2 = words&#160;<br/>$3 = with&#160;<br/>$4 = spaces&#160;<br/>
&#160;&#34;$@&#34; :&#160;<br/>$1 = word&#160;<br/>$2 = words with spaces&#160;<br/>$3 =&#160;<br/>$4 =&#160;<br/>
With&#160;our arguments,&#160;both&#160;$*&#160;and&#160;$@&#160;produce&#160;a&#160;four-word result.<br/>word words with spaces<br/>
&#34;$*&#34;&#160;produces&#160;a&#160;one-word result:<br/>
&#34;word words with spaces&#34;<br/>
&#34;$@&#34;&#160;produces&#160;a&#160;two-word result:<br/>
&#34;word&#34; &#34;words with spaces&#34;<br/>
This&#160;matches&#160;our&#160;actual&#160;intent.&#160;The&#160;lesson&#160;to&#160;take&#160;from&#160;this&#160;is&#160;that&#160;even&#160;though&#160;the&#160;shell<br/>provides&#160;four&#160;different&#160;ways&#160;of&#160;getting&#160;the&#160;list&#160;of&#160;positional&#160;parameters,&#160;&#34;$@&#34;&#160;is&#160;by&#160;far<br/>the&#160;most&#160;useful&#160;for&#160;most&#160;situations&#160;because&#160;it&#160;preserves&#160;the&#160;integrity&#160;of&#160;each&#160;positional<br/>parameter.&#160;To&#160;ensure&#160;safety,&#160;it&#160;should&#160;always&#160;be&#160;used,&#160;unless&#160;we&#160;have&#160;a&#160;compelling&#160;rea-<br/>son not&#160;to use&#160;it.<br/>
458<br/>
<hr/>
<a name=483></a>A&#160;More&#160;Complete&#160;Application<br/>
<b>A&#160;More&#160;Complete&#160;Application<br/></b>After&#160;a&#160;long&#160;hiatus,&#160;we&#160;are&#160;going&#160;to&#160;resume&#160;work&#160;on&#160;our&#160;&#160;sys_info_page&#160;&#160;program,<br/>last&#160;seen&#160;in&#160;Chapter&#160;27.&#160;Our&#160;next&#160;addition&#160;will&#160;add&#160;several&#160;command&#160;line&#160;options&#160;to&#160;the<br/>program&#160;as&#160;follows:<br/>
●<br/>
<b>Output&#160;file.</b>&#160;We&#160;will&#160;add&#160;an&#160;option&#160;to&#160;specify&#160;a&#160;name&#160;for&#160;a&#160;file&#160;to&#160;contain&#160;the&#160;pro-<br/>gram’s&#160;output. It&#160;will&#160;be&#160;specified as&#160;either&#160;-f&#160;<i>file</i>&#160;or&#160;--file&#160;<i>file</i>.<br/>
●<br/>
<b>Interactive&#160;mode.</b>&#160;This&#160;option&#160;will&#160;prompt&#160;the&#160;user&#160;for&#160;an&#160;output&#160;filename&#160;and<br/>will&#160;determine&#160;whether&#160;the&#160;specified&#160;file&#160;already&#160;exists.&#160;If&#160;it&#160;does,&#160;the&#160;user&#160;will&#160;be<br/>prompted&#160;before&#160;the&#160;existing&#160;file&#160;is&#160;overwritten.&#160;This&#160;option&#160;will&#160;be&#160;specified&#160;by<br/>either&#160;-i&#160;or&#160;--interactive.<br/>
●<br/>
<b>Help.</b>&#160;Either&#160;-h&#160;or&#160;--help&#160;may&#160;be&#160;specified&#160;to&#160;cause&#160;the&#160;program&#160;to&#160;output&#160;an<br/>informative&#160;usage&#160;message.<br/>
Here&#160;is&#160;the&#160;code&#160;needed&#160;to implement&#160;the&#160;command line&#160;processing:<br/>
usage () {&#160;<br/>
echo &#34;$PROGNAME: usage: $PROGNAME [-f file | -i]&#34;&#160;<br/>return&#160;<br/>
}&#160;<br/>
# process command line options&#160;<br/>
interactive=&#160;<br/>filename=&#160;<br/>
while [[ -n &#34;$1&#34; ]]; do&#160;<br/>
case &#34;$1&#34; in&#160;<br/>
-f | --file)<br/>
shift&#160;<br/>filename=&#34;$1&#34;&#160;<br/>;;&#160;<br/>
-i | --interactive)&#160;interactive=1&#160;<br/>
;;&#160;<br/>
-h | --help)<br/>
usage&#160;<br/>exit&#160;<br/>;;&#160;<br/>
*)<br/>
usage &gt;&amp;2&#160;<br/>exit 1&#160;<br/>;;&#160;<br/>
esac&#160;<br/>shift&#160;<br/>
done<br/>
459<br/>
<hr/>
<a name=484></a>32 – Positional&#160;Parameters<br/>
First,&#160;we&#160;add&#160;a&#160;shell&#160;function&#160;called&#160;usage&#160;to&#160;display&#160;a&#160;message&#160;when&#160;the&#160;help&#160;option&#160;is<br/>invoked or an&#160;unknown option&#160;is&#160;attempted.<br/>Next,&#160;we&#160;begin&#160;the&#160;processing&#160;loop.&#160;This&#160;loop&#160;continues&#160;while&#160;the&#160;positional&#160;parameter<br/>$1&#160;is&#160;not&#160;empty.&#160;At&#160;the&#160;end&#160;of&#160;the&#160;loop,&#160;we&#160;have&#160;a&#160;shift&#160;command&#160;to&#160;advance&#160;the&#160;posi-<br/>tional&#160;parameters&#160;to&#160;ensure&#160;that&#160;the&#160;loop&#160;will&#160;eventually terminate.<br/>Within&#160;the&#160;loop,&#160;we&#160;have&#160;a&#160;case&#160;statement&#160;that&#160;examines&#160;the&#160;current&#160;positional&#160;parame-<br/>ter&#160;to&#160;see&#160;whether&#160;it&#160;matches&#160;any&#160;of&#160;the&#160;supported&#160;choices.&#160;If&#160;a&#160;supported&#160;parameter&#160;is<br/>found, it&#160;is&#160;acted&#160;upon. If&#160;an unknown choice&#160;is&#160;found the&#160;usage&#160;message&#160;is&#160;displayed&#160;and<br/>the&#160;script&#160;terminates&#160;with an error.<br/>The&#160;-f&#160;parameter&#160;is&#160;handled&#160;in&#160;an&#160;interesting&#160;way.&#160;When&#160;detected,&#160;it&#160;causes&#160;an&#160;additional<br/>shift&#160;to&#160;occur,&#160;which&#160;advances&#160;the&#160;positional&#160;parameter&#160;$1&#160;to&#160;the&#160;filename&#160;argument<br/>supplied to&#160;the&#160;-f&#160;option.&#160;<br/>We&#160;next&#160;add&#160;the&#160;code&#160;to implement&#160;the&#160;interactive&#160;mode.<br/>
# interactive mode&#160;<br/>
if [[ -n &#34;$interactive&#34; ]]; then&#160;<br/>
while true; do&#160;<br/>
read -p &#34;Enter name of output file: &#34; filename&#160;<br/>if [[ -e &#34;$filename&#34; ]]; then&#160;<br/>
read -p &#34;'$filename' exists. Overwrite? [y/n/q] &gt; &#34;&#160;<br/>case &#34;$REPLY&#34; in&#160;<br/>
Y|y)&#160;break&#160;<br/>
;;&#160;<br/>
Q|q)&#160;echo &#34;Program terminated.&#34;&#160;<br/>
exit&#160;<br/>;;&#160;<br/>
*)<br/>
continue&#160;<br/>;;&#160;<br/>
esac<br/>
elif [[ -z &#34;$filename&#34; ]]; then<br/>
continue<br/>
else<br/>
break&#160;<br/>
fi<br/>
done&#160;<br/>
fi<br/>
If&#160;the&#160;interactive&#160;variable&#160;is&#160;not&#160;empty,&#160;an&#160;endless&#160;loop&#160;is&#160;started,&#160;which&#160;contains<br/>the&#160;filename&#160;prompt&#160;and&#160;subsequent&#160;existing&#160;file-handling&#160;code.&#160;If&#160;the&#160;desired&#160;output&#160;file<br/>
460<br/>
<hr/>
<a name=485></a>A&#160;More&#160;Complete&#160;Application<br/>
already&#160;exists,&#160;the&#160;user&#160;is&#160;prompted&#160;to&#160;overwrite,&#160;choose&#160;another&#160;filename,&#160;or&#160;quit&#160;the<br/>program.&#160;If&#160;the&#160;user&#160;chooses&#160;to&#160;overwrite&#160;an&#160;existing&#160;file,&#160;a&#160;break&#160;is&#160;executed&#160;to&#160;termi-<br/>nate&#160;the&#160;loop.&#160;Notice&#160;how&#160;the&#160;case&#160;statement&#160;detects&#160;only&#160;whether&#160;the&#160;user&#160;chooses&#160;to<br/>overwrite&#160;or&#160;quit.&#160;Any&#160;other&#160;choice&#160;causes&#160;the&#160;loop&#160;to&#160;continue&#160;and&#160;prompts&#160;the&#160;user<br/>again.<br/>To&#160;implement&#160;the&#160;output&#160;filename&#160;feature,&#160;we&#160;must&#160;first&#160;convert&#160;the&#160;existing&#160;page-writing<br/>code&#160;into&#160;a&#160;shell&#160;function,&#160;for reasons&#160;that&#160;will&#160;become&#160;clear in&#160;a&#160;moment.<br/>
write_html_page () {&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>&lt;html&gt;&#160;<br/>
&lt;head&gt;&#160;<br/>
&lt;title&gt;$TITLE&lt;/title&gt;&#160;<br/>
&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;<br/>
&lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&lt;p&gt;$TIMESTAMP&lt;/p&gt;&#160;<br/>$(report_uptime)&#160;<br/>$(report_disk_space)&#160;<br/>$(report_home_space)&#160;<br/>
&lt;/body&gt;&#160;<br/>
&lt;/html&gt;&#160;<br/>_EOF_&#160;<br/>return&#160;<br/>
}<br/>
# output html page&#160;<br/>
if [[ -n &#34;$filename&#34; ]]; then&#160;<br/>
if&#160;touch &#34;$filename&#34; &amp;&amp; [[ -f &#34;$filename&#34; ]]; then&#160;<br/>
write_html_page &gt; &#34;$filename&#34;&#160;<br/>
else&#160;<br/>
echo &#34;$PROGNAME: Cannot write file '$filename'&#34; &gt;&amp;2&#160;<br/>exit 1&#160;<br/>
fi&#160;<br/>
else&#160;<br/>
write_html_page&#160;<br/>
fi<br/>
The&#160;code&#160;that&#160;handles&#160;the&#160;logic&#160;of the&#160;-f&#160;option&#160;appears&#160;at&#160;the&#160;end of the&#160;previous&#160;listing.<br/>In&#160;it,&#160;we&#160;test&#160;for&#160;the&#160;existence&#160;of&#160;a&#160;filename&#160;and,&#160;if&#160;one&#160;is&#160;found,&#160;a&#160;test&#160;is&#160;performed&#160;to&#160;see<br/>whether&#160;the&#160;file&#160;is&#160;indeed&#160;writable.&#160;&#160;To&#160;do&#160;this,&#160;a&#160;touch&#160;is&#160;performed,&#160;followed&#160;by&#160;a&#160;test<br/>
461<br/>
<hr/>
<a name=486></a>32 – Positional&#160;Parameters<br/>
to&#160;determine&#160;whether&#160;the&#160;resulting&#160;file&#160;is&#160;a&#160;regular&#160;file.&#160;These&#160;two&#160;tests&#160;take&#160;care&#160;of&#160;situa-<br/>tions&#160;where&#160;an&#160;invalid&#160;pathname&#160;is&#160;input&#160;(touch&#160;will&#160;fail),&#160;and,&#160;if&#160;the&#160;file&#160;already&#160;exists,<br/>that&#160;it’s&#160;a&#160;regular file.<br/>As&#160;we&#160;can&#160;see,&#160;the&#160;write_html_page&#160;function&#160;is&#160;called&#160;to&#160;perform&#160;the&#160;actual&#160;gener-<br/>ation&#160;of&#160;the&#160;page.&#160;Its&#160;output&#160;is&#160;either&#160;directed&#160;to&#160;standard&#160;output&#160;(if&#160;the&#160;variable&#160;file-<br/>name&#160;is&#160;empty)&#160;or&#160;redirected&#160;to&#160;the&#160;specified&#160;file.&#160;Since&#160;we&#160;have&#160;two&#160;possible&#160;destina-<br/>tions&#160;for&#160;the&#160;HTML&#160;code,&#160;it&#160;makes&#160;sense&#160;to&#160;convert&#160;the&#160;write_html_page&#160;routine&#160;to<br/>a&#160;shell&#160;function&#160;to avoid redundant&#160;code.<br/>
<b>Summing&#160;Up<br/></b>With&#160;the&#160;addition&#160;of&#160;positional&#160;parameters,&#160;we&#160;can&#160;now&#160;write&#160;fairly&#160;functional&#160;scripts.<br/>For&#160;simple,&#160;repetitive&#160;tasks,&#160;positional&#160;parameters&#160;make&#160;it&#160;possible&#160;to&#160;write&#160;very&#160;useful<br/>shell&#160;functions&#160;that&#160;can be&#160;placed&#160;in a&#160;user’s&#160;.bashrc&#160;file.<br/>Our&#160;sys_info_page&#160;program&#160;has&#160;grown&#160;in&#160;complexity&#160;and&#160;sophistication.&#160;Here&#160;is&#160;a<br/>complete&#160;listing,&#160;with the&#160;most&#160;recent&#160;changes&#160;highlighted:<br/>
#!/bin/bash&#160;<br/>
# sys_info_page: program to output a system information page&#160;<br/>
<b>PROGNAME=&#34;$(basename &#34;$0&#34;)&#34;&#160;<br/></b>TITLE=&#34;System Information Report For $HOSTNAME&#34;&#160;<br/>CURRENT_TIME=&#34;$(date +&#34;%x %r %Z&#34;)&#34;&#160;<br/>TIMESTAMP=&#34;Generated $CURRENT_TIME, by $USER&#34;&#160;<br/>
report_uptime () {&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;System Uptime&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(uptime)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
return&#160;<br/>
}&#160;<br/>
report_disk_space () {&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;Disk Space Utilization&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(df -h)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
return&#160;<br/>
}&#160;<br/>
462<br/>
<hr/>
<a name=487></a>Summing&#160;Up<br/>
report_home_space () {&#160;<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;Home Space Utilization (All Users)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh /home/*)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
else&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;Home Space Utilization ($USER)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh &#34;$HOME&#34;)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
fi&#160;<br/>return&#160;<br/>
}&#160;<br/>
<b>usage () {&#160;</b><br/>
<b>echo &#34;$PROGNAME: usage: $PROGNAME [-f file | -i]&#34;&#160;<br/>return&#160;</b><br/>
<b>}&#160;</b><br/>
<b>write_html_page () {&#160;</b><br/>
<b>cat &lt;&lt;- _EOF_&#160;<br/>&lt;html&gt;&#160;</b><br/>
<b>&lt;head&gt;&#160;</b><br/>
<b>&lt;title&gt;$TITLE&lt;/title&gt;&#160;</b><br/>
<b>&lt;/head&gt;&#160;<br/>&lt;body&gt;&#160;</b><br/>
<b>&lt;h1&gt;$TITLE&lt;/h1&gt;&#160;<br/>&lt;p&gt;$TIMESTAMP&lt;/p&gt;&#160;<br/>$(report_uptime)&#160;<br/>$(report_disk_space)&#160;<br/>$(report_home_space)&#160;</b><br/>
<b>&lt;/body&gt;&#160;</b><br/>
<b>&lt;/html&gt;&#160;<br/>_EOF_&#160;<br/>return&#160;</b><br/>
<b>}&#160;</b><br/>
# process command line options&#160;<br/>
<b>interactive=&#160;<br/>filename=&#160;</b><br/>
463<br/>
<hr/>
<a name=488></a>32 – Positional&#160;Parameters<br/>
<b>while [[ -n &#34;$1&#34; ]]; do&#160;</b><br/>
<b>case &#34;$1&#34; in&#160;</b><br/>
<b>-f | --file)</b><br/>
<b>shift&#160;<br/>filename=&#34;$1&#34;&#160;<br/>;;&#160;</b><br/>
<b>-i | --interactive)&#160;interactive=1&#160;</b><br/>
<b>;;&#160;</b><br/>
<b>-h | --help)</b><br/>
<b>usage&#160;<br/>exit&#160;<br/>;;&#160;</b><br/>
<b>*)</b><br/>
<b>usage &gt;&amp;2&#160;<br/>exit 1&#160;<br/>;;&#160;</b><br/>
<b>esac&#160;<br/>shift&#160;</b><br/>
<b>done&#160;</b><br/>
# interactive mode&#160;<br/>
<b>if [[ -n &#34;$interactive&#34; ]]; then&#160;</b><br/>
<b>while true; do&#160;</b><br/>
<b>read -p &#34;Enter name of output file: &#34; filename&#160;<br/>if [[ -e &#34;$filename&#34; ]]; then&#160;</b><br/>
<b>read -p &#34;'$filename' exists. Overwrite? [y/n/q] &gt; &#34;&#160;<br/>case &#34;$REPLY&#34; in&#160;</b><br/>
<b>Y|y)&#160;break&#160;</b><br/>
<b>;;&#160;</b><br/>
<b>Q|q)&#160;echo &#34;Program terminated.&#34;&#160;</b><br/>
<b>exit&#160;<br/>;;&#160;</b><br/>
<b>*)</b><br/>
<b>continue&#160;<br/>;;&#160;</b><br/>
<b>esac</b><br/>
<b>elif [[ -z &#34;$filename&#34; ]]; then</b><br/>
<b>continue</b><br/>
<b>else</b><br/>
<b>break &#160;</b><br/>
<b>fi&#160;</b><br/>
<b>done&#160;</b><br/>
<b>fi&#160;</b><br/>
# output html page&#160;<br/>
<b>if [[ -n &#34;$filename&#34; ]]; then&#160;</b><br/>
464<br/>
<hr/>
<a name=489></a>Summing&#160;Up<br/>
<b>if touch &#34;$filename&#34; &amp;&amp; [[ -f &#34;$filename&#34; ]]; then&#160;</b><br/>
<b>write_html_page &gt; &#34;$filename&#34;&#160;</b><br/>
<b>else&#160;</b><br/>
<b>echo &#34;$PROGNAME: Cannot write file '$filename'&#34; &gt;&amp;2&#160;<br/>exit 1&#160;</b><br/>
<b>fi&#160;</b><br/>
<b>else&#160;</b><br/>
<b>write_html_page&#160;</b><br/>
<b>fi&#160;</b><br/>
We’re&#160;not&#160;done&#160;yet.&#160;There&#160;are&#160;still&#160;a&#160;few&#160;more&#160;things&#160;we&#160;can&#160;do&#160;and&#160;improvements&#160;we<br/>can make.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Hackers&#160;Wiki</i>&#160;has&#160;a&#160;good article&#160;on positional&#160;parameters:<br/><a href="http://wiki.bash-hackers.org/scripting/posparams">http://wiki.bash-hackers.org/scripting/posparams</a><br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;has&#160;an article&#160;on the&#160;special&#160;parameters, including&#160;<br/>$*&#160;and&#160;$@:<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html#Special-Parameters">http://www.gnu.org/software/bash/manual/bashref.html#Special-Parameters</a><br/>
●<br/>
In addition to the&#160;techniques&#160;discussed in this&#160;chapter,&#160;bash&#160;includes&#160;a&#160;builtin&#160;<br/>command&#160;called&#160;getopts, which&#160;can also be&#160;used for process&#160;command line&#160;ar-<br/>guments. It&#160;is&#160;described in&#160;the&#160;SHELL&#160;BUILTIN&#160;COMMANDS&#160;section&#160;of the&#160;<br/>bash&#160;man page&#160;and at&#160;the&#160;<i>Bash Hackers&#160;Wiki</i>:<br/><a href="http://wiki.bash-hackers.org/howto/getopts_tutorial">http://wiki.bash-hackers.org/howto/getopts_tutorial</a><br/>
465<br/>
<hr/>
<a name=490></a>33 – Flow&#160;Control:&#160;Looping with&#160;for<br/>
<i><b>33&#160;–&#160;Flow&#160;Control:&#160;Looping&#160;with&#160;for</b></i><br/>
In&#160;this&#160;final&#160;chapter&#160;on&#160;flow&#160;control,&#160;we&#160;will&#160;look&#160;at&#160;another&#160;of&#160;the&#160;shell’s&#160;looping&#160;con-<br/>structs.&#160;The&#160;<i>for&#160;loop</i>&#160;differs&#160;from&#160;the&#160;while&#160;and&#160;until&#160;loops&#160;in&#160;that&#160;it&#160;provides&#160;a&#160;means&#160;of<br/>processing&#160;sequences&#160;during&#160;a&#160;loop.&#160;This&#160;turns&#160;out&#160;to&#160;be&#160;very&#160;useful&#160;when&#160;programming.<br/>Accordingly,&#160;the&#160;for&#160;loop&#160;is&#160;a&#160;popular construct&#160;in&#160;bash&#160;scripting.<br/>A&#160;for&#160;&#160;loop&#160;is&#160;implemented,&#160;naturally&#160;enough,&#160;with&#160;the&#160;&#160;for&#160;&#160;&#160;compound&#160;command.&#160;In<br/>bash,&#160;for&#160;is&#160;available&#160;in two forms.<br/>
<b>for:&#160;Traditional&#160;Shell&#160;Form<br/></b>The&#160;original&#160;for&#160;command’s&#160;syntax is&#160;as&#160;follows:<br/>for&#160;<i>variable</i>&#160;[in&#160;<i>words</i>]; do<br/>
<i>commands</i><br/>
done<br/>
where&#160;<i>variable</i>&#160;is&#160;the&#160;name&#160;of a&#160;variable&#160;that&#160;will&#160;increment&#160;during&#160;the&#160;execution&#160;of&#160;<br/>the&#160;loop,&#160;<i>words</i>&#160;is&#160;an optional&#160;list&#160;of items&#160;that&#160;will&#160;be&#160;sequentially assigned&#160;to&#160;<i>vari-<br/>able</i>, and&#160;<i>commands</i>&#160;are&#160;the&#160;commands&#160;that&#160;are&#160;to be&#160;executed&#160;on each iteration of the&#160;<br/>loop.<br/>The&#160;for&#160;command is&#160;useful&#160;on the&#160;command line.&#160;We&#160;can&#160;easily demonstrate&#160;how&#160;it&#160;<br/>works.<br/>
[me@linuxbox ~]$&#160;<b>for i in A B C D; do echo $i; done&#160;<br/></b>A&#160;<br/>B&#160;<br/>C&#160;<br/>D<br/>
In&#160;this&#160;example,&#160;&#160;for&#160;&#160;is&#160;given&#160;a&#160;list&#160;of&#160;four&#160;words:&#160;&#160;A,&#160;&#160;B,&#160;&#160;C,&#160;and&#160;&#160;D.&#160;With&#160;a&#160;list&#160;of&#160;four<br/>words,&#160;the&#160;loop&#160;is&#160;executed&#160;four&#160;times.&#160;Each&#160;time&#160;the&#160;loop&#160;is&#160;executed,&#160;a&#160;word&#160;is&#160;assigned<br/>to the&#160;variable&#160;i. Inside&#160;the&#160;loop, we&#160;have&#160;an&#160;echo&#160;command that&#160;displays&#160;the&#160;value&#160;of&#160;i<br/>to&#160;show&#160;the&#160;assignment.&#160;As&#160;with&#160;the&#160;while&#160;and&#160;until&#160;loops,&#160;the&#160;done&#160;keyword&#160;closes<br/>
466<br/>
<hr/>
<a name=491></a>for:&#160;Traditional&#160;Shell&#160;Form<br/>
the&#160;loop.<br/>The&#160;really&#160;powerful&#160;feature&#160;of&#160;for&#160;is&#160;the&#160;number&#160;of interesting ways&#160;we&#160;can create&#160;the&#160;<br/>list&#160;of words. For example,&#160;we&#160;can do it&#160;through&#160;brace&#160;expansion, like&#160;so:<br/>
[me@linuxbox ~]$&#160;<b>for i in {A..D}; do echo $i; done<br/></b>A<br/>B<br/>C<br/>D<br/>
or we&#160;could use&#160;pathname&#160;expansion, as&#160;follows:<br/>
[me@linuxbox ~]$&#160;<b>for i in distros*.txt; do echo &#34;$i&#34;; done<br/></b>distros-by-date.txt&#160;<br/>distros-dates.txt&#160;<br/>distros-key-names.txt&#160;<br/>distros-key-vernums.txt&#160;<br/>distros-names.txt &#160;<br/>distros.txt&#160;<br/>distros-vernums.txt&#160;<br/>distros-versions.txt<br/>
Pathname&#160;expansion provides&#160;a&#160;nice,&#160;clean&#160;list&#160;of pathnames&#160;that&#160;can be&#160;processed in&#160;the&#160;<br/>loop.&#160;The&#160;one&#160;precaution needed&#160;is&#160;to check that&#160;the&#160;expansion actually&#160;matched some-<br/>thing. By default,&#160;if the&#160;expansion fails&#160;to match any files, the&#160;wildcards&#160;themselves&#160;<br/>(&#34;distros*.txt&#34; in&#160;the&#160;example&#160;above) will&#160;be&#160;returned.&#160;To guard against&#160;this, we&#160;would&#160;<br/>code&#160;the&#160;example&#160;above&#160;in a&#160;script&#160;this&#160;way:<br/>
for i in distros*.txt; do<br/>
if [[ -e &#34;$i&#34; ]]; then<br/>
echo &#34;$i&#34;<br/>
fi<br/>
done<br/>
By adding a&#160;test&#160;for file&#160;existence, we&#160;will&#160;ignore&#160;a&#160;failed expansion.<br/>Another common&#160;method&#160;of word production is&#160;command substitution.<br/>
#!/bin/bash&#160;<br/>
467<br/>
<hr/>
<a name=492></a>33 – Flow&#160;Control:&#160;Looping with&#160;for<br/>
# longest-word: find longest string in a file&#160;<br/>
while [[ -n &#34;$1&#34; ]]; do&#160;<br/>
if [[ -r &#34;$1&#34; ]]; then&#160;<br/>
max_word=&#160;<br/>max_len=0<br/>for i in $(strings &#34;$1&#34;); do&#160;<br/>
len=&#34;$(echo -n &#34;$i&#34; | wc -c)&#34;&#160;<br/>if (( len &gt; max_len )); then&#160;<br/>
max_len=&#34;$len&#34;<br/>max_word=&#34;$i&#34;<br/>
fi&#160;<br/>
done&#160;<br/>echo &#34;$1: '$max_word' ($max_len characters)&#34;&#160;<br/>
fi&#160;<br/>shift&#160;<br/>
done<br/>
In&#160;this&#160;example,&#160;we&#160;look&#160;for&#160;the&#160;longest&#160;string&#160;found&#160;within&#160;a&#160;file.&#160;When&#160;given&#160;one&#160;or<br/>more&#160;filenames&#160;on the&#160;command&#160;line,&#160;this&#160;program&#160;uses&#160;the&#160;strings&#160;program&#160;(which&#160;is<br/>included&#160;in&#160;the&#160;GNU&#160;binutils&#160;package)&#160;to&#160;generate&#160;a&#160;list&#160;of&#160;readable&#160;text&#160;“words”&#160;in&#160;each<br/>file.&#160;The&#160;for&#160;loop&#160;processes&#160;each&#160;word&#160;in&#160;turn&#160;and&#160;determines&#160;whether&#160;the&#160;current&#160;word<br/>is&#160;the&#160;longest&#160;found so far.&#160;When&#160;the&#160;loop concludes, the&#160;longest&#160;word is&#160;displayed.<br/>One&#160;thing&#160;to&#160;note&#160;here&#160;is&#160;that,&#160;contrary&#160;to&#160;our&#160;usual&#160;practice,&#160;we&#160;do&#160;not&#160;surround&#160;the&#160;com-<br/>mand&#160;substitution&#160;$(strings&#160;&#34;$1&#34;)&#160;with&#160;double&#160;quotes.&#160;This&#160;is&#160;because&#160;we&#160;actually<br/>want&#160;word&#160;splitting&#160;to&#160;occur&#160;to&#160;give&#160;us&#160;our&#160;list.&#160;If&#160;we&#160;had&#160;surrounded&#160;the&#160;command&#160;sub-<br/>stitution&#160;with&#160;quotes,&#160;it&#160;would&#160;produce&#160;only&#160;a&#160;single&#160;word&#160;containing&#160;every&#160;string&#160;in&#160;the<br/>file.&#160;That’s&#160;not&#160;exactly what&#160;we&#160;are&#160;looking&#160;for.<br/>If&#160;the&#160;optional&#160;in&#160;<i>words</i>&#160;portion&#160;of&#160;the&#160;for&#160;command&#160;is&#160;omitted,&#160;for&#160;defaults&#160;to&#160;pro-<br/>cessing&#160;the&#160;positional&#160;parameters.&#160;We&#160;will&#160;modify&#160;our&#160;longest-word&#160;script&#160;to&#160;use&#160;this<br/>method:<br/>
#!/bin/bash&#160;<br/>
# longest-word2: find longest string in a file&#160;<br/>
for i; do&#160;<br/>
if [[ -r &#34;$i&#34; ]]; then&#160;<br/>
max_word=&#160;<br/>
468<br/>
<hr/>
<a name=493></a>for:&#160;Traditional&#160;Shell&#160;Form<br/>
max_len=0&#160;<br/>for j in $(strings &#34;$i&#34;); do&#160;<br/>
len=&#34;$(echo -n &#34;$j&#34; | wc -c)&#34;&#160;<br/>if (( len &gt; max_len )); then&#160;<br/>
max_len=&#34;$len&#34;&#160;<br/>max_word=&#34;$j&#34;<br/>
fi&#160;<br/>
done&#160;<br/>echo &#34;$i: '$max_word' ($max_len characters)&#34;&#160;<br/>
fi&#160;<br/>
done<br/>
As&#160;we&#160;can&#160;see,&#160;we&#160;have&#160;changed&#160;the&#160;outermost&#160;loop&#160;to&#160;use&#160;for&#160;in&#160;place&#160;of&#160;while.&#160;By<br/>omitting&#160;the&#160;list&#160;of&#160;words&#160;in&#160;the&#160;&#160;for&#160;command,&#160;the&#160;positional&#160;parameters&#160;are&#160;used&#160;in-<br/>stead.&#160;Inside&#160;the&#160;loop,&#160;previous&#160;instances&#160;of&#160;the&#160;variable&#160;i&#160;have&#160;been&#160;changed&#160;to&#160;the&#160;vari-<br/>able&#160;j.&#160;The&#160;use&#160;of&#160;shift&#160;has&#160;also been&#160;eliminated.<br/>
<b>Why&#160;i?</b><br/>
You&#160;may&#160;have&#160;noticed&#160;that&#160;the&#160;variable&#160;&#160;i&#160;&#160;was&#160;chosen&#160;for&#160;each&#160;of&#160;the&#160;previous<br/>for&#160;loop&#160;examples.&#160;Why?&#160;No&#160;specific&#160;reason&#160;actually&#160;besides&#160;tradition.&#160;The&#160;vari-<br/>able&#160;used&#160;with&#160;&#160;for&#160;&#160;can&#160;be&#160;any&#160;valid&#160;variable,&#160;but&#160;&#160;i&#160;&#160;is&#160;the&#160;most&#160;common,&#160;fol-<br/>lowed by&#160;j&#160;and&#160;k.<br/>The&#160;basis&#160;of&#160;this&#160;tradition&#160;comes&#160;from&#160;the&#160;Fortran&#160;programming&#160;language.&#160;In&#160;For-<br/>tran,&#160;undeclared&#160;variables&#160;starting&#160;with&#160;the&#160;letters&#160;I,&#160;J,&#160;K,&#160;L,&#160;and&#160;M&#160;are&#160;automati-<br/>cally&#160;typed&#160;as&#160;integers,&#160;while&#160;variables&#160;beginning&#160;with&#160;any&#160;other&#160;letter&#160;are&#160;typed<br/>as&#160;reals&#160;(numbers&#160;with&#160;decimal&#160;fractions).&#160;This&#160;behavior&#160;led&#160;programmers&#160;to&#160;use<br/>the&#160;variables&#160;I,&#160;J,&#160;and&#160;K&#160;for&#160;loop&#160;variables&#160;since&#160;it&#160;was&#160;less&#160;work&#160;to&#160;use&#160;them<br/>when&#160;a&#160;temporary variable&#160;(as&#160;loop&#160;variables&#160;often are)&#160;was&#160;needed.<br/>It&#160;also led&#160;to the&#160;following&#160;Fortran-based witticism:<br/>“GOD&#160;is&#160;real,&#160;unless&#160;declared integer.”&#160;<br/>
<b>for:&#160;C&#160;Language&#160;Form<br/></b>Recent&#160;versions&#160;of&#160;bash&#160;have&#160;added&#160;a&#160;second&#160;form&#160;of&#160;for&#160;command&#160;syntax,&#160;one&#160;that<br/>resembles&#160;the&#160;form&#160;found&#160;in&#160;the&#160;C&#160;programming&#160;language.&#160;Many&#160;other&#160;languages&#160;support<br/>this&#160;form, as&#160;well.<br/>
469<br/>
<hr/>
<a name=494></a>33 – Flow&#160;Control:&#160;Looping with&#160;for<br/>
for ((&#160;<i>expression1</i>;&#160;<i>expression2</i>;&#160;<i>expression3</i>&#160;)); do<br/>
<i>commands</i><br/>
done<br/>
Here&#160;<i>expression1</i>,&#160;<i>expression2</i>,&#160;and&#160;<i>expression3</i>&#160;are&#160;arithmetic&#160;expressions<br/>and&#160;<i>commands</i>&#160;are&#160;the&#160;commands&#160;to&#160;be&#160;performed&#160;during each&#160;iteration&#160;of the&#160;loop.<br/>In terms&#160;of behavior, this&#160;form&#160;is&#160;equivalent&#160;to the&#160;following construct:<br/>((&#160;<i>expression1</i>&#160;))<br/>while ((&#160;<i>expression2</i>&#160;)); do<br/>
<i>commands<br/></i>((&#160;<i>expression3</i>&#160;))<br/>
done<br/>
<i>expression1</i>&#160;is&#160;used&#160;to initialize&#160;conditions&#160;for the&#160;loop,&#160;<i>expression2</i>&#160;is&#160;used&#160;to&#160;<br/>determine&#160;when the&#160;loop is&#160;finished, and&#160;<i>expression3</i>&#160;is&#160;carried out&#160;at&#160;the&#160;end of each<br/>iteration&#160;of the&#160;loop.<br/>Here&#160;is&#160;a&#160;typical&#160;application:<br/>
#!/bin/bash&#160;<br/>
# simple_counter: demo of C style for command&#160;<br/>
for (( i=0; i&lt;5; i=i+1 )); do&#160;<br/>
echo $i&#160;<br/>
done<br/>
When executed,&#160;it&#160;produces&#160;the&#160;following&#160;output:<br/>
[me@linuxbox ~]$&#160;<b>simple_counter</b>&#160;<br/>0&#160;<br/>1&#160;<br/>2&#160;<br/>3&#160;<br/>4<br/>
In&#160;this&#160;example,&#160;&#160;<i>expression1</i>&#160;initializes&#160;the&#160;variable&#160;&#160;i&#160;with&#160;the&#160;value&#160;of&#160;zero,&#160;&#160;<i>ex-<br/>pression2</i>&#160;allows&#160;the&#160;loop&#160;to&#160;continue&#160;as&#160;long&#160;as&#160;the&#160;value&#160;of&#160;i&#160;remains&#160;less&#160;than&#160;5,<br/>and&#160;<i>expression3</i>&#160;increments&#160;the&#160;value&#160;of&#160;i&#160;by 1 each time&#160;the&#160;loop repeats.<br/>The&#160;C language&#160;form&#160;of&#160;for&#160;is&#160;useful&#160;anytime&#160;a&#160;numeric&#160;sequence&#160;is&#160;needed.&#160;We&#160;will&#160;see<br/>several&#160;applications&#160;for this&#160;in the&#160;next&#160;two chapters.<br/>
470<br/>
<hr/>
<a name=495></a>Summing&#160;Up<br/>
<b>Summing&#160;Up<br/></b>With&#160;our&#160;knowledge&#160;of&#160;the&#160;for&#160;command,&#160;we&#160;will&#160;now&#160;apply&#160;the&#160;final&#160;improvements&#160;to<br/>our&#160;&#160;sys_info_page&#160;&#160;script.&#160;&#160;Currently,&#160;&#160;the&#160;&#160;report_home_space&#160;&#160;function&#160;&#160;looks<br/>like&#160;this:<br/>
report_home_space () {&#160;<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;Home Space Utilization (All Users)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh /home/*)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
else&#160;<br/>
cat &lt;&lt;- _EOF_&#160;<br/>
&lt;h2&gt;Home Space Utilization ($USER)&lt;/h2&gt;&#160;<br/>&lt;pre&gt;$(du -sh &#34;$HOME&#34;)&lt;/pre&gt;&#160;<br/>_EOF_&#160;<br/>
fi&#160;<br/>return&#160;<br/>
}<br/>
Next,&#160;we&#160;will&#160;rewrite&#160;it&#160;to&#160;provide&#160;more&#160;detail&#160;for&#160;each&#160;user’s&#160;home&#160;directory&#160;and&#160;include<br/>the&#160;total&#160;number of files&#160;and subdirectories&#160;in each.<br/>
report_home_space () {&#160;<br/>
local format=&#34;%8s%10s%10s\n&#34;&#160;<br/>local i dir_list total_files total_dirs total_size user_name<br/>
if [[ &#34;$(id -u)&#34; -eq 0 ]]; then&#160;<br/>
dir_list=/home/*<br/>user_name=&#34;All Users&#34;&#160;<br/>
else&#160;<br/>
dir_list=&#34;$HOME&#34;&#160;<br/>user_name=&#34;$USER&#34;<br/>
fi&#160;<br/>
echo &#34;&lt;h2&gt;Home Space Utilization ($user_name)&lt;/h2&gt;&#34;&#160;<br/>
for i in $dir_list; do<br/>
&#160;<br/>
total_files=&#34;$(find &#34;$i&#34; -type f | wc -l)&#34;&#160;<br/>
471<br/>
<hr/>
<a name=496></a>33 – Flow&#160;Control:&#160;Looping with&#160;for<br/>
total_dirs=&#34;$(find &#34;$i&#34; -type d | wc -l)&#34;&#160;<br/>total_size=&#34;$(du -sh &#34;$i&#34; | cut -f 1)&#34;&#160;<br/>
echo &#34;&lt;H3&gt;$i&lt;/H3&gt;&#34;&#160;<br/>echo &#34;&lt;pre&gt;&#34;&#160;<br/>printf &#34;$format&#34; &#34;Dirs&#34; &#34;Files&#34; &#34;Size&#34;&#160;<br/>printf &#34;$format&#34; &#34;----&#34; &#34;-----&#34; &#34;----&#34;&#160;<br/>printf &#34;$format&#34; &#34;$total_dirs&#34; &#34;$total_files&#34; &#34;$total_size&#34;<br/>echo &#34;&lt;/pre&gt;&#34;&#160;<br/>
done&#160;<br/>return&#160;<br/>
}<br/>
This&#160;rewrite&#160;applies&#160;much&#160;of&#160;what&#160;we&#160;have&#160;learned&#160;so&#160;far.&#160;We&#160;still&#160;test&#160;for&#160;the&#160;superuser,<br/>but&#160;instead&#160;of&#160;performing&#160;the&#160;complete&#160;set&#160;of&#160;actions&#160;as&#160;part&#160;of&#160;the&#160;if,&#160;we&#160;set&#160;some&#160;vari-<br/>ables&#160;used&#160;later&#160;in&#160;a&#160;for&#160;loop.&#160;We&#160;have&#160;added&#160;several&#160;local&#160;variables&#160;to&#160;the&#160;function&#160;and<br/>made&#160;use&#160;of&#160;printf&#160;to format&#160;some&#160;of the&#160;output.<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Advanced Bash-Scripting Guide</i>&#160;has&#160;a&#160;chapter on loops, with a&#160;variety&#160;of ex-<br/>amples&#160;using&#160;for:<br/><a href="http://tldp.org/LDP/abs/html/loops1.html">http://tldp.org/LDP/abs/html/loops1.html</a><br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;describes&#160;the&#160;looping compound commands, includ-<br/>ing&#160;for:<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html#Looping-Constructs">http://www.gnu.org/software/bash/manual/bashref.html#Looping-Constructs</a><br/>
472<br/>
<hr/>
<a name=497></a>34 – Strings&#160;and Numbers<br/>
<i><b>34&#160;–&#160;Strings&#160;and&#160;Numbers</b></i><br/>
Computer&#160;programs&#160;are&#160;all&#160;about&#160;working&#160;with&#160;data.&#160;In&#160;past&#160;chapters,&#160;we&#160;have&#160;focused&#160;on<br/>processing&#160;&#160;data&#160;&#160;&#160;at&#160;&#160;the&#160;&#160;&#160;file&#160;&#160;&#160;level.&#160;&#160;However,&#160;&#160;many&#160;&#160;&#160;programming&#160;&#160;&#160;problems&#160;&#160;need&#160;&#160;&#160;to&#160;&#160;be<br/>solved using smaller units&#160;of data&#160;such as&#160;strings&#160;and numbers.<br/>In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;several&#160;shell&#160;features&#160;that&#160;are&#160;used&#160;to&#160;manipulate&#160;strings<br/>and&#160;numbers.&#160;The&#160;shell&#160;provides&#160;a&#160;variety&#160;of&#160;parameter&#160;expansions&#160;that&#160;perform&#160;string<br/>operations.&#160;In&#160;addition&#160;to&#160;&#160;arithmetic&#160;&#160;expansion&#160;(which&#160;we&#160;touched&#160;upon&#160;in&#160;Chapter&#160;7,<br/>“Seeing&#160;the&#160;World&#160;as&#160;the&#160;Shell&#160;Sees&#160;It”),&#160;there&#160;is&#160;a&#160;well-known&#160;command&#160;line&#160;program<br/>called&#160;bc, which&#160;performs&#160;higher-level&#160;math.<br/>
<b>Parameter&#160;Expansion<br/></b>Though&#160;parameter&#160;expansion&#160;came&#160;up&#160;in&#160;Chapter&#160;7,&#160;we&#160;did&#160;not&#160;cover&#160;it&#160;in&#160;detail&#160;because<br/>most&#160;parameter&#160;expansions&#160;are&#160;used&#160;in&#160;scripts&#160;rather&#160;than&#160;on&#160;the&#160;command&#160;line.&#160;We&#160;have<br/>already&#160;worked&#160;with&#160;some&#160;forms&#160;of&#160;parameter&#160;expansion,&#160;for&#160;example,&#160;shell&#160;variables.<br/>The&#160;shell&#160;provides&#160;many&#160;more.<br/>
<b>Note</b>:&#160;It's&#160;always&#160;good&#160;practice&#160;to&#160;enclose&#160;parameter&#160;expansions&#160;in&#160;double&#160;quotes<br/>to&#160;prevent&#160;unwanted&#160;word&#160;splitting,&#160;unless&#160;there&#160;is&#160;a&#160;specific&#160;reason&#160;not&#160;to.&#160;This<br/>is&#160;especially&#160;true&#160;when&#160;dealing&#160;with&#160;filenames&#160;since&#160;they&#160;can&#160;often&#160;include&#160;em-<br/>bedded&#160;spaces&#160;and other&#160;assorted&#160;nastiness.<br/>
Basic&#160;Parameters<br/>The&#160;simplest&#160;form&#160;of&#160;parameter&#160;expansion&#160;is&#160;reflected&#160;in&#160;the&#160;ordinary&#160;use&#160;of&#160;variables.<br/>Here’s&#160;an example:<br/>$a<br/>
When&#160;expanded,&#160;this&#160;becomes&#160;whatever&#160;the&#160;variable&#160;a&#160;contains.&#160;Simple&#160;parameters&#160;may<br/>also be&#160;surrounded by braces.<br/>${a}<br/>
This&#160;has&#160;no&#160;effect&#160;on&#160;the&#160;expansion,&#160;but&#160;is&#160;required&#160;if&#160;the&#160;variable&#160;is&#160;adjacent&#160;to&#160;other<br/>
473<br/>
<hr/>
<a name=498></a>34 – Strings&#160;and Numbers<br/>
text,&#160;which&#160;may&#160;confuse&#160;the&#160;shell.&#160;In&#160;this&#160;example,&#160;we&#160;attempt&#160;to&#160;create&#160;a&#160;filename&#160;by&#160;ap-<br/>pending the&#160;string&#160;_file&#160;to&#160;the&#160;contents&#160;of the&#160;variable&#160;a.<br/>
[me@linuxbox ~]$&#160;<b>a=&#34;foo&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo &#34;$a_file&#34;</b><br/>
If&#160;we&#160;perform&#160;this&#160;sequence&#160;of&#160;commands,&#160;the&#160;result&#160;will&#160;be&#160;nothing&#160;because&#160;the&#160;shell<br/>will&#160;try&#160;to&#160;expand&#160;a&#160;variable&#160;named&#160;a_file&#160;rather&#160;than&#160;a.&#160;This&#160;problem&#160;can&#160;be&#160;solved<br/>by adding braces&#160;around the&#160;“real”&#160;variable&#160;name.<br/>
[me@linuxbox ~]$&#160;<b>echo &#34;${a}_file&#34;<br/></b>foo_file<br/>
We&#160;have&#160;also&#160;seen&#160;that&#160;positional&#160;parameters&#160;greater&#160;than&#160;nine&#160;can&#160;be&#160;accessed&#160;by&#160;sur-<br/>rounding&#160;the&#160;number&#160;in&#160;braces.&#160;For&#160;example,&#160;to&#160;access&#160;the&#160;eleventh&#160;positional&#160;parameter,<br/>we&#160;can do this:<br/>${11}<br/>
Expansions&#160;to&#160;Manage&#160;Empty&#160;Variables<br/>Several&#160;parameter&#160;expansions&#160;are&#160;intended&#160;to&#160;deal&#160;with&#160;nonexistent&#160;and&#160;empty&#160;variables.<br/>These&#160;expansions&#160;are&#160;handy&#160;for&#160;handling&#160;missing&#160;positional&#160;parameters&#160;and&#160;assigning&#160;de-<br/>fault&#160;values&#160;to&#160;parameters.<br/>${<i>parameter</i>:-<i>word</i>}<br/>If&#160;<i>parameter</i>&#160;is&#160;unset&#160;(i.e.,&#160;does&#160;not&#160;exist)&#160;or&#160;is&#160;empty,&#160;this&#160;expansion&#160;results&#160;in&#160;the&#160;value<br/>of&#160;<i>word</i>. If&#160;<i>parameter</i>&#160;is&#160;not&#160;empty,&#160;the&#160;expansion&#160;results&#160;in the&#160;value&#160;of&#160;<i>parameter</i>.<br/>
[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:-&#34;substitute value if unset&#34;}<br/></b>substitute value if unset<br/>[me@linuxbox ~]$&#160;<b>echo $foo</b><br/>
[me@linuxbox ~]$&#160;<b>foo=bar<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:-&#34;substitute value if unset&#34;}<br/></b>bar<br/>[me@linuxbox ~]$&#160;<b>echo $foo</b><br/>
474<br/>
<hr/>
<a name=499></a>Parameter&#160;Expansion<br/>
bar<br/>
${<i>parameter</i>:=<i>word</i>}<br/>If&#160;<i>parameter</i>&#160;is&#160;unset&#160;or&#160;empty,&#160;this&#160;expansion&#160;results&#160;in&#160;the&#160;value&#160;of&#160;<i>word</i>.&#160;In&#160;addition,<br/>the&#160;value&#160;of&#160;<i>word</i>&#160;is&#160;assigned&#160;to&#160;<i>parameter</i>.&#160;If&#160;<i>parameter</i>&#160;is&#160;not&#160;empty,&#160;the&#160;expansion&#160;re-<br/>sults&#160;in the&#160;value&#160;of&#160;<i>parameter</i>.<br/>
[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:=&#34;default value if unset&#34;}<br/></b>default value if unset<br/>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>default value if unset<br/>[me@linuxbox ~]$&#160;<b>foo=bar<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:=&#34;default value if unset&#34;}<br/></b>bar<br/>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>bar<br/>
<b>Note</b>:&#160;Positional&#160;and other&#160;special&#160;parameters&#160;cannot&#160;be&#160;assigned&#160;this&#160;way.<br/>
${<i>parameter</i>:?<i>word</i>}<br/>If&#160;<i>parameter</i>&#160;is&#160;unset&#160;or&#160;empty,&#160;this&#160;expansion&#160;causes&#160;the&#160;script&#160;to&#160;exit&#160;with&#160;an&#160;error,&#160;and<br/>the&#160;contents&#160;of&#160;<i>word</i>&#160;are&#160;sent&#160;to&#160;standard&#160;error.&#160;If&#160;<i>parameter</i>&#160;is&#160;not&#160;empty,&#160;the&#160;expansion<br/>results&#160;in the&#160;value&#160;of&#160;<i>parameter</i>.<br/>
[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:?&#34;parameter is empty&#34;}<br/></b>bash: foo: parameter is empty<br/>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>1<br/>[me@linuxbox ~]$&#160;<b>foo=bar<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:?&#34;parameter is empty&#34;}<br/></b>bar<br/>[me@linuxbox ~]$&#160;<b>echo $?<br/></b>0<br/>
475<br/>
<hr/>
<a name=500></a>34 – Strings&#160;and Numbers<br/>
${<i>parameter</i>:+<i>word</i>}<br/>If&#160;&#160;<i>parameter</i>&#160;&#160;is&#160;unset&#160;or&#160;empty,&#160;the&#160;expansion&#160;results&#160;in&#160;nothing.&#160;If&#160;&#160;<i>parameter</i>&#160;&#160;is&#160;not<br/>empty,&#160;the&#160;value&#160;of&#160;<i>word</i>&#160;is&#160;substituted&#160;for&#160;<i>parameter</i>;&#160;however,&#160;the&#160;value&#160;of&#160;<i>parameter</i>&#160;is<br/>not&#160;changed.<br/>
[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:+&#34;substitute value if set&#34;}</b><br/>
[me@linuxbox ~]$&#160;<b>foo=bar<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:+&#34;substitute value if set&#34;}<br/></b>substitute value if set<br/>
Expansions&#160;That&#160;Return&#160;Variable&#160;Names<br/>The&#160;shell&#160;has&#160;the&#160;ability&#160;to&#160;return&#160;the&#160;names&#160;of&#160;variables.&#160;This&#160;is&#160;used&#160;in&#160;some&#160;rather&#160;ex-<br/>otic&#160;situations.<br/>${!<i>prefix</i>*}<br/>${!<i>prefix</i>@}<br/>This&#160;expansion&#160;returns&#160;the&#160;names&#160;of&#160;existing&#160;variables&#160;with&#160;names&#160;beginning&#160;with&#160;<i>prefix</i>.<br/>According&#160;to&#160;the&#160;bash&#160;documentation,&#160;both&#160;forms&#160;of&#160;the&#160;expansion&#160;perform&#160;identically.<br/>Here, we&#160;list&#160;all&#160;the&#160;variables&#160;in the&#160;environment&#160;with names&#160;that&#160;begin&#160;with BASH:<br/>
[me@linuxbox ~]$&#160;<b>echo ${!BASH*}<br/></b>BASH BASH_ARGC BASH_ARGV BASH_COMMAND BASH_COMPLETION&#160;<br/>BASH_COMPLETION_DIR BASH_LINENO BASH_SOURCE BASH_SUBSHELL&#160;<br/>BASH_VERSINFO BASH_VERSION<br/>
String&#160;Operations<br/>There&#160;is&#160;a&#160;large&#160;set&#160;of&#160;expansions&#160;that&#160;can&#160;be&#160;used&#160;to&#160;operate&#160;on&#160;strings.&#160;Many&#160;of&#160;these<br/>expansions&#160;are&#160;particularly&#160;well&#160;suited&#160;for operations&#160;on pathnames.<br/>${#<i>parameter</i>}<br/>expands&#160;into&#160;the&#160;length&#160;of&#160;the&#160;string&#160;contained&#160;by&#160;<i>parameter</i>.&#160;Normally,&#160;<i>parameter</i>&#160;is&#160;a<br/>string;&#160;however,&#160;if&#160;<i>parameter</i>&#160;is&#160;either&#160;@&#160;or&#160;*,&#160;then&#160;the&#160;expansion&#160;results&#160;in&#160;the&#160;number&#160;of<br/>positional&#160;parameters.<br/>
476<br/>
<hr/>
<a name=501></a>Parameter&#160;Expansion<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;This string is long.&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo &#34;'$foo' is ${#foo} characters long.&#34;<br/></b>'This string is long.' is 20 characters long.<br/>
${<i>parameter</i>:<i>offset</i>}<br/>${<i>parameter</i>:<i>offset</i>:<i>length</i>}<br/>These&#160;expansions&#160;are&#160;used&#160;to&#160;extract&#160;a&#160;portion&#160;of&#160;the&#160;string&#160;contained&#160;in&#160;<i>parameter</i>.&#160;The<br/>extraction&#160;begins&#160;at&#160;<i>offset</i>&#160;characters&#160;from&#160;the&#160;beginning&#160;of&#160;the&#160;string&#160;and&#160;continues&#160;until<br/>the&#160;end&#160;of the&#160;string,&#160;unless&#160;<i>length</i>&#160;is&#160;specified.<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;This string is long.&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo:5}<br/></b>string is long.<br/>[me@linuxbox ~]$&#160;<b>echo ${foo:5:6}<br/></b>string<br/>
If&#160;the&#160;value&#160;of&#160;<i>offset</i>&#160;is&#160;negative,&#160;it&#160;is&#160;taken&#160;to&#160;mean&#160;it&#160;starts&#160;from&#160;the&#160;end&#160;of&#160;the&#160;string<br/>rather&#160;than&#160;the&#160;beginning.&#160;Note&#160;that&#160;negative&#160;values&#160;must&#160;be&#160;preceded&#160;by&#160;a&#160;space&#160;to&#160;pre-<br/>vent&#160;confusion&#160;with the&#160;${<i>parameter</i>:-<i>word</i>}&#160;expansion.&#160;<i>length</i>, if present,&#160;must&#160;not<br/>be&#160;less&#160;than&#160;zero.<br/>If&#160;<i>parameter</i>&#160;is&#160;@,&#160;the&#160;result&#160;of&#160;the&#160;expansion&#160;is&#160;<i>length</i>&#160;positional&#160;parameters,&#160;starting&#160;at<br/><i>offset</i>.&#160;<br/>
[me@linuxbox ~]$&#160;<b>foo=&#34;This string is long.&#34;<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo: -5}<br/></b>long.<br/>[me@linuxbox ~]$&#160;<b>echo ${foo: -5:2}<br/></b>lo<br/>
${<i>parameter</i>#<i>pattern</i>}<br/>${<i>parameter</i>##<i>pattern</i>}<br/>These&#160;expansions&#160;remove&#160;a&#160;leading&#160;portion&#160;of&#160;the&#160;string&#160;contained&#160;in&#160;<i>parameter</i>&#160;defined<br/>by&#160;<i>pattern</i>.&#160;<i>pattern</i>&#160;is&#160;a&#160;wildcard&#160;pattern&#160;like&#160;those&#160;used&#160;in&#160;pathname&#160;expansion.&#160;The&#160;dif-<br/>ference&#160;in the&#160;two forms&#160;is&#160;that&#160;the&#160;#&#160;form&#160;removes&#160;the&#160;shortest&#160;match,&#160;while&#160;the&#160;##&#160;form<br/>removes&#160;the&#160;longest&#160;match.<br/>
[me@linuxbox ~]$&#160;<b>foo=file.txt.zip</b><br/>
477<br/>
<hr/>
<a name=502></a>34 – Strings&#160;and Numbers<br/>
[me@linuxbox ~]$&#160;<b>echo ${foo#*.}<br/></b>txt.zip<br/>[me@linuxbox ~]$&#160;<b>echo ${foo##*.}<br/></b>zip<br/>
${<i>parameter</i>%<i>pattern</i>}<br/>${<i>parameter</i>%%<i>pattern</i>}<br/>These&#160;expansions&#160;are&#160;the&#160;same&#160;as&#160;the&#160;previous&#160;#&#160;and&#160;##&#160;expansions,&#160;except&#160;they&#160;remove<br/>text&#160;from&#160;the&#160;end of the&#160;string&#160;contained in&#160;<i>parameter</i>&#160;rather&#160;than from&#160;the&#160;beginning.<br/>
[me@linuxbox ~]$&#160;<b>foo=file.txt.zip<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo%.*}<br/></b>file.txt<br/>[me@linuxbox ~]$&#160;<b>echo ${foo%%.*}<br/></b>file<br/>
${<i>parameter</i>/<i>pattern</i>/<i>string</i>}<br/>${<i>parameter</i>//<i>pattern</i>/<i>string</i>}<br/>${<i>parameter</i>/#<i>pattern</i>/<i>string</i>}<br/>${<i>parameter</i>/%<i>pattern</i>/<i>string</i>}<br/>This&#160;expansion&#160;performs&#160;a&#160;search-and-replace&#160;operation&#160;upon&#160;the&#160;contents&#160;of&#160;<i>parameter</i>.<br/>If text&#160;is&#160;found&#160;matching&#160;wildcard&#160;<i>pattern</i>, it&#160;is&#160;replaced&#160;with&#160;the&#160;contents&#160;of&#160;<i>string</i>. In&#160;the<br/>normal&#160;form,&#160;only&#160;the&#160;first&#160;occurrence&#160;of&#160;<i>pattern</i>&#160;is&#160;replaced.&#160;In&#160;the&#160;//&#160;form,&#160;all&#160;occur-<br/>rences&#160;are&#160;replaced.&#160;The&#160;/#&#160;form&#160;requires&#160;that&#160;the&#160;match&#160;occur&#160;at&#160;the&#160;beginning&#160;of&#160;the<br/>string, and the&#160;/%&#160;form&#160;requires&#160;the&#160;match to&#160;occur at&#160;the&#160;end&#160;of the&#160;string.&#160;In every form,<br/>/<i>string</i>&#160;may&#160;be&#160;omitted,&#160;causing the&#160;text&#160;matched by&#160;<i>pattern</i>&#160;to be&#160;deleted.<br/>
[me@linuxbox ~]$&#160;<b>foo=JPG.JPG<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo/JPG/jpg}<br/></b>jpg.JPG<br/>[me@linuxbox ~]$&#160;<b>echo ${foo//JPG/jpg}<br/></b>jpg.jpg<br/>[me@linuxbox ~]$&#160;<b>echo ${foo/#JPG/jpg}<br/></b>jpg.JPG<br/>[me@linuxbox ~]$&#160;<b>echo ${foo/%JPG/jpg}<br/></b>JPG.jpg<br/>
Parameter&#160;expansion&#160;is&#160;a&#160;good&#160;thing&#160;to&#160;know.&#160;The&#160;string&#160;manipulation&#160;expansions&#160;can&#160;be<br/>used&#160;as&#160;substitutes&#160;for&#160;other&#160;common&#160;commands&#160;such&#160;as&#160;sed&#160;and&#160;cut.&#160;Expansions&#160;can<br/>
478<br/>
<hr/>
<a name=503></a>Parameter&#160;Expansion<br/>
improve&#160;the&#160;efficiency&#160;of&#160;scripts&#160;by&#160;eliminating&#160;the&#160;use&#160;of&#160;external&#160;programs.&#160;As&#160;an&#160;ex-<br/>ample,&#160;we&#160;will&#160;modify&#160;the&#160;longest-word&#160;program&#160;discussed&#160;in&#160;the&#160;previous&#160;chapter<br/>to&#160;use&#160;the&#160;parameter&#160;expansion&#160;${#j}&#160;in&#160;place&#160;of&#160;the&#160;command&#160;substitution&#160;$(echo&#160;-<br/>n $j | wc -c)&#160;and its&#160;resulting subshell,&#160;like&#160;so:<br/>
#!/bin/bash&#160;<br/>
# longest-word3: find longest string in a file&#160;<br/>
for i; do&#160;<br/>
if [[ -r &#34;$i&#34; ]]; then&#160;<br/>
max_word=&#160;<br/>max_len=0<br/>for j in $(strings $i); do&#160;<br/>
<b>len=&#34;${#j}&#34;&#160;<br/></b>if (( len &gt; max_len )); then&#160;<br/>
max_len=&#34;$len&#34;&#160;<br/>max_word=&#34;$j&#34;<br/>
fi&#160;<br/>
done&#160;<br/>echo &#34;$i: '$max_word' ($max_len characters)&#34;&#160;<br/>
fi<br/>
done<br/>
Next, we&#160;will&#160;compare&#160;the&#160;efficiency&#160;of the&#160;two versions&#160;by using the&#160;time&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>time longest-word2 dirlist-usr-bin.txt<br/></b>dirlist-usr-bin.txt: 'scrollkeeper-get-extended-content-list' (38&#160;<br/>characters)<br/>
real<br/>
0m3.618s&#160;<br/>
user<br/>
0m1.544s&#160;<br/>
sys&#160;0m1.768s<br/>[me@linuxbox ~]$&#160;<b>time longest-word3 dirlist-usr-bin.txt&#160;<br/></b>dirlist-usr-bin.txt: 'scrollkeeper-get-extended-content-list' (38&#160;<br/>characters)&#160;<br/>
real<br/>
0m0.060s&#160;<br/>
user<br/>
0m0.056s&#160;<br/>
sys&#160;0m0.008s<br/>
479<br/>
<hr/>
<a name=504></a>34 – Strings&#160;and Numbers<br/>
The&#160;original&#160;version&#160;of&#160;the&#160;script&#160;takes&#160;3.618&#160;seconds&#160;to&#160;scan&#160;the&#160;text&#160;file,&#160;while&#160;the&#160;new<br/>version,&#160;using&#160;parameter&#160;expansion,&#160;takes&#160;only&#160;0.06&#160;seconds — a&#160;significant&#160;improve-<br/>ment.<br/>
Case&#160;Conversion<br/>bash&#160;&#160;&#160;has&#160;four&#160;parameter&#160;expansions&#160;and&#160;two&#160;&#160;declare&#160;command&#160;options&#160;to&#160;support<br/>the&#160;uppercase/lowercase&#160;conversion&#160;of strings.<br/>So&#160;what&#160;is&#160;case&#160;conversion&#160;good&#160;for?&#160;&#160;Aside&#160;from&#160;the&#160;obvious&#160;aesthetic&#160;value,&#160;it&#160;has&#160;an<br/>important&#160;role&#160;in&#160;programming.&#160;&#160;Let's&#160;consider&#160;the&#160;case&#160;of&#160;a&#160;database&#160;lookup.&#160;&#160;Imagine<br/>that&#160;a&#160;user&#160;has&#160;entered&#160;a&#160;string&#160;into&#160;a&#160;data&#160;input&#160;field&#160;that&#160;we&#160;want&#160;to&#160;look&#160;up&#160;in&#160;a&#160;data-<br/>base.&#160;&#160;It's&#160;possible&#160;the&#160;user&#160;will&#160;enter&#160;the&#160;value&#160;in&#160;all&#160;uppercase&#160;letters&#160;or&#160;lowercase&#160;letters<br/>or&#160;a&#160;combination&#160;of&#160;both.&#160;&#160;We&#160;certainly&#160;don't&#160;want&#160;to&#160;populate&#160;our&#160;database&#160;with&#160;every<br/>possible&#160;permutation&#160;of uppercase&#160;and lowercase&#160;spellings. &#160;What&#160;to do?<br/>A&#160;common&#160;approach&#160;to&#160;this&#160;problem&#160;is&#160;to&#160;<i>normalize</i>&#160;the&#160;user's&#160;input.&#160;&#160;That&#160;is,&#160;convert&#160;it<br/>into&#160;a&#160;standardized&#160;form&#160;before&#160;we&#160;attempt&#160;the&#160;database&#160;lookup.&#160;&#160;We&#160;can&#160;do&#160;this&#160;by&#160;con-<br/>verting&#160;all&#160;the&#160;characters&#160;in&#160;the&#160;user's&#160;input&#160;to&#160;either&#160;lower&#160;or&#160;uppercase&#160;and&#160;ensure&#160;that<br/>the&#160;database&#160;entries&#160;are&#160;normalized the&#160;same&#160;way.<br/>The&#160;declare&#160;command&#160;can&#160;be&#160;used&#160;to&#160;normalize&#160;strings&#160;to&#160;either&#160;uppercase&#160;or&#160;lower-<br/>case.&#160;&#160;Using&#160;declare,&#160;we&#160;can&#160;force&#160;a&#160;variable&#160;to&#160;always&#160;contain&#160;the&#160;desired&#160;format&#160;no<br/>matter what&#160;is&#160;assigned&#160;to it.<br/>
#!/bin/bash<br/>
# ul-declare: demonstrate case conversion via declare<br/>
declare -u upper<br/>declare -l lower<br/>
if [[ $1 ]]; then<br/>&#160; &#160; &#160; &#160; upper=&#34;$1&#34;<br/>&#160; &#160; &#160; &#160; lower=&#34;$1&#34;<br/>&#160; &#160; &#160; &#160; echo &#34;$upper&#34;<br/>&#160; &#160; &#160; &#160; echo &#34;$lower&#34;<br/>fi<br/>
In&#160;the&#160;preceding&#160;script,&#160;we&#160;use&#160;declare&#160;to&#160;create&#160;two&#160;variables,&#160;upper&#160;and&#160;lower.<br/>We&#160;assign&#160;the&#160;value&#160;of&#160;the&#160;first&#160;command&#160;line&#160;argument&#160;(positional&#160;parameter&#160;1)&#160;to&#160;each<br/>of the&#160;variables&#160;and&#160;then display&#160;them&#160;on the&#160;screen.<br/>
480<br/>
<hr/>
<a name=505></a>Parameter&#160;Expansion<br/>
[me@linuxbox ~]$<b>&#160;ul-declare aBc<br/></b>ABC<br/>abc<br/>
As&#160;we&#160;can&#160;see,&#160;the&#160;command line&#160;argument&#160;(aBc) has&#160;been&#160;normalized.<br/>In&#160;addition&#160;to&#160;declare,&#160;there&#160;are&#160;four&#160;parameter&#160;expansions&#160;that&#160;perform&#160;upper/lower-<br/>case&#160;conversion&#160;as&#160;described in&#160;Table&#160;34-1.<br/>
<i>Table&#160;34-1: Case&#160;Conversion Parameter&#160;Expansions</i><br/>
<b>Format</b><br/>
<b>Result</b><br/>
${<i>parameter</i>,,<i>pattern</i>}<br/>
Expand the&#160;value&#160;of&#160;<i>parameter</i>&#160;into all&#160;lowercase.&#160;<br/><i>pattern</i>&#160;is&#160;an optional&#160;shell&#160;pattern (for&#160;<br/>example,&#160;[A-F]) that&#160;will&#160;limit&#160;which&#160;characters&#160;<br/>are&#160;converted. See&#160;the&#160;bash&#160;man&#160;page&#160;for a&#160;full&#160;<br/>description&#160;of patterns.<br/>
${<i>parameter</i>,<i>pattern</i>}<br/>
Expand the&#160;value&#160;of&#160;<i>parameter</i>, changing&#160;only the&#160;<br/>first&#160;character&#160;to lowercase.<br/>
${<i>parameter</i>^^<i>pattern</i>}<br/>
Expand the&#160;value&#160;of&#160;<i>parameter</i>&#160;into all&#160;uppercase&#160;<br/>letters.<br/>
${<i>parameter</i>^<i>pattern</i>}<br/>
Expand the&#160;value&#160;of&#160;<i>parameter</i>, changing&#160;only the&#160;<br/>first<i>&#160;</i>character&#160;to uppercase&#160;(capitalization).<br/>
Here&#160;is&#160;a&#160;script&#160;that&#160;demonstrates&#160;these&#160;expansions:<br/>
#!/bin/bash<br/>
# ul-param: demonstrate case conversion via parameter expansion<br/>
if [[ &#34;$1&#34; ]]; then<br/>&#160; &#160; &#160; &#160; echo &#34;${1,,}&#34;<br/>&#160; &#160; &#160; &#160; echo &#34;${1,}&#34;<br/>&#160; &#160; &#160; &#160; echo &#34;${1^^}&#34;<br/>&#160; &#160; &#160; &#160; echo &#34;${1^}&#34;<br/>fi<br/>
Here&#160;is&#160;the&#160;script&#160;in action:<br/>
481<br/>
<hr/>
<a name=506></a>34 – Strings&#160;and Numbers<br/>
[me@linuxbox ~]$&#160;<b>ul-param aBc<br/></b>abc<br/>aBc<br/>ABC<br/>ABc<br/>
Again,&#160;we&#160;process&#160;the&#160;first&#160;command&#160;line&#160;argument&#160;and&#160;output&#160;the&#160;four&#160;variations&#160;sup-<br/>ported&#160;by&#160;the&#160;parameter&#160;expansions.&#160;&#160;While&#160;this&#160;script&#160;uses&#160;the&#160;first&#160;positional&#160;parameter,<br/><i>parameter</i>&#160;may be&#160;any string, variable,&#160;or string expression.<br/>
<b>Arithmetic&#160;Evaluation&#160;and&#160;Expansion<br/></b>We&#160;looked&#160;at&#160;arithmetic&#160;expansion&#160;in&#160;Chapter&#160;7.&#160;It&#160;is&#160;used&#160;to&#160;perform&#160;various&#160;arithmetic<br/>operations&#160;on integers. Its&#160;basic&#160;form&#160;is&#160;as&#160;follows:<br/>$((<i>expression</i>))<br/>where&#160;<i>expression</i>&#160;is&#160;a&#160;valid&#160;arithmetic&#160;expression.<br/>This&#160;is&#160;related&#160;to&#160;the&#160;compound&#160;command&#160;((&#160;))&#160;used&#160;for&#160;arithmetic&#160;evaluation&#160;(truth<br/>tests) we&#160;encountered in&#160;Chapter 27.<br/>In&#160;previous&#160;chapters,&#160;we&#160;saw&#160;some&#160;of&#160;the&#160;common&#160;types&#160;of&#160;expressions&#160;and&#160;operators.<br/>Here, we&#160;will&#160;look at&#160;a&#160;more&#160;complete&#160;list.<br/>
Number&#160;Bases<br/>In Chapter&#160;9, we&#160;got&#160;a&#160;look&#160;at&#160;octal&#160;(base&#160;8)&#160;and&#160;hexadecimal&#160;(base&#160;16) numbers. In&#160;arith-<br/>metic&#160;expressions,&#160;the&#160;shell&#160;supports&#160;integer&#160;constants&#160;in&#160;any&#160;base.&#160;Table&#160;34-2&#160;lists&#160;the<br/>notations&#160;used&#160;to specify bases.<br/>
<i>Table&#160;34-2: Specifying Different&#160;Number&#160;Bases</i><br/>
<b>Notation</b><br/>
<b>Description</b><br/>
<i>number</i><br/>
By default, numbers&#160;without&#160;any&#160;notation&#160;are&#160;treated&#160;as&#160;decimal&#160;<br/>(base&#160;10) integers.<br/>
0<i>number</i><br/>
In arithmetic&#160;expressions, numbers&#160;with a&#160;leading&#160;zero are&#160;<br/>considered&#160;octal.<br/>
0x<i>number</i><br/>
Hexadecimal&#160;notation.<br/>
<i>base</i>#<i>number</i><br/>
<i>number</i>&#160;is&#160;in&#160;<i>base</i><br/>
Here&#160;are&#160;some&#160;examples:<br/>
482<br/>
<hr/>
<a name=507></a>Arithmetic&#160;Evaluation and&#160;Expansion<br/>
[me@linuxbox ~]$&#160;<b>echo $((0xff))<br/></b>255<br/>[me@linuxbox ~]$&#160;<b>echo $((2#11111111))<br/></b>255<br/>
In&#160;the&#160;previous&#160;examples,&#160;we&#160;print&#160;the&#160;value&#160;of&#160;the&#160;hexadecimal&#160;number&#160;ff&#160;(the&#160;largest<br/>two-digit&#160;number) and&#160;the&#160;largest&#160;eight-digit&#160;binary&#160;(base&#160;2) number.<br/>
Unary&#160;Operators<br/>There&#160;are&#160;two&#160;unary&#160;operators,&#160;+&#160;and&#160;-,&#160;which&#160;are&#160;used&#160;to&#160;indicate&#160;whether&#160;a&#160;number&#160;is<br/>positive&#160;or negative, respectively.&#160;An example&#160;is&#160;-5.<br/>
Simple&#160;Arithmetic<br/>The&#160;ordinary&#160;arithmetic&#160;operators&#160;are&#160;listed in&#160;Table&#160;34-3.<br/>
<i>Table&#160;34-3:&#160;Arithmetic&#160;Operators</i><br/>
<b>Operator</b><br/>
<b>Description</b><br/>
+<br/>
Addition<br/>
-<br/>
Subtraction<br/>
*<br/>
Multiplication<br/>
/<br/>
Integer division<br/>
**<br/>
Exponentiation<br/>
%<br/>
Modulo (remainder)<br/>
Most&#160;of&#160;these&#160;are&#160;self-explanatory,&#160;but&#160;integer&#160;division&#160;and&#160;modulo&#160;require&#160;further&#160;dis-<br/>cussion.<br/>Since&#160;the&#160;shell’s&#160;arithmetic&#160;operates&#160;only&#160;on&#160;integers,&#160;the&#160;results&#160;of&#160;division&#160;are&#160;always<br/>whole&#160;numbers.<br/>
[me@linuxbox ~]$&#160;<b>echo $(( 5 / 2 ))<br/></b>2<br/>
This&#160;makes&#160;the&#160;determination&#160;of a&#160;remainder in&#160;a&#160;division&#160;operation&#160;more&#160;important.<br/>
483<br/>
<hr/>
<a name=508></a>34 – Strings&#160;and Numbers<br/>
[me@linuxbox ~]$&#160;<b>echo $(( 5 % 2 ))<br/></b>1<br/>
By&#160;using&#160;the&#160;division&#160;and&#160;modulo&#160;operators,&#160;we&#160;can&#160;determine&#160;that&#160;5&#160;divided&#160;by&#160;2&#160;results<br/>in 2, with a&#160;remainder of 1.<br/>Calculating&#160;the&#160;remainder&#160;is&#160;useful&#160;in&#160;&#160;loops.&#160;It&#160;allows&#160;an&#160;operation&#160;to&#160;be&#160;performed&#160;at<br/>specified&#160;intervals&#160;during&#160;the&#160;loop's&#160;execution.&#160;In&#160;the&#160;following&#160;example,&#160;we&#160;display&#160;a<br/>line&#160;of numbers, highlighting&#160;each multiple&#160;of 5:<br/>
#!/bin/bash&#160;<br/>
# modulo: demonstrate the modulo operator&#160;<br/>
for ((i = 0; i &lt;= 20; i = i + 1)); do&#160;<br/>
remainder=$((i % 5))&#160;<br/>if (( remainder == 0 )); then&#160;<br/>
printf &#34;&lt;%d&gt; &#34; &#34;$i&#34;<br/>
else&#160;<br/>
printf &#34;%d &#34; &#34;$i&#34;<br/>
fi&#160;<br/>
done&#160;<br/>printf &#34;\n&#34;<br/>
When executed,&#160;the&#160;results&#160;look&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>modulo<br/></b>&lt;0&gt; 1 2 3 4 &lt;5&gt; 6 7 8 9 &lt;10&gt; 11 12 13 14 &lt;15&gt; 16 17 18 19 &lt;20&gt;<br/>
Assignment<br/>Although&#160;its&#160;uses&#160;may&#160;not&#160;be&#160;immediately&#160;apparent,&#160;arithmetic&#160;expressions&#160;may&#160;perform<br/>assignment.&#160;We&#160;have&#160;performed&#160;assignment&#160;many&#160;times,&#160;though&#160;in&#160;a&#160;different&#160;context.<br/>Each&#160;time&#160;we&#160;give&#160;a&#160;variable&#160;a&#160;value,&#160;we&#160;are&#160;performing&#160;assignment.&#160;We&#160;can&#160;also&#160;do&#160;it<br/>within arithmetic&#160;expressions.<br/>
[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo $foo</b><br/>
484<br/>
<hr/>
<a name=509></a>Arithmetic&#160;Evaluation and&#160;Expansion<br/>
[me@linuxbox ~]$&#160;<b>if (( foo = 5 )); then echo &#34;It is true.&#34;; fi<br/></b>It is true.<br/>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>5<br/>
In&#160;the&#160;preceding&#160;example,&#160;we&#160;first&#160;assign&#160;an&#160;empty&#160;value&#160;to&#160;the&#160;variable&#160;foo&#160;and&#160;verify<br/>that&#160;it&#160;is&#160;indeed&#160;empty.&#160;Next,&#160;we&#160;perform&#160;an&#160;if&#160;with&#160;the&#160;compound&#160;command&#160;((&#160;foo<br/>=&#160;5&#160;)).&#160;This&#160;process&#160;does&#160;two&#160;interesting&#160;things:&#160;it&#160;assigns&#160;the&#160;value&#160;of&#160;5&#160;to&#160;the&#160;vari-<br/>able&#160;foo, and it&#160;evaluates&#160;to true&#160;because&#160;foo&#160;was&#160;assigned&#160;a&#160;non-zero value.<br/>
<b>Note:</b>&#160;It&#160;is&#160;important&#160;to&#160;remember&#160;the&#160;exact&#160;meaning&#160;of&#160;=&#160;in&#160;the&#160;previous&#160;expres-<br/>sion.&#160;A&#160;single&#160;=&#160;performs&#160;assignment.&#160;foo&#160;=&#160;5&#160;says&#160;“make&#160;foo&#160;equal&#160;to&#160;5,”<br/>while&#160;==&#160;evaluates&#160;equivalence.&#160;foo&#160;==&#160;5&#160;says&#160;“does&#160;foo&#160;equal&#160;5?”&#160;&#160;This&#160;is&#160;a<br/>common&#160;feature&#160;in&#160;many&#160;programming&#160;languages.&#160;In&#160;the&#160;shell,&#160;this&#160;can&#160;be&#160;a&#160;little<br/>confusing&#160;because&#160;the&#160;test&#160;command&#160;accepts&#160;a&#160;single&#160;=&#160;for&#160;string&#160;equivalence.<br/>This&#160;is&#160;yet&#160;another reason to&#160;use&#160;the&#160;more&#160;modern&#160;[[ ]]&#160;and&#160;(( ))&#160;compound<br/>commands&#160;in place&#160;of&#160;test.<br/>
In&#160;addition&#160;to&#160;the&#160;&#160;=&#160;&#160;notation,&#160;the&#160;shell&#160;also&#160;provides&#160;notations&#160;that&#160;perform&#160;some&#160;very<br/>useful&#160;assignments&#160;as&#160;shown in&#160;Table&#160;34-4.<br/>
<i>Table&#160;34-4:&#160;Assignment&#160;Operators</i><br/>
<b>Notation</b><br/>
<b>Description</b><br/>
<i>parameter</i>&#160;=&#160;<i>value</i><br/>
Simple&#160;assignment.&#160;Assigns&#160;<i>value</i>&#160;to&#160;<i>parameter</i>.&#160;<br/>
<i>parameter</i>&#160;+=&#160;<i>value</i><br/>
Addition. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<i>parameter</i>&#160;+&#160;<br/><i>value.</i><br/>
<i>parameter</i>&#160;-=&#160;<i>value</i><br/>
Subtraction. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<i>parameter</i>&#160;–&#160;<br/><i>value.</i><br/>
<i>parameter</i>&#160;*=&#160;<i>value</i><br/>
Multiplication. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<i>parameter</i>&#160;<br/>*&#160;<i>value.</i><br/>
<i>parameter</i>&#160;/=&#160;<i>value</i><br/>
Integer&#160;division. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<br/><i>parameter</i>&#160;/&#160;<i>value.</i><br/>
<i>parameter</i>&#160;%=&#160;<i>value</i><br/>
Modulo.&#160;Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<i>parameter</i>&#160;%&#160;<br/><i>value.</i><br/>
<i>parameter</i>++<br/>
Variable&#160;post-increment. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<br/><i>parameter</i>&#160;+&#160;1 (however,&#160;see&#160;the&#160;following&#160;<br/>
485<br/>
<hr/>
<a name=510></a>34 – Strings&#160;and Numbers<br/>
discussion).<br/>
<i>parameter−−</i><br/>
Variable&#160;post-decrement. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<br/><i>parameter</i>&#160;−&#160;1.<br/>
++<i>parameter</i><br/>
Variable&#160;pre-increment.&#160;Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<br/><i>parameter</i>&#160;+&#160;1.<br/>
--<i>parameter</i><br/>
Variable&#160;pre-decrement. Equivalent&#160;to&#160;<i>parameter</i>&#160;=&#160;<br/><i>parameter</i>&#160;−&#160;1.<br/>
These&#160;assignment&#160;operators&#160;provide&#160;a&#160;convenient&#160;shorthand&#160;for&#160;many&#160;common&#160;arithmetic<br/>tasks.&#160;Of&#160;special&#160;interest&#160;are&#160;the&#160;increment&#160;(++)&#160;and&#160;decrement&#160;(−−)&#160;operators,&#160;which&#160;in-<br/>crease&#160;or&#160;decrease&#160;the&#160;value&#160;of&#160;their&#160;parameters&#160;by&#160;one.&#160;This&#160;style&#160;of&#160;notation&#160;is&#160;taken<br/>from&#160;the&#160;C&#160;programming&#160;language&#160;and&#160;has&#160;been&#160;incorporated&#160;into&#160;a&#160;number&#160;of&#160;other&#160;pro-<br/>gramming languages, including&#160;bash.<br/>The&#160;operators&#160;may&#160;appear&#160;either&#160;at&#160;the&#160;front&#160;of&#160;a&#160;parameter&#160;or&#160;at&#160;the&#160;end.&#160;While&#160;they&#160;both<br/>either&#160;increment&#160;or&#160;decrement&#160;the&#160;parameter&#160;by&#160;one,&#160;the&#160;two&#160;placements&#160;have&#160;a&#160;subtle<br/>difference.&#160;If&#160;placed&#160;at&#160;the&#160;front&#160;of&#160;the&#160;parameter,&#160;the&#160;parameter&#160;is&#160;incremented&#160;(or&#160;decre-<br/>mented)&#160;before&#160;the&#160;parameter&#160;is&#160;returned.&#160;If&#160;placed&#160;after,&#160;the&#160;operation&#160;is&#160;performed&#160;<i>after<br/></i>the&#160;parameter&#160;is&#160;returned.&#160;This&#160;is&#160;rather&#160;strange,&#160;but&#160;it&#160;is&#160;the&#160;intended&#160;behavior.&#160;Here&#160;is&#160;a<br/>demonstration:<br/>
[me@linuxbox ~]$&#160;<b>foo=1<br/></b>[me@linuxbox ~]$&#160;<b>echo $((foo++))<br/></b>1<br/>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>2<br/>
If we&#160;assign&#160;the&#160;value&#160;of one&#160;to&#160;the&#160;variable&#160;foo&#160;and then&#160;increment&#160;it&#160;with the&#160;++&#160;opera-<br/>tor&#160;placed&#160;after&#160;the&#160;parameter&#160;name,&#160;foo&#160;is&#160;returned&#160;with&#160;the&#160;value&#160;of&#160;one.&#160;However,&#160;if<br/>we&#160;look&#160;at&#160;the&#160;value&#160;of&#160;the&#160;variable&#160;a&#160;second&#160;time,&#160;we&#160;see&#160;the&#160;incremented&#160;value.&#160;If&#160;we<br/>place&#160;the&#160;++&#160;operator in front&#160;of the&#160;parameter, we&#160;get&#160;the&#160;more&#160;expected behavior.<br/>
[me@linuxbox ~]$&#160;<b>foo=1<br/></b>[me@linuxbox ~]$&#160;<b>echo $((++foo))<br/></b>2<br/>[me@linuxbox ~]$&#160;<b>echo $foo<br/></b>2<br/>
486<br/>
<hr/>
<a name=511></a>Arithmetic&#160;Evaluation and&#160;Expansion<br/>
For most&#160;shell&#160;applications, prefixing the&#160;operator&#160;will&#160;be&#160;the&#160;most&#160;useful.<br/>The&#160;++&#160;and&#160;--&#160;operators&#160;are&#160;often&#160;used&#160;in&#160;conjunction&#160;with&#160;loops.&#160;We&#160;will&#160;make&#160;some&#160;im-<br/>provements&#160;to our modulo&#160;script&#160;to&#160;tighten&#160;it&#160;up a&#160;bit.<br/>
#!/bin/bash&#160;<br/>
# modulo2: demonstrate the modulo operator&#160;<br/>
for ((i = 0; i &lt;= 20;&#160;<b>++i</b>&#160;)); do&#160;<br/>
if ((<b>(i % 5)</b>&#160;== 0 )); then&#160;<br/>
printf &#34;&lt;%d&gt; &#34; &#34;$i&#34;<br/>
else&#160;<br/>
printf &#34;%d &#34; &#34;$i&#34;<br/>
fi&#160;<br/>
done&#160;<br/>printf &#34;\n&#34;<br/>
Bit&#160;Operations<br/>One&#160;class&#160;of&#160;operators&#160;manipulates&#160;numbers&#160;in&#160;an&#160;unusual&#160;way.&#160;These&#160;operators&#160;work&#160;at<br/>the&#160;bit&#160;level.&#160;They&#160;are&#160;used&#160;for&#160;certain&#160;kinds&#160;of&#160;low-level&#160;tasks,&#160;often&#160;involving&#160;setting&#160;or<br/>reading&#160;bit-flags.&#160;The&#160;bit&#160;operators&#160;are&#160;listed&#160;in&#160;Table&#160;34-5.<br/>
<i>Table&#160;34-5:&#160;Bit&#160;Operators</i><br/>
<b>Operator</b><br/>
<b>Description</b><br/>
~<br/>
Bitwise&#160;negation. Negate&#160;all&#160;the&#160;bits&#160;in a&#160;number.<br/>
&lt;&lt;<br/>
Left&#160;bitwise&#160;shift. Shift&#160;all&#160;the&#160;bits&#160;in&#160;a&#160;number&#160;to the&#160;left.<br/>
&gt;&gt;<br/>
Right&#160;bitwise&#160;shift.&#160;Shift&#160;all&#160;the&#160;bits&#160;in a&#160;number to&#160;the&#160;right.<br/>
&amp;<br/>
Bitwise&#160;AND. Perform&#160;an&#160;AND&#160;operation on all&#160;the&#160;bits&#160;in&#160;two<br/>numbers.<br/>
|<br/>
Bitwise&#160;OR. Perform&#160;an OR operation&#160;on all&#160;the&#160;bits&#160;in two&#160;<br/>numbers.<br/>
^<br/>
Bitwise&#160;XOR. Perform&#160;an exclusive&#160;OR operation&#160;on all&#160;the&#160;<br/>bits&#160;in two numbers.<br/>
Note&#160;that&#160;there&#160;are&#160;also&#160;corresponding&#160;assignment&#160;operators&#160;(for&#160;example,&#160;&lt;&lt;=)&#160;for&#160;all<br/>but&#160;bitwise&#160;negation.<br/>
487<br/>
<hr/>
<a name=512></a>34 – Strings&#160;and Numbers<br/>
Here&#160;we&#160;will&#160;demonstrate&#160;producing&#160;a&#160;list&#160;of&#160;powers&#160;of&#160;2,&#160;using&#160;the&#160;left&#160;bitwise&#160;shift&#160;op-<br/>erator:<br/>
[me@linuxbox ~]$&#160;<b>for ((i=0;i&lt;8;++i)); do echo $((1&lt;&lt;i)); done<br/></b>1<br/>2<br/>4<br/>8<br/>16<br/>32<br/>64<br/>128<br/>
Logic<br/>As&#160;we&#160;discovered&#160;in&#160;Chapter&#160;27,&#160;the&#160;((&#160;))&#160;compound&#160;command&#160;supports&#160;a&#160;variety&#160;of<br/>comparison&#160;operators.&#160;There&#160;are&#160;a&#160;few&#160;more&#160;that&#160;can be&#160;used&#160;to evaluate&#160;logic.&#160;Table&#160;34-6<br/>provides&#160;the&#160;complete&#160;list.<br/>
<i>Table&#160;34-6:&#160;Comparison Operators</i><br/>
<b>Operator</b><br/>
<b>Description</b><br/>
&lt;=<br/>
Less&#160;than&#160;or equal&#160;to.<br/>
&gt;=<br/>
Greater than&#160;or equal&#160;to.<br/>
&lt;<br/>
Less&#160;than.<br/>
&gt;<br/>
Greater than.<br/>
==<br/>
Equal&#160;to.<br/>
!=<br/>
Not&#160;equal&#160;to.<br/>
&amp;&amp;<br/>
Logical&#160;AND.<br/>
||<br/>
Logical&#160;OR.<br/>
<i>expr1</i>?<i>expr2</i>:<i>expr3</i><br/>
Comparison (ternary)&#160;operator.&#160;If expression&#160;<i>expr1</i>&#160;<br/>evaluates&#160;to be&#160;non-zero&#160;(arithmetic&#160;true),&#160;then&#160;<i>expr2;</i>&#160;<br/>else&#160;<i>expr3</i>.<br/>
When&#160;used&#160;for&#160;logical&#160;operations,&#160;expressions&#160;follow&#160;the&#160;rules&#160;of&#160;arithmetic&#160;logic;&#160;that&#160;is,<br/>expressions&#160;that&#160;evaluate&#160;as&#160;zero&#160;are&#160;considered&#160;false,&#160;while&#160;non-zero&#160;expressions&#160;are<br/>
488<br/>
<hr/>
<a name=513></a>Arithmetic&#160;Evaluation and&#160;Expansion<br/>
considered&#160;true.&#160;The&#160;((&#160;))&#160;compound&#160;command&#160;maps&#160;the&#160;results&#160;into&#160;the&#160;shell’s&#160;normal<br/>exit&#160;codes.<br/>
[me@linuxbox ~]$&#160;<b>if ((1)); then echo &#34;true&#34;; else echo &#34;false&#34;; fi<br/></b>true<br/>[me@linuxbox ~]$&#160;<b>if ((0)); then echo &#34;true&#34;; else echo &#34;false&#34;; fi<br/></b>false<br/>
The&#160;strangest&#160;of&#160;the&#160;logical&#160;operators&#160;is&#160;the&#160;&#160;<i>ternary&#160;&#160;operator</i>.&#160;This&#160;operator&#160;(which&#160;is<br/>modeled&#160;after&#160;the&#160;one&#160;in&#160;the&#160;&#160;C&#160;programming&#160;language)&#160;performs&#160;a&#160;stand-alone&#160;logical<br/>test.&#160;It&#160;can&#160;be&#160;used&#160;as&#160;a&#160;kind&#160;of&#160;if/then/else&#160;statement.&#160;It&#160;acts&#160;on&#160;three&#160;arithmetic<br/>expressions&#160;(strings&#160;won’t&#160;work),&#160;and&#160;if&#160;the&#160;first&#160;expression&#160;is&#160;true&#160;(or&#160;non-zero),&#160;the&#160;sec-<br/>ond&#160;expression&#160;is&#160;performed.&#160;Otherwise,&#160;the&#160;third&#160;expression&#160;is&#160;performed.&#160;We&#160;can&#160;try<br/>this&#160;on the&#160;command&#160;line:<br/>
[me@linuxbox ~]$&#160;<b>a=0<br/></b>[me@linuxbox ~]$&#160;<b>((a&lt;1?++a:--a))<br/></b>[me@linuxbox ~]$&#160;<b>echo $a<br/></b>1<br/>[me@linuxbox ~]$&#160;<b>((a&lt;1?++a:--a))<br/></b>[me@linuxbox ~]$&#160;<b>echo $a<br/></b>0<br/>
Here&#160;we&#160;see&#160;a&#160;ternary&#160;operator&#160;in&#160;action.&#160;This&#160;example&#160;implements&#160;a&#160;toggle.&#160;Each&#160;time<br/>the&#160;operator&#160;is&#160;performed,&#160;the&#160;value&#160;of&#160;the&#160;variable&#160;a&#160;switches&#160;from&#160;zero&#160;to&#160;one&#160;or&#160;vice<br/>versa.<br/>Please&#160;note&#160;that&#160;performing&#160;assignment&#160;within&#160;the&#160;expressions&#160;is&#160;not&#160;straightforward.<br/>When attempted,&#160;bash&#160;will&#160;declare&#160;an&#160;error.<br/>
[me@linuxbox ~]$&#160;<b>a=0<br/></b>[me@linuxbox ~]$&#160;<b>((a&lt;1?a+=1:a-=1))</b>&#160;<br/>bash: ((: a&lt;1?a+=1:a-=1: attempted assignment to non-variable (error&#160;<br/>token is &#34;-=1&#34;)<br/>
This&#160;problem&#160;can&#160;be&#160;mitigated&#160;by&#160;surrounding&#160;the&#160;assignment&#160;expression&#160;with&#160;parenthe-<br/>ses.<br/>
[me@linuxbox ~]$&#160;<b>((a&lt;1?(a+=1):(a-=1)))</b><br/>
489<br/>
<hr/>
<a name=514></a>34 – Strings&#160;and Numbers<br/>
Next&#160;is&#160;a&#160;more&#160;complete&#160;example&#160;of&#160;using&#160;arithmetic&#160;operators&#160;in&#160;a&#160;script&#160;that&#160;produces&#160;a<br/>simple&#160;table&#160;of numbers.<br/>
#!/bin/bash&#160;<br/>
# arith-loop: script to demonstrate arithmetic operators&#160;<br/>
finished=0&#160;<br/>a=0&#160;<br/>printf &#34;a\ta**2\ta**3\n&#34;&#160;<br/>printf &#34;=\t====\t====\n&#34;&#160;<br/>
until ((finished)); do&#160;<br/>
b=$((a**2))&#160;<br/>c=$((a**3))&#160;<br/>printf &#34;%d\t%d\t%d\n&#34; &#34;$a&#34; &#34;$b&#34; &#34;$c&#34;&#160;<br/>((a&lt;10?++a:(finished=1)))<br/>
&#160;<br/>
done<br/>
In&#160;this&#160;script,&#160;we&#160;implement&#160;an&#160;until&#160;loop&#160;based&#160;on&#160;the&#160;value&#160;of&#160;the&#160;finished&#160;variable.<br/>Initially,&#160;the&#160;variable&#160;is&#160;set&#160;to&#160;zero&#160;(arithmetic&#160;false),&#160;and&#160;we&#160;continue&#160;the&#160;loop&#160;until&#160;it&#160;be-<br/>comes&#160;non-zero.&#160;Within the&#160;loop, we&#160;calculate&#160;the&#160;square&#160;and cube&#160;of the&#160;counter variable<br/>a.&#160;At&#160;the&#160;end&#160;of&#160;the&#160;loop,&#160;the&#160;value&#160;of&#160;the&#160;counter&#160;variable&#160;is&#160;evaluated.&#160;If&#160;it&#160;is&#160;less&#160;than<br/>10&#160;(the&#160;maximum&#160;number&#160;of&#160;iterations),&#160;it&#160;is&#160;incremented&#160;by&#160;one,&#160;or&#160;else&#160;the&#160;variable<br/>finished&#160;&#160;is&#160;given&#160;the&#160;value&#160;of&#160;one,&#160;making&#160;&#160;finished&#160;&#160;arithmetically&#160;true,&#160;thereby<br/>terminating&#160;the&#160;loop. Running the&#160;script&#160;gives&#160;this&#160;result:<br/>
[me@linuxbox ~]$&#160;<b>arith-loop<br/></b>a<br/>
a**2&#160;a**3&#160;<br/>
=<br/>
====&#160;====&#160;<br/>
0<br/>
0<br/>
0&#160;<br/>
1<br/>
1<br/>
1&#160;<br/>
2<br/>
4<br/>
8&#160;<br/>
3<br/>
9<br/>
27&#160;<br/>
4<br/>
16<br/>
64&#160;<br/>
5<br/>
25<br/>
125&#160;<br/>
6<br/>
36<br/>
216&#160;<br/>
7<br/>
49<br/>
343&#160;<br/>
8<br/>
64<br/>
512&#160;<br/>
9<br/>
81<br/>
729&#160;<br/>
10&#160;100&#160;1000<br/>
490<br/>
<hr/>
<a name=515></a>bc&#160;–&#160;An&#160;Arbitrary&#160;Precision Calculator&#160;Language<br/>
<b>bc&#160;–&#160;An&#160;Arbitrary&#160;Precision&#160;Calculator&#160;Language<br/></b>We&#160;have&#160;seen&#160;how&#160;the&#160;shell&#160;can&#160;handle&#160;many&#160;types&#160;of&#160;integer&#160;arithmetic,&#160;but&#160;what&#160;if&#160;we<br/>need&#160;to&#160;perform&#160;higher&#160;math&#160;or&#160;even&#160;just&#160;use&#160;floating-point&#160;numbers?&#160;The&#160;answer&#160;is,&#160;we<br/>can’t.&#160;At&#160;least&#160;not&#160;directly&#160;with&#160;the&#160;shell.&#160;To&#160;do&#160;this,&#160;we&#160;need&#160;to&#160;use&#160;an&#160;external&#160;program.<br/>There&#160;are&#160;several&#160;approaches&#160;we&#160;can&#160;take.&#160;Embedding&#160;Perl&#160;or&#160;AWK&#160;programs&#160;is&#160;one&#160;pos-<br/>sible&#160;solution, but&#160;unfortunately, it’s&#160;outside&#160;the&#160;scope&#160;of this&#160;book.<br/>Another&#160;approach&#160;is&#160;to&#160;use&#160;a&#160;specialized&#160;calculator&#160;program.&#160;One&#160;such&#160;program&#160;found&#160;on<br/>many Linux systems&#160;is&#160;called&#160;bc.<br/>The&#160;&#160;bc&#160;&#160;program&#160;reads&#160;a&#160;file&#160;written&#160;in&#160;its&#160;own&#160;C-like&#160;language&#160;and&#160;executes&#160;it.&#160;A&#160;bc<br/>script&#160;may&#160;be&#160;a&#160;separate&#160;file,&#160;or&#160;it&#160;may&#160;be&#160;read&#160;from&#160;standard&#160;input.&#160;The&#160;bc&#160;language&#160;sup-<br/>ports&#160;quite&#160;a&#160;few&#160;features&#160;including&#160;variables,&#160;loops,&#160;and&#160;programmer-defined&#160;functions.<br/>We&#160;won’t&#160;cover&#160;bc&#160;entirely&#160;here,&#160;just&#160;enough&#160;to&#160;get&#160;a&#160;taste.&#160;bc&#160;is&#160;well&#160;documented&#160;by&#160;its<br/>man page.<br/>Let’s&#160;start&#160;with&#160;a&#160;simple&#160;example.&#160;We’ll&#160;write&#160;a&#160;bc&#160;script&#160;to add 2 plus&#160;2.<br/>
/* A very simple bc script */&#160;<br/>
2 + 2<br/>
The&#160;first&#160;line&#160;of&#160;the&#160;script&#160;is&#160;a&#160;comment.&#160;bc&#160;uses&#160;the&#160;same&#160;syntax&#160;for&#160;comments&#160;as&#160;the&#160;C<br/>programming&#160;language.&#160;Comments,&#160;which&#160;may&#160;span&#160;multiple&#160;lines,&#160;begin&#160;with&#160;&#160;/*&#160;and<br/>end with&#160;*/.<br/>
Using&#160;bc<br/>If we&#160;save&#160;the&#160;previous&#160;&#160;bc&#160;script&#160;as&#160;foo.bc, we&#160;can&#160;run it&#160;this&#160;way:<br/>
[me@linuxbox ~]$&#160;<b>bc foo.bc<br/></b>bc 1.06.94&#160;<br/>Copyright 1991-1994, 1997, 1998, 2000, 2004, 2006 Free Software&#160;<br/>Foundation, Inc.&#160;<br/>This is free software with ABSOLUTELY NO WARRANTY.&#160;<br/>For details type `warranty'.&#160;<br/>4<br/>
If we&#160;look carefully,&#160;we&#160;can see&#160;the&#160;result&#160;at&#160;the&#160;very bottom,&#160;after&#160;the&#160;copyright&#160;message.<br/>This&#160;message&#160;can be&#160;suppressed with the&#160;-q&#160;(quiet)&#160;option.<br/>
491<br/>
<hr/>
<a name=516></a>34 – Strings&#160;and Numbers<br/>
bc&#160;can also&#160;be&#160;used&#160;interactively.<br/>
[me@linuxbox ~]$&#160;<b>bc -q<br/>2 + 2<br/></b>4<br/><b>quit</b><br/>
When&#160;using&#160;bc&#160;interactively,&#160;we&#160;simply&#160;type&#160;the&#160;calculations&#160;we&#160;want&#160;to&#160;perform,&#160;and<br/>the&#160;results&#160;are&#160;immediately&#160;displayed.&#160;The&#160;bc&#160;command&#160;quit&#160;ends&#160;the&#160;interactive&#160;ses-<br/>sion.<br/>It&#160;is&#160;also possible&#160;to pass&#160;a&#160;script&#160;to&#160;bc&#160;via&#160;standard&#160;input.<br/>
[me@linuxbox ~]$&#160;<b>bc &lt; foo.bc<br/></b>4<br/>
The&#160;ability&#160;to&#160;take&#160;standard&#160;input&#160;means&#160;that&#160;we&#160;can&#160;use&#160;here&#160;documents,&#160;here&#160;strings,<br/>and pipes&#160;to&#160;pass&#160;scripts.&#160;This&#160;is&#160;a&#160;here&#160;string&#160;example:<br/>
[me@linuxbox ~]$&#160;<b>bc &lt;&lt;&lt; &#34;2+2&#34;<br/></b>4<br/>
An&#160;Example&#160;Script<br/>As&#160;a&#160;real-world&#160;example,&#160;we&#160;will&#160;construct&#160;a&#160;script&#160;that&#160;performs&#160;a&#160;common&#160;calculation,<br/>monthly&#160;loan&#160;payments.&#160;In&#160;the&#160;script&#160;below,&#160;we&#160;use&#160;a&#160;here&#160;document&#160;to&#160;pass&#160;a&#160;script&#160;to<br/>bc:<br/>
#!/bin/bash&#160;<br/>
# loan-calc: script to calculate monthly loan payments&#160;<br/>
PROGNAME=&#34;${0##*/}&#34; # Use parameter expansion to get basename &#160;<br/>
usage () {&#160;<br/>
cat &lt;&lt;- EOF&#160;<br/>Usage: $PROGNAME PRINCIPAL INTEREST MONTHS&#160;<br/>
492<br/>
<hr/>
<a name=517></a>bc&#160;–&#160;An&#160;Arbitrary&#160;Precision Calculator&#160;Language<br/>
Where:&#160;<br/>
PRINCIPAL is the amount of the loan.<br/>INTEREST is the APR as a number (7% = 0.07).<br/>MONTHS is the length of the loan's term.&#160;<br/>
EOF&#160;<br/>
}&#160;<br/>
if (($# != 3)); then&#160;<br/>
usage&#160;<br/>exit 1&#160;<br/>
fi&#160;<br/>
principal=$1&#160;<br/>interest=$2&#160;<br/>months=$3&#160;<br/>
bc &lt;&lt;- EOF&#160;<br/>
scale = 10&#160;<br/>i = $interest / 12&#160;<br/>p = $principal&#160;<br/>n = $months&#160;<br/>a = p * ((i * ((1 + i) ^ n)) / (((1 + i) ^ n) - 1))&#160;<br/>print a, &#34;\n&#34;&#160;<br/>
EOF<br/>
When executed,&#160;the&#160;results&#160;look&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>loan-calc 135000 0.0775 180</b>&#160;<br/>1270.7222490000<br/>
This&#160;example&#160;calculates&#160;the&#160;monthly&#160;payment&#160;for&#160;a&#160;$135,000&#160;loan&#160;at&#160;7.75&#160;percent&#160;APR<br/>for&#160;180&#160;months&#160;(15&#160;years).&#160;Notice&#160;the&#160;precision&#160;of&#160;the&#160;answer.&#160;This&#160;is&#160;determined&#160;by&#160;the<br/>value&#160;given&#160;to&#160;the&#160;special&#160;scale&#160;variable&#160;in&#160;the&#160;bc&#160;script.&#160;A&#160;full&#160;description&#160;of&#160;the&#160;bc<br/>scripting&#160;language&#160;is&#160;provided&#160;by&#160;the&#160;&#160;bc&#160;man&#160;page.&#160;While&#160;its&#160;mathematical&#160;notation&#160;is<br/>slightly&#160;different&#160;from&#160;that&#160;of&#160;the&#160;shell&#160;(bc&#160;more&#160;closely&#160;resembles&#160;C),&#160;most&#160;of&#160;it&#160;will&#160;be<br/>quite&#160;familiar,&#160;based on what&#160;we&#160;have&#160;learned&#160;so far.<br/>
<b>Summing&#160;Up<br/></b>In&#160;this&#160;chapter,&#160;we&#160;learned&#160;about&#160;many&#160;of&#160;the&#160;little&#160;things&#160;that&#160;can&#160;be&#160;used&#160;to&#160;get&#160;the&#160;“real<br/>
493<br/>
<hr/>
<a name=518></a>34 – Strings&#160;and Numbers<br/>
work”&#160;done&#160;in&#160;scripts.&#160;As&#160;our&#160;experience&#160;with&#160;scripting&#160;grows,&#160;the&#160;ability&#160;to&#160;effectively<br/>manipulate&#160;strings&#160;and&#160;numbers&#160;will&#160;prove&#160;extremely&#160;valuable.&#160;Our&#160;loan-calc&#160;script<br/>demonstrates&#160;that&#160;even simple&#160;scripts&#160;can&#160;be&#160;created&#160;to do some&#160;really useful&#160;things.<br/>
<b>Extra&#160;Credit<br/></b>While&#160;the&#160;basic&#160;functionality&#160;of&#160;the&#160;loan-calc&#160;script&#160;is&#160;in&#160;place,&#160;the&#160;script&#160;is&#160;far&#160;from<br/>complete.&#160;For&#160;extra&#160;credit,&#160;try&#160;improving&#160;the&#160;loan-calc&#160;script&#160;with&#160;the&#160;following&#160;fea-<br/>tures:<br/>
●<br/>
Full&#160;verification of the&#160;command line&#160;arguments<br/>
●<br/>
A&#160;command&#160;line&#160;option&#160;to&#160;implement&#160;an&#160;“interactive”&#160;mode&#160;that&#160;will&#160;prompt&#160;the<br/>user&#160;to input&#160;the&#160;principal,&#160;interest&#160;rate,&#160;and term&#160;of the&#160;loan<br/>
●<br/>
A&#160;better&#160;format&#160;for the&#160;output<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;<i>Bash Hackers&#160;Wiki</i>&#160;has&#160;a&#160;good discussion of parameter expansion:<br/><a href="http://wiki.bash-hackers.org/syntax/pe">http://wiki.bash-hackers.org/syntax/pe</a><br/>
●<br/>
The&#160;<i>Bash Reference&#160;Manual</i>&#160;covers&#160;this, too:<br/><a href="http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expansion">http://www.gnu.org/software/bash/manual/bashref.html#Shell-Parameter-Expan-<br/>sion</a><br/>
●<br/>
The&#160;<i>Wikipedia</i>&#160;has&#160;a&#160;good article&#160;describing bit&#160;operations:<br/><a href="http://en.wikipedia.org/wiki/Bit_operation">http://en.wikipedia.org/wiki/Bit_operation</a><br/>
●<br/>
and an article&#160;on ternary&#160;operations:<br/><a href="http://en.wikipedia.org/wiki/Ternary_operation">http://en.wikipedia.org/wiki/Ternary_operation</a><br/>
●<br/>
as&#160;well&#160;as&#160;a&#160;description&#160;of the&#160;formula&#160;for calculating loan payments&#160;used in our&#160;<br/>loan-calc&#160;script:<br/><a href="http://en.wikipedia.org/wiki/Amortization_calculator">http://en.wikipedia.org/wiki/Amortization_calculator</a><br/>
494<br/>
<hr/>
<a name=519></a>35 –&#160;Arrays<br/>
<i><b>35&#160;–&#160;Arrays</b></i><br/>
In&#160;the&#160;previous&#160;chapter,&#160;we&#160;looked&#160;at&#160;how&#160;the&#160;shell&#160;can&#160;manipulate&#160;strings&#160;and&#160;numbers.<br/>The&#160;data&#160;types&#160;we&#160;have&#160;looked&#160;at&#160;so&#160;far&#160;are&#160;known&#160;in&#160;computer&#160;science&#160;circles&#160;as&#160;<i>scalar<br/>variables</i>;&#160;that&#160;is, they are&#160;variables&#160;that&#160;contain&#160;a&#160;single&#160;value.<br/>In&#160;this&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;another&#160;kind&#160;of&#160;data&#160;structure&#160;called&#160;an&#160;<i>array</i>,&#160;which&#160;holds<br/>multiple&#160;values.&#160;Arrays&#160;are&#160;a&#160;feature&#160;of&#160;virtually&#160;every&#160;programming&#160;language.&#160;The&#160;shell<br/>supports&#160;them,&#160;too,&#160;though&#160;in&#160;a&#160;rather&#160;limited&#160;fashion.&#160;Even&#160;so,&#160;they&#160;can&#160;be&#160;very&#160;useful<br/>for solving some&#160;types&#160;of programming&#160;problems.<br/>
<b>What&#160;Are&#160;Arrays?<br/></b>Arrays&#160;are&#160;variables&#160;that&#160;hold&#160;more&#160;than&#160;one&#160;value&#160;at&#160;a&#160;time.&#160;Arrays&#160;are&#160;organized&#160;like&#160;a<br/>table.&#160;Let’s&#160;consider&#160;a&#160;spreadsheet&#160;as&#160;an&#160;example.&#160;A&#160;spreadsheet&#160;acts&#160;like&#160;a&#160;<i>two-dimen-<br/>sional&#160;array</i>.&#160;It&#160;has&#160;both&#160;rows&#160;and&#160;columns,&#160;and&#160;an&#160;individual&#160;cell&#160;in&#160;the&#160;spreadsheet&#160;can<br/>be&#160;located&#160;according&#160;to&#160;its&#160;row&#160;and&#160;column&#160;address.&#160;An&#160;array&#160;behaves&#160;the&#160;same&#160;way.&#160;An<br/>array&#160;has&#160;cells,&#160;which&#160;are&#160;called&#160;<i>elements</i>,&#160;and&#160;each&#160;element&#160;contains&#160;data.&#160;An&#160;individual<br/>array element&#160;is&#160;accessed&#160;using&#160;an address&#160;called an&#160;<i>index</i>&#160;or&#160;<i>subscript</i>.<br/>Most&#160;programming&#160;languages&#160;support&#160;<i>multidimensional&#160;arrays</i>.&#160;A&#160;spreadsheet&#160;is&#160;an&#160;ex-<br/>ample&#160;of&#160;a&#160;multidimensional&#160;array&#160;with&#160;two&#160;dimensions,&#160;width&#160;and&#160;height.&#160;Many&#160;lan-<br/>guages&#160;support&#160;arrays&#160;with&#160;an&#160;arbitrary&#160;number&#160;of&#160;dimensions,&#160;though&#160;two-&#160;and&#160;three-di-<br/>mensional&#160;arrays&#160;are&#160;probably the&#160;most&#160;commonly used.<br/>Arrays&#160;in&#160;bash&#160;are&#160;limited&#160;to&#160;a&#160;single&#160;dimension.&#160;We&#160;can&#160;think&#160;of&#160;them&#160;as&#160;a&#160;spreadsheet<br/>with&#160;a&#160;single&#160;column.&#160;Even&#160;with&#160;this&#160;limitation,&#160;there&#160;are&#160;many&#160;applications&#160;for&#160;them.&#160;Ar-<br/>ray&#160;support&#160;first&#160;appeared&#160;in&#160;bash&#160;version&#160;2.&#160;The&#160;original&#160;Unix&#160;shell&#160;program,&#160;sh,&#160;did<br/>not&#160;support&#160;arrays&#160;at&#160;all.<br/>
<b>Creating&#160;an&#160;Array<br/></b>Array&#160;variables&#160;are&#160;named&#160;just&#160;like&#160;other&#160;bash&#160;variables,&#160;and&#160;are&#160;created&#160;automatically<br/>when&#160;they are&#160;accessed. Here&#160;is&#160;an example:<br/>
495<br/>
<hr/>
<a name=520></a>35 –&#160;Arrays<br/>
[me@linuxbox ~]$&#160;<b>a[1]=foo<br/></b>[me@linuxbox ~]$&#160;<b>echo ${a[1]}<br/></b>foo<br/>
Here&#160;we&#160;see&#160;an&#160;example&#160;of&#160;both&#160;the&#160;assignment&#160;and&#160;access&#160;of&#160;an&#160;array&#160;element.&#160;With&#160;the<br/>first&#160;command,&#160;element&#160;1&#160;of&#160;array&#160;a&#160;is&#160;assigned&#160;the&#160;value&#160;“foo”.&#160;The&#160;second&#160;command<br/>displays&#160;the&#160;stored&#160;value&#160;of&#160;element&#160;1.&#160;The&#160;use&#160;of&#160;braces&#160;in&#160;the&#160;second&#160;command&#160;is&#160;re-<br/>quired&#160;to&#160;prevent&#160;the&#160;shell&#160;from&#160;attempting&#160;pathname&#160;expansion&#160;on&#160;the&#160;name&#160;of&#160;the&#160;array<br/>element.<br/>An array&#160;can also be&#160;created with&#160;the&#160;declare&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>declare -a a</b><br/>
Using the&#160;-a&#160;option,&#160;this&#160;example&#160;of&#160;declare&#160;creates&#160;the&#160;array&#160;a.&#160;<br/>
<b>Assigning&#160;Values&#160;to&#160;an&#160;Array<br/></b>Values&#160;may&#160;be&#160;assigned&#160;in&#160;one&#160;of&#160;two&#160;ways.&#160;Single&#160;values&#160;may&#160;be&#160;assigned&#160;using&#160;the&#160;fol-<br/>lowing syntax:<br/><i>name</i>[<i>subscript</i>]=<i>value</i><br/>
where&#160;<i>name</i>&#160;is&#160;the&#160;name&#160;of&#160;the&#160;array&#160;and&#160;<i>subscript</i>&#160;is&#160;an&#160;integer&#160;(or&#160;arithmetic&#160;ex-<br/>pression)&#160;greater&#160;than&#160;or&#160;equal&#160;to&#160;zero.&#160;Note&#160;that&#160;the&#160;first&#160;element&#160;of&#160;an&#160;array&#160;is&#160;subscript<br/>zero, not&#160;one.&#160;<i>value</i>&#160;is&#160;a&#160;string or integer&#160;assigned&#160;to the&#160;array element.<br/>Multiple&#160;values&#160;may be&#160;assigned&#160;using&#160;the&#160;following&#160;syntax:<br/><i>name</i>=(<i>value1</i>&#160;<i>value2</i>&#160;...)<br/>
where&#160;&#160;<i>name</i>&#160;is&#160;the&#160;name&#160;of&#160;the&#160;array&#160;and&#160;<i>value</i>&#160;placeholders&#160;are&#160;values&#160;assigned&#160;se-<br/>quentially&#160;to&#160;elements&#160;of&#160;the&#160;array,&#160;starting&#160;with&#160;element&#160;zero.&#160;For&#160;example,&#160;if&#160;we&#160;wanted<br/>to assign abbreviated&#160;days&#160;of the&#160;week to&#160;the&#160;array&#160;days, we&#160;could do this:<br/>
[me@linuxbox ~]$&#160;<b>days=(Sun Mon Tue Wed Thu Fri Sat)</b>&#160;<br/>
It&#160;is&#160;also&#160;possible&#160;to&#160;assign&#160;values&#160;to&#160;a&#160;specific&#160;element&#160;by&#160;specifying&#160;a&#160;subscript&#160;for&#160;each<br/>value.<br/>
[me@linuxbox ~]$&#160;<b>days=([0]=Sun [1]=Mon [2]=Tue [3]=Wed [4]=Thu&#160;<br/>[5]=Fri [6]=Sat)</b><br/>
496<br/>
<hr/>
<a name=521></a>Accessing&#160;Array&#160;Elements<br/>
<b>Accessing&#160;Array&#160;Elements<br/></b>So&#160;what&#160;are&#160;arrays&#160;good&#160;for?&#160;Just&#160;as&#160;many&#160;data-management&#160;tasks&#160;can&#160;be&#160;performed&#160;with<br/>a&#160;spreadsheet&#160;program, many&#160;programming tasks&#160;can&#160;be&#160;performed&#160;with arrays.<br/>Let’s&#160;consider&#160;a&#160;simple&#160;data-gathering&#160;and&#160;presentation&#160;example.&#160;We&#160;will&#160;construct&#160;a<br/>script&#160;that&#160;examines&#160;the&#160;modification&#160;times&#160;of&#160;the&#160;files&#160;in&#160;a&#160;specified&#160;directory.&#160;From&#160;this<br/>data,&#160;our&#160;script&#160;will&#160;output&#160;a&#160;table&#160;showing&#160;at&#160;what&#160;hour&#160;of&#160;the&#160;day&#160;the&#160;files&#160;were&#160;last<br/>modified.&#160;Such&#160;a&#160;script&#160;could&#160;be&#160;used&#160;to&#160;determine&#160;when&#160;a&#160;system&#160;is&#160;most&#160;active.&#160;This<br/>script, called&#160;hours, produces&#160;this&#160;result:<br/>
[me@linuxbox ~]$&#160;<b>hours .<br/></b>Hour &#160;Files &#160;Hour &#160;Files&#160;<br/>---- &#160;----- &#160;---- &#160;-----&#160;<br/>00 &#160; &#160;0 &#160; &#160; &#160;12 &#160; &#160;11&#160;<br/>01 &#160; &#160;1 &#160; &#160; &#160;13 &#160; &#160;7&#160;<br/>02 &#160; &#160;0 &#160; &#160; &#160;14 &#160; &#160;1&#160;<br/>03 &#160; &#160;0 &#160; &#160; &#160;15 &#160; &#160;7&#160;<br/>04 &#160; &#160;1 &#160; &#160; &#160;16 &#160; &#160;6&#160;<br/>05 &#160; &#160;1 &#160; &#160; &#160;17 &#160; &#160;5&#160;<br/>06 &#160; &#160;6 &#160; &#160; &#160;18 &#160; &#160;4&#160;<br/>07 &#160; &#160;3 &#160; &#160; &#160;19 &#160; &#160;4&#160;<br/>08 &#160; &#160;1 &#160; &#160; &#160;20 &#160; &#160;1&#160;<br/>09 &#160; &#160;14 &#160; &#160; 21 &#160; &#160;0&#160;<br/>10 &#160; &#160;2 &#160; &#160; &#160;22 &#160; &#160;0&#160;<br/>11 &#160; &#160;5 &#160; &#160; &#160;23 &#160; &#160;0&#160;<br/>
Total files = 80<br/>
We&#160;execute&#160;the&#160;&#160;hours&#160;&#160;program,&#160;specifying&#160;the&#160;current&#160;directory&#160;as&#160;the&#160;target.&#160;It&#160;pro-<br/>duces&#160;a&#160;table&#160;showing,&#160;for&#160;each&#160;hour&#160;of&#160;the&#160;day&#160;(0-23),&#160;how&#160;many&#160;files&#160;were&#160;last&#160;modi-<br/>fied.&#160;The&#160;code&#160;to&#160;produce&#160;this&#160;is&#160;as&#160;follows:&#160;<br/>
#!/bin/bash&#160;<br/>
# hours: script to count files by modification time&#160;<br/>
usage () {&#160;<br/>
echo &#34;usage: ${0##*/} directory&#34; &gt;&amp;2&#160;<br/>
}&#160;<br/>
# Check that argument is a directory&#160;<br/>
497<br/>
<hr/>
<a name=522></a>35 –&#160;Arrays<br/>
if [[ ! -d &#34;$1&#34; ]]; then&#160;<br/>
usage&#160;<br/>exit 1&#160;<br/>
fi&#160;<br/>
# Initialize array&#160;<br/>for i in {0..23}; do hours[i]=0; done&#160;<br/>
# Collect data&#160;<br/>for i in $(stat -c %y &#34;$1&#34;/* | cut -c 12-13); do&#160;<br/>
j=&#34;${i#0}&#34;&#160;<br/>((++hours[j]))&#160;<br/>((++count))&#160;<br/>
done&#160;<br/>
# Display data&#160;<br/>echo -e &#34;Hour\tFiles\tHour\tFiles&#34;&#160;<br/>echo -e &#34;----\t-----\t----\t-----&#34;&#160;<br/>for i in {0..11}; do&#160;<br/>
j=$((i + 12))&#160;<br/>printf &#34;%02d\t%d\t%02d\t%d\n&#34; \<br/>
&#34;$i&#34; \<br/>&#34;${hours[i]}&#34; \<br/>&#34;$j&#34; \<br/>&#34;${hours[j]}&#34;<br/>
done&#160;<br/>printf &#34;\nTotal files = %d\n&#34; $count<br/>
The&#160;script&#160;consists&#160;of&#160;one&#160;function&#160;(usage)&#160;and&#160;a&#160;main&#160;body&#160;with&#160;four&#160;sections.&#160;In&#160;the<br/>first&#160;section,&#160;we&#160;check&#160;that&#160;there&#160;is&#160;a&#160;command&#160;line&#160;argument&#160;and&#160;that&#160;it&#160;is&#160;a&#160;directory.&#160;If<br/>it&#160;is&#160;not,&#160;we&#160;display the&#160;usage&#160;message&#160;and&#160;exit.<br/>The&#160;second&#160;section&#160;initializes&#160;the&#160;array&#160;hours.&#160;It&#160;does&#160;this&#160;by&#160;assigning&#160;each&#160;element&#160;a<br/>value&#160;of&#160;zero.&#160;There&#160;is&#160;no&#160;special&#160;requirement&#160;to prepare&#160;arrays&#160;prior&#160;to&#160;use, but&#160;our&#160;script<br/>needs&#160;to&#160;ensure&#160;that&#160;no&#160;element&#160;is&#160;empty.&#160;Note&#160;the&#160;interesting&#160;way&#160;the&#160;loop&#160;is&#160;con-<br/>structed.&#160;By&#160;employing&#160;brace&#160;expansion&#160;({0..23}),&#160;we&#160;are&#160;able&#160;to&#160;easily&#160;generate&#160;a&#160;se-<br/>quence&#160;of words&#160;for the&#160;for&#160;command.<br/>The&#160;next&#160;section&#160;gathers&#160;the&#160;data&#160;by&#160;running&#160;the&#160;stat&#160;program&#160;on&#160;each&#160;file&#160;in&#160;the&#160;direc-<br/>tory.&#160;We&#160;use&#160;cut&#160;to&#160;extract&#160;the&#160;two-digit&#160;hour&#160;from&#160;the&#160;result.&#160;Inside&#160;the&#160;loop,&#160;we&#160;need&#160;to<br/>remove&#160;leading&#160;zeros&#160;from&#160;the&#160;hour&#160;field,&#160;since&#160;the&#160;shell&#160;will&#160;try&#160;(and&#160;ultimately&#160;fail)&#160;to<br/>interpret&#160;values&#160;00&#160;through&#160;09&#160;as&#160;octal&#160;numbers&#160;(see&#160;Table&#160;34-2). Next, we&#160;increment&#160;the<br/>value&#160;of&#160;the&#160;array&#160;element&#160;corresponding&#160;with&#160;the&#160;hour&#160;of&#160;the&#160;day.&#160;Finally,&#160;we&#160;increment<br/>
498<br/>
<hr/>
<a name=523></a>Accessing&#160;Array&#160;Elements<br/>
a&#160;counter&#160;(count) to track&#160;the&#160;total&#160;number of files&#160;in the&#160;directory.<br/>The&#160;last&#160;section&#160;of&#160;the&#160;script&#160;displays&#160;the&#160;contents&#160;of&#160;the&#160;array.&#160;We&#160;first&#160;output&#160;a&#160;couple&#160;of<br/>header&#160;lines&#160;and&#160;then&#160;enter&#160;a&#160;loop&#160;that&#160;produces&#160;four columns&#160;of output.&#160;Lastly,&#160;we&#160;output<br/>the&#160;final&#160;tally&#160;of files.<br/>
<b>Array&#160;Operations<br/></b>There&#160;are&#160;many&#160;common&#160;array&#160;operations.&#160;Such&#160;things&#160;as&#160;deleting&#160;arrays,&#160;determining<br/>their&#160;size, sorting,&#160;and so on, have&#160;many&#160;applications&#160;in&#160;scripting.<br/>
Outputting&#160;the&#160;Entire&#160;Contents&#160;of&#160;an&#160;Array<br/>The&#160;subscripts&#160;*&#160;and&#160;@&#160;can&#160;be&#160;used&#160;to&#160;access&#160;every&#160;element&#160;in&#160;an&#160;array.&#160;As&#160;with&#160;posi-<br/>tional&#160;parameters, the&#160;@&#160;notation is&#160;the&#160;more&#160;useful&#160;of the&#160;two. Here&#160;is&#160;a&#160;demonstration:<br/>
[me@linuxbox ~]$&#160;<b>animals=(&#34;a dog&#34; &#34;a cat&#34; &#34;a fish&#34;)<br/></b>[me@linuxbox ~]$&#160;<b>for i in ${animals[*]}; do echo $i; done<br/></b>a&#160;<br/>dog&#160;<br/>a&#160;<br/>cat&#160;<br/>a&#160;<br/>fish<br/>[me@linuxbox ~]$&#160;<b>for i in ${animals[@]}; do echo $i; done<br/></b>a&#160;<br/>dog&#160;<br/>a&#160;<br/>cat&#160;<br/>a&#160;<br/>fish<br/>[me@linuxbox ~]$&#160;<b>for i in &#34;${animals[*]}&#34;; do echo $i; done<br/></b>a dog a cat a fish<br/>[me@linuxbox ~]$&#160;<b>for i in &#34;${animals[@]}&#34;; do echo $i; done<br/></b>a dog&#160;<br/>a cat&#160;<br/>a fish<br/>
We&#160;create&#160;the&#160;array&#160;animals&#160;and&#160;assign&#160;it&#160;three&#160;two-word&#160;strings.&#160;We&#160;then&#160;execute&#160;four<br/>loops&#160;to&#160;see&#160;the&#160;effect&#160;of&#160;word&#160;splitting&#160;on&#160;the&#160;array&#160;contents.&#160;The&#160;behavior&#160;of&#160;notations&#160;$<br/>{animals[*]}&#160;and&#160;${animals[@]}&#160;is&#160;identical&#160;until&#160;they&#160;are&#160;quoted.&#160;The&#160;*&#160;nota-<br/>tion&#160;results&#160;in&#160;a&#160;single&#160;word&#160;containing&#160;the&#160;array’s&#160;contents,&#160;while&#160;the&#160;@&#160;notation&#160;results<br/>
499<br/>
<hr/>
<a name=524></a>35 –&#160;Arrays<br/>
in three&#160;two-word strings, which&#160;matches&#160;the&#160;array's&#160;“real”&#160;contents.<br/>
Determining&#160;the&#160;Number&#160;of&#160;Array&#160;Elements<br/>Using&#160;parameter&#160;expansion,&#160;we&#160;can&#160;&#160;determine&#160;the&#160;number&#160;of&#160;elements&#160;in&#160;an&#160;array&#160;in<br/>much the&#160;same&#160;way as&#160;finding&#160;the&#160;length of a&#160;string. Here&#160;is&#160;an example:<br/>
[me@linuxbox ~]$&#160;<b>a[100]=foo<br/></b>[me@linuxbox ~]$&#160;<b>echo ${#a[@]} &#160;# number of array elements<br/></b>1<br/>[me@linuxbox ~]$&#160;<b>echo ${#a[100]} &#160;# length of element 100<br/></b>3<br/>
We&#160;create&#160;array&#160;a&#160;and&#160;assign&#160;the&#160;string&#160;foo&#160;to&#160;element&#160;100.&#160;Next,&#160;we&#160;use&#160;parameter&#160;ex-<br/>pansion&#160;to&#160;examine&#160;the&#160;length&#160;of&#160;the&#160;array,&#160;using&#160;the&#160;@&#160;notation.&#160;Finally,&#160;we&#160;look&#160;at&#160;the<br/>length&#160;of&#160;element&#160;100,&#160;which&#160;contains&#160;the&#160;string&#160;foo.&#160;It&#160;is&#160;interesting&#160;to&#160;note&#160;that&#160;while<br/>we&#160;assigned&#160;our&#160;string&#160;to&#160;element&#160;100,&#160;bash&#160;reports&#160;only&#160;one&#160;element&#160;in&#160;the&#160;array.&#160;This<br/>differs&#160;from&#160;the&#160;behavior&#160;of some&#160;other languages&#160;in&#160;which&#160;the&#160;unused elements&#160;of the&#160;ar-<br/>ray&#160;(elements&#160;0-99)&#160;would&#160;be&#160;initialized&#160;with&#160;empty&#160;values&#160;and&#160;counted.&#160;In&#160;bash,&#160;array<br/>elements&#160;exist&#160;only if they have&#160;been assigned a&#160;value&#160;regardless&#160;of their&#160;subscript.<br/>
Finding&#160;the&#160;Subscripts&#160;Used&#160;by&#160;an&#160;Array<br/>As&#160;bash&#160;allows&#160;arrays&#160;to&#160;contain&#160;“gaps”&#160;in&#160;the&#160;assignment&#160;of&#160;subscripts,&#160;it&#160;is&#160;sometimes<br/>useful&#160;to&#160;determine&#160;which&#160;elements&#160;actually&#160;exist.&#160;This&#160;can&#160;be&#160;done&#160;with&#160;a&#160;parameter&#160;ex-<br/>pansion using the&#160;following forms:<br/>${!<i>array</i>[*]}<br/>${!<i>array</i>[@]}<br/>where&#160;<i>array</i>&#160;is&#160;the&#160;name&#160;of&#160;an&#160;array&#160;variable.&#160;Like&#160;the&#160;other&#160;expansions&#160;that&#160;use&#160;*&#160;and&#160;@,<br/>the&#160;@&#160;form&#160;enclosed in&#160;quotes&#160;is&#160;the&#160;most&#160;useful, as&#160;it&#160;expands&#160;into&#160;separate&#160;words.<br/>
[me@linuxbox ~]$&#160;<b>foo=([2]=a [4]=b [6]=c)<br/></b>[me@linuxbox ~]$&#160;<b>for i in &#34;${foo[@]}&#34;; do echo $i; done<br/></b>a<br/>b<br/>c<br/>[me@linuxbox ~]$&#160;<b>for i in &#34;${!foo[@]}&#34;; do echo $i; done<br/></b>2<br/>4<br/>
500<br/>
<hr/>
<a name=525></a>Array&#160;Operations<br/>
6<br/>
Adding&#160;Elements&#160;to&#160;the&#160;End&#160;of&#160;an&#160;Array<br/>Knowing the&#160;number&#160;of elements&#160;in an&#160;array is&#160;no help&#160;if we&#160;need to&#160;append values&#160;to the<br/>end&#160;of&#160;an&#160;array&#160;since&#160;the&#160;values&#160;returned&#160;by&#160;the&#160;*&#160;and&#160;@&#160;notations&#160;do&#160;not&#160;tell&#160;us&#160;the&#160;maxi-<br/>mum&#160;array&#160;index&#160;in&#160;use.&#160;Fortunately,&#160;the&#160;shell&#160;provides&#160;us&#160;with&#160;a&#160;solution.&#160;By&#160;using&#160;the<br/>+=&#160;assignment&#160;operator,&#160;we&#160;can&#160;automatically&#160;append&#160;values&#160;to&#160;the&#160;end&#160;of&#160;an&#160;array.&#160;Here,<br/>we&#160;assign&#160;three&#160;values&#160;to the&#160;array&#160;foo&#160;and&#160;then append&#160;three&#160;more.<br/>
[me@linuxbox ~]$&#160;<b>foo=(a b c)<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>a b c<br/>[me@linuxbox ~]$&#160;<b>foo+=(d e f)<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>a b c d e f<br/>
Sorting&#160;an&#160;Array<br/>Just&#160;as&#160;with&#160;spreadsheets,&#160;it&#160;is&#160;often&#160;necessary&#160;to&#160;sort&#160;the&#160;values&#160;in&#160;a&#160;column&#160;of&#160;data.&#160;The<br/>shell&#160;has&#160;no direct&#160;way of doing&#160;this, but&#160;it's&#160;not&#160;hard to do with&#160;a&#160;little&#160;coding.<br/>
#!/bin/bash&#160;<br/>
# array-sort: Sort an array&#160;<br/>
a=(f e d c b a)&#160;<br/>
echo &#34;Original array: ${a[@]}&#34;&#160;<br/>a_sorted=($(for i in &#34;${a[@]}&#34;; do echo $i; done | sort))&#160;<br/>echo &#34;Sorted array: &#160; ${a_sorted[@]}&#34;<br/>
When executed,&#160;the&#160;script&#160;produces&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>array-sort<br/></b>Original array: f e d c b a&#160;<br/>Sorted array: &#160; a b c d e f<br/>
501<br/>
<hr/>
<a name=526></a>35 –&#160;Arrays<br/>
The&#160;script&#160;operates&#160;by&#160;copying&#160;the&#160;contents&#160;of&#160;the&#160;original&#160;array&#160;(a)&#160;into&#160;a&#160;second&#160;array<br/>(a_sorted)&#160;with&#160;a&#160;tricky&#160;piece&#160;of&#160;command&#160;substitution.&#160;This&#160;basic&#160;technique&#160;can&#160;be<br/>used&#160;to&#160;perform&#160;many&#160;kinds&#160;of&#160;operations&#160;on&#160;the&#160;array&#160;by&#160;changing&#160;the&#160;design&#160;of&#160;the<br/>pipeline.<br/>
Deleting&#160;an&#160;Array<br/>To&#160;delete&#160;an array, use&#160;the&#160;unset&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>foo=(a b c d e f)<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>a b c d e f<br/>[me@linuxbox ~]$&#160;<b>unset foo<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}</b><br/>
[me@linuxbox ~]$&#160;<br/>
unset&#160;may also&#160;be&#160;used to delete&#160;single&#160;array&#160;elements.<br/>
[me@linuxbox ~]$&#160;<b>foo=(a b c d e f)<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>a b c d e f<br/>[me@linuxbox ~]$&#160;<b>unset 'foo[2]'<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}&#160;<br/></b>a b d e f<br/>
In&#160;this&#160;example,&#160;we&#160;delete&#160;the&#160;third&#160;element&#160;of&#160;the&#160;array,&#160;subscript&#160;2.&#160;Remember,&#160;arrays<br/>start&#160;with&#160;subscript&#160;zero,&#160;not&#160;one!&#160;Notice&#160;also&#160;that&#160;the&#160;array&#160;element&#160;must&#160;be&#160;quoted&#160;to<br/>prevent&#160;the&#160;shell&#160;from&#160;performing pathname&#160;expansion.<br/>Interestingly, the&#160;assignment&#160;of an empty value&#160;to an array&#160;does&#160;not&#160;empty its&#160;contents.<br/>
[me@linuxbox ~]$&#160;<b>foo=(a b c d e f)<br/></b>[me@linuxbox ~]$&#160;<b>foo=<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>b c d e f<br/>
Any reference&#160;to an array&#160;variable&#160;without&#160;a&#160;subscript&#160;refers&#160;to element&#160;zero of the&#160;array.<br/>
502<br/>
<hr/>
<a name=527></a>Array&#160;Operations<br/>
[me@linuxbox ~]$&#160;<b>foo=(a b c d e f)<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>a b c d e f<br/>[me@linuxbox ~]$&#160;<b>foo=A<br/></b>[me@linuxbox ~]$&#160;<b>echo ${foo[@]}<br/></b>A b c d e f<br/>
<b>Associative&#160;Arrays<br/></b>bash&#160;versions&#160;4.0&#160;and&#160;greater&#160;support&#160;<i>associative&#160;arrays</i>.&#160;&#160;Associative&#160;arrays&#160;use&#160;strings<br/>rather&#160;than&#160;integers&#160;as&#160;array&#160;indexes.&#160;&#160;This&#160;capability&#160;allows&#160;interesting&#160;new&#160;approaches<br/>to&#160;managing&#160;data.&#160;&#160;&#160;For&#160;example,&#160;we&#160;can&#160;create&#160;an&#160;array&#160;called&#160;&#160;colors&#160;and&#160;use&#160;color<br/>names&#160;as&#160;indexes.<br/>
declare -A colors<br/>colors[&#34;red&#34;]=&#34;#ff0000&#34;<br/>colors[&#34;green&#34;]=&#34;#00ff00&#34;<br/>colors[&#34;blue&#34;]=&#34;#0000ff&#34;<br/>
Unlike&#160;integer&#160;indexed&#160;arrays,&#160;which&#160;are&#160;created&#160;by&#160;merely&#160;referencing&#160;them,&#160;associative<br/>arrays&#160;must&#160;be&#160;created&#160;with&#160;the&#160;declare&#160;command&#160;using&#160;the&#160;new&#160;-A&#160;option.&#160;Associa-<br/>tive&#160;array elements&#160;are&#160;accessed&#160;in much&#160;the&#160;same&#160;way as&#160;integer&#160;indexed&#160;arrays.<br/>
echo ${colors[&#34;blue&#34;]}<br/>
In&#160;the&#160;next&#160;chapter,&#160;we&#160;will&#160;look&#160;at&#160;a&#160;script&#160;that&#160;makes&#160;good&#160;use&#160;of&#160;associative&#160;arrays&#160;to<br/>produce&#160;an&#160;interesting report.<br/>
<b>Summing&#160;Up<br/></b>If&#160;we&#160;search&#160;the&#160;bash&#160;man&#160;page&#160;for&#160;the&#160;word&#160;<i>array</i>,&#160;we&#160;find&#160;many&#160;instances&#160;of&#160;where<br/>bash&#160;makes&#160;use&#160;of&#160;array&#160;variables.&#160;Most&#160;of&#160;these&#160;are&#160;rather&#160;obscure,&#160;but&#160;they&#160;may&#160;pro-<br/>vide&#160;occasional&#160;utility&#160;in&#160;some&#160;special&#160;circumstances.&#160;In&#160;fact,&#160;the&#160;entire&#160;topic&#160;of&#160;arrays&#160;is<br/>rather&#160;under-utilized&#160;in&#160;shell&#160;programming&#160;owing&#160;largely&#160;to&#160;the&#160;fact&#160;that&#160;the&#160;traditional<br/>Unix&#160;shell&#160;programs&#160;(such&#160;as&#160;sh)&#160;lacked&#160;any&#160;support&#160;for arrays.&#160;This&#160;lack&#160;of popularity&#160;is<br/>unfortunate&#160;because&#160;arrays&#160;are&#160;widely&#160;used&#160;in&#160;other&#160;programming&#160;languages&#160;and&#160;provide<br/>a&#160;powerful&#160;tool&#160;for solving many&#160;kinds&#160;of programming problems.<br/>Arrays&#160;and&#160;loops&#160;have&#160;a&#160;natural&#160;affinity&#160;and&#160;are&#160;often&#160;used&#160;together.&#160;The&#160;following&#160;form<br/>
503<br/>
<hr/>
<a name=528></a>35 –&#160;Arrays<br/>
of loop is&#160;particularly well-suited to&#160;calculating array&#160;subscripts:<br/>for ((<i>expr</i>;&#160;<i>expr</i>;&#160;<i>expr</i>))<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
A&#160;couple&#160;of&#160;Wikipedia&#160;articles&#160;about&#160;the&#160;data&#160;structures&#160;found&#160;in&#160;this&#160;chapter:<br/><a href="http://en.wikipedia.org/wiki/Scalar_(computing)">http://en.wikipedia.org/wiki/Scalar_(computing)</a><br/>
<a href="http://en.wikipedia.org/wiki/Associative_array">http://en.wikipedia.org/wiki/Associative_array</a><br/>
504<br/>
<hr/>
<a name=529></a>36 – Exotica<br/>
<i><b>36&#160;–&#160;Exotica</b></i><br/>
In&#160;this,&#160;the&#160;final&#160;chapter&#160;of&#160;our&#160;journey,&#160;we&#160;will&#160;look&#160;at&#160;some&#160;odds&#160;and&#160;ends.&#160;While&#160;we<br/>have&#160;certainly&#160;covered&#160;a&#160;lot&#160;of&#160;ground in&#160;the&#160;previous&#160;chapters,&#160;there&#160;are&#160;many&#160;bash&#160;fea-<br/>tures&#160;that&#160;we&#160;have&#160;not&#160;covered.&#160;Most&#160;are&#160;fairly&#160;obscure&#160;and&#160;useful&#160;mainly&#160;to&#160;those&#160;inte-<br/>grating&#160;bash&#160;into&#160;a&#160;Linux&#160;distribution.&#160;However,&#160;there&#160;are&#160;a&#160;few&#160;that,&#160;while&#160;not&#160;in&#160;com-<br/>mon use, are&#160;helpful&#160;for certain&#160;programming problems.&#160;We&#160;will&#160;cover&#160;them&#160;here.&#160;<br/>
<b>Group&#160;Commands&#160;and&#160;Subshells<br/></b>bash&#160;allows&#160;commands&#160;to&#160;be&#160;grouped&#160;together.&#160;This&#160;can&#160;be&#160;done&#160;in&#160;one&#160;of&#160;two&#160;ways,&#160;ei-<br/>ther with&#160;a&#160;<i>group</i>&#160;<i>command</i>&#160;or with a&#160;<i>subshell</i>.&#160;<br/>Here&#160;are&#160;examples&#160;of the&#160;syntax of a&#160;group command:<br/>{ command1; command2; [command3; ...] }<br/>Here&#160;is&#160;the&#160;syntax&#160;of a&#160;subshell:<br/>(command1; command2; [command3;...])<br/>The&#160;two&#160;forms&#160;differ&#160;in&#160;that&#160;a&#160;group&#160;command&#160;surrounds&#160;its&#160;commands&#160;with&#160;braces&#160;and&#160;a<br/>subshell&#160;uses&#160;parentheses.&#160;It&#160;is&#160;important&#160;to&#160;note&#160;that,&#160;because&#160;of&#160;the&#160;way&#160;bash&#160;imple-<br/>ments&#160;group&#160;commands,&#160;the&#160;braces&#160;must&#160;be&#160;separated&#160;from&#160;the&#160;commands&#160;by&#160;a&#160;space&#160;and<br/>the&#160;last&#160;command&#160;must&#160;be&#160;terminated&#160;with&#160;either&#160;a&#160;semicolon&#160;or&#160;a&#160;newline&#160;prior&#160;to&#160;the<br/>closing brace.<br/>So,&#160;what&#160;are&#160;group&#160;commands&#160;and&#160;subshells&#160;good&#160;for?&#160;While&#160;they&#160;have&#160;an&#160;important&#160;dif-<br/>ference&#160;(which&#160;we&#160;will&#160;get&#160;to&#160;in&#160;a&#160;moment),&#160;they&#160;are&#160;both&#160;used&#160;to&#160;&#160;manage&#160;redirection.<br/>Let’s&#160;consider a&#160;script&#160;segment&#160;that&#160;performs&#160;redirections&#160;on multiple&#160;commands.<br/>
ls -l &gt; output.txt<br/>echo &#34;Listing of foo.txt&#34; &gt;&gt; output.txt<br/>cat foo.txt &gt;&gt; output.txt<br/>
This&#160;is&#160;pretty&#160;straightforward.&#160;Three&#160;commands&#160;have&#160;their&#160;output&#160;redirected&#160;to&#160;a&#160;file<br/>named&#160;output.txt. Using a&#160;group command,&#160;we&#160;could code&#160;this&#160;as&#160;follows:<br/>
505<br/>
<hr/>
<a name=530></a>36 – Exotica<br/>
{ ls -l; echo &#34;Listing of foo.txt&#34;; cat foo.txt; } &gt; output.txt<br/>
Using a&#160;subshell&#160;is&#160;similar.<br/>
(ls -l; echo &#34;Listing of foo.txt&#34;; cat foo.txt) &gt; output.txt<br/>
Using&#160;this&#160;technique&#160;we&#160;have&#160;saved&#160;ourselves&#160;some&#160;typing,&#160;but&#160;where&#160;a&#160;group&#160;command<br/>or&#160;subshell&#160;really&#160;shines&#160;is&#160;with&#160;pipelines.&#160;When&#160;constructing&#160;a&#160;pipeline&#160;of&#160;commands,&#160;it<br/>is&#160;often&#160;useful&#160;to&#160;combine&#160;the&#160;results&#160;of&#160;several&#160;commands&#160;into&#160;a&#160;single&#160;stream.&#160;Group<br/>commands&#160;and subshells&#160;make&#160;this&#160;easy.<br/>
{ ls -l; echo &#34;Listing of foo.txt&#34;; cat foo.txt; } | lpr<br/>
Here&#160;we&#160;have&#160;combined&#160;the&#160;output&#160;of&#160;our&#160;three&#160;commands&#160;and&#160;piped&#160;them&#160;into&#160;the&#160;input<br/>of&#160;lpr&#160;to produce&#160;a&#160;printed&#160;report.<br/>In&#160;the&#160;script&#160;that&#160;follows,&#160;we&#160;will&#160;use&#160;groups&#160;commands&#160;and&#160;look&#160;at&#160;several&#160;programming<br/>techniques&#160;&#160;&#160;that&#160;&#160;&#160;can&#160;&#160;&#160;be&#160;&#160;&#160;employed&#160;&#160;&#160;in&#160;&#160;&#160;conjunction&#160;&#160;&#160;with&#160;&#160;associative&#160;&#160;&#160;arrays.&#160;&#160;This&#160;&#160;&#160;script,<br/>called&#160;array-2,&#160;when&#160;given&#160;the&#160;name&#160;of&#160;a&#160;directory,&#160;prints&#160;a&#160;listing&#160;of&#160;the&#160;files&#160;in&#160;the<br/>directory&#160;along&#160;with&#160;the&#160;names&#160;of&#160;the&#160;file's&#160;owner&#160;and&#160;group&#160;owner.&#160;&#160;At&#160;the&#160;end&#160;of&#160;the<br/>listing,&#160;the&#160;script&#160;prints&#160;a&#160;tally&#160;of&#160;the&#160;number&#160;of&#160;files&#160;belonging&#160;to&#160;each&#160;owner&#160;and&#160;group.<br/>Here&#160;we&#160;see&#160;the&#160;results&#160;(condensed&#160;for&#160;brevity)&#160;when&#160;the&#160;script&#160;is&#160;given&#160;the&#160;directory&#160;/<br/>usr/bin:<br/>
[me@linuxbox ~]$&#160;<b>array-2 /usr/bin<br/></b>/usr/bin/2to3-2.6 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/2to3 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/a2p &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/abrowser &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/aconnect &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/acpi_fakekey &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/acpi_listen &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/add-apt-repository &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root<br/>.<br/>.<br/>.<br/>/usr/bin/zipgrep &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/zipinfo &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/zipnote &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>
506<br/>
<hr/>
<a name=531></a>Group Commands&#160;and Subshells<br/>
/usr/bin/zip &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/zipsplit &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/zjsdecode &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>/usr/bin/zsoelim &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; root &#160; &#160; &#160; root &#160; &#160; &#160;<br/>
File owners:<br/>daemon &#160; &#160;: &#160; &#160; 1 file(s)<br/>root &#160; &#160; &#160;: &#160;1394 file(s)<br/>
File group owners:<br/>crontab &#160; : &#160; &#160; 1 file(s)<br/>daemon &#160; &#160;: &#160; &#160; 1 file(s)<br/>lpadmin &#160; : &#160; &#160; 1 file(s)<br/>mail &#160; &#160; &#160;: &#160; &#160; 4 file(s)<br/>mlocate &#160; : &#160; &#160; 1 file(s)<br/>root &#160; &#160; &#160;: &#160;1380 file(s)<br/>shadow &#160; &#160;: &#160; &#160; 2 file(s)<br/>ssh &#160; &#160; &#160; : &#160; &#160; 1 file(s)<br/>tty &#160; &#160; &#160; : &#160; &#160; 2 file(s)<br/>utmp &#160; &#160; &#160;: &#160; &#160; 2 file(s)<br/>
Here&#160;is&#160;a&#160;listing (with&#160;line&#160;numbers) of the&#160;script:<br/>
&#160; &#160; &#160;1 &#160; &#160;#!/bin/bash<br/>&#160; &#160; &#160;2 &#160; &#160;<br/>&#160; &#160; &#160;3 &#160; &#160;# array-2: Use arrays to tally file owners<br/>&#160; &#160; &#160;4 &#160; &#160;<br/>&#160; &#160; &#160;5 &#160; &#160;declare -A files file_group file_owner groups owners<br/>&#160; &#160; &#160;6 &#160; &#160;<br/>&#160; &#160; &#160;7 &#160; &#160;if [[ ! -d &#34;$1&#34; ]]; then<br/>&#160; &#160; &#160;8 &#160; &#160; &#160; &#160;echo &#34;Usage: array-2 dir&#34; &gt;&amp;2<br/>&#160; &#160; &#160;9 &#160; &#160; &#160; &#160;exit 1<br/>&#160; &#160; 10 &#160; &#160;fi<br/>&#160; &#160; 11 &#160; &#160;<br/>&#160; &#160; 12 &#160; &#160;for i in &#34;$1&#34;/*; do<br/>&#160; &#160; 13 &#160; &#160; &#160; &#160;owner=&#34;$(stat -c %U &#34;$i&#34;)&#34;<br/>&#160; &#160; 14 &#160; &#160; &#160; &#160;group=&#34;$(stat -c %G &#34;$i&#34;)&#34;<br/>&#160; &#160; 15 &#160; &#160; &#160; &#160;files[&#34;$i&#34;]=&#34;$i&#34;<br/>&#160; &#160; 16 &#160; &#160; &#160; &#160;file_owner[&#34;$i&#34;]=&#34;$owner&#34;<br/>&#160; &#160; 17 &#160; &#160; &#160; &#160;file_group[&#34;$i&#34;]=&#34;$group&#34;<br/>&#160; &#160; 18 &#160; &#160; &#160; &#160;((++owners[$owner]))<br/>&#160; &#160; 19 &#160; &#160; &#160; &#160;((++groups[$group]))<br/>
507<br/>
<hr/>
<a name=532></a>36 – Exotica<br/>
&#160; &#160; 20 &#160; &#160;done<br/>&#160; &#160; 21 &#160; &#160;<br/>&#160; &#160; 22 &#160; &#160;# List the collected files<br/>&#160; &#160; 23 &#160; &#160;{ for i in &#34;${files[@]}&#34;; do<br/>&#160; &#160; 24 &#160; &#160; &#160; &#160;printf &#34;%-40s %-10s %-10s\n&#34; \<br/>&#160; &#160; 25 &#160; &#160; &#160; &#160; &#160; &#160;&#34;$i&#34; &#34;${file_owner[&#34;$i&#34;]}&#34; &#34;${file_group[&#34;$i&#34;]}&#34;<br/>&#160; &#160; 26 &#160; &#160;done } | sort<br/>&#160; &#160; 27 &#160; &#160;echo<br/>&#160; &#160; 28 &#160; &#160;<br/>&#160; &#160; 29 &#160; &#160;# List owners<br/>&#160; &#160; 30 &#160; &#160;echo &#34;File owners:&#34;<br/>&#160; &#160; 31 &#160; &#160;{ for i in &#34;${!owners[@]}&#34;; do<br/>&#160; &#160; 32 &#160; &#160; &#160; &#160;printf &#34;%-10s: %5d file(s)\n&#34; &#34;$i&#34; &#34;${owners[&#34;$i&#34;]}&#34;<br/>&#160; &#160; 33 &#160; &#160;done } | sort<br/>&#160; &#160; 34 &#160; &#160;echo<br/>&#160; &#160; 35 &#160; &#160;<br/>&#160; &#160; 36 &#160; &#160;# List groups<br/>&#160; &#160; 37 &#160; &#160;echo &#34;File group owners:&#34;<br/>&#160; &#160; 38 &#160; &#160;{ for i in &#34;${!groups[@]}&#34;; do<br/>&#160; &#160; 39 &#160; &#160; &#160; &#160;printf &#34;%-10s: %5d file(s)\n&#34; &#34;$i&#34; &#34;${groups[&#34;$i&#34;]}&#34;<br/>&#160; &#160; 40 &#160; &#160;done } | sort<br/>
Let's&#160;take&#160;a&#160;look at&#160;the&#160;mechanics&#160;of this&#160;script:<br/><b>Line&#160;5:</b>&#160;Associative&#160;arrays&#160;must&#160;be&#160;created&#160;with&#160;the&#160;declare&#160;command&#160;using&#160;the&#160;-A<br/>option. &#160;In this&#160;script&#160;we&#160;create&#160;five&#160;arrays&#160;as&#160;follows:<br/>
•<br/>
files&#160;contains&#160;the&#160;names&#160;of the&#160;files&#160;in the&#160;directory, indexed&#160;by filename<br/>
•<br/>
file_group&#160;contains&#160;the&#160;group owner of each&#160;file,&#160;indexed&#160;by filename<br/>
•<br/>
file_owner&#160;contains&#160;the&#160;owner of each&#160;file,&#160;indexed&#160;by file&#160;name<br/>
•<br/>
groups&#160;contains&#160;the&#160;number&#160;of files&#160;belonging to&#160;the&#160;indexed group<br/>
•<br/>
owners&#160;contains&#160;the&#160;number&#160;of files&#160;belonging to&#160;the&#160;indexed owner<br/>
<b>Lines&#160;7-10:</b>&#160;These&#160;lines&#160;check&#160;to&#160;see&#160;that&#160;a&#160;valid&#160;directory&#160;name&#160;was&#160;passed&#160;as&#160;a&#160;posi-<br/>tional&#160;parameter. &#160;If not, a&#160;usage&#160;message&#160;is&#160;displayed and the&#160;script&#160;exits&#160;with an&#160;exit&#160;sta-<br/>tus&#160;of 1.<br/><b>Lines&#160;12-20:</b>&#160;&#160;These&#160;lines&#160;loop&#160;through&#160;the&#160;files&#160;in&#160;the&#160;directory.&#160;&#160;Using&#160;the&#160;stat&#160;com-<br/>mand,&#160;lines&#160;13 and&#160;14&#160;extract&#160;the&#160;names&#160;of the&#160;file&#160;owner&#160;and&#160;group owner&#160;and&#160;assign&#160;the<br/>values&#160;to&#160;their&#160;respective&#160;arrays&#160;(lines&#160;16&#160;and&#160;17)&#160;using&#160;the&#160;name&#160;of&#160;the&#160;file&#160;as&#160;the&#160;array<br/>index. &#160;Likewise, the&#160;file&#160;name&#160;itself is&#160;assigned&#160;to the&#160;files&#160;array (line&#160;15).<br/><b>Lines&#160;18-19:</b>&#160;&#160;The&#160;total&#160;number&#160;of&#160;files&#160;belonging&#160;to&#160;the&#160;file&#160;owner&#160;and&#160;group&#160;owner&#160;are<br/>
508<br/>
<hr/>
<a name=533></a>Group Commands&#160;and Subshells<br/>
incremented&#160;by one.<br/><b>Lines&#160;22-27:</b>&#160;&#160;&#160;The&#160;list&#160;of&#160;files&#160;is&#160;output.&#160;&#160;This&#160;is&#160;done&#160;using&#160;the&#160;&#34;${array[@]}&#34;&#160;pa-<br/>rameter&#160;expansion&#160;which&#160;expands&#160;into&#160;the&#160;entire&#160;list&#160;of&#160;array&#160;elements&#160;with&#160;each&#160;element<br/>treated&#160;as&#160;a&#160;separate&#160;word.&#160;&#160;This&#160;allows&#160;for&#160;the&#160;possibility&#160;that&#160;a&#160;filename&#160;may&#160;contain<br/>embedded&#160;spaces.&#160;&#160;&#160;Also&#160;note&#160;that&#160;the&#160;entire&#160;loop&#160;is&#160;enclosed&#160;in&#160;braces&#160;thus&#160;forming&#160;a<br/>group&#160;command.&#160;This&#160;permits&#160;the&#160;entire&#160;output&#160;of&#160;the&#160;loop&#160;to&#160;be&#160;piped&#160;into&#160;the&#160;&#160;sort<br/>command.&#160;This&#160;is&#160;necessary because&#160;the&#160;expansion of the&#160;array elements&#160;is&#160;not&#160;sorted.<br/><b>Lines&#160;29-40:</b>&#160;&#160;These&#160;two&#160;loops&#160;are&#160;similar&#160;to&#160;the&#160;file&#160;list&#160;loop&#160;except&#160;that&#160;they&#160;use&#160;the&#160;&#34;$<br/>{!array[@]}&#34;&#160;expansion&#160;which&#160;expands&#160;into&#160;the&#160;list&#160;of&#160;array&#160;indexes&#160;rather&#160;than&#160;the<br/>list&#160;of array&#160;elements.<br/>
Process&#160;Substitution<br/>While&#160;they&#160;look&#160;similar&#160;and&#160;can&#160;both&#160;be&#160;used&#160;to&#160;combine&#160;streams&#160;for&#160;redirection,&#160;there&#160;is<br/>an&#160;important&#160;difference&#160;between&#160;group&#160;commands&#160;and&#160;subshells.&#160;Whereas&#160;a&#160;group&#160;com-<br/>mand&#160;executes&#160;all&#160;of&#160;its&#160;commands&#160;in&#160;the&#160;current&#160;shell,&#160;a&#160;subshell&#160;(as&#160;the&#160;name&#160;suggests)<br/>executes&#160;its&#160;commands&#160;in&#160;a&#160;child&#160;copy&#160;of&#160;the&#160;current&#160;shell.&#160;This&#160;means&#160;the&#160;environment&#160;is<br/>copied&#160;and&#160;given&#160;to&#160;a&#160;new&#160;instance&#160;of&#160;the&#160;shell.&#160;When&#160;the&#160;subshell&#160;exits,&#160;the&#160;copy&#160;of&#160;the<br/>environment&#160;is&#160;lost,&#160;so&#160;any&#160;changes&#160;made&#160;to&#160;the&#160;subshell’s&#160;environment&#160;(including&#160;vari-<br/>able&#160;assignment)&#160;are&#160;lost&#160;as&#160;well.&#160;Therefore,&#160;in&#160;most&#160;cases,&#160;unless&#160;a&#160;script&#160;requires&#160;a&#160;sub-<br/>shell,&#160;group&#160;commands&#160;are&#160;preferable&#160;to&#160;subshells.&#160;Group&#160;commands&#160;are&#160;both&#160;faster&#160;and<br/>require&#160;less&#160;memory.<br/>We&#160;saw&#160;an&#160;example&#160;of&#160;the&#160;subshell&#160;environment&#160;problem&#160;in&#160;Chapter&#160;28,&#160;“Reading&#160;Key-<br/>board&#160;Input,”&#160;when&#160;we&#160;discovered&#160;that&#160;a&#160;read&#160;command&#160;in&#160;a&#160;pipeline&#160;does&#160;not&#160;work&#160;as<br/>we&#160;might&#160;intuitively&#160;expect.&#160;To recap,&#160;if we&#160;construct&#160;a&#160;pipeline&#160;like&#160;this:<br/>
echo &#34;foo&#34; | read<br/>echo $REPLY<br/>
the&#160;content&#160;of&#160;the&#160;REPLY&#160;variable&#160;is&#160;always&#160;empty&#160;because&#160;the&#160;read&#160;command&#160;is&#160;exe-<br/>cuted&#160;in a&#160;subshell, and&#160;its&#160;copy of&#160;REPLY&#160;is&#160;destroyed&#160;when&#160;the&#160;subshell&#160;terminates.<br/>Because&#160;commands&#160;in&#160;pipelines&#160;are&#160;always&#160;executed&#160;in&#160;subshells,&#160;any&#160;command&#160;that&#160;as-<br/>signs&#160;variables&#160;will&#160;encounter&#160;this&#160;issue.&#160;Fortunately,&#160;the&#160;shell&#160;provides&#160;an&#160;exotic&#160;form&#160;of<br/>expansion called&#160;<i>process&#160;substitution</i>&#160;that&#160;can be&#160;used to&#160;work around&#160;this&#160;problem.<br/>Process&#160;substitution is&#160;expressed in&#160;two ways.<br/>For processes&#160;that&#160;produce&#160;standard output,&#160;it&#160;looks&#160;like&#160;this:<br/>&lt;(<i>list</i>)<br/>
509<br/>
<hr/>
<a name=534></a>36 – Exotica<br/>
or, for processes&#160;that&#160;intake&#160;standard input,&#160;it&#160;looks&#160;like&#160;this:<br/>&gt;(<i>list</i>)<br/>where&#160;<i>list</i>&#160;is&#160;a&#160;list&#160;of commands.<br/>To solve&#160;our problem&#160;with&#160;read, we&#160;can&#160;employ&#160;process&#160;substitution like&#160;this:<br/>
read &lt; &lt;(echo &#34;foo&#34;)<br/>echo $REPLY<br/>
Process&#160;substitution&#160;allows&#160;us&#160;to&#160;treat&#160;the&#160;output&#160;of&#160;a&#160;subshell&#160;as&#160;an&#160;ordinary&#160;file&#160;for&#160;pur-<br/>poses&#160;of&#160;redirection.&#160;In&#160;fact,&#160;since&#160;it&#160;is&#160;a&#160;form&#160;of&#160;expansion,&#160;we&#160;can&#160;examine&#160;its&#160;real<br/>value.<br/>
[me@linuxbox ~]$ echo &lt;(echo &#34;foo&#34;)<br/>/dev/fd/63<br/>
By&#160;using&#160;echo&#160;to&#160;view&#160;the&#160;result&#160;of&#160;the&#160;expansion,&#160;we&#160;see&#160;that&#160;the&#160;output&#160;of&#160;the&#160;subshell<br/>is&#160;being provided&#160;by a&#160;file&#160;named&#160;/dev/fd/63.<br/>Process&#160;substitution&#160;is&#160;often&#160;used&#160;with&#160;loops&#160;containing&#160;read.&#160;Here&#160;is&#160;an&#160;example&#160;of&#160;a<br/>read&#160;loop that&#160;processes&#160;the&#160;contents&#160;of a&#160;directory&#160;listing&#160;created&#160;by a&#160;subshell:<br/>
#!/bin/bash&#160;<br/>
# pro-sub: demo of process substitution&#160;<br/>
while read attr links owner group size date time filename; do&#160;<br/>
cat &lt;&lt;- EOF&#160;<br/>
Filename: &#160; $filename&#160;<br/>Size: &#160; &#160; &#160; $size&#160;<br/>Owner: &#160; &#160; &#160;$owner&#160;<br/>Group: &#160; &#160; &#160;$group&#160;<br/>Modified: &#160; $date $time&#160;<br/>Links: &#160; &#160; &#160;$links&#160;<br/>Attributes: $attr&#160;<br/>
EOF&#160;<br/>
done &lt; &lt;(ls -l | tail -n +2)<br/>
The&#160;loop&#160;executes&#160;read&#160;for&#160;each&#160;line&#160;of&#160;a&#160;directory&#160;listing.&#160;The&#160;listing&#160;itself&#160;is&#160;produced<br/>
510<br/>
<hr/>
<a name=535></a>Group Commands&#160;and Subshells<br/>
on&#160;the&#160;final&#160;line&#160;of&#160;the&#160;script.&#160;This&#160;line&#160;redirects&#160;the&#160;output&#160;of&#160;the&#160;process&#160;substitution&#160;into<br/>the&#160;standard&#160;input&#160;of&#160;the&#160;loop.&#160;The&#160;tail&#160;command&#160;is&#160;included&#160;in&#160;the&#160;process&#160;substitution<br/>pipeline&#160;to&#160;eliminate&#160;the&#160;first&#160;line&#160;of the&#160;listing, which&#160;is&#160;not&#160;needed.<br/>When executed,&#160;the&#160;script&#160;produces&#160;output&#160;like&#160;this:<br/>
[me@linuxbox ~]$&#160;<b>pro-sub | head -n 20<br/></b>Filename: &#160; addresses.ldif&#160;<br/>Size: &#160; &#160; &#160; 14540&#160;<br/>Owner: &#160; &#160; &#160;me<br/>Group: &#160; &#160; &#160;me&#160;<br/>Modified: &#160; 2009-04-02 11:12&#160;<br/>Links: &#160; &#160; &#160;1&#160;<br/>Attributes: -rw-r--r--&#160;<br/>
Filename: &#160; bin&#160;<br/>Size: &#160; &#160; &#160; 4096&#160;<br/>Owner: &#160; &#160; &#160;me&#160;<br/>Group: &#160; &#160; &#160;me&#160;<br/>Modified: &#160; 2009-07-10 07:31&#160;<br/>Links: &#160; &#160; &#160;2&#160;<br/>Attributes: drwxr-xr-x&#160;<br/>
Filename: &#160; bookmarks.html&#160;<br/>Size: &#160; &#160; &#160; 394213&#160;<br/>Owner: &#160; &#160; &#160;me&#160;<br/>Group: &#160; &#160; &#160;me<br/>
<b>Traps<br/></b>In&#160;Chapter&#160;10,&#160;“Processes,”&#160;we&#160;saw&#160;how&#160;programs&#160;can&#160;respond&#160;to&#160;&#160;signals.&#160;We&#160;can&#160;add<br/>this&#160;capability&#160;to&#160;our&#160;scripts,&#160;too.&#160;While&#160;the&#160;scripts&#160;we&#160;have&#160;written&#160;so&#160;far&#160;have&#160;not<br/>needed&#160;this&#160;capability&#160;(because&#160;they&#160;have&#160;very&#160;short&#160;execution&#160;times,&#160;and&#160;do&#160;not&#160;create<br/>temporary&#160;files),&#160;larger&#160;and&#160;more&#160;complicated&#160;scripts&#160;may&#160;benefit&#160;from&#160;having&#160;a&#160;signal<br/>handling&#160;routine.<br/>When&#160;we&#160;design&#160;a&#160;large,&#160;complicated&#160;script,&#160;it&#160;is&#160;important&#160;to&#160;consider&#160;what&#160;happens&#160;if<br/>the&#160;user&#160;logs&#160;off&#160;or&#160;shuts&#160;down&#160;the&#160;computer&#160;while&#160;the&#160;script&#160;is&#160;running.&#160;When&#160;such&#160;an<br/>event&#160;occurs,&#160;a&#160;signal&#160;will&#160;be&#160;sent&#160;to&#160;all&#160;affected&#160;processes.&#160;In&#160;turn,&#160;the&#160;programs&#160;repre-<br/>senting&#160;those&#160;processes&#160;can&#160;perform&#160;actions&#160;to&#160;ensure&#160;a&#160;proper&#160;and&#160;orderly&#160;termination&#160;of<br/>the&#160;program.&#160;Let’s&#160;say,&#160;for&#160;example,&#160;that&#160;we&#160;wrote&#160;a&#160;script&#160;that&#160;created&#160;a&#160;temporary&#160;file<br/>during its&#160;execution.&#160;In the&#160;course&#160;of good design, we&#160;would&#160;have&#160;the&#160;script&#160;delete&#160;the&#160;file<br/>when&#160;the&#160;script&#160;finishes&#160;its&#160;work.&#160;It&#160;would&#160;also&#160;be&#160;smart&#160;to&#160;have&#160;the&#160;script&#160;delete&#160;the&#160;file<br/>
511<br/>
<hr/>
<a name=536></a>36 – Exotica<br/>
if a&#160;signal&#160;is&#160;received indicating that&#160;the&#160;program&#160;was&#160;going to be&#160;terminated&#160;prematurely.<br/>
bash&#160;&#160;provides&#160;a&#160;mechanism&#160;for&#160;this&#160;purpose&#160;known&#160;as&#160;a&#160;&#160;<i>trap</i>.&#160;Traps&#160;are&#160;implemented<br/>with the&#160;appropriately named builtin&#160;command,&#160;trap.&#160;trap&#160;uses&#160;the&#160;following&#160;syntax:<br/>trap&#160;<i>argument</i>&#160;<i>signal</i>&#160;[<i>signal</i>...]<br/>where&#160;<i>argument</i>&#160;is&#160;a&#160;string&#160;that&#160;will&#160;be&#160;read&#160;and&#160;treated&#160;as&#160;a&#160;command&#160;and&#160;<i>signal</i>&#160;is&#160;the<br/>specification&#160;of a&#160;signal&#160;that&#160;will&#160;trigger the&#160;execution of the&#160;interpreted command.<br/>Here&#160;is&#160;a&#160;simple&#160;example:<br/>
#!/bin/bash&#160;<br/>
# trap-demo: simple signal handling demo&#160;<br/>
trap &#34;echo 'I am ignoring you.'&#34; SIGINT SIGTERM&#160;<br/>
for i in {1..5}; do&#160;<br/>
echo &#34;Iteration $i of 5&#34;&#160;<br/>sleep 5&#160;<br/>
done<br/>
This&#160;script&#160;defines&#160;a&#160;trap&#160;that&#160;will&#160;execute&#160;an&#160;echo&#160;command&#160;each&#160;time&#160;either&#160;the&#160;SIG-<br/>INT&#160;&#160;or&#160;&#160;SIGTERM&#160;&#160;signal&#160;is&#160;received&#160;while&#160;the&#160;script&#160;is&#160;running.&#160;Execution&#160;of&#160;the&#160;pro-<br/>gram&#160;looks&#160;like&#160;this&#160;when&#160;the&#160;user attempts&#160;to stop the&#160;script&#160;by pressing&#160;Ctrl-c:<br/>
[me@linuxbox ~]$&#160;<b>trap-demo</b>&#160;<br/>Iteration 1 of 5&#160;<br/>Iteration 2 of 5&#160;<br/>^CI am ignoring you.&#160;<br/>Iteration 3 of 5&#160;<br/>^CI am ignoring you.&#160;<br/>Iteration 4 of 5&#160;<br/>Iteration 5 of 5<br/>
As&#160;we&#160;can&#160;see,&#160;each&#160;time&#160;the&#160;user&#160;attempts&#160;to&#160;interrupt&#160;the&#160;program,&#160;the&#160;message&#160;is<br/>printed&#160;instead.<br/>Constructing&#160;a&#160;string&#160;to&#160;form&#160;a&#160;useful&#160;sequence&#160;of&#160;commands&#160;can&#160;be&#160;awkward,&#160;so&#160;it&#160;is<br/>common&#160;practice&#160;to&#160;specify&#160;a&#160;shell&#160;function&#160;as&#160;the&#160;command.&#160;In&#160;this&#160;example,&#160;a&#160;separate<br/>shell&#160;function is&#160;specified for each signal&#160;to be&#160;handled:<br/>
512<br/>
<hr/>
<a name=537></a>Traps<br/>
#!/bin/bash&#160;<br/>
#&#160;trap-demo2: simple signal handling demo&#160;<br/>
exit_on_signal_SIGINT () {&#160;<br/>
echo &#34;Script interrupted.&#34; 2&gt;&amp;1&#160;<br/>exit 0&#160;<br/>
}&#160;<br/>
exit_on_signal_SIGTERM () {&#160;<br/>
echo &#34;Script terminated.&#34; 2&gt;&amp;1&#160;<br/>exit 0&#160;<br/>
}&#160;<br/>
trap exit_on_signal_SIGINT SIGINT&#160;<br/>trap exit_on_signal_SIGTERM SIGTERM&#160;<br/>
for i in {1..5}; do&#160;<br/>
echo &#34;Iteration $i of 5&#34;&#160;<br/>sleep 5&#160;<br/>
done<br/>
This&#160;script&#160;features&#160;two&#160;trap&#160;commands,&#160;one&#160;for&#160;each&#160;signal.&#160;Each&#160;trap,&#160;in&#160;turn,&#160;speci-<br/>fies&#160;a&#160;shell&#160;function&#160;to&#160;be&#160;executed&#160;when&#160;the&#160;particular&#160;signal&#160;is&#160;received.&#160;Note&#160;the&#160;inclu-<br/>sion&#160;of&#160;an&#160;exit&#160;command&#160;in&#160;each&#160;of&#160;the&#160;signal-handling&#160;functions.&#160;Without&#160;an&#160;exit,<br/>the&#160;script&#160;would continue&#160;after&#160;completing&#160;the&#160;function.<br/>When&#160;the&#160;user&#160;presses&#160;Ctrl-c&#160;during&#160;the&#160;execution&#160;of&#160;this&#160;script,&#160;the&#160;results&#160;look&#160;like<br/>this:<br/>
[me@linuxbox ~]$&#160;<b>trap-demo2&#160;<br/></b>Iteration 1 of 5&#160;<br/>Iteration 2 of 5&#160;<br/>^CScript interrupted.<br/>
513<br/>
<hr/>
<a name=538></a>36 – Exotica<br/>
<b>Temporary&#160;Files</b><br/>
One&#160;reason&#160;signal&#160;handlers&#160;are&#160;included&#160;in&#160;scripts&#160;is&#160;to&#160;remove&#160;temporary&#160;files<br/>that&#160;the&#160;script&#160;may&#160;create&#160;to&#160;hold&#160;intermediate&#160;results&#160;during&#160;execution.&#160;There&#160;is<br/>something&#160;of&#160;an&#160;art&#160;to&#160;naming&#160;temporary&#160;files.&#160;Traditionally,&#160;programs&#160;on&#160;Unix-<br/>like&#160;systems&#160;create&#160;their&#160;temporary&#160;files&#160;in&#160;the&#160;/tmp&#160;directory,&#160;a&#160;shared&#160;directory<br/>intended&#160;for&#160;such&#160;files.&#160;However,&#160;since&#160;the&#160;directory&#160;is&#160;shared,&#160;this&#160;poses&#160;certain<br/>security&#160;concerns,&#160;particularly&#160;for&#160;programs&#160;running&#160;with&#160;superuser&#160;privileges.<br/>Aside&#160;from&#160;the&#160;obvious&#160;step&#160;of&#160;setting&#160;proper&#160;permissions&#160;for&#160;files&#160;exposed&#160;to&#160;all<br/>users&#160;of&#160;the&#160;system,&#160;it&#160;is&#160;important&#160;to&#160;give&#160;temporary&#160;files&#160;nonpredictable&#160;file-<br/>names.&#160;This&#160;avoids&#160;an&#160;exploit&#160;known&#160;as&#160;a&#160;<i>temp&#160;race&#160;attack</i>.&#160;One&#160;way&#160;to&#160;create&#160;a<br/>nonpredictable&#160;(but&#160;still&#160;descriptive)&#160;name&#160;is&#160;to&#160;do something&#160;like&#160;this:<br/>tempfile=/tmp/$(basename $0).$$.$RANDOM<br/>
This&#160;will&#160;create&#160;a&#160;filename&#160;consisting&#160;of&#160;the&#160;program’s&#160;name,&#160;followed&#160;by&#160;its<br/>process&#160;ID&#160;(PID),&#160;followed&#160;by&#160;a&#160;random&#160;integer.&#160;Note,&#160;however,&#160;that&#160;the&#160;$RAN-<br/>DOM&#160;shell&#160;variable&#160;returns&#160;only&#160;a&#160;value&#160;in&#160;the&#160;range&#160;of&#160;1-32767,&#160;which&#160;is&#160;not&#160;a<br/>large&#160;range&#160;in&#160;computer&#160;terms,&#160;so&#160;a&#160;single&#160;instance&#160;of&#160;the&#160;variable&#160;is&#160;not&#160;sufficient<br/>to overcome&#160;a&#160;determined attacker.<br/>A&#160;better&#160;way is&#160;to use&#160;the&#160;mktemp&#160;program&#160;(not&#160;to&#160;be&#160;confused with the&#160;mktemp<br/>standard&#160;library&#160;function)&#160;to&#160;both&#160;name&#160;and&#160;create&#160;the&#160;temporary&#160;file.&#160;The&#160;&#160;mk-<br/>temp&#160;program&#160;accepts&#160;a&#160;template&#160;as&#160;an&#160;argument&#160;that&#160;is&#160;used&#160;to&#160;build&#160;the&#160;file-<br/>name.&#160;The&#160;template&#160;should&#160;include&#160;a&#160;series&#160;of&#160;“X”&#160;characters,&#160;which&#160;are&#160;replaced<br/>by&#160;a&#160;corresponding&#160;number&#160;of&#160;random&#160;letters&#160;and&#160;numbers.&#160;The&#160;longer&#160;the&#160;series<br/>of “X”&#160;characters, the&#160;longer the&#160;series&#160;of random&#160;characters. Here&#160;is&#160;an example:<br/>tempfile=$(mktemp /tmp/foobar.$$.XXXXXXXXXX)<br/>
This&#160;creates&#160;a&#160;temporary&#160;file&#160;and&#160;assigns&#160;its&#160;name&#160;to&#160;the&#160;variable&#160;&#160;tempfile.<br/>The&#160;“X”&#160;characters&#160;in&#160;the&#160;template&#160;are&#160;replaced&#160;with&#160;random&#160;letters&#160;and&#160;numbers<br/>so&#160;that&#160;the&#160;final&#160;filename&#160;(which,&#160;in&#160;this&#160;example,&#160;also&#160;includes&#160;the&#160;expanded<br/>value&#160;of the&#160;special&#160;parameter&#160;$$&#160;to obtain the&#160;PID) might&#160;be&#160;something like&#160;this:<br/>/tmp/foobar.6593.UOZuvM6654<br/>
For&#160;scripts&#160;that&#160;are&#160;executed&#160;by&#160;regular&#160;users,&#160;it&#160;may&#160;be&#160;wise&#160;to&#160;avoid&#160;the&#160;use&#160;of<br/>the&#160;&#160;/tmp&#160;&#160;directory&#160;and&#160;create&#160;a&#160;directory&#160;for&#160;temporary&#160;files&#160;within&#160;the&#160;user’s<br/>home&#160;directory,&#160;with a&#160;line&#160;of code&#160;such&#160;as&#160;this:<br/>[[ -d $HOME/tmp ]] || mkdir $HOME/tmp<br/>
514<br/>
<hr/>
<a name=539></a>Asynchronous&#160;Execution<br/>
<b>Asynchronous&#160;Execution<br/></b>It&#160;is&#160;sometimes&#160;desirable&#160;to&#160;perform&#160;more&#160;than&#160;one&#160;task&#160;at&#160;the&#160;same&#160;time.&#160;We&#160;have&#160;seen<br/>how&#160;all&#160;modern&#160;operating&#160;systems&#160;are&#160;at&#160;least&#160;multitasking&#160;if&#160;not&#160;multiuser&#160;as&#160;well.<br/>Scripts&#160;can&#160;be&#160;constructed&#160;to behave&#160;in a&#160;multitasking&#160;fashion.<br/>Usually&#160;this&#160;involves&#160;launching&#160;a&#160;script&#160;that,&#160;in&#160;turn,&#160;launches&#160;one&#160;or&#160;more&#160;child&#160;scripts&#160;to<br/>perform&#160;an&#160;additional&#160;task&#160;while&#160;the&#160;parent&#160;script&#160;continues&#160;to&#160;run.&#160;However,&#160;when&#160;a&#160;se-<br/>ries&#160;of&#160;scripts&#160;runs&#160;this&#160;way,&#160;there&#160;can&#160;be&#160;problems&#160;keeping&#160;the&#160;parent&#160;and&#160;child&#160;coordi-<br/>nated.&#160;That&#160;is,&#160;what&#160;if&#160;the&#160;parent&#160;or&#160;child&#160;is&#160;dependent&#160;on&#160;the&#160;other&#160;and&#160;one&#160;script&#160;must<br/>wait&#160;for the&#160;other&#160;to finish its&#160;task before&#160;finishing&#160;its&#160;own?<br/>
bash&#160;has&#160;a&#160;builtin&#160;command&#160;to&#160;help&#160;manage&#160;<i>asynchronous&#160;execution</i>&#160;such&#160;as&#160;this.&#160;The<br/>wait&#160;command&#160;causes&#160;a&#160;parent&#160;script&#160;to&#160;pause&#160;until&#160;a&#160;specified&#160;process&#160;(i.e.,&#160;the&#160;child<br/>script) finishes.<br/>
wait<br/>We&#160;will&#160;demonstrate&#160;the&#160;wait&#160;command&#160;first.&#160;To&#160;do&#160;this,&#160;we&#160;will&#160;need&#160;two&#160;scripts.&#160;First<br/>a&#160;parent&#160;script.<br/>
#!/bin/bash&#160;<br/>
# async-parent: Asynchronous execution demo (parent)&#160;<br/>
echo &#34;Parent: starting...&#34;&#160;<br/>
echo &#34;Parent: launching child script...&#34;&#160;<br/>async-child &amp;&#160;<br/>pid=$!&#160;<br/>echo &#34;Parent: child (PID= $pid) launched.&#34;&#160;<br/>
echo &#34;Parent: continuing...&#34;&#160;<br/>sleep 2&#160;<br/>
echo &#34;Parent: pausing to wait for child to finish...&#34;&#160;<br/>wait &#34;$pid&#34;&#160;<br/>
echo &#34;Parent: child is finished. Continuing...&#34;&#160;<br/>echo &#34;Parent: parent is done. Exiting.&#34;<br/>
The&#160;second&#160;is&#160;a&#160;child&#160;script.<br/>
515<br/>
<hr/>
<a name=540></a>36 – Exotica<br/>
#!/bin/bash&#160;<br/>
# async-child: Asynchronous execution demo (child)&#160;<br/>
echo &#34;Child: child is running...&#34;&#160;<br/>sleep 5&#160;<br/>echo &#34;Child: child is done. Exiting.&#34;<br/>
In&#160;this&#160;example,&#160;we&#160;see&#160;that&#160;the&#160;child&#160;script&#160;is&#160;simple.&#160;The&#160;real&#160;action&#160;is&#160;being&#160;performed<br/>by&#160;the&#160;parent.&#160;In&#160;the&#160;parent&#160;script,&#160;the&#160;child&#160;script&#160;is&#160;launched&#160;and&#160;put&#160;into&#160;the&#160;back-<br/>ground.&#160;The&#160;process&#160;ID&#160;of&#160;the&#160;child&#160;script&#160;is&#160;recorded&#160;by&#160;assigning&#160;the&#160;pid&#160;variable&#160;with<br/>the&#160;value&#160;of&#160;the&#160;$!&#160;shell&#160;parameter,&#160;which&#160;will&#160;always&#160;contain&#160;the&#160;process&#160;ID&#160;of&#160;the&#160;last<br/>job put&#160;into the&#160;background.<br/>The&#160;parent&#160;script&#160;continues&#160;and then&#160;executes&#160;a&#160;wait&#160;command&#160;with&#160;the&#160;PID&#160;of&#160;the&#160;child<br/>process.&#160;This&#160;causes&#160;the&#160;parent&#160;script&#160;to&#160;pause&#160;until&#160;the&#160;child&#160;script&#160;exits,&#160;at&#160;which&#160;point<br/>the&#160;parent&#160;script&#160;concludes.<br/>When executed,&#160;the&#160;parent&#160;and child scripts&#160;produce&#160;the&#160;following output:<br/>
[me@linuxbox ~]$&#160;<b>async-parent&#160;<br/></b>Parent: starting...&#160;<br/>Parent: launching child script...&#160;<br/>Parent: child (PID= 6741) launched.&#160;<br/>Parent: continuing...&#160;<br/>Child: child is running...&#160;<br/>Parent: pausing to wait for child to finish...&#160;<br/>Child: child is done. Exiting.&#160;<br/>Parent: child is finished. Continuing...&#160;<br/>Parent: parent is done. Exiting.<br/>
<b>Named&#160;Pipes<br/></b>In&#160;most&#160;Unix-like&#160;systems,&#160;it&#160;is&#160;possible&#160;to&#160;create&#160;a&#160;special&#160;type&#160;of&#160;file&#160;called&#160;a&#160;<i>named<br/>pipe</i>.&#160;Named&#160;pipes&#160;are&#160;used&#160;to&#160;create&#160;a&#160;connection&#160;between&#160;two&#160;processes&#160;and&#160;can&#160;be<br/>used&#160;just&#160;like&#160;other&#160;types&#160;of&#160;files.&#160;They&#160;are&#160;not&#160;that&#160;popular,&#160;but&#160;they’re&#160;good&#160;to&#160;know<br/>about.<br/>There&#160;is&#160;a&#160;common&#160;programming architecture&#160;called&#160;<i>client-server</i>,&#160;which&#160;can make&#160;use&#160;of<br/>a&#160;communication&#160;method&#160;such&#160;as&#160;named&#160;pipes,&#160;as&#160;well&#160;as&#160;other&#160;kinds&#160;of&#160;&#160;<i>interprocess<br/>communication</i>&#160;such&#160;as&#160;network connections.<br/>The&#160;most&#160;widely&#160;used&#160;type&#160;of&#160;client-server&#160;system&#160;is, of&#160;course, a&#160;web&#160;browser&#160;communi-<br/>
516<br/>
<hr/>
<a name=541></a>Named Pipes<br/>
cating&#160;with&#160;a&#160;web&#160;server.&#160;The&#160;web&#160;browser&#160;acts&#160;as&#160;the&#160;client,&#160;making&#160;requests&#160;to&#160;the<br/>server, and the&#160;server responds&#160;to the&#160;browser with&#160;web pages.<br/>Named&#160;pipes&#160;behave&#160;like&#160;files&#160;but&#160;actually&#160;form&#160;first-in&#160;first-out&#160;(FIFO)&#160;buffers.&#160;As&#160;with<br/>ordinary&#160;(unnamed)&#160;pipes,&#160;data&#160;goes&#160;in&#160;one&#160;end&#160;and&#160;emerges&#160;out&#160;the&#160;other.&#160;With&#160;named<br/>pipes, it&#160;is&#160;possible&#160;to set&#160;up something like&#160;this:<br/><i>process1</i>&#160;&gt;&#160;<i>named_pipe<br/></i>and this:<br/><i>process2</i>&#160;&lt;&#160;<i>named_pipe<br/></i>and it&#160;will&#160;behave&#160;like&#160;this:<br/><i>process1</i>&#160;|&#160;<i>process2</i><br/>
Setting&#160;Up&#160;a&#160;Named&#160;Pipe<br/>First, we&#160;must&#160;create&#160;a&#160;named&#160;pipe.&#160;This&#160;is&#160;done&#160;using&#160;the&#160;mkfifo&#160;command.<br/>
[me@linuxbox ~]$&#160;<b>mkfifo pipe1<br/></b>[me@linuxbox ~]$&#160;<b>ls -l pipe1<br/></b>prw-r--r-- 1 me &#160; me &#160; &#160;0 2009-07-17 06:41 pipe1<br/>
Here&#160;we&#160;use&#160;mkfifo&#160;to&#160;create&#160;a&#160;named&#160;pipe&#160;called&#160;pipe1.&#160;Using&#160;ls,&#160;we&#160;examine&#160;the<br/>file&#160;and&#160;see&#160;that&#160;the&#160;first&#160;letter&#160;in&#160;the&#160;attributes&#160;field&#160;is&#160;“p”,&#160;indicating&#160;that&#160;it&#160;is&#160;a&#160;named<br/>pipe.<br/>
Using&#160;Named&#160;Pipes<br/>To&#160;demonstrate&#160;how&#160;the&#160;named&#160;pipe&#160;works,&#160;we&#160;will&#160;need&#160;two&#160;terminal&#160;windows&#160;(or&#160;alter-<br/>nately,&#160;two&#160;virtual&#160;consoles).&#160;In&#160;the&#160;first&#160;terminal,&#160;we&#160;enter&#160;a&#160;simple&#160;command&#160;and&#160;redi-<br/>rect&#160;its&#160;output&#160;to the&#160;named pipe.<br/>
[me@linuxbox ~]$&#160;<b>ls -l &gt; pipe1</b><br/>
After&#160;we&#160;press&#160;the&#160;Enter&#160;key,&#160;the&#160;command&#160;will&#160;appear&#160;to&#160;hang.&#160;This&#160;is&#160;because&#160;there&#160;is<br/>nothing&#160;receiving&#160;data&#160;from&#160;the&#160;other&#160;end&#160;of&#160;the&#160;pipe&#160;yet.&#160;When&#160;this&#160;occurs,&#160;it&#160;is&#160;said&#160;that<br/>the&#160;pipe&#160;is&#160;<i>blocked</i>.&#160;This&#160;condition&#160;will&#160;clear&#160;once&#160;we&#160;attach&#160;a&#160;process&#160;to&#160;the&#160;other&#160;end<br/>and&#160;it&#160;begins&#160;to&#160;read&#160;input&#160;from&#160;the&#160;pipe.&#160;Using&#160;the&#160;second&#160;terminal&#160;window,&#160;we&#160;enter<br/>this&#160;command:<br/>
517<br/>
<hr/>
<a name=542></a>36 – Exotica<br/>
[me@linuxbox ~]$&#160;<b>cat &lt; pipe1</b><br/>
The&#160;directory&#160;listing&#160;produced&#160;from&#160;the&#160;first&#160;terminal&#160;window&#160;appears&#160;in&#160;the&#160;second&#160;ter-<br/>minal&#160;as&#160;the&#160;output&#160;from&#160;the&#160;cat&#160;command.&#160;The&#160;ls&#160;command&#160;in&#160;the&#160;first&#160;terminal&#160;suc-<br/>cessfully completes&#160;once&#160;it&#160;is&#160;no longer blocked.<br/>
<b>Summing&#160;Up<br/></b>Well,&#160;we&#160;have&#160;completed&#160;our&#160;journey.&#160;The&#160;only&#160;thing&#160;left&#160;to&#160;do&#160;now&#160;is&#160;practice,&#160;practice,<br/>practice.&#160;Even&#160;though&#160;we&#160;covered&#160;a&#160;lot&#160;of&#160;ground in&#160;our&#160;trek,&#160;we&#160;barely&#160;scratched&#160;the&#160;sur-<br/>face&#160;as&#160;far&#160;as&#160;the&#160;command&#160;line&#160;goes.&#160;There&#160;are&#160;still&#160;thousands&#160;of&#160;command&#160;line&#160;pro-<br/>grams&#160;left&#160;to&#160;be&#160;discovered&#160;and&#160;enjoyed.&#160;Start&#160;digging&#160;around&#160;in&#160;/usr/bin&#160;and&#160;you’ll<br/>see!&#160;<br/>
<b>Further&#160;Reading</b><br/>
●<br/>
The&#160;“Compound&#160;Commands”&#160;section&#160;of the&#160;bash man&#160;page&#160;contains&#160;a&#160;full&#160;de-<br/>scription&#160;of group command&#160;and subshell&#160;notations.<br/>
●<br/>
The&#160;EXPANSION&#160;section of the&#160;bash man page&#160;contains&#160;a&#160;subsection&#160;covering&#160;<br/>process&#160;substitution.<br/>
●<br/>
<i>The&#160;Advanced&#160;Bash-Scripting&#160;Guide</i>&#160;also has&#160;a&#160;discussion of process&#160;substitution:<br/><a href="http://tldp.org/LDP/abs/html/process-sub.html">http://tldp.org/LDP/abs/html/process-sub.html</a><br/>
●<br/>
<i>Linux&#160;Journal</i>&#160;has&#160;two good articles&#160;on named pipes.&#160;The&#160;first, from&#160;September&#160;<br/>1997:<br/><a href="http://www.linuxjournal.com/article/2156">http://www.linuxjournal.com/article/2156</a><br/>
●<br/>
and the&#160;second, from&#160;March 2009:<br/><a href="http://www.linuxjournal.com/content/using-named-pipes-fifos-bash">http://www.linuxjournal.com/content/using-named-pipes-fifos-bash</a><br/>
518<br/>
<hr/>
<a name=543></a>Index<br/>
<i><b>Index</b></i><br/>
<b>A</b><br/>
two-dimensional...........................................495<br/>
a2ps command...................................................344<br/>
ASCII.............................79, 83, 229, 259, 272, 344<br/>
absolute&#160;pathnames................................................9<br/>
bell&#160;character................................................163<br/>
alias command.............................................50, 130<br/>
carriage&#160;return..............................................276<br/>
aliases.....................................................42, 50, 128<br/>
collation order..............................259, 261, 400<br/>
American National&#160;Standards&#160;Institute&#160;(see&#160;ANSI)<br/>
control&#160;codes..................................79, 259, 338<br/>
............................................................................166<br/>
groff&#160;output&#160;driver........................................331<br/>
American Standard&#160;Code&#160;for&#160;Information&#160;<br/>
linefeed character.........................................276<br/>
Interchange&#160;(see&#160;ASCII).......................................18<br/>
null&#160;character................................................229<br/>
anchors...............................................................255<br/>
printable&#160;characters......................................259<br/>
anonymous FTP&#160;servers.....................................207<br/>
text..................................................................18<br/>
ANSI..................................................................166<br/>
aspell&#160;command.................................................309<br/>
ANSI&#160;escape&#160;codes....................................166, 170<br/>
assembler............................................................351<br/>
ANSI.SYS..........................................................166<br/>
assembly language.............................................351<br/>
Apache&#160;web&#160;server.............................................120<br/>
assignment&#160;operators..........................................485<br/>
apropos command................................................48<br/>
associative&#160;arrays.......................................503, 506<br/>
apt-cache&#160;command...........................................175<br/>
asynchronous&#160;execution.....................................515<br/>
apt-get&#160;command................................................175<br/>
audio CDs...................................................186, 197<br/>
aptitude&#160;command..............................................175<br/>
AWK&#160;programming language....................309, 491<br/>
Arch....................................................................172<br/>archiving............................................................238<br/>
<b>B</b><br/>
arithmetic&#160;expansion..............71, 76, 377, 473, 482<br/>
back&#160;references........................................272, 304p.<br/>
arithmetic&#160;expressions..................71, 470, 482, 484<br/>
backslash&#160;escape&#160;sequences.................................79<br/>
arithmetic&#160;operators.....................................71, 483<br/>
backslash-escaped&#160;special&#160;characters.................162<br/>
arithmetic&#160;truth tests...................................403, 482<br/>
backups,&#160;incremental..........................................242<br/>
arrays........................................................................<br/>
basename&#160;command...........................................455<br/>
append values&#160;to the&#160;end..............................501<br/>
bash................................................................2, 128<br/>
assigning values............................................496<br/>
man page........................................................48<br/>
associative............................................503, 506<br/>
b<i>asic&#160;r</i>egular&#160;expressions&#160;262, 271p., 302, 306, 316<br/>
creating.........................................................495<br/>
bc&#160;command.......................................................491<br/>
deleting.........................................................502<br/>
Berkeley&#160;Software&#160;Distribution.........................342<br/>
determine&#160;number&#160;of&#160;elements.....................500<br/>
bg command.......................................................118<br/>
finding used subscripts.................................500<br/>
binary.............................................95, 99, 351, 483<br/>
index.............................................................495<br/>
bit&#160;mask................................................................98<br/>
multidimensional..........................................495<br/>
bit&#160;operators.......................................................487<br/>
reading variables in<i>to</i>...................................413<br/>
Bourne, Steve.....................................................2, 6<br/>
sorting...........................................................501<br/>
brace&#160;expansion......................................72, 76, 467<br/>
subscript.......................................................495<br/>
519<br/>
<hr/>
<a name=544></a>Index<br/>
branching............................................................393<br/>
documentation................................................44<br/>
break&#160;command..........................................426, 461<br/>
executable&#160;program&#160;files........................42, 351<br/>
broken&#160;links..........................................................40<br/>
executing as another&#160;user.............................101<br/>
BSD&#160;style...........................................................113<br/>
long options....................................................14<br/>
buffering.............................................................188<br/>
options............................................................14<br/>
bugs.................................................................438p.<br/>
comments...........................133, 139, 308, 365, 440<br/>
build environment..............................................357<br/>
Common Unix Printing System.................340, 349<br/>
bzip2 command..................................................237<br/>
comparison operators.........................................488<br/>compiler.............................................................351<br/>compiling...........................................................350<br/>
<b>C</b><br/>
completions..........................................................83<br/>
C&#160;programming language...........351, 469, 486, 489<br/>
compound commands..............................................<br/>
C++....................................................................351<br/>
case...............................................................444<br/>
cal&#160;command..........................................................4<br/>
for.................................................................466<br/>
cancel&#160;command.................................................349<br/>
if...................................................................393<br/>
carriage&#160;return.&#160;.18, 79, 163, 259p., 275, 308p., 341<br/>
until...............................................................428<br/>
case&#160;compound command..................................444<br/>
while.............................................................424<br/>
case&#160;conversion..................................................480<br/>
((&#160;))................................................403, 419, 482<br/>
cat&#160;command................................................59, 275<br/>
[[&#160;]]........................................................402, 419<br/>
cd command.....................................................9, 11<br/>
<i>compression algorithms</i>.....................................235<br/>
CD-ROMs...............................................185p., 197<br/>
conditional&#160;expressions..............................409, 434<br/>
cdrecord&#160;command.............................................198<br/>
configuration files..................................18, 21, 128<br/>
character&#160;classes...26p., 256, 258, 260p., 265, 299,&#160;<br/>
configure&#160;command...........................................357<br/>
309<br/>
constants.............................................................376<br/>
character&#160;ranges................................27, 257p., 309<br/>
continue&#160;command.............................................426<br/>
chgrp&#160;command..................................................106<br/>
control&#160;characters.......................................163, 275<br/>
child process.......................................................110<br/>
control&#160;codes................................................79, 259<br/>
chmod command..................................94, 107, 366<br/>
control&#160;operators......................................................<br/>
chown command........................................104, 107<br/>
&amp;&amp;........................................................407, 419<br/>
Chrome...............................................................371<br/>
||....................................................................407<br/>
chronological&#160;sorting.........................................283<br/>
controlling terminal............................................111<br/>
cleartext......................................................207, 210<br/>
COPYING..........................................................355<br/>
client-server&#160;architecture....................................516<br/>
copying and pasting.................................................<br/>
COBOL&#160;programming language........................351<br/>
in vim............................................................150<br/>
collation order....................131, 259, 261, 299, 400<br/>
on the&#160;command&#160;line......................................82<br/>
ASCII...................................................261, 400<br/>
with X&#160;Window&#160;System....................................3<br/>
dictionary......................................................260<br/>
coreutils package.........................46, 49p., 289, 313<br/>
traditional.....................................................261<br/>
counting words in a&#160;file........................................63<br/>
comm&#160;command.................................................294<br/>
cp command...................................28, 35, 136, 214<br/>
command history..............................................3, 85<br/>
CPU.........................................................110p.,&#160;350<br/>
command line...........................................................<br/>
cron&#160;job..............................................................219<br/>
arguments.....................................................451<br/>
crossword&#160;puzzles..............................................256<br/>
editing.........................................................3, 81<br/>
csplit&#160;command..................................................314<br/>
expansion........................................................68<br/>
CUPS..........................................................340, 349<br/>
history.........................................................3, 86<br/>
current&#160;working directory......................................8<br/>
interfaces................................................xvii, 28<br/>
cursor&#160;movement..................................................81<br/>
command options.................................................14<br/>
cut&#160;command..............................................286, 478<br/>
command substitution............................74, 76, 467<br/>commands................................................................<br/>
arguments...............................................14, 451<br/>
<b>D</b><br/>
determining type.............................................43<br/>
daemon programs.......................................110,&#160;120<br/>
520<br/>
<hr/>
<a name=545></a>Index<br/>
data&#160;compression................................................234<br/>
dpkg command...................................................175<br/>
data&#160;redundancy.................................................234<br/>
du command...............................................278, 391<br/>
data&#160;validation....................................................402<br/>
Dynamic&#160;Host&#160;Configuration Protocol&#160;(DHCP)&#160;205<br/>
date&#160;command........................................................4<br/>date&#160;formats........................................................282<br/>dd command.......................................................196<br/>
<b>E</b><br/>
Debian................................................................172<br/>
echo&#160;command.....................................68, 130, 372<br/>
Debian&#160;Style&#160;(.deb)............................................173<br/>
-e&#160;option..........................................................79<br/>
debugging...................................................388, 439<br/>
-n option.......................................................412<br/>
declare&#160;command...............................................480<br/>
edge&#160;and corner&#160;cases.........................................439<br/>
defensive&#160;programming.............................435, 439<br/>
EDITOR&#160;variable...............................................131<br/>
delimiters..............................................77, 280, 283<br/>
effective&#160;group ID..............................................100<br/>
dependencies..............................................174, 360<br/>
effective&#160;user&#160;ID.........................................100, 111<br/>
design.........................................................437, 439<br/>
elif&#160;statement......................................................400<br/>
device&#160;drivers.............................................180, 351<br/>
email...................................................................274<br/>
device&#160;names......................................................188<br/>
embedded&#160;systems.............................................351<br/>
device&#160;nodes.........................................................21<br/>
empty variables..................................................474<br/>
df&#160;command...................................................5, 390<br/>
encrypted tunnels...............................................213<br/>
diction................................................................352<br/>
encryption..........................................................300<br/>
dictionary collation order...................................260<br/>
end of&#160;file.....................................................60, 380<br/>
diff&#160;command.....................................................295<br/>
endless loop........................................................427<br/>
Digital&#160;Restrictions Management&#160;(DRM)..........174<br/>
enscript&#160;command..............................................347<br/>
directories.................................................................<br/>
environment.......................................102, 128, 417<br/>
archiving.......................................................238<br/>
aliases...........................................................128<br/>
changing...........................................................9<br/>
establishing...................................................131<br/>
copying...........................................................28<br/>
examining.....................................................128<br/>
creating.....................................................28, 34<br/>
login shell.....................................................131<br/>
current&#160;working................................................8<br/>
shell&#160;functions..............................................128<br/>
deleting.....................................................31, 39<br/>
shell&#160;variables...............................................128<br/>
hierarchical.......................................................7<br/>
startup files...................................................131<br/>
home.................................................21, 92, 391<br/>
subshells.......................................................509<br/>
listing..............................................................13<br/>
variables.......................................................128<br/>
moving......................................................30, 36<br/>
eqn command.....................................................329<br/>
navigating.........................................................7<br/>
executable&#160;files...................................................358<br/>
OLD_PWD&#160;variable.....................................131<br/>
executable&#160;program&#160;files..............................42, 351<br/>
parent................................................................8<br/>
executable&#160;programs................................................<br/>
PATH&#160;variable..............................................131<br/>
determining location.......................................43<br/>
PWD&#160;variable...............................................131<br/>
PATH&#160;variable..............................................131<br/>
removing...................................................31, 39<br/>
exit&#160;command.........................................5, 398, 421<br/>
renaming...................................................30, 36<br/>
exit&#160;status...................................................394, 398<br/>
root...................................................................7<br/>
expand&#160;command...............................................289<br/>
shared...........................................................106<br/>
expansions............................................................68<br/>
sticky bit.......................................................100<br/>
arithmetic..........................71, 76, 377, 473, 482<br/>
synchronizing...............................................246<br/>
brace.................................................72, 76, 467<br/>
transferring over&#160;a&#160;network..........................246<br/>
command&#160;substitution......................74, 76, 467<br/>
viewing contents...............................................8<br/>
delimiters........................................................77<br/>
disk partitions.....................................................183<br/>
errors&#160;resulting from.....................................432<br/>
DISPLAY&#160;variable.............................................130<br/>
history.......................................................86, 88<br/>
Dolphin................................................................28<br/>
parameter..........................73, 76, 375, 381, 473<br/>
dos2unix command............................................276<br/>
pathname..........................................69, 76, 467<br/>
double&#160;quotes.......................................................76<br/>
tilde...........................................................70, 76<br/>
521<br/>
<hr/>
<a name=546></a>Index<br/>
word-splitting.................................................76<br/>
mode...............................................................93<br/>
expressions...............................................................<br/>
moving......................................................30, 36<br/>
arithm<i>etic</i>........................71, 470, 482, 484, 496<br/>
owner..............................................................94<br/>
conditional............................................409, 434<br/>
permissions.....................................................91<br/>
ext4.....................................................................194<br/>
read access......................................................92<br/>
extended&#160;regular&#160;expressions.............................262<br/>
regular...........................................................220<br/>
Extensible&#160;Markup&#160;Language............................274<br/>
removing...................................................31, 39<br/>renaming...................................................30, 36<br/>rpm...............................................................172<br/>
<b>F</b><br/>
shared library..................................................21<br/>
false&#160;command...................................................395<br/>
startup...........................................................131<br/>
fdisk command...................................................192<br/>
sticky bit.......................................................100<br/>
fg command........................................................118<br/>
symbolic&#160;links..............................................220<br/>
FIFO...................................................................517<br/>
synchronizing...............................................246<br/>
file&#160;command.......................................................17<br/>
temporary.....................................................514<br/>
file&#160;descriptor.......................................................57<br/>
text..................................................................17<br/>
file&#160;system&#160;corruption........................................188<br/>
transferring over&#160;a&#160;network..........206, 243, 246<br/>
File&#160;Transfer&#160;Protocol&#160;(FTP)..............................206<br/>
truncating........................................................56<br/>
filenames............................................................229<br/>
type.................................................................92<br/>
case&#160;sensitive..................................................12<br/>
viewing contents.............................................17<br/>
embedded spaces in................................12, 269<br/>
write&#160;access....................................................92<br/>
extensions.......................................................12<br/>
&#160;image...........................................................198<br/>
hidden.............................................................11<br/>
filters....................................................................62<br/>
leading&#160;hyphens............................................436<br/>
find command............................................219, 242<br/>
POSIX&#160;Portable&#160;Filename&#160;Character&#160;Set.....437<br/>
findutils package................................................233<br/>
problems with...............................................436<br/>
Firefox................................................................371<br/>
files...........................................................................<br/>
firewalls..............................................................202<br/>
access..............................................................91<br/>
first-in first-out...................................................517<br/>
archiving...............................................238, 244<br/>
floppy disks........................................................189<br/>
attributes.........................................................92<br/>
flow&#160;control..............................................................<br/>
bl<i>ock&#160;special</i>...................................................93<br/>
branching......................................................393<br/>
block special&#160;device.....................................220<br/>
case&#160;compound&#160;command............................444<br/>
changing file&#160;mode.........................................94<br/>
elif&#160;statement................................................400<br/>
changing owner&#160;and group&#160;owner................104<br/>
endless&#160;loop..................................................427<br/>
ch<i>aracter special</i>............................................93<br/>
for&#160;compound command...............................466<br/>
character&#160;special&#160;device................................220<br/>
for&#160;loop.........................................................466<br/>
compression..................................................234<br/>
functi<i>on s</i>tatement........................................385<br/>
configuration..................................18, 128, 273<br/>
if&#160;compound&#160;command.................................393<br/>
copying.....................................................28, 35<br/>
looping..........................................................423<br/>
copying over&#160;a&#160;network................................206<br/>
menu-driven.................................................419<br/>
creating empty................................................56<br/>
multiple-choice&#160;decisions.............................444<br/>
deb................................................................172<br/>
reading files with while&#160;and&#160;until&#160;loops.......428<br/>
deleting.............................................31, 39, 226<br/>
terminating a&#160;loop.........................................426<br/>
determining contents......................................17<br/>
traps..............................................................512<br/>
device&#160;nodes...................................................21<br/>
until&#160;loop......................................................428<br/>
execution access.............................................92<br/>
while&#160;loop.....................................................424<br/>
expressions...................................................396<br/>
fmt&#160;command.....................................................320<br/>
finding..........................................................217<br/>
focus policy............................................................4<br/>
hidden.............................................................11<br/>
<i>fold co</i>mmand.....................................................319<br/>
iso image......................................................197<br/>
for&#160;compound&#160;command....................................466<br/>
listing..........................................................8, 13<br/>
for&#160;loop...............................................................466<br/>
522<br/>
<hr/>
<a name=547></a>Index<br/>
Fortran programming language..................351, 469<br/>
hello world program...........................................365<br/>
free&#160;command.................................................5, 187<br/>
help command......................................................44<br/>
Free&#160;Software&#160;Foundation..........................xix, xxii<br/>
here&#160;documents..................................................379<br/>
fsck command....................................................195<br/>
here&#160;strings.........................................................417<br/>
ftp command..............................206, 214, 352, 380<br/>
hexadecimal.................................................95, 482<br/>
FTP&#160;servers.................................................206, 380<br/>
hidden files.....................................................11,&#160;70<br/>
FUNCNAME variable.......................................456<br/>
hierarchical&#160;directory&#160;structure..............................7<br/>
function&#160;<i>stat</i>emen<i>t</i>..............................................385<br/>
high-level&#160;programming languages....................351<br/>history......................................................................<br/>
expansion..................................................86, 88<br/>
<b>G</b><br/>
searching.........................................................86<br/>
gcc......................................................................352<br/>
history&#160;command..................................................86<br/>
gedit&#160;command...........................................116,&#160;135<br/>
home&#160;directories...................................................21<br/>
genisoimage&#160;command.......................................197<br/>
root&#160;account....................................................22<br/>
Gentoo................................................................172<br/>
/etc/passwd.....................................................92<br/>
getopts command...............................................465<br/>
home&#160;directory...........................8, 11,&#160;70, 102, 131<br/>
Ghostscript.........................................................340<br/>
HOME variable..................................................131<br/>
gid........................................................................91<br/>
hostname............................................................163<br/>
global&#160;variables..................................................387<br/>
HTML........................274, 309, 329, 371, 382, 384<br/>
globbing...............................................................26<br/>
Hypertext&#160;Markup Language.............................274<br/>
GNOME...............................2, 27, 41, 98, 135, 215<br/>gnome-terminal......................................................2<br/>GNU&#160;binutils package........................................468<br/>
<b>I</b><br/>
GNU&#160;C&#160;Compiler...............................................352<br/>
I/O&#160;redirection (see&#160;redirection)...........................54<br/>
GNU&#160;coreutils package...............46, 49p., 289, 313<br/>
ICMP&#160;ECHO_REQUEST..................................202<br/>
GNU&#160;findutils package......................................233<br/>
id command..........................................................91<br/>
GNU&#160;Project.........14, xix, xxii, 233, 313, 352, 354<br/>
IDE.....................................................................189<br/>
info command.................................................49<br/>
if&#160;compound command......................133, 432, 444<br/>
GNU/Linux.................................................xix, xxii<br/>
ifconfig command..............................................204<br/>
graphical&#160;user&#160;interfaces....................................xvii<br/>
IFS&#160;variable........................................................415<br/>
grep&#160;command......................................63, 251, 416<br/>
incremental&#160;backups...........................................242<br/>
groff....................................................................329<br/>
info files...............................................................49<br/>
group commands................................................505<br/>
init......................................................................110<br/>
groups...................................................................91<br/>
init&#160;scripts...........................................................110<br/>
effective&#160;group&#160;ID........................................100<br/>
inodes...................................................................38<br/>
gid...................................................................91<br/>
INSTALL...........................................................355<br/>
primary&#160;group ID............................................91<br/>
installation wizard..............................................173<br/>
setgid............................................................100<br/>
integers.....................................................................<br/>
GUI................................3, xvii, 27, 41, 81, 98, 132<br/>
arithmetic................................................71, 491<br/>
gunzip command................................................235<br/>
division...................................................72, 483<br/>
gzip command..............................................50, 235<br/>
expressions...................................................400<br/>
interactivity........................................................410<br/>Internal&#160;Field Separator......................................415<br/>
<b>H</b><br/>
interpreted&#160;languages.........................................351<br/>
halt&#160;command.....................................................123<br/>
interpreted&#160;programs..........................................352<br/>
hard&#160;disks...........................................................182<br/>
interpreter...........................................................351<br/>
hard&#160;links........................................................24, 34<br/>
ip command........................................................204<br/>
creating...........................................................37<br/>
iso images........................................................197p.<br/>
listing..............................................................38<br/>
iso9660.......................................................186, 198<br/>
head&#160;command.....................................................64<br/>header&#160;files.........................................................356<br/>
523<br/>
<hr/>
<a name=548></a>Index<br/>
<b>J</b><br/>
Red Hat&#160;Enterprise&#160;Linux.............................173<br/>
job control..........................................................117<br/>
Slackware.....................................................172<br/>
job numbers........................................................117<br/>
Ubuntu................................................xix, 172p.<br/>
jobspec................................................................118<br/>
Linux Filesystem&#160;Hierarchy&#160;Standard.&#160;.&#160;.19, 24, 368<br/>
join command.....................................................291<br/>
Linux kernel......xvi, xixp., 47, 110,&#160;121, 180, 189,&#160;<br/>
Joliet&#160;extensions.................................................198<br/>
297, 360<br/>
Joy, Bill..............................................................142<br/>
device&#160;drivers...............................................180<br/>
literal&#160;characters.................................................254<br/>live&#160;CDs..............................................................xix<br/>
<b>K</b><br/>
ln command....................................................33, 37<br/>
kate&#160;command....................................................135<br/>
local&#160;variables....................................................387<br/>
KDE.....................................2, 28, 41, 98, 135, 215<br/>
locale..........................................259, 261, 299, 400<br/>
kedit&#160;command...................................................135<br/>
locale&#160;command.................................................261<br/>
kernel...xvi, xixp., 47, 110,&#160;121, 180, 189, 297, 360<br/>
localhost.............................................................210<br/>
key fields............................................................280<br/>
locate&#160;command.........................................217, 269<br/>
kill&#160;command......................................................119<br/>
logical&#160;errors......................................................434<br/>
killall&#160;command.................................................122<br/>
logical&#160;operations...............................................404<br/>
killing text............................................................82<br/>
logical&#160;operators.................................................222<br/>
Knuth, Donald....................................................328<br/>
logical&#160;relationships...................................222, 226<br/>
Konqueror............................................................28<br/>
login prompt...................................................5, 208<br/>
konsole...................................................................2<br/>
login shell.............................................92, 102, 131<br/>
kwrite&#160;command.........................................116,&#160;135<br/>
long options..........................................................14<br/>loopback interface..............................................205<br/>
<b>L</b><br/>
looping...............................................................423<br/>loops...................................434, 484, 487, 503, 510<br/>
LANG&#160;variable...................................131, 260, 262<br/>
<i>lossless</i>&#160;compression..........................................235<br/>
less command.................................17, 61, 246, 270<br/>
<i>lossy</i>&#160;compression..............................................235<br/>
lftp command.....................................................209<br/>
lowercase&#160;to upperca<i>se&#160;conver</i>sion....................481<br/>
libraries..............................................................351<br/>
lp command........................................................343<br/>
LibreOffice&#160;Writer.......................................18, xxii<br/>
lpq command......................................................348<br/>
line&#160;continuation character.................................369<br/>
lpr&#160;command......................................................342<br/>
line&#160;editors..........................................................142<br/>
lprm&#160;command...................................................349<br/>
line-continuation character.................................308<br/>
lpstat&#160;command..................................................347<br/>
linker..................................................................351<br/>
ls command......................................................8, 13<br/>
linking................................................................351<br/>
long format.....................................................16<br/>
links..........................................................................<br/>
viewing file&#160;attributes.....................................92<br/>
broken.............................................................40<br/>
Lukyanov,&#160;Alexander.........................................209<br/>
creating...........................................................33<br/>
LVM (Logical&#160;Volume&#160;Manager)...............182, 185<br/>
hard...........................................................24, 34<br/>symbolic...................................................23, 34<br/>
Linux community...............................................172<br/>
<b>M</b><br/>
Linux distributions.............................................172<br/>
machine&#160;language...............................................350<br/>
Arch..............................................................172<br/>
maintenance...............................368, 372, 374, 383<br/>
CentOS.........................................................173<br/>
make&#160;command..................................................357<br/>
Debian...............................................172p., 350<br/>
makefile..............................................................357<br/>
Fedora..............................................xix, 91, 173<br/>
man command......................................................46<br/>
Gentoo..........................................................172<br/>
man pages.....................................................46, 329<br/>
Linux Mint....................................................173<br/>
markup languages......................................274, 329<br/>
OpenSUSE............................................xix, 173<br/>
memory....................................................................<br/>
packaging systems........................................172<br/>
assigned&#160;to each&#160;process...............................111<br/>
Raspbian.......................................................173<br/>
displaying free..................................................5<br/>
524<br/>
<hr/>
<a name=549></a>Index<br/>
Resident&#160;set&#160;size...........................................113<br/>
tracing the&#160;route&#160;to a&#160;host.............................203<br/>
segmentation violation.................................122<br/>
transferring files...........................................246<br/>
usage.............................................................113<br/>
transporting files...........................................206<br/>
viewing usage...............................................124<br/>
virtual&#160;private&#160;network.................................213<br/>
virtual............................................................113<br/>
newline&#160;character...............................................163<br/>
menu-driven&#160;programs.......................................419<br/>
newlines...............................................................77<br/>
meta&#160;key...............................................................83<br/>
NEWS................................................................355<br/>
meta&#160;sequences...................................................254<br/>
nl&#160;command........................................................315<br/>
metacharacters....................................................254<br/>
nroff&#160;command...................................................328<br/>
metadata.....................................................173, 175<br/>
null&#160;character......................................................229<br/>
mkdir&#160;command.............................................28, 34<br/>
number&#160;bases......................................................482<br/>
mkfifo command................................................517<br/>mkfs command...................................................194<br/>mkisofs command..............................................198<br/>
<b>O</b><br/>
mktemp command..............................................514<br/>
octal......................................................95, 482, 498<br/>
mnemonics.........................................................351<br/>
Ogg&#160;Vorbis.........................................................106<br/>
modal&#160;editor.......................................................145<br/>
OLD_PWD&#160;variable...........................................131<br/>
monospaced&#160;fonts...............................................340<br/>
OpenOffice.org&#160;Writer.................................xx, xxii<br/>
Moolenaar, Bram................................................142<br/>
OpenSSH............................................................210<br/>
more&#160;command.....................................................19<br/>
operators...................................................................<br/>
mount&#160;command.........................................184, 198<br/>
arithmetic................................................71, 483<br/>
mount&#160;points.........................................21, 184, 186<br/>
assignment....................................................485<br/>
mounting............................................................183<br/>
binary............................................................433<br/>
MP3....................................................................106<br/>
comparison...................................................488<br/>
multi-user&#160;systems...............................................90<br/>
ternary...........................................................489<br/>
multiple-choice&#160;decisions...................................444<br/>
owning files..........................................................91<br/>
multitasking..........................................90, 110,&#160;515<br/>mv command..................................................30, 36<br/>
<b>P<br/></b>package&#160;files.......................................................173<br/>
<b>N</b><br/>
package&#160;maintainers...........................................173<br/>
named pipes.......................................................516<br/>
package&#160;management.........................................172<br/>
nano command...................................................141<br/>
deb................................................................172<br/>
Nautilus................................................................27<br/>
Debian Style&#160;(.deb).......................................173<br/>
netstat&#160;command................................................205<br/>
finding packages...........................................175<br/>
networking.........................................................201<br/>
high-level&#160;tools.............................................174<br/>
anonymous FTP&#160;servers...............................207<br/>
installing packages.......................................175<br/>
default&#160;route..................................................206<br/>
Low-level&#160;tools.............................................174<br/>
Dynamic&#160;Host&#160;Configuration Protocol&#160;(DHCP)<br/>
package&#160;repositories.....................................173<br/>
......................................................................205<br/>
Red Hat&#160;Style&#160;(.rpm)....................................173<br/>
encrypted&#160;tunnels..........................................213<br/>
removing packages.......................................176<br/>
examine&#160;network&#160;settings and&#160;statistics.......205<br/>
RPM.............................................................172<br/>
File&#160;Transfer&#160;Protocol&#160;(FTP)........................206<br/>
updating packages........................................177<br/>
firewalls........................................................202<br/>
packaging systems.............................................172<br/>
FTP&#160;servers...................................................206<br/>
page&#160;description language..................274, 331, 339<br/>
local&#160;area&#160;network........................................206<br/>
PAGER&#160;variable.................................................131<br/>
loopback&#160;interface........................................205<br/>
pagers...................................................................19<br/>
man in the&#160;middle&#160;attacks.............................210<br/>
parameter&#160;expansion..............................73, 76, 473<br/>
routers...........................................................204<br/>
parent&#160;directory......................................................8<br/>
secure&#160;communication with remote&#160;hosts....210<br/>
parent&#160;process.....................................................110<br/>
testing if&#160;a&#160;host&#160;is alive.................................202<br/>
passwd command...............................................108<br/>
525<br/>
<hr/>
<a name=550></a>Index<br/>
passwords...........................................................108<br/>
pretty.............................................................344<br/>
paste&#160;command...................................................290<br/>
print&#160;queues..................................................347<br/>
PATA..................................................................189<br/>
proportional&#160;fonts.........................................339<br/>
patch command..................................................297<br/>
queue............................................................348<br/>
patches................................................................295<br/>
spooling........................................................347<br/>
PATH&#160;variable............................131, 133, 366, 385<br/>
terminate&#160;print&#160;jobs.......................................349<br/>
pathname&#160;expansion...............................69, 76, 467<br/>
viewing jobs.................................................348<br/>
pathnames..........................................................269<br/>
process&#160;ID...........................................................111<br/>
absolute.............................................................9<br/>
process&#160;substitution............................................509<br/>
completion......................................................83<br/>
processes............................................................110<br/>
relative..............................................................9<br/>
background...................................................117<br/>
pa<i>ttern</i>................................................................481<br/>
child..............................................................110<br/>
PDF............................................................332, 342<br/>
controlling.....................................................116<br/>
Perl&#160;programming language.42, 251, 309, 351, 491<br/>
foreground....................................................117<br/>
permissions........................................................364<br/>
interrupting...................................................117<br/>
PHP&#160;programming language..............................351<br/>
job control.....................................................117<br/>
ping command....................................................202<br/>
killing............................................................119<br/>
pipelines...............................................61, 417, 509<br/>
nice...............................................................112<br/>
in command substitution................................75<br/>
parent............................................................110<br/>
portability...........................................357, 391, 407<br/>
PID................................................................111<br/>
portable..............................................................391<br/>
process ID.....................................................111<br/>
Portable&#160;Document&#160;Format........................332, 342<br/>
SIGINT.........................................................512<br/>
Portable&#160;Operating System&#160;Interface.................263<br/>
signals...........................................................119<br/>
pos<i>itional&#160;p</i>arameters......................451, 474p., 477<br/>
SIGTERM....................................................512<br/>
POSIX.............................................259, 262p., 407<br/>
sleeping.........................................................112<br/>
character&#160;classes.....26p., 258, 260p., 265, 299,&#160;<br/>
state...............................................................112<br/>
309<br/>
stopping........................................................118<br/>
POSIX-...............................................................198<br/>
viewing.................................................111, 113<br/>
PostScript...........................274, 331, 339, 344, 349<br/>
zombie..........................................................112<br/>
poweroff&#160;command............................................123<br/>
production use....................................................438<br/>
pr&#160;command...............................................323, 340<br/>
programmable&#160;completion...................................85<br/>
primary group&#160;ID.................................................91<br/>
ps command........................................................111<br/>
printable&#160;characters............................................259<br/>
PS1 variable...............................................131, 162<br/>
printenv command.......................................74, 128<br/>
PS2 variable.......................................................373<br/>
printer&#160;buffers.....................................................187<br/>
ps2pdf&#160;command................................................332<br/>
printers.......................................................187, 189<br/>
PS4 variable.......................................................441<br/>
buffering&#160;output............................................187<br/>
pseudocode.................................................393, 423<br/>
control&#160;codes................................................338<br/>
pstree&#160;command.................................................124<br/>
daisy-wheel...................................................338<br/>
PuTTY................................................................215<br/>
device&#160;names................................................189<br/>
pwd command........................................................8<br/>
drivers...........................................................340<br/>
PWD&#160;variable.....................................................131<br/>
graphical.......................................................339<br/>
Python programming language..........................351<br/>
impact...........................................................338<br/>laser..............................................................339<br/>
printf&#160;command..........................................324, 472<br/>
<b>Q</b><br/>
printing.....................................................................<br/>
quoting.................................................................75<br/>
determining system&#160;status............................347<br/>
double&#160;quotes..................................................76<br/>
history of......................................................337<br/>
escape&#160;character..............................................78<br/>
Internet&#160;Printing Protocol.............................347<br/>
missing quote................................................431<br/>
monospaced fonts.........................................338<br/>
single&#160;quotes...................................................78<br/>
preparing&#160;text................................................340<br/>
526<br/>
<hr/>
<a name=551></a>Index<br/>
<b>R</b><br/>
rsync&#160;command..................................................246<br/>
RAID&#160;(Redundant&#160;Array&#160;of&#160;Independent&#160;Disks)<br/>
rsync&#160;remote-update&#160;protocol............................246<br/>
............................................................................182<br/>
Ruby programming language.............................351<br/>
ra<i>ster&#160;image&#160;process</i>or.......................................340<br/>read&#160;command....................411,&#160;421, 429, 437, 509<br/>
<b>S</b><br/>
Readline...............................................................81<br/>
scalar&#160;variables...................................................495<br/>
README.....................................................50, 355<br/>
Schilling, Jorg....................................................198<br/>
reboot&#160;command.................................................123<br/>
scp command.....................................................214<br/>
redirection................................................................<br/>
script&#160;command....................................................88<br/>
blocked&#160;pipe.................................................517<br/>
scripting languages.......................................42, 351<br/>
group&#160;commands and subshells....................505<br/>
sdiff&#160;command....................................................314<br/>
here&#160;documents.............................................379<br/>
searching a&#160;file&#160;for&#160;patterns..................................63<br/>
here&#160;strings...................................................417<br/>
searching history..................................................86<br/>
standard error..................................................57<br/>
Secure&#160;Shell.......................................................210<br/>
standard input.........................................58, 380<br/>
sed command.....................................301, 332, 478<br/>
standard output...............................................55<br/>
set&#160;command..............................................128, 441<br/>
redirection operators................................................<br/>
setgid..................................................................100<br/>
&amp;&gt;...................................................................58<br/>
<i>setu</i>id..........................................................100, 397<br/>
&amp;&gt;&gt;................................................................58<br/>
Seward,&#160;Julian....................................................237<br/>
&lt;......................................................................60<br/>
sftp command.....................................................214<br/>
&lt;(<i>list</i>)............................................................509<br/>
shared&#160;libraries.............................................21, 174<br/>
&lt;&lt;.........................................................379, 381<br/>
shebang......................................................365, 370<br/>
&lt;&lt;-................................................................381<br/>
shell&#160;builtins.........................................................42<br/>
&lt;&lt;&lt;...............................................................417<br/>
shell&#160;functions..............................42, 128, 385, 456<br/>
&gt;......................................................................55<br/>
shell&#160;prompts&#160;2, 9, 87, 102, 116,&#160;131, 162, 211, 373<br/>
&gt;(<i>list</i>)............................................................510<br/>
shell&#160;scripts.........................................................364<br/>
&gt;&gt;...................................................................56<br/>
SHELL&#160;variable.................................................131<br/>
|.......................................................................61<br/>
shell&#160;variables.....................................................128<br/>
regular&#160;expressions...............63, 251, 305, 402, 416<br/>
shift&#160;command............................................454, 460<br/>
anchors.........................................................255<br/>
shutdown&#160;command...........................................123<br/>
back references..................................272, 304p.<br/>
SIGINT..............................................................512<br/>
b<i>asic</i>..........................262, 271p., 302, 306, 316<br/>
signals.................................................................511<br/>
extended.......................................................262<br/>
single&#160;quotes.........................................................78<br/>
relational&#160;databases............................................291<br/>
Slackware...........................................................172<br/>
relative&#160;pathnames.................................................9<br/>
sleep command...................................................426<br/>
release&#160;early, release&#160;often.................................438<br/>
soft&#160;link................................................................23<br/>
removing duplicate&#160;lines in a&#160;file.........................62<br/>
sort&#160;command...............................................62, 277<br/>
REPLY&#160;variable..........................................411,&#160;509<br/>
sort&#160;keys.............................................................280<br/>
report&#160;generator..................................................371<br/>
source&#160;code..............................172p., 180, 274, 350<br/>
repositories.........................................................173<br/>
source&#160;command........................................140, 367<br/>
return&#160;command.........................................386, 398<br/>
source&#160;tree..........................................................354<br/>
reusable..............................................................391<br/>
special&#160;parameters......................................456, 475<br/>
RI<i>P</i>.....................................................................340<br/>
split&#160;command....................................................314<br/>
rlogin command.................................................209<br/>
SSH....................................................................210<br/>
rm&#160;command........................................................31<br/>
ssh command..............................................210, 243<br/>
Rock&#160;Ridge&#160;extensions.......................................198<br/>
ssh program..........................................................90<br/>
roff......................................................................328<br/>
Stallman, Richard........xvi, xix, xxii, 135, 263, 352<br/>
ROT13 encoding................................................300<br/>
standard&#160;error..............................................54, 56p.<br/>
RPM...................................................................172<br/>
disposing of....................................................58<br/>
rpm&#160;command....................................................175<br/>
redirecting to a&#160;file.........................................57<br/>
527<br/>
<hr/>
<a name=552></a>Index<br/>
standard&#160;input.......................................55, 380, 411<br/>
<b>T</b><br/>
redirecting.......................................................58<br/>
tables..................................................................291<br/>
standard&#160;output.....................................................54<br/>
tabular&#160;data.................................................280, 327<br/>
appending to a&#160;file..........................................56<br/>
tail&#160;command........................................................64<br/>
disposing of....................................................58<br/>
tape&#160;archive........................................................239<br/>
redirecting standard error&#160;to...........................57<br/>
tar&#160;command.......................................................239<br/>
redirecting to a&#160;file.........................................55<br/>
tarballs................................................................354<br/>
startup files.........................................................131<br/>
targets.................................................................358<br/>
stat&#160;command.....................................................231<br/>
Task Manager.....................................................115<br/>
sticky&#160;bit.............................................................100<br/>
Tatham, Simon...................................................215<br/>
storage&#160;devices...................................................182<br/>
tbl&#160;command...............................................329, 332<br/>
audio CDs.............................................186, 197<br/>
tee&#160;command........................................................65<br/>
CD-ROMs.........................................185p., 197<br/>
teletype...............................................................111<br/>
creating file&#160;systems.....................................191<br/>
telnet&#160;command..................................................209<br/>
device&#160;names................................................188<br/>
TERM variable...................................................131<br/>
disk partitions...............................................183<br/>
terminal&#160;emulators.................................................2<br/>
FAT32...........................................................191<br/>
terminal&#160;sessions......................................................<br/>
floppy disks..................................................189<br/>
controlling terminal......................................111<br/>
formatting.....................................................191<br/>
effect&#160;of&#160;.bashrc............................................367<br/>
LVM (Logical&#160;Volume&#160;Manager).................185<br/>
environment..................................................102<br/>
mount&#160;points.........................................184, 186<br/>
exiting...............................................................5<br/>
partitions.......................................................192<br/>
login shell.............................................102, 131<br/>
reading and&#160;writing directly.........................196<br/>
TERM variable.............................................131<br/>
repairing file&#160;systems...................................195<br/>
using named&#160;pipes........................................517<br/>
unmounting...................................................187<br/>
virtual...............................................................5<br/>
USB&#160;flash drives...........................................196<br/>
with remote&#160;systems.......................................90<br/>
stream&#160;editor.......................................................301<br/>
terminals..............................83, 89p., 165, 328, 338<br/>
strings.......................................................................<br/>
ternary operator..................................................489<br/>
expressions...................................................399<br/>
test&#160;cases.............................................................439<br/>
extract&#160;a&#160;portion of.......................................477<br/>
test&#160;command.....................................396, 402, 433<br/>
length of........................................................476<br/>
test&#160;coverage.......................................................439<br/>
perform&#160;search&#160;and replace&#160;upon.................478<br/>
testing..............................................................438p.<br/>
remove&#160;leading&#160;portion of............................477<br/>
TEX....................................................................328<br/>
remove&#160;trailing portion of............................478<br/>
text........................................................................17<br/>
${<i>parameter</i>:<i>offset</i>:len<i>gth}</i>...........................477<br/>
adjusting line&#160;length..................................319p.<br/>
${<i>parameter</i>:<i>offset</i>}......................................477<br/>
ASCII.............................................................18<br/>
strings command................................................468<br/>
carriage&#160;return..............................................276<br/>
stubs...........................................................389, 438<br/>
comparing.....................................................293<br/>
style....................................................................355<br/>
converting MS-DOS&#160;to Unix........................299<br/>
su command.......................................................101<br/>
counting words...............................................63<br/>
subshells.....................................................417, 505<br/>
cutting...........................................................286<br/>
sudo command...........................................101, 103<br/>
deleting duplicate&#160;lines.................................284<br/>
Sun Microsystems..............................................142<br/>
deleting multiple&#160;blank&#160;lines........................276<br/>
superuser..........................................3, 92, 102, 123<br/>
detecting differences.....................................295<br/>
symbolic&#160;links..........................................23, 34, 38<br/>
displaying common lines..............................294<br/>
creating.....................................................38, 41<br/>
displaying control&#160;characters........................275<br/>
listing..............................................................39<br/>
DOS&#160;format..................................................276<br/>
symlink.................................................................23<br/>
EDITOR&#160;variable.........................................131<br/>
syntax&#160;errors.......................................................430<br/>
editors...................................................135, 273<br/>
syntax&#160;highlighting.....................................364, 369<br/>
expanding tabs..............................................289<br/>
528<br/>
<hr/>
<a name=553></a>Index<br/>
files.................................................................17<br/>
traps....................................................................512<br/>
filtering...........................................................62<br/>
troff&#160;command....................................................328<br/>
folding.......................................................319p.<br/>
true&#160;command.....................................................395<br/>
formatting.....................................................315<br/>
TTY....................................................................111<br/>
formatting for&#160;typesetters.............................328<br/>
type&#160;command......................................................43<br/>
formatting tables...........................................332<br/>
typesetters..................................................329, 339<br/>
joining...........................................................291<br/>
TZ variable.........................................................131<br/>
linefeed character.........................................276<br/>lowercase&#160;to uppercase&#160;con<i>version</i>..............299<br/>numbering&#160;lines....................................276, 315<br/>
<b>U</b><br/>
paginating.....................................................323<br/>
Ubuntu..................................91, 104, 172, 259, 367<br/>
pasting..........................................................290<br/>
umask command..........................................98, 107<br/>
preparing&#160;for&#160;printing...................................340<br/>
umount&#160;command...............................................187<br/>
removing duplicate&#160;lines................................62<br/>
unalias command.................................................52<br/>
rendering&#160;in PostScript.................................331<br/>
unary&#160;operator&#160;expected.....................................433<br/>
ROT13 encoded............................................300<br/>
unary&#160;operators...................................................483<br/>
searching&#160;for&#160;patterns.....................................63<br/>
unexpand&#160;command...........................................289<br/>
sorting.....................................................62, 277<br/>
unexpected token...............................................432<br/>
spell&#160;checking...............................................309<br/>
uniq command..............................................62, 284<br/>
substituting...................................................304<br/>
Unix...................................................................xvii<br/>
substituting tabs for&#160;spaces...........................289<br/>
Unix System&#160;V...................................................342<br/>
tab-delimited.................................................288<br/>
unix2dos command............................................276<br/>
transliterating characters..............................299<br/>
unset&#160;command..................................................502<br/>
Unix format..................................................276<br/>
until&#160;compound command..................................428<br/>
viewing with less......................................17, 61<br/>
until&#160;loop............................................................428<br/>
text&#160;editors..........................................135, 273, 298<br/>
unzip command..................................................244<br/>
emacs............................................................135<br/>
updatedb command............................................219<br/>
for&#160;writing shell&#160;scripts.................................364<br/>
upstream&#160;providers.............................................173<br/>
gedit......................................................135, 364<br/>
uptime................................................................384<br/>
interactive.....................................................298<br/>
uptime&#160;command................................................390<br/>
kate.......................................................135, 364<br/>
USB&#160;flash&#160;drives........................................182, 196<br/>
kedit..............................................................135<br/>
Usenet................................................................300<br/>
kwrite............................................................135<br/>
USER&#160;variable...........................................129, 131<br/>
line................................................................142<br/>
users.........................................................................<br/>
nano......................................................135, 141<br/>
accounts..........................................................91<br/>
pico...............................................................135<br/>
changing identity..........................................101<br/>
stream...........................................................301<br/>
changing passwords......................................108<br/>
syntax highlighting...............................364, 369<br/>
effective&#160;user&#160;ID...................................100, 111<br/>
vi...................................................................135<br/>
home&#160;directory................................................92<br/>
vim................................................135, 364, 369<br/>
identity............................................................91<br/>
visual............................................................142<br/>
password.........................................................92<br/>
tilde&#160;expansion...............................................70, 76<br/>
setting default&#160;permissions.............................98<br/>
tload&#160;command...................................................124<br/>
setuid............................................................100<br/>
top command......................................................113<br/>
superuser................................92, 94, 100p., 109<br/>
top-down design.................................................383<br/>
/etc/passwd.....................................................92<br/>
Torvalds, Linus............................................xvi, xxi<br/>
/etc/shadow.....................................................92<br/>
touch command.......................230p., 247, 360, 461<br/>
UUID..................................................................184<br/>
tr&#160;command........................................................299<br/>traceroute&#160;command...........................................203<br/>
<b>V</b><br/>
tracing................................................................440<br/>
validating input..................................................418<br/>
transliterating characters....................................299<br/>
529<br/>
<hr/>
<a name=554></a>Index<br/>
variables...............................................74, 374, 473<br/>
zless command.....................................................50<br/>
assigning values....................................377, 484<br/>constants.......................................................376<br/>declaring...............................................375, 377<br/>
<b>-</b><br/>
environment..................................................128<br/>
--help&#160;option.........................................................45<br/>
global............................................................387<br/>local..............................................................387<br/>
<b>.</b><br/>
names....................................................376, 476<br/>
./configure..........................................................356<br/>
scalar.............................................................495<br/>
.bash_history........................................................86<br/>
shell..............................................................128<br/>
.bash_login.........................................................132<br/>
vfat.....................................................................195<br/>
.bash_profile.......................................................132<br/>
vi&#160;command........................................................141<br/>
.bashrc................................132, 135, 367, 391, 456<br/>
vim&#160;command.............................................271, 369<br/>
.profile................................................................132<br/>
virtual&#160;consoles......................................................5<br/>
.ssh/known_hosts...............................................212<br/>
virtual&#160;private&#160;network.......................................213<br/>virtual&#160;terminals.....................................................5<br/>visual&#160;editors......................................................142<br/>
<b>(</b><br/>
vmstat&#160;command................................................124<br/>
((&#160;))&#160;compound command...........................482, 488<br/>
<b>W</b><br/>
<b>[</b><br/>
wait&#160;command....................................................515<br/>
[&#160;command.........................................................432<br/>
wc&#160;command........................................................63<br/>
[[]]&#160;compound command....................................424<br/>
web pages...........................................................274<br/>wget&#160;command...................................................209<br/>What&#160;You See&#160;Is&#160;What&#160;You&#160;Get.........................338<br/>
<b>/</b><br/>
whatis command..................................................48<br/>
/............................................................................20<br/>
which command.............................................43, 74<br/>
/bin.......................................................................20<br/>
while&#160;compound command................................424<br/>
/boot.....................................................................20<br/>
wildcards..................................26, 59, 68, 251, 258<br/>
/boot/grub/grub.conf............................................20<br/>
wodim&#160;command................................................199<br/>
/boot/vmlinuz.......................................................20<br/>
word-splitting....................................................76p.<br/>
/dev.......................................................................21<br/>
world....................................................................91<br/>
/dev/cdrom.........................................................189<br/>
WYSIWYG........................................................338<br/>
/dev/dvd..............................................................189<br/>/dev/floppy.........................................................189<br/>/dev/null...............................................................58<br/>
<b>X</b><br/>
/etc........................................................................21<br/>
X&#160;Window&#160;System...................................3, 90, 213<br/>
/etc/bash.bashrc..................................................132<br/>
xargs&#160;command..................................................228<br/>
/etc/crontab...........................................................21<br/>
xload command..................................................124<br/>
/etc/fstab...............................................21, 183, 195<br/>
xlogo command..................................................116<br/>
/etc/group.............................................................92<br/>
XML...................................................................274<br/>
/etc/passwd.............................21, 92, 283, 289, 416<br/>/etc/profile.......................................................132p.<br/>
<b>Y</b><br/>
/etc/shadow..........................................................92<br/>/etc/sudoers........................................................101<br/>
yanking text..........................................................82<br/>
/lib........................................................................21<br/>
yum&#160;command....................................................175<br/>
/lost+found...........................................................21<br/>/media...................................................................21<br/>
<b>Z</b><br/>
/mnt......................................................................21<br/>
zgrep&#160;command..................................................271<br/>
/opt.......................................................................22<br/>
zip command......................................................244<br/>
/proc.....................................................................22<br/>
530<br/>
<hr/>
<a name=555></a>Index<br/>
/root..............................................................22, 102<br/>
${!<i>prefix</i>@}........................................................476<br/>
/sbin......................................................................22<br/>
${!<i>prefix</i>*}.........................................................476<br/>
/tmp..............................................................22, 514<br/>
${#<i>parameter</i>}...................................................476<br/>
/usr........................................................................22<br/>
${<i>parameter</i>,,<i>pattern</i>}........................................481<br/>
/usr/bin.................................................................22<br/>
${<i>parameter</i>,<i>pattern</i>}.........................................481<br/>
/usr/lib..................................................................22<br/>
${<i>parameter</i>:-<i>word</i>}...........................................474<br/>
/usr/local...............................................................22<br/>
${<i>parameter</i>:?<i>word</i>}..........................................475<br/>
/usr/local/bin........................................22, 360, 368<br/>
${<i>parameter</i>:+<i>word</i>}..........................................476<br/>
/usr/local/sbin.....................................................368<br/>
${<i>parameter</i>:=<i>word</i>}..........................................475<br/>
/usr/sbin................................................................22<br/>
${<i>parameter</i>/<i>/patter</i>n<i>/strin</i>g}.............................478<br/>
/usr/share..............................................................22<br/>
${<i>parameter</i>/<i>#patter</i>n<i>/strin</i>g}............................478<br/>
/usr/share/dict.....................................................256<br/>
${<i>parameter</i>/<i>%patter</i>n<i>/strin</i>g}...........................478<br/>
/usr/share/doc.................................................23, 50<br/>
${<i>parameter</i>/<i>pattern</i>/<i>string</i>}..............................478<br/>
/var.......................................................................23<br/>
${<i>parameter</i>#<i>#patter</i>n}......................................477<br/>
/var/log.................................................................23<br/>
${<i>parameter</i>#<i>pattern</i>}........................................477<br/>
/var/log/messages...................................23, 65, 189<br/>
${<i>parameter</i>%<i>%patter</i>n}...................................478<br/>
/var/log/syslog........................................23, 65, 189<br/>
${<i>parameter</i>%<i>pattern</i>}......................................478<br/>${<i>parameter</i>^^<i>pattern</i>}......................................481<br/>${<i>parameter</i>^<i>pattern</i>}........................................481<br/>
<b>$</b><br/>
$@..............................................................457, 465<br/>
$!........................................................................516<br/>
$*................................................................457, 465<br/>
$((<i>expression</i>))...................................................482<br/>
$#........................................................................452<br/>
${!<i>array</i>[@]}.....................................................500<br/>
$0........................................................................456<br/>
${!<i>array</i>[*]}.......................................................500<br/>
531<br/>
<hr/>
<a name="outline"></a><h1>Document Outline</h1>
<ul>
<li><a href="linux-command-lines.html#18">Introduction</a>
<ul>
<li><a href="linux-command-lines.html#18">Why Use the Command Line?</a></li>
<li><a href="linux-command-lines.html#19">What This Book Is About</a></li>
<li><a href="linux-command-lines.html#19">Who Should Read This Book</a></li>
<li><a href="linux-command-lines.html#20">What's in This Book</a></li>
<li><a href="linux-command-lines.html#21">How To Read This Book</a>
<ul>
<li><a href="linux-command-lines.html#21">Prerequisites</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#22">What's New in the Fifth Internet Edition</a></li>
<li><a href="linux-command-lines.html#22">Acknowledgments</a>
<ul>
<li><a href="linux-command-lines.html#22">First Internet Edition</a></li>
<li><a href="linux-command-lines.html#23">Second Internet Edition</a></li>
<li><a href="linux-command-lines.html#23">Third Internet Edition</a></li>
<li><a href="linux-command-lines.html#23">Fourth Internet Edition</a></li>
<li><a href="linux-command-lines.html#23">Fifth Internet Edition</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#23">Your Feedback Is Needed!</a></li>
<li><a href="linux-command-lines.html#23">Further Reading</a></li>
<li><a href="linux-command-lines.html#24">Colophon</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#25">Part 1 – Learning the Shell</a>
<ul>
<li><a href="linux-command-lines.html#26">1 – What Is the Shell?</a>
<ul>
<li><a href="linux-command-lines.html#26">Terminal Emulators</a></li>
<li><a href="linux-command-lines.html#26">Making Your First Keystrokes</a>
<ul>
<li><a href="linux-command-lines.html#27">Command History</a></li>
<li><a href="linux-command-lines.html#27">Cursor Movement</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#28">Try Some Simple Commands</a></li>
<li><a href="linux-command-lines.html#29">Ending a Terminal Session</a></li>
<li><a href="linux-command-lines.html#29">Summing Up</a></li>
<li><a href="linux-command-lines.html#30">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#31">2 – Navigation</a>
<ul>
<li><a href="linux-command-lines.html#31">Understanding the File System Tree</a></li>
<li><a href="linux-command-lines.html#31">The Current Working Directory</a></li>
<li><a href="linux-command-lines.html#32">Listing the Contents of a Directory</a></li>
<li><a href="linux-command-lines.html#33">Changing the Current Working Directory</a>
<ul>
<li><a href="linux-command-lines.html#33">Absolute Pathnames</a></li>
<li><a href="linux-command-lines.html#33">Relative Pathnames</a></li>
<li><a href="linux-command-lines.html#35">Some Helpful Shortcuts</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#36">Summing Up</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#37">3 – Exploring the System</a>
<ul>
<li><a href="linux-command-lines.html#37">Having More Fun with ls</a>
<ul>
<li><a href="linux-command-lines.html#38">Options and Arguments</a></li>
<li><a href="linux-command-lines.html#40">A Longer Look at Long Format</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#41">Determining a File's Type with file</a></li>
<li><a href="linux-command-lines.html#41">Viewing File Contents with less</a></li>
<li><a href="linux-command-lines.html#43">Taking a Guided Tour</a></li>
<li><a href="linux-command-lines.html#47">Symbolic Links</a></li>
<li><a href="linux-command-lines.html#48">Hard Links</a></li>
<li><a href="linux-command-lines.html#48">Summing Up</a></li>
<li><a href="linux-command-lines.html#48">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#49">4 – Manipulating Files and Directories</a>
<ul>
<li><a href="linux-command-lines.html#49">Wildcards</a></li>
<li><a href="linux-command-lines.html#52">mkdir – Create Directories</a></li>
<li><a href="linux-command-lines.html#52">cp – Copy Files and Directories</a>
<ul>
<li><a href="linux-command-lines.html#53">Useful Options and Examples</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#54">mv – Move and Rename Files</a>
<ul>
<li><a href="linux-command-lines.html#54">Useful Options and Examples</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#55">rm – Remove Files and Directories</a>
<ul>
<li><a href="linux-command-lines.html#56">Useful Options and Examples</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#57">ln – Create Links</a>
<ul>
<li><a href="linux-command-lines.html#57">Hard Links</a></li>
<li><a href="linux-command-lines.html#58">Symbolic Links</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#58">Let's Build a Playground</a>
<ul>
<li><a href="linux-command-lines.html#58">Creating Directories</a></li>
<li><a href="linux-command-lines.html#59">Copying Files</a></li>
<li><a href="linux-command-lines.html#60">Moving and Renaming Files</a></li>
<li><a href="linux-command-lines.html#61">Creating Hard Links</a></li>
<li><a href="linux-command-lines.html#62">Creating Symbolic Links</a></li>
<li><a href="linux-command-lines.html#63">Removing Files and Directories</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#65">Summing Up</a></li>
<li><a href="linux-command-lines.html#65">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#66">5 – Working with Commands</a>
<ul>
<li><a href="linux-command-lines.html#66">What Exactly Are Commands?</a></li>
<li><a href="linux-command-lines.html#67">Identifying Commands</a>
<ul>
<li><a href="linux-command-lines.html#67">type – Display a Command's Type</a></li>
<li><a href="linux-command-lines.html#67">which – Display an Executable's Location</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#68">Getting a Command's Documentation</a>
<ul>
<li><a href="linux-command-lines.html#68">help – Get Help for Shell Builtins</a></li>
<li><a href="linux-command-lines.html#69">--help – Display Usage Information</a></li>
<li><a href="linux-command-lines.html#70">man – Display a Program's Manual Page</a></li>
<li><a href="linux-command-lines.html#71">apropos – Display Appropriate Commands</a></li>
<li><a href="linux-command-lines.html#72">whatis – Display One-line Manual Page Descriptions</a></li>
<li><a href="linux-command-lines.html#72">info – Display a Program's Info Entry</a></li>
<li><a href="linux-command-lines.html#74">README and Other Program Documentation Files</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#74">Creating Our Own Commands with alias</a></li>
<li><a href="linux-command-lines.html#76">Summing Up</a></li>
<li><a href="linux-command-lines.html#76">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#78">6 – Redirection</a>
<ul>
<li><a href="linux-command-lines.html#78">Standard Input, Output, and Error</a></li>
<li><a href="linux-command-lines.html#79">Redirecting Standard Output</a></li>
<li><a href="linux-command-lines.html#81">Redirecting Standard Error</a>
<ul>
<li><a href="linux-command-lines.html#81">Redirecting Standard Output and Standard Error to One File</a></li>
<li><a href="linux-command-lines.html#82">Disposing of Unwanted Output</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#82">Redirecting Standard Input</a>
<ul>
<li><a href="linux-command-lines.html#83">cat – Concatenate Files</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#85">Pipelines</a>
<ul>
<li><a href="linux-command-lines.html#86">Filters</a></li>
<li><a href="linux-command-lines.html#86">uniq - Report or Omit Repeated Lines</a></li>
<li><a href="linux-command-lines.html#87">wc – Print Line, Word, and Byte Counts</a></li>
<li><a href="linux-command-lines.html#87">grep – Print Lines Matching a Pattern</a></li>
<li><a href="linux-command-lines.html#88">head / tail – Print First / Last Part of Files</a></li>
<li><a href="linux-command-lines.html#89">tee – Read from Stdin and Output to Stdout and Files</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#90">Summing Up</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#92">7 – Seeing the World as the Shell Sees It</a>
<ul>
<li><a href="linux-command-lines.html#92">Expansion</a>
<ul>
<li><a href="linux-command-lines.html#93">Pathname Expansion</a></li>
<li><a href="linux-command-lines.html#94">Tilde Expansion</a></li>
<li><a href="linux-command-lines.html#95">Arithmetic Expansion</a></li>
<li><a href="linux-command-lines.html#96">Brace Expansion</a></li>
<li><a href="linux-command-lines.html#97">Parameter Expansion</a></li>
<li><a href="linux-command-lines.html#98">Command Substitution</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#99">Quoting</a>
<ul>
<li><a href="linux-command-lines.html#100">Double Quotes</a></li>
<li><a href="linux-command-lines.html#102">Single Quotes</a></li>
<li><a href="linux-command-lines.html#102">Escaping Characters</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#103">Summing Up</a></li>
<li><a href="linux-command-lines.html#104">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#105">8 – Advanced Keyboard Tricks</a>
<ul>
<li><a href="linux-command-lines.html#105">Command Line Editing</a>
<ul>
<li><a href="linux-command-lines.html#105">Cursor Movement</a></li>
<li><a href="linux-command-lines.html#106">Modifying Text</a></li>
<li><a href="linux-command-lines.html#106">Cutting and Pasting (Killing and Yanking) Text</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#107">Completion</a></li>
<li><a href="linux-command-lines.html#109">Using History</a>
<ul>
<li><a href="linux-command-lines.html#110">Searching History</a></li>
<li><a href="linux-command-lines.html#112">History Expansion</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#113">Summing Up</a></li>
<li><a href="linux-command-lines.html#113">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#114">9 – Permissions</a>
<ul>
<li><a href="linux-command-lines.html#115">Owners, Group Members, and Everybody Else</a></li>
<li><a href="linux-command-lines.html#116">Reading, Writing, and Executing</a>
<ul>
<li><a href="linux-command-lines.html#118">chmod – Change File Mode</a></li>
<li><a href="linux-command-lines.html#122">Setting File Mode with the GUI</a></li>
<li><a href="linux-command-lines.html#122">umask – Set Default Permissions</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#125">Changing Identities</a>
<ul>
<li><a href="linux-command-lines.html#126">su – Run a Shell with Substitute User and Group IDs</a></li>
<li><a href="linux-command-lines.html#127">sudo – Execute a Command as Another User</a></li>
<li><a href="linux-command-lines.html#128">chown – Change File Owner and Group</a></li>
<li><a href="linux-command-lines.html#130">chgrp – Change Group Ownership</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#130">Exercising Our Privileges</a></li>
<li><a href="linux-command-lines.html#132">Changing Your Password</a></li>
<li><a href="linux-command-lines.html#133">Summing Up</a></li>
<li><a href="linux-command-lines.html#133">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#134">10 – Processes</a>
<ul>
<li><a href="linux-command-lines.html#134">How a Process Works</a></li>
<li><a href="linux-command-lines.html#135">Viewing Processes</a>
<ul>
<li><a href="linux-command-lines.html#137">Viewing Processes Dynamically with top</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#140">Controlling Processes</a>
<ul>
<li><a href="linux-command-lines.html#140">Interrupting a Process</a></li>
<li><a href="linux-command-lines.html#141">Putting a Process in the Background</a></li>
<li><a href="linux-command-lines.html#142">Returning a Process to the Foreground</a></li>
<li><a href="linux-command-lines.html#142">Stopping (Pausing) a Process</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#143">Signals</a>
<ul>
<li><a href="linux-command-lines.html#144">Sending Signals to Processes with kill</a></li>
<li><a href="linux-command-lines.html#146">Sending Signals to Multiple Processes with killall</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#147">Shutting Down the System</a></li>
<li><a href="linux-command-lines.html#148">More Process-Related Commands</a></li>
<li><a href="linux-command-lines.html#148">Summing Up</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="linux-command-lines.html#151">Part 2 – Configuration and the Environment</a>
<ul>
<li><a href="linux-command-lines.html#152">11 – The Environment</a>
<ul>
<li><a href="linux-command-lines.html#152">What is Stored in the Environment?</a>
<ul>
<li><a href="linux-command-lines.html#152">Examining The Environment</a></li>
<li><a href="linux-command-lines.html#154">Some Interesting Variables</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#155">How Is The Environment Established?</a>
<ul>
<li><a href="linux-command-lines.html#156">What's in a Startup File?</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#158">Modifying the Environment</a>
<ul>
<li><a href="linux-command-lines.html#159">Which Files Should We Modify?</a></li>
<li><a href="linux-command-lines.html#159">Text Editors</a></li>
<li><a href="linux-command-lines.html#160">Using a Text Editor</a></li>
<li><a href="linux-command-lines.html#164">Activating Our Changes</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#164">Summing Up</a></li>
<li><a href="linux-command-lines.html#164">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#165">12 – A Gentle Introduction to vi</a>
<ul>
<li><a href="linux-command-lines.html#165">Why We Should Learn vi</a></li>
<li><a href="linux-command-lines.html#166">A Little Background</a></li>
<li><a href="linux-command-lines.html#166">Starting and Stopping vi</a></li>
<li><a href="linux-command-lines.html#168">Editing Modes</a>
<ul>
<li><a href="linux-command-lines.html#169">Entering Insert Mode</a></li>
<li><a href="linux-command-lines.html#169">Saving Our Work</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#170">Moving the Cursor Around</a></li>
<li><a href="linux-command-lines.html#171">Basic Editing</a>
<ul>
<li><a href="linux-command-lines.html#171">Appending Text</a></li>
<li><a href="linux-command-lines.html#172">Opening a Line</a></li>
<li><a href="linux-command-lines.html#173">Deleting Text</a></li>
<li><a href="linux-command-lines.html#174">Cutting, Copying, and Pasting Text</a></li>
<li><a href="linux-command-lines.html#176">Joining Lines</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#176">Search-and-Replace</a>
<ul>
<li><a href="linux-command-lines.html#176">Searching Within a Line</a></li>
<li><a href="linux-command-lines.html#176">Searching the Entire File</a></li>
<li><a href="linux-command-lines.html#177">Global Search-and-Replace</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#179">Editing Multiple Files</a>
<ul>
<li><a href="linux-command-lines.html#180">Switching Between Files</a></li>
<li><a href="linux-command-lines.html#181">Opening Additional Files for Editing</a></li>
<li><a href="linux-command-lines.html#181">Copying Content from One File into Another</a></li>
<li><a href="linux-command-lines.html#182">Inserting an Entire File into Another</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#183">Saving Our Work</a></li>
<li><a href="linux-command-lines.html#184">Summing Up</a></li>
<li><a href="linux-command-lines.html#184">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#186">13 – Customizing the Prompt</a>
<ul>
<li><a href="linux-command-lines.html#186">Anatomy of a Prompt</a></li>
<li><a href="linux-command-lines.html#188">Trying Some Alternative Prompt Designs</a></li>
<li><a href="linux-command-lines.html#189">Adding Color</a></li>
<li><a href="linux-command-lines.html#192">Moving the Cursor</a></li>
<li><a href="linux-command-lines.html#193">Saving the Prompt</a></li>
<li><a href="linux-command-lines.html#193">Summing Up</a></li>
<li><a href="linux-command-lines.html#194">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="linux-command-lines.html#195">Part 3 – Common Tasks and Essential Tools</a>
<ul>
<li><a href="linux-command-lines.html#196">14 – Package Management</a>
<ul>
<li><a href="linux-command-lines.html#196">Packaging Systems</a></li>
<li><a href="linux-command-lines.html#197">How a Package System Works</a>
<ul>
<li><a href="linux-command-lines.html#197">Package Files</a></li>
<li><a href="linux-command-lines.html#197">Repositories</a></li>
<li><a href="linux-command-lines.html#198">Dependencies</a></li>
<li><a href="linux-command-lines.html#198">High and Low-level Package Tools</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#199">Common Package Management Tasks</a>
<ul>
<li><a href="linux-command-lines.html#199">Finding a Package in a Repository</a></li>
<li><a href="linux-command-lines.html#199">Installing a Package from a Repository</a></li>
<li><a href="linux-command-lines.html#200">Installing a Package from a Package File</a></li>
<li><a href="linux-command-lines.html#200">Removing a Package</a></li>
<li><a href="linux-command-lines.html#201">Updating Packages from a Repository</a></li>
<li><a href="linux-command-lines.html#201">Upgrading a Package from a Package File</a></li>
<li><a href="linux-command-lines.html#202">Listing Installed Packages</a></li>
<li><a href="linux-command-lines.html#202">Determining Whether a Package is Installed</a></li>
<li><a href="linux-command-lines.html#203">Displaying Information About an Installed Package</a></li>
<li><a href="linux-command-lines.html#203">Finding Which Package Installed a File</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#204">Summing Up</a></li>
<li><a href="linux-command-lines.html#205">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#206">15 – Storage Media</a>
<ul>
<li><a href="linux-command-lines.html#206">Mounting and Unmounting Storage Devices</a>
<ul>
<li><a href="linux-command-lines.html#208">Viewing a List of Mounted File Systems</a></li>
<li><a href="linux-command-lines.html#212">Determining Device Names</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#215">Creating New File Systems</a>
<ul>
<li><a href="linux-command-lines.html#216">Manipulating Partitions with fdisk</a></li>
<li><a href="linux-command-lines.html#218">Creating a New File System with mkfs</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#219">Testing and Repairing File Systems</a></li>
<li><a href="linux-command-lines.html#220">Moving Data Directly to and from Devices</a></li>
<li><a href="linux-command-lines.html#221">Creating CD-ROM Images</a>
<ul>
<li><a href="linux-command-lines.html#221">Creating an Image Copy of a CD-ROM</a></li>
<li><a href="linux-command-lines.html#221">Creating an Image From a Collection of Files</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#222">Writing CD-ROM Images</a>
<ul>
<li><a href="linux-command-lines.html#222">Mounting an ISO Image Directly</a></li>
<li><a href="linux-command-lines.html#223">Blanking a Rewritable CD-ROM</a></li>
<li><a href="linux-command-lines.html#223">Writing an Image</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#223">Summing Up</a></li>
<li><a href="linux-command-lines.html#223">Further Reading</a></li>
<li><a href="linux-command-lines.html#223">Extra Credit</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#225">16 – Networking</a>
<ul>
<li><a href="linux-command-lines.html#226">Examining and Monitoring a Network</a>
<ul>
<li><a href="linux-command-lines.html#226">ping</a></li>
<li><a href="linux-command-lines.html#227">traceroute</a></li>
<li><a href="linux-command-lines.html#228">ip</a></li>
<li><a href="linux-command-lines.html#229">netstat</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#230">Transporting Files Over a Network</a>
<ul>
<li><a href="linux-command-lines.html#230">ftp</a></li>
<li><a href="linux-command-lines.html#233">lftp – A Better ftp</a></li>
<li><a href="linux-command-lines.html#233">wget</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#233">Secure Communication with Remote Hosts</a>
<ul>
<li><a href="linux-command-lines.html#234">ssh</a></li>
<li><a href="linux-command-lines.html#238">scp and sftp</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#239">Summing Up</a></li>
<li><a href="linux-command-lines.html#239">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#241">17 – Searching for Files</a>
<ul>
<li><a href="linux-command-lines.html#241">locate – Find Files the Easy Way</a></li>
<li><a href="linux-command-lines.html#243">find – Find Files the Hard Way</a>
<ul>
<li><a href="linux-command-lines.html#244">Tests</a></li>
<li><a href="linux-command-lines.html#246">Operators</a></li>
<li><a href="linux-command-lines.html#249">Predefined Actions</a></li>
<li><a href="linux-command-lines.html#251">User-Defined Actions</a></li>
<li><a href="linux-command-lines.html#252">Improving Efficiency</a></li>
<li><a href="linux-command-lines.html#252">xargs</a></li>
<li><a href="linux-command-lines.html#253">A Return to the Playground</a></li>
<li><a href="linux-command-lines.html#256">Options</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#257">Summing Up</a></li>
<li><a href="linux-command-lines.html#257">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#258">18 – Archiving and Backup</a>
<ul>
<li><a href="linux-command-lines.html#258">Compressing Files</a>
<ul>
<li><a href="linux-command-lines.html#259">gzip</a></li>
<li><a href="linux-command-lines.html#261">bzip2</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#262">Archiving Files</a>
<ul>
<li><a href="linux-command-lines.html#263">tar</a></li>
<li><a href="linux-command-lines.html#268">zip</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#270">Synchronizing Files and Directories</a>
<ul>
<li><a href="linux-command-lines.html#273">Using rsync Over a Network</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#274">Summing Up</a></li>
<li><a href="linux-command-lines.html#274">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#275">19 – Regular Expressions</a>
<ul>
<li><a href="linux-command-lines.html#275">What are Regular Expressions?</a></li>
<li><a href="linux-command-lines.html#275">grep</a></li>
<li><a href="linux-command-lines.html#277">Metacharacters and Literals</a></li>
<li><a href="linux-command-lines.html#278">The Any Character</a></li>
<li><a href="linux-command-lines.html#279">Anchors</a></li>
<li><a href="linux-command-lines.html#280">Bracket Expressions and Character Classes</a>
<ul>
<li><a href="linux-command-lines.html#281">Negation</a></li>
<li><a href="linux-command-lines.html#281">Traditional Character Ranges</a></li>
<li><a href="linux-command-lines.html#282">POSIX Character Classes</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#286">POSIX Basic vs. Extended Regular Expressions</a></li>
<li><a href="linux-command-lines.html#287">Alternation</a></li>
<li><a href="linux-command-lines.html#288">Quantifiers</a>
<ul>
<li><a href="linux-command-lines.html#288">? - Match an Element Zero or One Time</a></li>
<li><a href="linux-command-lines.html#289">* - Match an Element Zero or More Times</a></li>
<li><a href="linux-command-lines.html#290">+ - Match an Element One or More Times</a></li>
<li><a href="linux-command-lines.html#290">{ } - Match an Element a Specific Number of Times</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#291">Putting Regular Expressions to Work</a>
<ul>
<li><a href="linux-command-lines.html#291">Validating a Phone List With grep</a></li>
<li><a href="linux-command-lines.html#293">Finding Ugly Filenames with find</a></li>
<li><a href="linux-command-lines.html#293">Searching for Files with locate</a></li>
<li><a href="linux-command-lines.html#294">Searching for Text with less and vim</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#295">Summing Up</a></li>
<li><a href="linux-command-lines.html#296">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#297">20 – Text Processing</a>
<ul>
<li><a href="linux-command-lines.html#297">Applications of Text</a>
<ul>
<li><a href="linux-command-lines.html#298">Documents</a></li>
<li><a href="linux-command-lines.html#298">Web Pages</a></li>
<li><a href="linux-command-lines.html#298">Email</a></li>
<li><a href="linux-command-lines.html#298">Printer Output</a></li>
<li><a href="linux-command-lines.html#298">Program Source Code</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#298">Revisiting Some Old Friends</a>
<ul>
<li><a href="linux-command-lines.html#299">cat</a></li>
<li><a href="linux-command-lines.html#301">sort</a></li>
<li><a href="linux-command-lines.html#308">uniq</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#310">Slicing and Dicing</a>
<ul>
<li><a href="linux-command-lines.html#310">cut</a></li>
<li><a href="linux-command-lines.html#314">paste</a></li>
<li><a href="linux-command-lines.html#315">join</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#317">Comparing Text</a>
<ul>
<li><a href="linux-command-lines.html#318">comm</a></li>
<li><a href="linux-command-lines.html#319">diff</a></li>
<li><a href="linux-command-lines.html#321">patch</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#322">Editing on the Fly</a>
<ul>
<li><a href="linux-command-lines.html#323">tr</a></li>
<li><a href="linux-command-lines.html#325">sed</a></li>
<li><a href="linux-command-lines.html#333">aspell</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#337">Summing Up</a></li>
<li><a href="linux-command-lines.html#337">Further Reading</a></li>
<li><a href="linux-command-lines.html#338">Extra Credit</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#339">21 – Formatting Output</a>
<ul>
<li><a href="linux-command-lines.html#339">Simple Formatting Tools</a>
<ul>
<li><a href="linux-command-lines.html#339">nl – Number Lines</a></li>
<li><a href="linux-command-lines.html#343">fold – Wrap Each Line to a Specified Length</a></li>
<li><a href="linux-command-lines.html#344">fmt – A Simple Text Formatter</a></li>
<li><a href="linux-command-lines.html#347">pr – Format Text for Printing</a></li>
<li><a href="linux-command-lines.html#348">printf – Format and Print Data</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#352">Document Formatting Systems</a>
<ul>
<li><a href="linux-command-lines.html#353">groff</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#359">Summing Up</a></li>
<li><a href="linux-command-lines.html#359">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#361">22 – Printing</a>
<ul>
<li><a href="linux-command-lines.html#361">A Brief History of Printing</a>
<ul>
<li><a href="linux-command-lines.html#361">Printing in the Dim Times</a></li>
<li><a href="linux-command-lines.html#362">Character-Based Printers</a></li>
<li><a href="linux-command-lines.html#363">Graphical Printers</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#364">Printing with Linux</a></li>
<li><a href="linux-command-lines.html#364">Preparing Files for Printing</a>
<ul>
<li><a href="linux-command-lines.html#364">pr – Convert Text Files for Printing</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#366">Sending a Print Job to a Printer</a>
<ul>
<li><a href="linux-command-lines.html#366">lpr – Print Files (Berkeley Style)</a></li>
<li><a href="linux-command-lines.html#367">lp – Print Files (System V Style)</a></li>
<li><a href="linux-command-lines.html#368">Another Option: a2ps</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#371">Monitoring and Controlling Print Jobs</a>
<ul>
<li><a href="linux-command-lines.html#371">lpstat – Display Print System Status</a></li>
<li><a href="linux-command-lines.html#372">lpq – Display Printer Queue Status</a></li>
<li><a href="linux-command-lines.html#373">lprm / cancel – Cancel Print Jobs</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#373">Summing Up</a></li>
<li><a href="linux-command-lines.html#373">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#374">23 – Compiling Programs</a>
<ul>
<li><a href="linux-command-lines.html#374">What is Compiling?</a>
<ul>
<li><a href="linux-command-lines.html#375">Are All Programs Compiled?</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#376">Compiling a C Program</a>
<ul>
<li><a href="linux-command-lines.html#376">Obtaining the Source Code</a></li>
<li><a href="linux-command-lines.html#379">Examining the Source Tree</a></li>
<li><a href="linux-command-lines.html#380">Building the Program</a></li>
<li><a href="linux-command-lines.html#384">Installing the Program</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#385">Summing Up</a></li>
<li><a href="linux-command-lines.html#385">Further Reading</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="linux-command-lines.html#387">Part 4 – Writing Shell Scripts</a>
<ul>
<li><a href="linux-command-lines.html#388">24 – Writing Your First Script</a>
<ul>
<li><a href="linux-command-lines.html#388">What are Shell Scripts?</a></li>
<li><a href="linux-command-lines.html#388">How to Write a Shell Script</a></li>
<li><a href="linux-command-lines.html#389">Script File Format</a></li>
<li><a href="linux-command-lines.html#390">Executable Permissions</a></li>
<li><a href="linux-command-lines.html#390">Script File Location</a>
<ul>
<li><a href="linux-command-lines.html#392">Good Locations for Scripts</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#392">More Formatting Tricks</a>
<ul>
<li><a href="linux-command-lines.html#392">Long Option Names</a></li>
<li><a href="linux-command-lines.html#392">Indentation and Line-Continuation</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#394">Summing Up</a></li>
<li><a href="linux-command-lines.html#394">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#395">25 – Starting a Project</a>
<ul>
<li><a href="linux-command-lines.html#395">First Stage: Minimal Document</a></li>
<li><a href="linux-command-lines.html#397">Second Stage: Adding a Little Data</a></li>
<li><a href="linux-command-lines.html#398">Variables and Constants</a>
<ul>
<li><a href="linux-command-lines.html#401">Assigning Values to Variables and Constants</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#403">Here Documents</a></li>
<li><a href="linux-command-lines.html#405">Summing Up</a></li>
<li><a href="linux-command-lines.html#406">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#407">26 – Top-Down Design</a>
<ul>
<li><a href="linux-command-lines.html#408">Shell Functions</a></li>
<li><a href="linux-command-lines.html#411">Local Variables</a></li>
<li><a href="linux-command-lines.html#412">Keep Scripts Running</a></li>
<li><a href="linux-command-lines.html#415">Summing Up</a></li>
<li><a href="linux-command-lines.html#416">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#417">27 – Flow Control: Branching with if</a>
<ul>
<li><a href="linux-command-lines.html#417">if</a></li>
<li><a href="linux-command-lines.html#418">Exit Status</a></li>
<li><a href="linux-command-lines.html#420">test</a>
<ul>
<li><a href="linux-command-lines.html#420">File Expressions</a></li>
<li><a href="linux-command-lines.html#423">String Expressions</a></li>
<li><a href="linux-command-lines.html#424">Integer Expressions</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#426">A More Modern Version of test</a></li>
<li><a href="linux-command-lines.html#427">(( )) - Designed for Integers</a></li>
<li><a href="linux-command-lines.html#428">Combining Expressions</a></li>
<li><a href="linux-command-lines.html#431">Control Operators: Another Way to Branch</a></li>
<li><a href="linux-command-lines.html#432">Summing Up</a></li>
<li><a href="linux-command-lines.html#433">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#434">28 – Reading Keyboard Input</a>
<ul>
<li><a href="linux-command-lines.html#435">read – Read Values from Standard Input</a>
<ul>
<li><a href="linux-command-lines.html#437">Options</a></li>
<li><a href="linux-command-lines.html#439">IFS</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#442">Validating Input</a></li>
<li><a href="linux-command-lines.html#443">Menus</a></li>
<li><a href="linux-command-lines.html#445">Summing Up</a>
<ul>
<li><a href="linux-command-lines.html#445">Extra Credit</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#445">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#447">29 – Flow Control: Looping with while / until</a>
<ul>
<li><a href="linux-command-lines.html#447">Looping</a>
<ul>
<li><a href="linux-command-lines.html#448">while</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#450">Breaking Out of a Loop</a>
<ul>
<li><a href="linux-command-lines.html#452">until</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#452">Reading Files with Loops</a></li>
<li><a href="linux-command-lines.html#453">Summing Up</a></li>
<li><a href="linux-command-lines.html#453">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#454">30 – Troubleshooting</a>
<ul>
<li><a href="linux-command-lines.html#454">Syntactic Errors</a>
<ul>
<li><a href="linux-command-lines.html#455">Missing Quotes</a></li>
<li><a href="linux-command-lines.html#456">Missing or Unexpected Tokens</a></li>
<li><a href="linux-command-lines.html#456">Unanticipated Expansions</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#458">Logical Errors</a>
<ul>
<li><a href="linux-command-lines.html#459">Defensive Programming</a></li>
<li><a href="linux-command-lines.html#460">Watch Out for Filenames</a></li>
<li><a href="linux-command-lines.html#461">Verifying Input</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#462">Testing</a>
<ul>
<li><a href="linux-command-lines.html#463">Test Cases</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#463">Debugging</a>
<ul>
<li><a href="linux-command-lines.html#463">Finding the Problem Area</a></li>
<li><a href="linux-command-lines.html#464">Tracing</a></li>
<li><a href="linux-command-lines.html#466">Examining Values During Execution</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#467">Summing Up</a></li>
<li><a href="linux-command-lines.html#467">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#468">31 – Flow Control: Branching with case</a>
<ul>
<li><a href="linux-command-lines.html#468">case</a>
<ul>
<li><a href="linux-command-lines.html#470">Patterns</a></li>
<li><a href="linux-command-lines.html#472">Performing Multiple Actions</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#474">Summing Up</a></li>
<li><a href="linux-command-lines.html#474">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#475">32 – Positional Parameters</a>
<ul>
<li><a href="linux-command-lines.html#475">Accessing the Command Line</a>
<ul>
<li><a href="linux-command-lines.html#476">Determining the Number of Arguments</a></li>
<li><a href="linux-command-lines.html#477">shift – Getting Access to Many Arguments</a></li>
<li><a href="linux-command-lines.html#479">Simple Applications</a></li>
<li><a href="linux-command-lines.html#479">Using Positional Parameters with Shell Functions</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#480">Handling Positional Parameters en Masse</a></li>
<li><a href="linux-command-lines.html#483">A More Complete Application</a></li>
<li><a href="linux-command-lines.html#486">Summing Up</a></li>
<li><a href="linux-command-lines.html#489">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#490">33 – Flow Control: Looping with for</a>
<ul>
<li><a href="linux-command-lines.html#490">for: Traditional Shell Form</a></li>
<li><a href="linux-command-lines.html#493">for: C Language Form</a></li>
<li><a href="linux-command-lines.html#495">Summing Up</a></li>
<li><a href="linux-command-lines.html#496">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#497">34 – Strings and Numbers</a>
<ul>
<li><a href="linux-command-lines.html#497">Parameter Expansion</a>
<ul>
<li><a href="linux-command-lines.html#497">Basic Parameters</a></li>
<li><a href="linux-command-lines.html#498">Expansions to Manage Empty Variables</a></li>
<li><a href="linux-command-lines.html#500">Expansions That Return Variable Names</a></li>
<li><a href="linux-command-lines.html#500">String Operations</a></li>
<li><a href="linux-command-lines.html#504">Case Conversion</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#506">Arithmetic Evaluation and Expansion</a>
<ul>
<li><a href="linux-command-lines.html#506">Number Bases</a></li>
<li><a href="linux-command-lines.html#507">Unary Operators</a></li>
<li><a href="linux-command-lines.html#507">Simple Arithmetic</a></li>
<li><a href="linux-command-lines.html#508">Assignment</a></li>
<li><a href="linux-command-lines.html#511">Bit Operations</a></li>
<li><a href="linux-command-lines.html#512">Logic</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#515">bc – An Arbitrary Precision Calculator Language</a>
<ul>
<li><a href="linux-command-lines.html#515">Using bc</a></li>
<li><a href="linux-command-lines.html#516">An Example Script</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#517">Summing Up</a></li>
<li><a href="linux-command-lines.html#518">Extra Credit</a></li>
<li><a href="linux-command-lines.html#518">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#519">35 – Arrays</a>
<ul>
<li><a href="linux-command-lines.html#519">What Are Arrays?</a></li>
<li><a href="linux-command-lines.html#519">Creating an Array</a></li>
<li><a href="linux-command-lines.html#520">Assigning Values to an Array</a></li>
<li><a href="linux-command-lines.html#521">Accessing Array Elements</a></li>
<li><a href="linux-command-lines.html#523">Array Operations</a>
<ul>
<li><a href="linux-command-lines.html#523">Outputting the Entire Contents of an Array</a></li>
<li><a href="linux-command-lines.html#524">Determining the Number of Array Elements</a></li>
<li><a href="linux-command-lines.html#524">Finding the Subscripts Used by an Array</a></li>
<li><a href="linux-command-lines.html#525">Adding Elements to the End of an Array</a></li>
<li><a href="linux-command-lines.html#525">Sorting an Array</a></li>
<li><a href="linux-command-lines.html#526">Deleting an Array</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#527">Associative Arrays</a></li>
<li><a href="linux-command-lines.html#527">Summing Up</a></li>
<li><a href="linux-command-lines.html#528">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#529">36 – Exotica</a>
<ul>
<li><a href="linux-command-lines.html#529">Group Commands and Subshells</a>
<ul>
<li><a href="linux-command-lines.html#533">Process Substitution</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#535">Traps</a></li>
<li><a href="linux-command-lines.html#539">Asynchronous Execution</a>
<ul>
<li><a href="linux-command-lines.html#539">wait</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#540">Named Pipes</a>
<ul>
<li><a href="linux-command-lines.html#541">Setting Up a Named Pipe</a></li>
<li><a href="linux-command-lines.html#541">Using Named Pipes</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#542">Summing Up</a></li>
<li><a href="linux-command-lines.html#542">Further Reading</a></li>
</ul>
</li>
<li><a href="linux-command-lines.html#543">Index</a></li>
</ul>
</li>
</ul>
<hr/>
</body>
</html>
